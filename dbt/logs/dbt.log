[0m17:37:47.633940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736317A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273651D4D30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273651D4B80>]}


============================== 17:37:47.638925 | d7d7defb-24fd-41ba-9ef2-4c44fcaf5fa1 ==============================
[0m17:37:47.638925 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:37:47.640185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt init f1_analytics', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:37:47.669654 [debug] [MainThread]: Starter project path: C:\Users\samee\Desktop\F1\.venv\lib\site-packages\dbt\include\starter_project
[0m17:37:47.692343 [info ] [MainThread]: 
Your new dbt project "f1_analytics" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m17:37:47.692343 [info ] [MainThread]: Setting up your profile.
[0m17:38:55.079528 [info ] [MainThread]: Profile f1_analytics written to C:\Users\samee\Desktop\F1\dbt\profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m17:38:55.082563 [debug] [MainThread]: Command `dbt init` succeeded at 17:38:55.082563 after 67.59 seconds
[0m17:38:55.082563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002736317A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273651D4AC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000273642E11B0>]}
[0m17:38:55.085785 [debug] [MainThread]: Flushing usage events
[0m17:38:56.292468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:58.307709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEC96A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEDBF0D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEDBF0BB0>]}


============================== 17:44:58.314448 | a44d8024-6da6-4a8d-9d33-ee60e6c029fb ==============================
[0m17:44:58.314448 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:44:58.314448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:44:58.333135 [info ] [MainThread]: dbt version: 1.10.6
[0m17:44:58.345918 [info ] [MainThread]: python version: 3.10.10
[0m17:44:58.345918 [info ] [MainThread]: python path: C:\Users\samee\Desktop\F1\.venv\Scripts\python.exe
[0m17:44:58.345918 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:44:59.335863 [info ] [MainThread]: Using profiles dir at C:\Users\samee\Desktop\F1\dbt
[0m17:44:59.335863 [info ] [MainThread]: Using profiles.yml file at C:\Users\samee\Desktop\F1\dbt\profiles.yml
[0m17:44:59.335863 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\samee\Desktop\F1\dbt\dbt_project.yml
[0m17:44:59.335863 [info ] [MainThread]: adapter type: snowflake
[0m17:44:59.335863 [info ] [MainThread]: adapter version: 1.10.0
[0m17:44:59.335863 [info ] [MainThread]: Configuration:
[0m17:44:59.335863 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:44:59.335863 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m17:44:59.335863 [info ] [MainThread]: Required dependencies:
[0m17:44:59.335863 [debug] [MainThread]: Executing "git --help"
[0m17:44:59.420511 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:44:59.420511 [debug] [MainThread]: STDERR: "b''"
[0m17:44:59.420511 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:44:59.420511 [info ] [MainThread]: Connection:
[0m17:44:59.420511 [info ] [MainThread]:   account: zczvngs-ti82223
[0m17:44:59.420511 [info ] [MainThread]:   user: MARKPONI
[0m17:44:59.420511 [info ] [MainThread]:   database: F1
[0m17:44:59.420511 [info ] [MainThread]:   warehouse: F1_WH
[0m17:44:59.420511 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m17:44:59.420511 [info ] [MainThread]:   schema: PONI
[0m17:44:59.431676 [info ] [MainThread]:   authenticator: None
[0m17:44:59.431676 [info ] [MainThread]:   oauth_client_id: None
[0m17:44:59.431676 [info ] [MainThread]:   query_tag: None
[0m17:44:59.431676 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:44:59.431676 [info ] [MainThread]:   host: None
[0m17:44:59.431676 [info ] [MainThread]:   port: None
[0m17:44:59.431676 [info ] [MainThread]:   proxy_host: None
[0m17:44:59.431676 [info ] [MainThread]:   proxy_port: None
[0m17:44:59.431676 [info ] [MainThread]:   protocol: None
[0m17:44:59.431676 [info ] [MainThread]:   connect_retries: 1
[0m17:44:59.431676 [info ] [MainThread]:   connect_timeout: None
[0m17:44:59.431676 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:44:59.447353 [info ] [MainThread]:   retry_all: False
[0m17:44:59.447353 [info ] [MainThread]:   insecure_mode: False
[0m17:44:59.447353 [info ] [MainThread]:   reuse_connections: True
[0m17:44:59.447353 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m17:44:59.452836 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:44:59.776461 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:45:10.741947 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:45:10.741947 [debug] [MainThread]: On debug: select 1 as id
[0m17:45:10.741947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:13.042690 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.295 seconds
[0m17:45:13.044436 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:45:13.045699 [info ] [MainThread]: [31m1 check failed:[0m
[0m17:45:13.046798 [info ] [MainThread]: Project loading failed for the following reason:
 project path <C:\Users\samee\Desktop\F1\dbt\dbt_project.yml> not found

[0m17:45:13.048445 [debug] [MainThread]: Command `dbt debug` failed at 17:45:13.048445 after 14.83 seconds
[0m17:45:13.048974 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:45:13.049509 [debug] [MainThread]: On debug: Close
[0m17:45:13.686482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024DEC96A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D8662E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024D86671360>]}
[0m17:45:13.686482 [debug] [MainThread]: Flushing usage events
[0m17:45:14.932024 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:08.138762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1EB6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A3F1CD60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A3F1CB80>]}


============================== 17:49:08.144530 | c7c4b762-d48f-47f2-9283-3865bf0d6235 ==============================
[0m17:49:08.144530 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:49:08.144530 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:49:08.170681 [info ] [MainThread]: dbt version: 1.10.6
[0m17:49:08.170681 [info ] [MainThread]: python version: 3.10.10
[0m17:49:08.170681 [info ] [MainThread]: python path: C:\Users\samee\Desktop\F1\.venv\Scripts\python.exe
[0m17:49:08.170681 [info ] [MainThread]: os info: Windows-10-10.0.26100-SP0
[0m17:49:09.092881 [info ] [MainThread]: Using profiles dir at C:\Users\samee\Desktop\F1\dbt
[0m17:49:09.094888 [info ] [MainThread]: Using profiles.yml file at C:\Users\samee\Desktop\F1\dbt\profiles.yml
[0m17:49:09.094888 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\samee\Desktop\F1\dbt\dbt_project.yml
[0m17:49:09.094888 [info ] [MainThread]: adapter type: snowflake
[0m17:49:09.094888 [info ] [MainThread]: adapter version: 1.10.0
[0m17:49:09.200135 [info ] [MainThread]: Configuration:
[0m17:49:09.200135 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:49:09.200135 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:49:09.200135 [info ] [MainThread]: Required dependencies:
[0m17:49:09.200135 [debug] [MainThread]: Executing "git --help"
[0m17:49:09.265990 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:49:09.267998 [debug] [MainThread]: STDERR: "b''"
[0m17:49:09.267998 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:49:09.270006 [info ] [MainThread]: Connection:
[0m17:49:09.270006 [info ] [MainThread]:   account: zczvngs-ti82223
[0m17:49:09.272012 [info ] [MainThread]:   user: MARKPONI
[0m17:49:09.272012 [info ] [MainThread]:   database: F1
[0m17:49:09.274017 [info ] [MainThread]:   warehouse: F1_WH
[0m17:49:09.274017 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m17:49:09.276023 [info ] [MainThread]:   schema: PONI
[0m17:49:09.276023 [info ] [MainThread]:   authenticator: None
[0m17:49:09.276023 [info ] [MainThread]:   oauth_client_id: None
[0m17:49:09.276023 [info ] [MainThread]:   query_tag: None
[0m17:49:09.279714 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:49:09.279714 [info ] [MainThread]:   host: None
[0m17:49:09.282231 [info ] [MainThread]:   port: None
[0m17:49:09.284253 [info ] [MainThread]:   proxy_host: None
[0m17:49:09.284253 [info ] [MainThread]:   proxy_port: None
[0m17:49:09.286265 [info ] [MainThread]:   protocol: None
[0m17:49:09.286265 [info ] [MainThread]:   connect_retries: 1
[0m17:49:09.286265 [info ] [MainThread]:   connect_timeout: None
[0m17:49:09.286265 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:49:09.286265 [info ] [MainThread]:   retry_all: False
[0m17:49:09.286265 [info ] [MainThread]:   insecure_mode: False
[0m17:49:09.286265 [info ] [MainThread]:   reuse_connections: True
[0m17:49:09.286265 [info ] [MainThread]:   s3_stage_vpce_dns_name: None
[0m17:49:09.295540 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:49:09.613842 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:49:09.716414 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:49:09.716414 [debug] [MainThread]: On debug: select 1 as id
[0m17:49:09.716414 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:49:11.556085 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.830 seconds
[0m17:49:11.556085 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:49:11.559608 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:49:11.559608 [debug] [MainThread]: Command `dbt debug` succeeded at 17:49:11.559608 after 3.51 seconds
[0m17:49:11.559608 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:49:11.559608 [debug] [MainThread]: On debug: Close
[0m17:49:12.239039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A1EB6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211A3662B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211BC927490>]}
[0m17:49:12.240189 [debug] [MainThread]: Flushing usage events
[0m17:49:13.422328 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:03:18.144758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179E019A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179E1230EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179E1230D00>]}


============================== 18:03:18.159322 | 310ede3c-ac82-408a-888a-d880e1729d64 ==============================
[0m18:03:18.159322 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:03:18.159322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --models staging.stg_sessions', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:03:18.159322 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
Usage of `--models`, `--model`, and `-m` is deprecated in favor of `--select` or
`-s`.
[0m18:03:18.159322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '310ede3c-ac82-408a-888a-d880e1729d64', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179E1230BE0>]}
[0m18:03:19.312345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '310ede3c-ac82-408a-888a-d880e1729d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179E1232B60>]}
[0m18:03:19.386002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '310ede3c-ac82-408a-888a-d880e1729d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179E0AE9840>]}
[0m18:03:19.388433 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:03:19.765587 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:03:19.765587 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:03:19.765587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '310ede3c-ac82-408a-888a-d880e1729d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179F9C9F490>]}
[0m18:03:20.621342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.f1_analytics.example
[0m18:03:20.627501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '310ede3c-ac82-408a-888a-d880e1729d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FA05E6E0>]}
[0m18:03:20.674596 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:03:20.674596 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:03:20.726607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '310ede3c-ac82-408a-888a-d880e1729d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FA028D90>]}
[0m18:03:20.727895 [info ] [MainThread]: Found 477 macros
[0m18:03:20.730273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '310ede3c-ac82-408a-888a-d880e1729d64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FA02ABF0>]}
[0m18:03:20.730875 [warn ] [MainThread]: The selection criterion 'staging.stg_sessions' does not match any enabled nodes
[0m18:03:20.732886 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:03:20.732886 [debug] [MainThread]: Command end result
[0m18:03:20.759417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:03:20.762196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:03:20.766153 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m18:03:20.767469 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- ModelParamUsageDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:03:20.769746 [debug] [MainThread]: Command `dbt run` succeeded at 18:03:20.769746 after 2.75 seconds
[0m18:03:20.770584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179E019A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179FA05DF00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179E026B2E0>]}
[0m18:03:20.771224 [debug] [MainThread]: Flushing usage events
[0m18:03:22.165687 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:04:53.516127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088EDAA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088FE410F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088FE40F10>]}


============================== 18:04:53.516127 | f7b22c9f-4568-439d-b5a6-7570c61662a3 ==============================
[0m18:04:53.516127 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:04:53.522007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt ls', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:04:54.637115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7b22c9f-4568-439d-b5a6-7570c61662a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A875AEF0>]}
[0m18:04:54.684248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7b22c9f-4568-439d-b5a6-7570c61662a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088FE43520>]}
[0m18:04:54.696378 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:04:55.007554 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:04:55.149441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:04:55.149441 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:04:55.149441 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.f1_analytics.example
[0m18:04:55.163586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7b22c9f-4568-439d-b5a6-7570c61662a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A8CD69B0>]}
[0m18:04:55.211955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:04:55.211955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:04:55.244301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7b22c9f-4568-439d-b5a6-7570c61662a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A8BCC370>]}
[0m18:04:55.244301 [info ] [MainThread]: Found 477 macros
[0m18:04:55.255675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7b22c9f-4568-439d-b5a6-7570c61662a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A8BCF610>]}
[0m18:04:55.255675 [warn ] [MainThread]: No nodes selected!
[0m18:04:55.255675 [debug] [MainThread]: Command `dbt ls` succeeded at 18:04:55.255675 after 1.83 seconds
[0m18:04:55.259609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088EDAA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208A877A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088D556500>]}
[0m18:04:55.259609 [debug] [MainThread]: Flushing usage events
[0m18:04:56.646421 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:58.961713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C16362C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C36A0EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C36A0D00>]}


============================== 18:06:58.967654 | 9e1c99be-9f8b-4a2f-8ccb-e97c847232c0 ==============================
[0m18:06:58.967654 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:06:58.968754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging.stg_sessions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:07:00.237572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e1c99be-9f8b-4a2f-8ccb-e97c847232c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C36A2B60>]}
[0m18:07:00.308767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e1c99be-9f8b-4a2f-8ccb-e97c847232c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C2F59840>]}
[0m18:07:00.308767 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:07:00.604177 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:07:00.763136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:07:00.763136 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:07:00.763136 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.f1_analytics.example
[0m18:07:00.763136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e1c99be-9f8b-4a2f-8ccb-e97c847232c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DC53A7D0>]}
[0m18:07:00.815244 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:07:00.815244 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:07:00.843610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e1c99be-9f8b-4a2f-8ccb-e97c847232c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DC44F190>]}
[0m18:07:00.843610 [info ] [MainThread]: Found 477 macros
[0m18:07:00.843610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e1c99be-9f8b-4a2f-8ccb-e97c847232c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1DC4D36A0>]}
[0m18:07:00.843610 [warn ] [MainThread]: The selection criterion 'staging.stg_sessions' does not match any enabled nodes
[0m18:07:00.843610 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:07:00.858899 [debug] [MainThread]: Command end result
[0m18:07:00.875169 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:07:00.875169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:07:00.875169 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m18:07:00.875169 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:00.875169 after 2.02 seconds
[0m18:07:00.890299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C16362C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C2F59840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F1C26DB2E0>]}
[0m18:07:00.890299 [debug] [MainThread]: Flushing usage events
[0m18:07:02.079780 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:16.191851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA13C62C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA342CEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA342CCD0>]}


============================== 18:07:16.195180 | 0b14a87c-7b1a-4d22-8a72-1aa662c14c1f ==============================
[0m18:07:16.195180 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:07:16.195180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sessions', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:07:17.376529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b14a87c-7b1a-4d22-8a72-1aa662c14c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA25336D0>]}
[0m18:07:17.422192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b14a87c-7b1a-4d22-8a72-1aa662c14c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA342F4F0>]}
[0m18:07:17.422192 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:07:17.748090 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:07:17.891651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:07:17.891651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:07:17.891651 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.f1_analytics.example
[0m18:07:17.907542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b14a87c-7b1a-4d22-8a72-1aa662c14c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBC2CA7A0>]}
[0m18:07:17.952702 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:07:17.968463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:07:18.000176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b14a87c-7b1a-4d22-8a72-1aa662c14c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBC2CB9A0>]}
[0m18:07:18.000176 [info ] [MainThread]: Found 477 macros
[0m18:07:18.008754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b14a87c-7b1a-4d22-8a72-1aa662c14c1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBC263640>]}
[0m18:07:18.008754 [warn ] [MainThread]: The selection criterion 'stg_sessions' does not match any enabled nodes
[0m18:07:18.008754 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:07:18.008754 [debug] [MainThread]: Command end result
[0m18:07:18.043786 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:07:18.047889 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:07:18.055659 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m18:07:18.057066 [debug] [MainThread]: Command `dbt run` succeeded at 18:07:18.057066 after 1.95 seconds
[0m18:07:18.058430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA13C62C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDBBDB6BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDA342F4F0>]}
[0m18:07:18.059253 [debug] [MainThread]: Flushing usage events
[0m18:07:19.329433 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:45.063489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237547FA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023756854F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023756854D60>]}


============================== 18:07:45.070834 | ab4a7625-888c-4b1f-8c90-7254bf6f158e ==============================
[0m18:07:45.070834 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:07:45.070834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_sessions', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:07:45.070834 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'f1_analytics'
[0m18:07:45.070834 [debug] [MainThread]: Command `dbt run` failed at 18:07:45.070834 after 0.14 seconds
[0m18:07:45.070834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237547FA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023756855FF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023756855F90>]}
[0m18:07:45.079303 [debug] [MainThread]: Flushing usage events
[0m18:07:46.323602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:09.519392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4B066350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4C140F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4C140D90>]}


============================== 18:08:09.519392 | ca10daac-4995-4b86-998f-5b4152a5aac5 ==============================
[0m18:08:09.519392 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:08:09.519392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_sessions.sql', 'send_anonymous_usage_stats': 'True'}
[0m18:08:10.669827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca10daac-4995-4b86-998f-5b4152a5aac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4C1093F0>]}
[0m18:08:10.737888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca10daac-4995-4b86-998f-5b4152a5aac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4C1434F0>]}
[0m18:08:10.747873 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:08:11.174302 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:08:11.360011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:08:11.360011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:08:11.360011 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.f1_analytics.example
[0m18:08:11.366126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca10daac-4995-4b86-998f-5b4152a5aac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E64FDA860>]}
[0m18:08:11.423605 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:08:11.432162 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:08:11.471666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca10daac-4995-4b86-998f-5b4152a5aac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E64EEF1C0>]}
[0m18:08:11.471666 [info ] [MainThread]: Found 477 macros
[0m18:08:11.471666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca10daac-4995-4b86-998f-5b4152a5aac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E64F73A60>]}
[0m18:08:11.471666 [warn ] [MainThread]: The selection criterion 'stg_sessions.sql' does not match any enabled nodes
[0m18:08:11.471666 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:08:11.471666 [debug] [MainThread]: Command end result
[0m18:08:11.502961 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:08:11.502961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:08:11.518594 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m18:08:11.522087 [debug] [MainThread]: Command `dbt run` succeeded at 18:08:11.518594 after 2.08 seconds
[0m18:08:11.522087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E4B066350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E64BA7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020E64AC11B0>]}
[0m18:08:11.522087 [debug] [MainThread]: Flushing usage events
[0m18:08:12.781972 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:35.140748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9FE762C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA0F04EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA0F04CD0>]}


============================== 18:09:35.148773 | 4cf26e2d-c623-40aa-96e8-77a80d56fc29 ==============================
[0m18:09:35.148773 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:09:35.150512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sessions', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:09:36.450203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cf26e2d-c623-40aa-96e8-77a80d56fc29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA00136D0>]}
[0m18:09:36.525931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cf26e2d-c623-40aa-96e8-77a80d56fc29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA0F074F0>]}
[0m18:09:36.529132 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:09:36.887532 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:09:37.034355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:37.034355 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:37.034355 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.f1_analytics.example
[0m18:09:37.034355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cf26e2d-c623-40aa-96e8-77a80d56fc29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB9DAA7A0>]}
[0m18:09:37.100735 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:09:37.102740 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:09:37.130047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cf26e2d-c623-40aa-96e8-77a80d56fc29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB9DAB9A0>]}
[0m18:09:37.130047 [info ] [MainThread]: Found 477 macros
[0m18:09:37.130047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cf26e2d-c623-40aa-96e8-77a80d56fc29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB9D43640>]}
[0m18:09:37.143034 [warn ] [MainThread]: The selection criterion 'stg_sessions' does not match any enabled nodes
[0m18:09:37.143034 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:09:37.146615 [debug] [MainThread]: Command end result
[0m18:09:37.162015 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:09:37.162015 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:09:37.162015 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m18:09:37.178075 [debug] [MainThread]: Command `dbt run` succeeded at 18:09:37.178075 after 2.14 seconds
[0m18:09:37.178075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC9FE762C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCB9896BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DCA0F074F0>]}
[0m18:09:37.178075 [debug] [MainThread]: Flushing usage events
[0m18:09:38.392953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:12:14.518592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6E5FFA230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6E7290E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6E7290C40>]}


============================== 18:12:14.524378 | 6d74fa0e-ea09-4788-9b28-1e3c7c70d0bb ==============================
[0m18:12:14.524378 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:12:14.526110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sessions', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:12:15.625748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d74fa0e-ea09-4788-9b28-1e3c7c70d0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6E62B7B20>]}
[0m18:12:15.691633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d74fa0e-ea09-4788-9b28-1e3c7c70d0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6E7257310>]}
[0m18:12:15.691633 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:12:16.117158 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:12:16.208792 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:12:16.223155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d74fa0e-ea09-4788-9b28-1e3c7c70d0bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6E698E830>]}
[0m18:12:17.503361 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in f1_analytics/models\staging\src.yml @ sources: {'name': 'raw', 'schema': 'PONI', 'tables': ['name:sessions']} - at path ['tables'][0]: 'name:sessions' is not of type 'object'
[0m18:12:17.503361 [debug] [MainThread]: Command `dbt run` failed at 18:12:17.503361 after 3.10 seconds
[0m18:12:17.503361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6E5FFA230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6802D8520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C6802D8670>]}
[0m18:12:17.503361 [debug] [MainThread]: Flushing usage events
[0m18:12:18.583581 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:33.845496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017957BB6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017958C8CF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017958C8CD60>]}


============================== 18:13:33.845496 | a1d0cf73-d95b-41bc-a187-e9ad3eef5aeb ==============================
[0m18:13:33.845496 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:13:33.856483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_sessions', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:13:34.916646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a1d0cf73-d95b-41bc-a187-e9ad3eef5aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179715AA200>]}
[0m18:13:34.986020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a1d0cf73-d95b-41bc-a187-e9ad3eef5aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017958C8F4F0>]}
[0m18:13:34.986020 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:13:35.265157 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:13:35.381335 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:13:35.383232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a1d0cf73-d95b-41bc-a187-e9ad3eef5aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000179583D32B0>]}
[0m18:13:36.665535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1d0cf73-d95b-41bc-a187-e9ad3eef5aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017971FA5EA0>]}
[0m18:13:36.832323 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:13:36.833525 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:13:36.873568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1d0cf73-d95b-41bc-a187-e9ad3eef5aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017971ED0A60>]}
[0m18:13:36.874262 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 477 macros
[0m18:13:36.874885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1d0cf73-d95b-41bc-a187-e9ad3eef5aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017971ED3EE0>]}
[0m18:13:36.874885 [info ] [MainThread]: 
[0m18:13:36.874885 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:13:36.879578 [info ] [MainThread]: 
[0m18:13:36.879578 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:13:36.881847 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m18:13:36.944955 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m18:13:36.944955 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m18:13:36.944955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:39.012322 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.060 seconds
[0m18:13:39.049046 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m18:13:39.066327 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m18:13:39.067036 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m18:13:39.067678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:40.808467 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.750 seconds
[0m18:13:40.824794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1d0cf73-d95b-41bc-a187-e9ad3eef5aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017971F709D0>]}
[0m18:13:40.849206 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m18:13:40.851046 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_sessions .................................. [RUN]
[0m18:13:40.852771 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_sessions'
[0m18:13:40.854002 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m18:13:40.859994 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m18:13:40.859994 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m18:13:40.896151 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m18:13:40.902440 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_sessions"
[0m18:13:40.902440 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: create or replace   view F1.PONI.stg_sessions
  
  
  
  
  as (
    

with raw as(
    select * from F1.PONI.sessions
)
SELECT
  CAST(session_key AS INT)             AS session_key,
  CAST(meeting_key AS INT)             AS meeting_key,
  session_name                         AS session_name,
  session_type                         AS session_type,
  TO_TIMESTAMP_NTZ(date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(date_end)           AS date_end,
  location                             AS location
FROM raw
WHERE session_key IS NOT NULL
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */;
[0m18:13:40.902440 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:13:42.924277 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.030 seconds
[0m18:13:42.957036 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a1d0cf73-d95b-41bc-a187-e9ad3eef5aeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017954F37160>]}
[0m18:13:42.957036 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_sessions ............................. [[32mSUCCESS 1[0m in 2.10s]
[0m18:13:42.957036 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m18:13:42.957036 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:42.957036 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m18:13:42.957036 [debug] [MainThread]: On list_F1: Close
[0m18:13:43.553076 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m18:13:43.559170 [debug] [MainThread]: On list_F1_PONI: Close
[0m18:13:44.164758 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was left open.
[0m18:13:44.164758 [debug] [MainThread]: On model.f1_analytics.stg_sessions: Close
[0m18:13:44.795204 [info ] [MainThread]: 
[0m18:13:44.800641 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.91 seconds (7.91s).
[0m18:13:44.803639 [debug] [MainThread]: Command end result
[0m18:13:44.831619 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:13:44.837031 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:13:44.847866 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m18:13:44.848515 [info ] [MainThread]: 
[0m18:13:44.850257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:44.850910 [info ] [MainThread]: 
[0m18:13:44.852156 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:13:44.853443 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:44.853443 after 11.09 seconds
[0m18:13:44.853443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017957BB6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017971F9D510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017957CB92D0>]}
[0m18:13:44.853443 [debug] [MainThread]: Flushing usage events
[0m18:13:46.104032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:11.709058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61CC16380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61EEC0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61EEC0D60>]}


============================== 19:01:11.711425 | 9e9d6c4f-3360-46be-b370-b67fe8ce3181 ==============================
[0m19:01:11.711425 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:01:11.711425 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sessions', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:01:12.613220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9e9d6c4f-3360-46be-b370-b67fe8ce3181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61B18DAE0>]}
[0m19:01:12.678038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9e9d6c4f-3360-46be-b370-b67fe8ce3181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61EEC3550>]}
[0m19:01:12.679841 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:01:12.960997 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:01:13.247054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:13.248313 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m19:01:13.480572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9e9d6c4f-3360-46be-b370-b67fe8ce3181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D637F55090>]}
[0m19:01:13.567277 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:01:13.569262 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:01:13.595029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9e9d6c4f-3360-46be-b370-b67fe8ce3181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D637F568F0>]}
[0m19:01:13.595887 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 477 macros
[0m19:01:13.596391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9d6c4f-3360-46be-b370-b67fe8ce3181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D637F56D10>]}
[0m19:01:13.597775 [info ] [MainThread]: 
[0m19:01:13.599171 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:01:13.599678 [info ] [MainThread]: 
[0m19:01:13.600383 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:13.601576 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:01:13.660770 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:01:13.660770 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:01:13.660770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:15.444686 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.778 seconds
[0m19:01:15.451255 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:01:15.462599 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:01:15.463206 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:01:15.463908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:17.018789 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.556 seconds
[0m19:01:17.047968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9e9d6c4f-3360-46be-b370-b67fe8ce3181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D637D3DB70>]}
[0m19:01:17.065776 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m19:01:17.068576 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_sessions .................................. [RUN]
[0m19:01:17.072773 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_sessions'
[0m19:01:17.074494 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m19:01:17.091911 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m19:01:17.091911 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m19:01:17.120614 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m19:01:17.122252 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_sessions"
[0m19:01:17.123313 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: create or replace   view F1.PONI.stg_sessions
  
  
  
  
  as (
    

with raw as(
    select * from F1.PONI.sessions
)
SELECT
  CAST(session_key AS INT)             AS session_key,
  CAST(meeting_key AS INT)             AS meeting_key,
  session_name                         AS session_name,
  session_type                         AS session_type,
  TO_TIMESTAMP_NTZ(date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(date_end)           AS date_end,
  location                             AS location
FROM raw
WHERE session_key IS NOT NULL and session_type in('Practice', 'Qualifying')
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */;
[0m19:01:17.123822 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:01:18.916385 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.795 seconds
[0m19:01:18.944571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9e9d6c4f-3360-46be-b370-b67fe8ce3181', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6384B7A00>]}
[0m19:01:18.944571 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_sessions ............................. [[32mSUCCESS 1[0m in 1.86s]
[0m19:01:18.944571 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m19:01:18.948591 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:18.948591 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:01:18.948591 [debug] [MainThread]: On list_F1: Close
[0m19:01:19.545823 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:01:19.547133 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:01:20.130751 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was left open.
[0m19:01:20.132449 [debug] [MainThread]: On model.f1_analytics.stg_sessions: Close
[0m19:01:20.716501 [info ] [MainThread]: 
[0m19:01:20.718512 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.12 seconds (7.12s).
[0m19:01:20.720523 [debug] [MainThread]: Command end result
[0m19:01:20.738551 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:01:20.744324 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:01:20.751193 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:01:20.751193 [info ] [MainThread]: 
[0m19:01:20.751193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:20.751193 [info ] [MainThread]: 
[0m19:01:20.751193 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:01:20.751193 [debug] [MainThread]: Command `dbt run` succeeded at 19:01:20.751193 after 9.15 seconds
[0m19:01:20.751193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61CC16380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61DFC39D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D61EEC3550>]}
[0m19:01:20.751193 [debug] [MainThread]: Flushing usage events
[0m19:01:21.856667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:07.628305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018323156350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018324224F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018324224D30>]}


============================== 19:02:07.628305 | 608fd7e4-e312-4f70-a95d-91b42fbcb586 ==============================
[0m19:02:07.628305 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:02:07.628305 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_sessions', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:02:08.479407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '608fd7e4-e312-4f70-a95d-91b42fbcb586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183241F53F0>]}
[0m19:02:08.522205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '608fd7e4-e312-4f70-a95d-91b42fbcb586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001832396C6A0>]}
[0m19:02:08.522205 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:02:08.808007 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:02:09.049516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:02:09.050239 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m19:02:09.317168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '608fd7e4-e312-4f70-a95d-91b42fbcb586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D2C5060>]}
[0m19:02:09.398648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:02:09.401713 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:02:09.423777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '608fd7e4-e312-4f70-a95d-91b42fbcb586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D2C6200>]}
[0m19:02:09.424575 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 477 macros
[0m19:02:09.425229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608fd7e4-e312-4f70-a95d-91b42fbcb586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D2C6C80>]}
[0m19:02:09.426238 [info ] [MainThread]: 
[0m19:02:09.427709 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:02:09.427709 [info ] [MainThread]: 
[0m19:02:09.428722 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:02:09.429730 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:02:09.478770 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:02:09.478770 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:02:09.478770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:11.226619 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.737 seconds
[0m19:02:11.246070 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:02:11.261870 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:02:11.262869 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:02:11.262869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:02:12.905469 [debug] [ThreadPool]: SQL status: SUCCESS 12 in 1.644 seconds
[0m19:02:12.921190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '608fd7e4-e312-4f70-a95d-91b42fbcb586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833CFDCBE0>]}
[0m19:02:12.933791 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m19:02:12.937407 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_sessions .................................. [RUN]
[0m19:02:12.937948 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_sessions'
[0m19:02:12.937948 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m19:02:12.937948 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m19:02:12.937948 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m19:02:12.969215 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m19:02:12.969215 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_sessions"
[0m19:02:12.969215 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: create or replace   view F1.PONI.stg_sessions
  
  
  
  
  as (
    

with raw as(
    select * from F1.PONI.sessions
)
SELECT
  CAST(session_key AS INT)             AS session_key,
  CAST(meeting_key AS INT)             AS meeting_key,
  session_name                         AS session_name,
  session_type                         AS session_type,
  TO_TIMESTAMP_NTZ(date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(date_end)           AS date_end,
  location                             AS location
FROM raw
WHERE session_key IS NOT NULL and session_type in('Race', 'Qualifying')
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */;
[0m19:02:12.969215 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:02:14.893356 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.917 seconds
[0m19:02:14.931615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '608fd7e4-e312-4f70-a95d-91b42fbcb586', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833D8279D0>]}
[0m19:02:14.931615 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_sessions ............................. [[32mSUCCESS 1[0m in 1.99s]
[0m19:02:14.942634 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m19:02:14.942634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:02:14.942634 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:02:14.942634 [debug] [MainThread]: On list_F1: Close
[0m19:02:15.528721 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:02:15.529309 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:02:16.113407 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was left open.
[0m19:02:16.114578 [debug] [MainThread]: On model.f1_analytics.stg_sessions: Close
[0m19:02:16.708736 [info ] [MainThread]: 
[0m19:02:16.710753 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m19:02:16.710753 [debug] [MainThread]: Command end result
[0m19:02:16.757206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:02:16.761518 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:02:16.766889 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:02:16.766889 [info ] [MainThread]: 
[0m19:02:16.766889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:02:16.766889 [info ] [MainThread]: 
[0m19:02:16.766889 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:02:16.766889 [debug] [MainThread]: Command `dbt run` succeeded at 19:02:16.766889 after 9.22 seconds
[0m19:02:16.766889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018323156350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001833CC721D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000183232592D0>]}
[0m19:02:16.766889 [debug] [MainThread]: Flushing usage events
[0m19:02:17.851361 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:15:48.041904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C061A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C2674EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C2674D00>]}


============================== 19:15:48.042584 | 9a8f22e4-2379-467d-a358-15fb46bd9d77 ==============================
[0m19:15:48.042584 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:15:48.042584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_drivers', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:15:48.928520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a8f22e4-2379-467d-a358-15fb46bd9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C16AC790>]}
[0m19:15:48.983631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a8f22e4-2379-467d-a358-15fb46bd9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C26774F0>]}
[0m19:15:48.985736 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:15:49.245441 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:15:49.486649 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:15:49.486649 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg_drivers.sql
[0m19:15:49.488440 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m19:15:49.793932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a8f22e4-2379-467d-a358-15fb46bd9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1DB6C91B0>]}
[0m19:15:49.879924 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:15:49.881708 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:15:49.906176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a8f22e4-2379-467d-a358-15fb46bd9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1DB527C70>]}
[0m19:15:49.908198 [info ] [MainThread]: Found 4 models, 4 data tests, 2 sources, 477 macros
[0m19:15:49.908718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a8f22e4-2379-467d-a358-15fb46bd9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1DB527CD0>]}
[0m19:15:49.910251 [info ] [MainThread]: 
[0m19:15:49.911301 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:15:49.911827 [info ] [MainThread]: 
[0m19:15:49.912861 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:15:49.913326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:15:49.983942 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:15:49.984712 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:15:49.985418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:51.711307 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.726 seconds
[0m19:15:51.719380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:15:51.731669 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:15:51.732276 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:15:51.732276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:15:53.370165 [debug] [ThreadPool]: SQL status: SUCCESS 13 in 1.640 seconds
[0m19:15:53.379496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a8f22e4-2379-467d-a358-15fb46bd9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1DB5254B0>]}
[0m19:15:53.379496 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_drivers
[0m19:15:53.394379 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_drivers ................................... [RUN]
[0m19:15:53.394379 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_drivers'
[0m19:15:53.394379 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_drivers
[0m19:15:53.394379 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_drivers"
[0m19:15:53.394379 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_drivers
[0m19:15:53.430053 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_drivers"
[0m19:15:53.430053 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_drivers"
[0m19:15:53.430053 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: create or replace   view F1.PONI.stg_drivers
  
  
  
  
  as (
    

with raw as(
    select *,
           row_number() over (partition by driver_number, full_name,team_name order by full_name) as rn
           from F1.PONI.drivers
)
SELECT
  CAST(driver_number AS INT)           AS driver_number,
  BROADCAST_NAME                       as broadcast_name,
  FULL_NAME                            AS full_name,
  name_acronym,
  team_name,
  team_colour,
  first_name,
  last_name,
  country_code
FROM raw
WHERE rn=1
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */;
[0m19:15:53.430053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:15:55.267874 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.833 seconds
[0m19:15:55.285168 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a8f22e4-2379-467d-a358-15fb46bd9d77', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1BEA3FA90>]}
[0m19:15:55.285168 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_drivers .............................. [[32mSUCCESS 1[0m in 1.89s]
[0m19:15:55.285168 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_drivers
[0m19:15:55.285168 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:15:55.285168 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:15:55.285168 [debug] [MainThread]: On list_F1: Close
[0m19:15:55.870894 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:15:55.870894 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:15:56.448184 [debug] [MainThread]: Connection 'model.f1_analytics.stg_drivers' was left open.
[0m19:15:56.448184 [debug] [MainThread]: On model.f1_analytics.stg_drivers: Close
[0m19:15:57.032561 [info ] [MainThread]: 
[0m19:15:57.034583 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.10 seconds (7.10s).
[0m19:15:57.034583 [debug] [MainThread]: Command end result
[0m19:15:57.127850 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:15:57.127850 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:15:57.127850 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:15:57.127850 [info ] [MainThread]: 
[0m19:15:57.143941 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:15:57.143941 [info ] [MainThread]: 
[0m19:15:57.143941 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:15:57.143941 [debug] [MainThread]: Command `dbt run` succeeded at 19:15:57.143941 after 9.22 seconds
[0m19:15:57.143941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C061A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D8AA14E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1C26774F0>]}
[0m19:15:57.143941 [debug] [MainThread]: Flushing usage events
[0m19:15:58.193981 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:50.687930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF35BA260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF561CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF561CCD0>]}


============================== 18:48:50.703881 | d137b7c4-fce6-4e54-9dc4-f58f0e06e94c ==============================
[0m18:48:50.703881 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:48:50.703881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_weather.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:48:50.708465 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'f1_analytics'
[0m18:48:50.708465 [debug] [MainThread]: Command `dbt run` failed at 18:48:50.708465 after 0.09 seconds
[0m18:48:50.708465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF35BA260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF561DF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AF561DF00>]}
[0m18:48:50.708465 [debug] [MainThread]: Flushing usage events
[0m18:48:51.957860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:49:29.348333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F16D66380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1803CF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1803CD60>]}


============================== 18:49:29.348333 | 16a94252-d871-489e-b3d5-0034c5d7879e ==============================
[0m18:49:29.348333 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:49:29.348333 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_weather.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:49:30.194999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16a94252-d871-489e-b3d5-0034c5d7879e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F14B65930>]}
[0m18:49:30.242596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16a94252-d871-489e-b3d5-0034c5d7879e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1803F550>]}
[0m18:49:30.242596 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:49:31.034864 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:49:36.281686 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:49:36.281686 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg_weather.sql
[0m18:49:36.281686 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m18:49:36.578823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16a94252-d871-489e-b3d5-0034c5d7879e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F31287FA0>]}
[0m18:49:36.641967 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:49:36.641967 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:49:36.689495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16a94252-d871-489e-b3d5-0034c5d7879e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F30EBDFF0>]}
[0m18:49:36.689495 [info ] [MainThread]: Found 5 models, 4 data tests, 3 sources, 477 macros
[0m18:49:36.689495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16a94252-d871-489e-b3d5-0034c5d7879e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F30EBCD90>]}
[0m18:49:36.689495 [info ] [MainThread]: 
[0m18:49:36.689495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:49:36.689495 [info ] [MainThread]: 
[0m18:49:36.689495 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:49:36.689495 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m18:49:45.099153 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m18:49:45.099153 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m18:49:45.099153 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:47.028445 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.918 seconds
[0m18:49:47.037706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m18:49:47.048200 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m18:49:47.049198 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m18:49:47.049198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:48.780309 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.730 seconds
[0m18:49:48.782001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16a94252-d871-489e-b3d5-0034c5d7879e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F30EBE0E0>]}
[0m18:49:48.799743 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_weather
[0m18:49:48.800746 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_weather ................................... [RUN]
[0m18:49:48.802688 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_weather'
[0m18:49:48.803655 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_weather
[0m18:49:48.815376 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_weather"
[0m18:49:48.817399 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_weather
[0m18:49:48.846651 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_weather"
[0m18:49:48.850850 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_weather"
[0m18:49:48.851750 [debug] [Thread-1 (]: On model.f1_analytics.stg_weather: create or replace   view F1.PONI.stg_weather
  
  
  
  
  as (
    


with cte as(
SELECT *,
  cast(DATEADD(
    minute,
    FLOOR(DATE_PART('minute', date) / 30) * 30,
    DATE_TRUNC('hour', date)
  )as time) AS time_window_start,

  cast(DATEADD(
    minute,
    (FLOOR(DATE_PART('minute', date) / 30) * 30) + 30,
    DATE_TRUNC('hour', date)
  ) as time) AS time_window_end,

FROM weather
),
agg as(
select session_key,
avg(air_temperature) over (partition by session_key,time_window_start,time_window_end) as avg_air_temp,
avg(humidity) over (partition by session_key,time_window_start,time_window_end) as avg_humidity,
avg(wind_speed) over (partition by session_key,time_window_start,time_window_end) as avg_wind_speed,
avg(track_temperature) over (partition by session_key,time_window_start,time_window_end) as avg_track_temp,
avg(rainfall) over (partition by session_key,time_window_start,time_window_end) as avg_rainfall,
time_window_start,
time_window_end,
row_number() over (partition by session_key,time_window_start,time_window_end order by session_key) as rn
from cte
)
select
        session_key,
        time_window_start,
        time_window_end,
        round(avg_air_temp,2) as avg_air_temp,
        round(avg_track_temp,2) as avg_track_temp,
        round(avg_humidity,2) as avg_humidity,
        round(avg_wind_speed,2) as avg_speed,
        round(avg_rainfall,2) as avg_rainfall
from agg
where rn=1
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */;
[0m18:49:48.851750 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:49:50.933011 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.090 seconds
[0m18:49:50.964769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a94252-d871-489e-b3d5-0034c5d7879e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F309586A0>]}
[0m18:49:50.964769 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_weather .............................. [[32mSUCCESS 1[0m in 2.16s]
[0m18:49:50.964769 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_weather
[0m18:49:50.964769 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:50.964769 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m18:49:50.964769 [debug] [MainThread]: On list_F1: Close
[0m18:49:51.670677 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m18:49:51.670677 [debug] [MainThread]: On list_F1_PONI: Close
[0m18:49:52.309013 [debug] [MainThread]: Connection 'model.f1_analytics.stg_weather' was left open.
[0m18:49:52.312071 [debug] [MainThread]: On model.f1_analytics.stg_weather: Close
[0m18:49:52.887094 [info ] [MainThread]: 
[0m18:49:52.887094 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 16.20 seconds (16.20s).
[0m18:49:52.887094 [debug] [MainThread]: Command end result
[0m18:49:53.001184 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:49:53.003222 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:49:53.010326 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m18:49:53.011322 [info ] [MainThread]: 
[0m18:49:53.012218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:53.013259 [info ] [MainThread]: 
[0m18:49:53.014258 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:49:53.017367 [debug] [MainThread]: Command `dbt run` succeeded at 18:49:53.016209 after 23.77 seconds
[0m18:49:53.020348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F16D66380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F1706A860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016F30290FD0>]}
[0m18:49:53.024333 [debug] [MainThread]: Flushing usage events
[0m18:49:54.324325 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:26:09.534439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924B8D6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924CBACF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924CBACD30>]}


============================== 19:26:09.538238 | 877ecd16-c35b-498b-9a98-3a11055c3a8f ==============================
[0m19:26:09.538238 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:26:09.540248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_weather.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:26:10.228195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '877ecd16-c35b-498b-9a98-3a11055c3a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924CB753F0>]}
[0m19:26:10.275710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '877ecd16-c35b-498b-9a98-3a11055c3a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924C2EC6A0>]}
[0m19:26:10.275710 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:26:10.477373 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:26:10.699374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:26:10.699374 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg.laps.sql
[0m19:26:10.699374 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_weather.sql
[0m19:26:10.924593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '877ecd16-c35b-498b-9a98-3a11055c3a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019265CDA260>]}
[0m19:26:11.011459 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:26:11.013463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:26:11.035246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '877ecd16-c35b-498b-9a98-3a11055c3a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019265A3FC10>]}
[0m19:26:11.035246 [info ] [MainThread]: Found 6 models, 4 data tests, 3 sources, 477 macros
[0m19:26:11.035246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877ecd16-c35b-498b-9a98-3a11055c3a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019265A75330>]}
[0m19:26:11.035246 [info ] [MainThread]: 
[0m19:26:11.035246 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:26:11.035246 [info ] [MainThread]: 
[0m19:26:11.035246 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:26:11.035246 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:26:11.082915 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:26:11.082915 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:26:11.082915 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:13.180142 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.095 seconds
[0m19:26:13.196163 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:26:13.212138 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:26:13.212138 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:26:13.212138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:26:14.909114 [debug] [ThreadPool]: SQL status: SUCCESS 14 in 1.691 seconds
[0m19:26:14.909114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '877ecd16-c35b-498b-9a98-3a11055c3a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019265A3EDA0>]}
[0m19:26:14.924875 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_weather
[0m19:26:14.924875 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_weather ................................... [RUN]
[0m19:26:14.940621 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_weather'
[0m19:26:14.940621 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_weather
[0m19:26:14.940621 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_weather"
[0m19:26:14.940621 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_weather
[0m19:26:14.972864 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_weather"
[0m19:26:14.972864 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_weather"
[0m19:26:14.972864 [debug] [Thread-1 (]: On model.f1_analytics.stg_weather: create or replace   view F1.PONI.stg_weather
  
  
  
  
  as (
    


with cte as(
SELECT *,
  cast(DATEADD(
    minute,
    FLOOR(DATE_PART('minute', date) / 30) * 30,
    DATE_TRUNC('hour', date)
  )as time) AS time_window_start,

  cast(DATEADD(
    minute,
    (FLOOR(DATE_PART('minute', date) / 30) * 30) + 30,
    DATE_TRUNC('hour', date)
  ) as time) AS time_window_end,

FROM F1.PONI.weather
),
agg AS (
  SELECT
    session_key,
    time_window_start,
    time_window_end,
    AVG(air_temperature) AS avg_air_temp,
    AVG(humidity) AS avg_humidity,
    AVG(wind_speed) AS avg_wind_speed,
    AVG(track_temperature) AS avg_track_temp,
    AVG(rainfall) AS avg_rainfall
  FROM cte
  GROUP BY session_key, time_window_start, time_window_end
)
select
        session_key,
        time_window_start,
        time_window_end,
        round(avg_air_temp,2) as avg_air_temp,
        round(avg_track_temp,2) as avg_track_temp,
        round(avg_humidity,2) as avg_humidity,
        round(avg_wind_speed,2) as avg_speed,
        round(avg_rainfall,2) as avg_rainfall
from agg
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */;
[0m19:26:14.972864 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:26:17.120865 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.141 seconds
[0m19:26:17.136953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '877ecd16-c35b-498b-9a98-3a11055c3a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019248E87160>]}
[0m19:26:17.136953 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_weather .............................. [[32mSUCCESS 1[0m in 2.20s]
[0m19:26:17.136953 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_weather
[0m19:26:17.152652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:26:17.152652 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:26:17.152652 [debug] [MainThread]: On list_F1: Close
[0m19:26:17.836973 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:26:17.836973 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:26:18.449288 [debug] [MainThread]: Connection 'model.f1_analytics.stg_weather' was left open.
[0m19:26:18.449288 [debug] [MainThread]: On model.f1_analytics.stg_weather: Close
[0m19:26:19.075121 [info ] [MainThread]: 
[0m19:26:19.075121 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.04 seconds (8.04s).
[0m19:26:19.090966 [debug] [MainThread]: Command end result
[0m19:26:19.123249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:26:19.127656 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:26:19.127656 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:26:19.127656 [info ] [MainThread]: 
[0m19:26:19.139098 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:26:19.139098 [info ] [MainThread]: 
[0m19:26:19.139098 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:26:19.139098 [debug] [MainThread]: Command `dbt run` succeeded at 19:26:19.139098 after 9.69 seconds
[0m19:26:19.139098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924B8D6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192655EDA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924BBD8220>]}
[0m19:26:19.139098 [debug] [MainThread]: Flushing usage events
[0m19:26:20.387230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:30:47.571068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002976DFE6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029770090F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029770090D60>]}


============================== 19:30:47.571068 | 8c56f150-7996-4c8c-8d14-f79b12a31798 ==============================
[0m19:30:47.571068 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:30:47.571068 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_laps.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:30:48.277218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c56f150-7996-4c8c-8d14-f79b12a31798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002976C365930>]}
[0m19:30:48.324535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c56f150-7996-4c8c-8d14-f79b12a31798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029770093550>]}
[0m19:30:48.324535 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:30:48.503336 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:30:48.751396 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m19:30:48.751396 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg_laps.sql
[0m19:30:48.757779 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m19:30:48.757779 [debug] [MainThread]: Partial parsing: deleted file: f1_analytics://f1_analytics/models\staging\stg.laps.sql
[0m19:30:49.076065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c56f150-7996-4c8c-8d14-f79b12a31798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970A310130>]}
[0m19:30:49.139908 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:30:49.156081 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:30:49.176831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c56f150-7996-4c8c-8d14-f79b12a31798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029708F2D4E0>]}
[0m19:30:49.176831 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 477 macros
[0m19:30:49.176831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c56f150-7996-4c8c-8d14-f79b12a31798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029708F40730>]}
[0m19:30:49.176831 [info ] [MainThread]: 
[0m19:30:49.176831 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:30:49.176831 [info ] [MainThread]: 
[0m19:30:49.176831 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:30:49.176831 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:30:49.230057 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:30:49.230057 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:30:49.230057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:51.060568 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.828 seconds
[0m19:30:51.084256 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:30:51.094270 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:30:51.095268 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:30:51.095268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:52.954080 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.864 seconds
[0m19:30:52.972876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c56f150-7996-4c8c-8d14-f79b12a31798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029708F2D180>]}
[0m19:30:52.979871 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_laps
[0m19:30:52.982184 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_laps ...................................... [RUN]
[0m19:30:52.983186 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_laps'
[0m19:30:52.983186 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_laps
[0m19:30:52.989806 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_laps"
[0m19:30:52.994183 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_laps
[0m19:30:53.013006 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_laps"
[0m19:30:53.013006 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_laps"
[0m19:30:53.013006 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: create or replace   view F1.PONI.stg_laps
  
  
  
  
  as (
    

select
        session_key,
        driver_number,
        lap_number,
        date_start,
        duration_sector_1,
        duration_sector_2,
        duration_sector_3,
        lap_duration,
        is_pit_out_lap,
        i1_speed,
        i2_speed,
        i3_speed,
        st_speed
from F1.PONI.laps
where lap_duration is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */;
[0m19:30:53.013006 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:30:55.043554 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be3bc8-0003-5213-0009-1a0e0003e426
[0m19:30:55.043554 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 21 at position 8
invalid identifier 'I3_SPEED'
[0m19:30:55.059362 [debug] [Thread-1 (]: Database Error in model stg_laps (f1_analytics/models\staging\stg_laps.sql)
  000904 (42000): SQL compilation error: error line 21 at position 8
  invalid identifier 'I3_SPEED'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_laps.sql
[0m19:30:55.069867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c56f150-7996-4c8c-8d14-f79b12a31798', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029708F2D180>]}
[0m19:30:55.069867 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_laps ............................. [[31mERROR[0m in 2.08s]
[0m19:30:55.069867 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_laps
[0m19:30:55.069867 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_laps' to be skipped because of status 'error'.  Reason: Database Error in model stg_laps (f1_analytics/models\staging\stg_laps.sql)
  000904 (42000): SQL compilation error: error line 21 at position 8
  invalid identifier 'I3_SPEED'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_laps.sql.
[0m19:30:55.075438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:30:55.075438 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:30:55.075438 [debug] [MainThread]: On list_F1: Close
[0m19:30:55.766382 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:30:55.766382 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:30:56.470099 [debug] [MainThread]: Connection 'model.f1_analytics.stg_laps' was left open.
[0m19:30:56.475181 [debug] [MainThread]: On model.f1_analytics.stg_laps: Close
[0m19:30:57.081669 [info ] [MainThread]: 
[0m19:30:57.081669 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.90 seconds (7.90s).
[0m19:30:57.081669 [debug] [MainThread]: Command end result
[0m19:30:57.181235 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:30:57.183673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:30:57.189323 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:30:57.189832 [info ] [MainThread]: 
[0m19:30:57.189832 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:30:57.191086 [info ] [MainThread]: 
[0m19:30:57.192093 [error] [MainThread]: [31mFailure in model stg_laps (f1_analytics/models\staging\stg_laps.sql)[0m
[0m19:30:57.192093 [error] [MainThread]:   Database Error in model stg_laps (f1_analytics/models\staging\stg_laps.sql)
  000904 (42000): SQL compilation error: error line 21 at position 8
  invalid identifier 'I3_SPEED'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_laps.sql
[0m19:30:57.193088 [info ] [MainThread]: 
[0m19:30:57.194087 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_laps.sql
[0m19:30:57.194087 [info ] [MainThread]: 
[0m19:30:57.195090 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m19:30:57.196089 [debug] [MainThread]: Command `dbt run` failed at 19:30:57.196089 after 9.69 seconds
[0m19:30:57.197088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002976DFE6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002970920DFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002976D72BF40>]}
[0m19:30:57.197088 [debug] [MainThread]: Flushing usage events
[0m19:30:58.500277 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:31:21.928855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C8646350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CA6ECF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CA6ECD30>]}


============================== 19:31:21.928855 | 5dcab436-4d28-4a85-bfd2-25619aa8aa89 ==============================
[0m19:31:21.928855 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:31:21.928855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_laps.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:31:22.577529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dcab436-4d28-4a85-bfd2-25619aa8aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174CA6B53F0>]}
[0m19:31:22.624717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dcab436-4d28-4a85-bfd2-25619aa8aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C9E2C6A0>]}
[0m19:31:22.624717 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:31:22.813886 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:31:23.051037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:31:23.051037 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_laps.sql
[0m19:31:23.272860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5dcab436-4d28-4a85-bfd2-25619aa8aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E3822500>]}
[0m19:31:23.352767 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:31:23.352767 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:31:23.382691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5dcab436-4d28-4a85-bfd2-25619aa8aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E35838B0>]}
[0m19:31:23.382691 [info ] [MainThread]: Found 6 models, 4 data tests, 4 sources, 477 macros
[0m19:31:23.384431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dcab436-4d28-4a85-bfd2-25619aa8aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E35BD810>]}
[0m19:31:23.384431 [info ] [MainThread]: 
[0m19:31:23.384431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:31:23.384431 [info ] [MainThread]: 
[0m19:31:23.384431 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:31:23.384431 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:31:23.432167 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:31:23.432167 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:31:23.432167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:25.374241 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.948 seconds
[0m19:31:25.390011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:31:25.427674 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:31:25.429692 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:31:25.431705 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:27.104775 [debug] [ThreadPool]: SQL status: SUCCESS 15 in 1.672 seconds
[0m19:31:27.104775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5dcab436-4d28-4a85-bfd2-25619aa8aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E35821A0>]}
[0m19:31:27.120741 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_laps
[0m19:31:27.120741 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_laps ...................................... [RUN]
[0m19:31:27.136525 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_laps'
[0m19:31:27.136525 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_laps
[0m19:31:27.152259 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_laps"
[0m19:31:27.154268 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_laps
[0m19:31:27.168116 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_laps"
[0m19:31:27.168116 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_laps"
[0m19:31:27.168116 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: create or replace   view F1.PONI.stg_laps
  
  
  
  
  as (
    

select
        session_key,
        driver_number,
        lap_number,
        date_start,
        duration_sector_1,
        duration_sector_2,
        duration_sector_3,
        lap_duration,
        is_pit_out_lap,
        i1_speed,
        i2_speed,
        st_speed
from F1.PONI.laps
where lap_duration is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */;
[0m19:31:27.168116 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:31:29.236523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.058 seconds
[0m19:31:29.250325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5dcab436-4d28-4a85-bfd2-25619aa8aa89', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C6997160>]}
[0m19:31:29.250325 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_laps ................................. [[32mSUCCESS 1[0m in 2.13s]
[0m19:31:29.250325 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_laps
[0m19:31:29.250325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:29.250325 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:31:29.250325 [debug] [MainThread]: On list_F1: Close
[0m19:31:29.859521 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:31:29.875626 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:31:30.468047 [debug] [MainThread]: Connection 'model.f1_analytics.stg_laps' was left open.
[0m19:31:30.468047 [debug] [MainThread]: On model.f1_analytics.stg_laps: Close
[0m19:31:31.075876 [info ] [MainThread]: 
[0m19:31:31.075876 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.69 seconds (7.69s).
[0m19:31:31.094026 [debug] [MainThread]: Command end result
[0m19:31:31.141742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:31:31.143746 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:31:31.149762 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:31:31.149762 [info ] [MainThread]: 
[0m19:31:31.149762 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:31:31.149762 [info ] [MainThread]: 
[0m19:31:31.149762 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:31:31.149762 [debug] [MainThread]: Command `dbt run` succeeded at 19:31:31.149762 after 9.28 seconds
[0m19:31:31.149762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174C8646350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E35A6290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000174E31B0670>]}
[0m19:31:31.149762 [debug] [MainThread]: Flushing usage events
[0m19:31:32.397789 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:11:18.334869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024298C96350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024299F6CF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024299F6CD60>]}


============================== 00:11:18.336017 | 8e186ebf-d040-48c4-846a-efddebfed402 ==============================
[0m00:11:18.336017 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:11:18.336017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_car_data.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:20.048503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e186ebf-d040-48c4-846a-efddebfed402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242B29AFC40>]}
[0m00:11:20.098138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e186ebf-d040-48c4-846a-efddebfed402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024299F6F550>]}
[0m00:11:20.098138 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:11:20.351455 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:11:20.622394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:11:20.622394 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg_car_data.sql
[0m00:11:20.622394 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m00:11:21.001738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e186ebf-d040-48c4-846a-efddebfed402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242B320C490>]}
[0m00:11:21.084796 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:11:21.084796 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:11:21.127954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e186ebf-d040-48c4-846a-efddebfed402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242B2E13CD0>]}
[0m00:11:21.127954 [info ] [MainThread]: Found 7 models, 4 data tests, 5 sources, 477 macros
[0m00:11:21.127954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e186ebf-d040-48c4-846a-efddebfed402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242B2E41DE0>]}
[0m00:11:21.133046 [info ] [MainThread]: 
[0m00:11:21.133046 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:11:21.133046 [info ] [MainThread]: 
[0m00:11:21.133046 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:11:21.133046 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:11:21.223516 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:11:21.223516 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:11:21.223516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:23.418547 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.180 seconds
[0m00:11:23.432717 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:11:23.466399 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:11:23.466399 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:11:23.466399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:25.284009 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 1.817 seconds
[0m00:11:25.296102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e186ebf-d040-48c4-846a-efddebfed402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242B2E13190>]}
[0m00:11:25.303460 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_car_data
[0m00:11:25.303460 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_car_data .................................. [RUN]
[0m00:11:25.311573 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_car_data'
[0m00:11:25.311573 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_car_data
[0m00:11:25.319332 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_car_data"
[0m00:11:25.319332 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_car_data
[0m00:11:25.351284 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_car_data"
[0m00:11:25.351284 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_car_data"
[0m00:11:25.351284 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: create or replace   view F1.PONI.stg_car_data
  
  
  
  
  as (
    

SELECT
    session_key,
    driver_number::VARCHAR(50) as driver_number,
    date,
    cast(rpm as int),
    cast(speed as int),
    cast(throttle as int),
    cast(brake as int),
    cast(drs as int)
FROM F1.PONI.car_data
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */;
[0m00:11:25.351284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:11:27.095520 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be3ce1-0003-5210-0009-1a0e000404da
[0m00:11:27.095520 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m00:11:27.099573 [debug] [Thread-1 (]: Database Error in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_car_data.sql
[0m00:11:27.101589 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e186ebf-d040-48c4-846a-efddebfed402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242B3244AF0>]}
[0m00:11:27.101589 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_car_data ......................... [[31mERROR[0m in 1.79s]
[0m00:11:27.104851 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_car_data
[0m00:11:27.104851 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_car_data' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_car_data.sql.
[0m00:11:27.104851 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:27.104851 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:11:27.104851 [debug] [MainThread]: On list_F1: Close
[0m00:11:27.737357 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:11:27.739374 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:11:28.352456 [debug] [MainThread]: Connection 'model.f1_analytics.stg_car_data' was left open.
[0m00:11:28.352456 [debug] [MainThread]: On model.f1_analytics.stg_car_data: Close
[0m00:11:29.075529 [info ] [MainThread]: 
[0m00:11:29.080392 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m00:11:29.082417 [debug] [MainThread]: Command end result
[0m00:11:29.186904 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:11:29.202916 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:11:29.202916 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:11:29.202916 [info ] [MainThread]: 
[0m00:11:29.213710 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:11:29.213710 [info ] [MainThread]: 
[0m00:11:29.213710 [error] [MainThread]: [31mFailure in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)[0m
[0m00:11:29.213710 [error] [MainThread]:   Database Error in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_car_data.sql
[0m00:11:29.213710 [info ] [MainThread]: 
[0m00:11:29.213710 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_car_data.sql
[0m00:11:29.218709 [info ] [MainThread]: 
[0m00:11:29.220717 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:11:29.220717 [debug] [MainThread]: Command `dbt run` failed at 00:11:29.220717 after 10.97 seconds
[0m00:11:29.220717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024298C96350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000242990709A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024296B37700>]}
[0m00:11:29.224051 [debug] [MainThread]: Flushing usage events
[0m00:11:30.471249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:12:50.762492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E47FB06380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E401CCCF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E401CCCD90>]}


============================== 00:12:50.762492 | 3fd2631a-f68e-4298-ac88-303a5e37ce3c ==============================
[0m00:12:50.762492 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:12:50.762492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_car_data.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:12:51.811692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3fd2631a-f68e-4298-ac88-303a5e37ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E401334250>]}
[0m00:12:51.906572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3fd2631a-f68e-4298-ac88-303a5e37ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E40135C700>]}
[0m00:12:51.906572 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:12:52.192286 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:12:52.464146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:12:52.477964 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_car_data.sql
[0m00:12:52.734552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3fd2631a-f68e-4298-ac88-303a5e37ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41AE04100>]}
[0m00:12:52.812458 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:12:52.823408 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:12:52.859661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3fd2631a-f68e-4298-ac88-303a5e37ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41AB52A10>]}
[0m00:12:52.862696 [info ] [MainThread]: Found 7 models, 4 data tests, 5 sources, 477 macros
[0m00:12:52.862696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd2631a-f68e-4298-ac88-303a5e37ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41AB52440>]}
[0m00:12:52.862696 [info ] [MainThread]: 
[0m00:12:52.862696 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:12:52.862696 [info ] [MainThread]: 
[0m00:12:52.862696 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:12:52.862696 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:12:52.923406 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:12:52.923406 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:12:52.923406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:54.816690 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.892 seconds
[0m00:12:54.837856 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:12:54.837856 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:12:54.837856 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:12:54.837856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:12:56.831975 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 1.987 seconds
[0m00:12:56.842725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3fd2631a-f68e-4298-ac88-303a5e37ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E41AE21960>]}
[0m00:12:56.858502 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_car_data
[0m00:12:56.858502 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_car_data .................................. [RUN]
[0m00:12:56.858502 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_car_data'
[0m00:12:56.858502 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_car_data
[0m00:12:56.878330 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_car_data"
[0m00:12:56.883274 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_car_data
[0m00:12:56.905952 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_car_data"
[0m00:12:56.905952 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_car_data"
[0m00:12:56.905952 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: create or replace   view F1.PONI.stg_car_data
  
  
  
  
  as (
    

SELECT
    session_key,
    driver_number,
    date,
    cast(rpm as int),
    cast(speed as int),
    cast(throttle as int),
    cast(brake as int),
    cast(drs as int)
FROM F1.PONI.car_data
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */;
[0m00:12:56.905952 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:12:58.789935 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be3ce2-0003-521c-0009-1a0e0003d472
[0m00:12:58.789935 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m00:12:58.800430 [debug] [Thread-1 (]: Database Error in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_car_data.sql
[0m00:12:58.800430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3fd2631a-f68e-4298-ac88-303a5e37ce3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E47F7386A0>]}
[0m00:12:58.800430 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_car_data ......................... [[31mERROR[0m in 1.94s]
[0m00:12:58.800430 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_car_data
[0m00:12:58.800430 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_car_data' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_car_data.sql.
[0m00:12:58.800430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:12:58.800430 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:12:58.800430 [debug] [MainThread]: On list_F1: Close
[0m00:12:59.621387 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:12:59.623408 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:13:00.257023 [debug] [MainThread]: Connection 'model.f1_analytics.stg_car_data' was left open.
[0m00:13:00.259041 [debug] [MainThread]: On model.f1_analytics.stg_car_data: Close
[0m00:13:00.931691 [info ] [MainThread]: 
[0m00:13:00.933717 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m00:13:00.938695 [debug] [MainThread]: Command end result
[0m00:13:00.961738 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:13:00.969497 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:13:00.969497 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:13:00.977781 [info ] [MainThread]: 
[0m00:13:00.977781 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:13:00.980269 [info ] [MainThread]: 
[0m00:13:00.980269 [error] [MainThread]: [31mFailure in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)[0m
[0m00:13:00.980269 [error] [MainThread]:   Database Error in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_car_data.sql
[0m00:13:00.980269 [info ] [MainThread]: 
[0m00:13:00.983266 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_car_data.sql
[0m00:13:00.985167 [info ] [MainThread]: 
[0m00:13:00.985167 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:13:00.985167 [debug] [MainThread]: Command `dbt run` failed at 00:13:00.985167 after 10.30 seconds
[0m00:13:00.985167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E47FB06380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E47FC1E6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E47FC0A860>]}
[0m00:13:00.989016 [debug] [MainThread]: Flushing usage events
[0m00:13:02.315169 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:14:14.199485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AA996380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279ABC6CF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279ABC6CD90>]}


============================== 00:14:14.205287 | 1e4f867c-0f70-4b48-a362-2e7039f8f21b ==============================
[0m00:14:14.205287 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:14:14.205287 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_car_data.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:14:15.273088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e4f867c-0f70-4b48-a362-2e7039f8f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AB3D4250>]}
[0m00:14:15.339064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e4f867c-0f70-4b48-a362-2e7039f8f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AB3FC700>]}
[0m00:14:15.339064 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:14:15.568041 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:14:15.855879 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:14:15.855879 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_car_data.sql
[0m00:14:16.135368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e4f867c-0f70-4b48-a362-2e7039f8f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279C4DA8100>]}
[0m00:14:16.225735 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:14:16.225735 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:14:16.246998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e4f867c-0f70-4b48-a362-2e7039f8f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279C4AF6A10>]}
[0m00:14:16.260898 [info ] [MainThread]: Found 7 models, 4 data tests, 5 sources, 477 macros
[0m00:14:16.262765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e4f867c-0f70-4b48-a362-2e7039f8f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279C4AF6440>]}
[0m00:14:16.265130 [info ] [MainThread]: 
[0m00:14:16.267136 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:14:16.267136 [info ] [MainThread]: 
[0m00:14:16.269153 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:14:16.269153 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:14:16.334372 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:14:16.334372 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:14:16.336378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:18.251127 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.916 seconds
[0m00:14:18.269166 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:14:18.299589 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:14:18.299589 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:14:18.299589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:20.293792 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 1.992 seconds
[0m00:14:20.307857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e4f867c-0f70-4b48-a362-2e7039f8f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279C4DC1960>]}
[0m00:14:20.326011 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_car_data
[0m00:14:20.326011 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_car_data .................................. [RUN]
[0m00:14:20.328524 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_car_data'
[0m00:14:20.328524 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_car_data
[0m00:14:20.341697 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_car_data"
[0m00:14:20.345269 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_car_data
[0m00:14:20.370360 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_car_data"
[0m00:14:20.373375 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_car_data"
[0m00:14:20.373375 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: create or replace   view F1.PONI.stg_car_data
  
  
  
  
  as (
    

SELECT
    driver_number,
    session_key,
    date,
    CAST(rpm AS INT)      AS rpm,
    CAST(speed AS INT)    AS speed,
    CAST(throttle AS INT) AS throttle,
    CAST(brake AS INT)    AS brake,
    CAST(drs AS INT)      AS drs
FROM F1.PONI.car_data
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */;
[0m00:14:20.375380 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:14:22.743835 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.381 seconds
[0m00:14:22.775627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e4f867c-0f70-4b48-a362-2e7039f8f21b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279A7F37190>]}
[0m00:14:22.775627 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_car_data ............................. [[32mSUCCESS 1[0m in 2.43s]
[0m00:14:22.775627 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_car_data
[0m00:14:22.775627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:22.775627 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:14:22.775627 [debug] [MainThread]: On list_F1: Close
[0m00:14:23.470531 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:14:23.474506 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:14:24.189828 [debug] [MainThread]: Connection 'model.f1_analytics.stg_car_data' was left open.
[0m00:14:24.191836 [debug] [MainThread]: On model.f1_analytics.stg_car_data: Close
[0m00:14:24.803662 [info ] [MainThread]: 
[0m00:14:24.803662 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.54 seconds (8.54s).
[0m00:14:24.817089 [debug] [MainThread]: Command end result
[0m00:14:24.860990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:14:24.865038 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:14:24.866799 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:14:24.866799 [info ] [MainThread]: 
[0m00:14:24.866799 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:14:24.866799 [info ] [MainThread]: 
[0m00:14:24.866799 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:14:24.866799 [debug] [MainThread]: Command `dbt run` succeeded at 00:14:24.866799 after 10.76 seconds
[0m00:14:24.866799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AA996380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279C4CAA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000279AB3FC700>]}
[0m00:14:24.879825 [debug] [MainThread]: Flushing usage events
[0m00:14:26.231853 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:21:24.293194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D42190A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D422BA0EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D422BA0D00>]}


============================== 00:21:24.293194 | 5e6bc264-a40c-4375-8ae0-c99cce3239d8 ==============================
[0m00:21:24.293194 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:21:24.301799 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_intervals.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:21:25.355417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e6bc264-a40c-4375-8ae0-c99cce3239d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D422BA2B60>]}
[0m00:21:25.426647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e6bc264-a40c-4375-8ae0-c99cce3239d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D422459840>]}
[0m00:21:25.428652 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:21:25.689944 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:21:25.960355 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m00:21:25.960355 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:21:25.960355 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m00:21:25.960355 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_car_data.sql
[0m00:21:26.366981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e6bc264-a40c-4375-8ae0-c99cce3239d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43BE3FDC0>]}
[0m00:21:26.453211 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:21:26.453211 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:21:26.484648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e6bc264-a40c-4375-8ae0-c99cce3239d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43BE3DBA0>]}
[0m00:21:26.484648 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:21:26.484648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6bc264-a40c-4375-8ae0-c99cce3239d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43BE3DC00>]}
[0m00:21:26.484648 [info ] [MainThread]: 
[0m00:21:26.484648 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:21:26.484648 [info ] [MainThread]: 
[0m00:21:26.484648 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:21:26.484648 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:21:26.568668 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:21:26.568668 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:21:26.570675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:28.839765 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.274 seconds
[0m00:21:28.848382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:21:28.880549 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:21:28.880549 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:21:28.880549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:30.983455 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 2.109 seconds
[0m00:21:31.005467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e6bc264-a40c-4375-8ae0-c99cce3239d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43BE3E1A0>]}
[0m00:21:31.015581 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:21:31.021889 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:21:31.021889 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:21:31.021889 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:21:31.036226 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:21:31.036226 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:21:31.063301 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:21:31.063301 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:21:31.079249 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    

    select *
    from F1.PONI.intervals
    where gap_to_leader is not null or interval is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:21:31.079249 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:21:33.242094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.164 seconds
[0m00:21:33.258253 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e6bc264-a40c-4375-8ae0-c99cce3239d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43D4ACDC0>]}
[0m00:21:33.258253 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 2.24s]
[0m00:21:33.274000 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:21:33.274000 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:33.274000 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:21:33.274000 [debug] [MainThread]: On list_F1: Close
[0m00:21:33.963269 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:21:33.963269 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:21:34.592211 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:21:34.592211 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:21:35.197817 [info ] [MainThread]: 
[0m00:21:35.197817 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.71 seconds (8.71s).
[0m00:21:35.197817 [debug] [MainThread]: Command end result
[0m00:21:35.309510 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:21:35.319879 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:21:35.330886 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:21:35.330886 [info ] [MainThread]: 
[0m00:21:35.330886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:21:35.336758 [info ] [MainThread]: 
[0m00:21:35.336758 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:21:35.336758 [debug] [MainThread]: Command `dbt run` succeeded at 00:21:35.336758 after 11.12 seconds
[0m00:21:35.341275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D42190A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4202D8D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D43BD0CA90>]}
[0m00:21:35.341275 [debug] [MainThread]: Flushing usage events
[0m00:21:36.616013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:24:20.010504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7F26380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFA1D0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFA1D0D60>]}


============================== 00:24:20.010504 | e561cb44-0ccf-476a-b63e-21cd4679addc ==============================
[0m00:24:20.010504 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:24:20.010504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_intervals.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:24:21.207072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e561cb44-0ccf-476a-b63e-21cd4679addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF64DDAE0>]}
[0m00:24:21.290680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e561cb44-0ccf-476a-b63e-21cd4679addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BFA1D3550>]}
[0m00:24:21.292685 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:24:21.558810 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:24:21.801483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:24:21.801483 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:24:22.068851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e561cb44-0ccf-476a-b63e-21cd4679addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B933D0130>]}
[0m00:24:22.154613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:24:22.154613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:24:22.203026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e561cb44-0ccf-476a-b63e-21cd4679addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9315AEC0>]}
[0m00:24:22.203534 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:24:22.204915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e561cb44-0ccf-476a-b63e-21cd4679addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B93158D00>]}
[0m00:24:22.204915 [info ] [MainThread]: 
[0m00:24:22.204915 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:24:22.204915 [info ] [MainThread]: 
[0m00:24:22.204915 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:24:22.204915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:24:22.280593 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:24:22.280593 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:24:22.280593 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:24.232802 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.953 seconds
[0m00:24:24.245812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:24:24.262640 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:24:24.262640 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:24:24.262640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:25.978396 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 1.719 seconds
[0m00:24:25.994284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e561cb44-0ccf-476a-b63e-21cd4679addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B92BB86A0>]}
[0m00:24:26.013160 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:24:26.013160 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:24:26.013160 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:24:26.013160 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:24:26.033318 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:24:26.033318 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:24:26.058321 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:24:26.071412 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:24:26.071412 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    

    select *
    from F1.PONI.intervals
    where gap_to_leader is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:24:26.071412 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:24:28.033601 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.970 seconds
[0m00:24:28.065471 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e561cb44-0ccf-476a-b63e-21cd4679addc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF64B3190>]}
[0m00:24:28.065471 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 2.05s]
[0m00:24:28.081272 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:24:28.083282 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:28.083282 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:24:28.083282 [debug] [MainThread]: On list_F1: Close
[0m00:24:28.766670 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:24:28.766670 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:24:29.371582 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:24:29.371582 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:24:30.017509 [info ] [MainThread]: 
[0m00:24:30.017509 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.81 seconds (7.81s).
[0m00:24:30.033498 [debug] [MainThread]: Command end result
[0m00:24:30.048079 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:24:30.048079 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:24:30.063887 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:24:30.063887 [info ] [MainThread]: 
[0m00:24:30.063887 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:24:30.063887 [info ] [MainThread]: 
[0m00:24:30.063887 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:24:30.063887 [debug] [MainThread]: Command `dbt run` succeeded at 00:24:30.063887 after 10.14 seconds
[0m00:24:30.063887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022BF7F26380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B92BD9D80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B94A90760>]}
[0m00:24:30.076609 [debug] [MainThread]: Flushing usage events
[0m00:24:31.316083 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:26:21.048448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250060FA2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025007390F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025007390D30>]}


============================== 00:26:21.049577 | e5ba188f-da2c-430e-a303-7db7bc1c8de2 ==============================
[0m00:26:21.049577 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:26:21.049577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_intervals.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:26:22.223699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5ba188f-da2c-430e-a303-7db7bc1c8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250063B4B80>]}
[0m00:26:22.310671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5ba188f-da2c-430e-a303-7db7bc1c8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002501FC90730>]}
[0m00:26:22.310671 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:26:22.557873 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:26:22.829329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:26:22.829329 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:26:23.142802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5ba188f-da2c-430e-a303-7db7bc1c8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250204C4100>]}
[0m00:26:23.226561 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:26:23.226561 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:26:23.278181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5ba188f-da2c-430e-a303-7db7bc1c8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250202480A0>]}
[0m00:26:23.278181 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:26:23.280187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5ba188f-da2c-430e-a303-7db7bc1c8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002502024B370>]}
[0m00:26:23.284197 [info ] [MainThread]: 
[0m00:26:23.284197 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:26:23.284197 [info ] [MainThread]: 
[0m00:26:23.284197 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:26:23.291821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:26:23.349911 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:26:23.349911 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:26:23.351917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:25.242987 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.898 seconds
[0m00:26:25.278970 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:26:25.291137 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:26:25.291137 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:26:25.291137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:26:27.232879 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 1.941 seconds
[0m00:26:27.261859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5ba188f-da2c-430e-a303-7db7bc1c8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025020224B50>]}
[0m00:26:27.283764 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:26:27.286667 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:26:27.286667 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:26:27.286667 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:26:27.293711 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:26:27.293711 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:26:27.324921 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:26:27.327798 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:26:27.329808 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    

    select *
    from F1.PONI.intervals
    where gap_to_leader is not null or "interval" is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:26:27.329808 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:26:28.984956 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be3cf0-0003-523b-0009-1a0e0003c576
[0m00:26:29.000952 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 39
invalid identifier '"interval"'
[0m00:26:29.000952 [debug] [Thread-1 (]: Database Error in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)
  000904 (42000): SQL compilation error: error line 11 at position 39
  invalid identifier '"interval"'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_intervals.sql
[0m00:26:29.000952 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5ba188f-da2c-430e-a303-7db7bc1c8de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025004F80490>]}
[0m00:26:29.000952 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_intervals ........................ [[31mERROR[0m in 1.71s]
[0m00:26:29.000952 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:26:29.000952 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_intervals' to be skipped because of status 'error'.  Reason: Database Error in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)
  000904 (42000): SQL compilation error: error line 11 at position 39
  invalid identifier '"interval"'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_intervals.sql.
[0m00:26:29.000952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:26:29.000952 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:26:29.000952 [debug] [MainThread]: On list_F1: Close
[0m00:26:29.723449 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:26:29.723449 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:26:30.310340 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:26:30.312354 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:26:30.924842 [info ] [MainThread]: 
[0m00:26:30.931488 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.64 seconds (7.64s).
[0m00:26:30.940504 [debug] [MainThread]: Command end result
[0m00:26:30.969807 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:26:30.972815 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:26:30.972815 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:26:30.972815 [info ] [MainThread]: 
[0m00:26:30.972815 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:26:30.972815 [info ] [MainThread]: 
[0m00:26:30.972815 [error] [MainThread]: [31mFailure in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)[0m
[0m00:26:30.988631 [error] [MainThread]:   Database Error in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)
  000904 (42000): SQL compilation error: error line 11 at position 39
  invalid identifier '"interval"'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_intervals.sql
[0m00:26:30.988631 [info ] [MainThread]: 
[0m00:26:30.990957 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_intervals.sql
[0m00:26:30.990957 [info ] [MainThread]: 
[0m00:26:30.990957 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:26:30.994184 [debug] [MainThread]: Command `dbt run` failed at 00:26:30.994184 after 10.03 seconds
[0m00:26:30.994184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250060FA2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025007355FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250063F2DD0>]}
[0m00:26:30.994184 [debug] [MainThread]: Flushing usage events
[0m00:26:32.251452 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:27:10.077594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0926A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A500EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A500D00>]}


============================== 00:27:10.077594 | a9bb7765-43e6-441a-95e9-c28e896afb2e ==============================
[0m00:27:10.077594 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:27:10.077594 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_intervals.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:27:11.232561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a9bb7765-43e6-441a-95e9-c28e896afb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0A502B60>]}
[0m00:27:11.302271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a9bb7765-43e6-441a-95e9-c28e896afb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A09DB9840>]}
[0m00:27:11.304279 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:27:11.566340 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:27:11.868740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:27:11.868740 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:27:12.144750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9bb7765-43e6-441a-95e9-c28e896afb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A23630100>]}
[0m00:27:12.242319 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:27:12.256161 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:27:12.297364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9bb7765-43e6-441a-95e9-c28e896afb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A233BA140>]}
[0m00:27:12.297364 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:27:12.299407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9bb7765-43e6-441a-95e9-c28e896afb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A233B80D0>]}
[0m00:27:12.299407 [info ] [MainThread]: 
[0m00:27:12.299407 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:27:12.299407 [info ] [MainThread]: 
[0m00:27:12.303466 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:27:12.310076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:27:12.367154 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:27:12.367154 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:27:12.367154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:14.324808 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.964 seconds
[0m00:27:14.340903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:27:14.356736 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:27:14.356736 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:27:14.356736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:27:16.565305 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 2.201 seconds
[0m00:27:16.587629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9bb7765-43e6-441a-95e9-c28e896afb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A23394A30>]}
[0m00:27:16.597487 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:27:16.597487 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:27:16.597487 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:27:16.597487 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:27:16.613355 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:27:16.613355 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:27:16.647287 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:27:16.649323 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:27:16.649323 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    

    select *
    from F1.PONI.intervals
    where gap_to_leader is not null or 'interval' is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:27:16.649323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:27:18.642516 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.988 seconds
[0m00:27:18.665872 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9bb7765-43e6-441a-95e9-c28e896afb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A06804F70>]}
[0m00:27:18.665872 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 2.07s]
[0m00:27:18.665872 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:27:18.665872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:27:18.665872 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:27:18.665872 [debug] [MainThread]: On list_F1: Close
[0m00:27:19.352981 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:27:19.352981 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:27:19.981639 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:27:19.983647 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:27:20.599686 [info ] [MainThread]: 
[0m00:27:20.603406 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.30 seconds (8.30s).
[0m00:27:20.605556 [debug] [MainThread]: Command end result
[0m00:27:20.636562 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:27:20.636562 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:27:20.645152 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:27:20.645152 [info ] [MainThread]: 
[0m00:27:20.650586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:27:20.651184 [info ] [MainThread]: 
[0m00:27:20.652581 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:27:20.653519 [debug] [MainThread]: Command `dbt run` succeeded at 00:27:20.653519 after 10.66 seconds
[0m00:27:20.653519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0926A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A0953F2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A09562DA0>]}
[0m00:27:20.655313 [debug] [MainThread]: Flushing usage events
[0m00:27:22.017609 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:01.488568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025082EC6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025085170F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025085170D60>]}


============================== 00:29:01.488568 | f0a2f010-f750-4a06-9052-99c6d4fba6d2 ==============================
[0m00:29:01.488568 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:29:01.504248 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_intervals.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:29:02.642407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0a2f010-f750-4a06-9052-99c6d4fba6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509DBB3C40>]}
[0m00:29:02.691602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0a2f010-f750-4a06-9052-99c6d4fba6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025085173550>]}
[0m00:29:02.691602 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:29:02.944027 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:29:03.191674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:29:03.191674 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:29:03.507923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0a2f010-f750-4a06-9052-99c6d4fba6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509E2A0130>]}
[0m00:29:03.587614 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:29:03.587614 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:29:03.635196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0a2f010-f750-4a06-9052-99c6d4fba6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509E02AF80>]}
[0m00:29:03.635196 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:29:03.635196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0a2f010-f750-4a06-9052-99c6d4fba6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509E02BBE0>]}
[0m00:29:03.635196 [info ] [MainThread]: 
[0m00:29:03.635196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:29:03.635196 [info ] [MainThread]: 
[0m00:29:03.635196 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:29:03.635196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:29:03.703331 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:29:03.703331 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:29:03.703331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:05.670082 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.962 seconds
[0m00:29:05.685827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:29:05.695006 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:29:05.695006 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:29:05.695006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:07.591978 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.904 seconds
[0m00:29:07.632778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0a2f010-f750-4a06-9052-99c6d4fba6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509DC53580>]}
[0m00:29:07.640015 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:29:07.640015 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:29:07.640015 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:29:07.640015 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:29:07.655777 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:29:07.655777 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:29:07.687595 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:29:07.687595 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:29:07.687595 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    

    select *
    from F1.PONI.intervals
    where gap_to_leader is not null or "INTERVAL" is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:29:07.687595 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:29:09.541465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.850 seconds
[0m00:29:09.573029 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0a2f010-f750-4a06-9052-99c6d4fba6d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025081447160>]}
[0m00:29:09.573029 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 1.93s]
[0m00:29:09.588893 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:29:09.590906 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:09.595418 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:29:09.595418 [debug] [MainThread]: On list_F1: Close
[0m00:29:10.254636 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:29:10.262862 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:29:10.859263 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:29:10.871113 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:29:11.495286 [info ] [MainThread]: 
[0m00:29:11.495286 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.86 seconds (7.86s).
[0m00:29:11.514295 [debug] [MainThread]: Command end result
[0m00:29:11.543300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:29:11.547312 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:29:11.547312 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:29:11.547312 [info ] [MainThread]: 
[0m00:29:11.559200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:11.559200 [info ] [MainThread]: 
[0m00:29:11.559200 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:29:11.564174 [debug] [MainThread]: Command `dbt run` succeeded at 00:29:11.564174 after 10.15 seconds
[0m00:29:11.564174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025082EC6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000250841992D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002509F9DBB50>]}
[0m00:29:11.564174 [debug] [MainThread]: Flushing usage events
[0m00:29:12.776542 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:42.055972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992123A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992349CF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992349CD90>]}


============================== 00:29:42.055972 | f90b2a43-e0d7-44b1-8cda-2687062d39af ==============================
[0m00:29:42.055972 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:29:42.062089 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_intervals.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:29:43.282655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f90b2a43-e0d7-44b1-8cda-2687062d39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993BDBB610>]}
[0m00:29:43.341796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f90b2a43-e0d7-44b1-8cda-2687062d39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992349F4F0>]}
[0m00:29:43.344121 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:29:43.581068 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:29:43.881624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:29:43.881624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:29:43.929268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f90b2a43-e0d7-44b1-8cda-2687062d39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993C40E8C0>]}
[0m00:29:44.035249 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:29:44.035249 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:29:44.066863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f90b2a43-e0d7-44b1-8cda-2687062d39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993C3587C0>]}
[0m00:29:44.066863 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:29:44.082119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90b2a43-e0d7-44b1-8cda-2687062d39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993C359F60>]}
[0m00:29:44.084129 [info ] [MainThread]: 
[0m00:29:44.084129 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:29:44.084129 [info ] [MainThread]: 
[0m00:29:44.084129 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:29:44.084129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:29:44.159335 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:29:44.159335 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:29:44.161338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:45.994181 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.833 seconds
[0m00:29:46.001386 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:29:46.013701 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:29:46.015708 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:29:46.015708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:47.724918 [debug] [ThreadPool]: SQL status: SUCCESS 17 in 1.711 seconds
[0m00:29:47.740904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90b2a43-e0d7-44b1-8cda-2687062d39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993C35BA00>]}
[0m00:29:47.741842 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:29:47.741842 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:29:47.756959 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:29:47.756959 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:29:47.756959 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:29:47.756959 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:29:47.788896 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:29:47.788896 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:29:47.788896 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    

    select *
    from F1.PONI.intervals
    where gap_to_leader is not null or "INTERVAL" is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:29:47.806565 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:29:49.678547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.874 seconds
[0m00:29:49.706469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90b2a43-e0d7-44b1-8cda-2687062d39af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002991F744FD0>]}
[0m00:29:49.706469 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 1.94s]
[0m00:29:49.706469 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:29:49.711477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:49.711477 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:29:49.713266 [debug] [MainThread]: On list_F1: Close
[0m00:29:50.276790 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:29:50.276790 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:29:50.923054 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:29:50.923054 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:29:51.521877 [info ] [MainThread]: 
[0m00:29:51.539974 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.44 seconds (7.44s).
[0m00:29:51.545615 [debug] [MainThread]: Command end result
[0m00:29:51.570440 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:29:51.578846 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:29:51.584884 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:29:51.584884 [info ] [MainThread]: 
[0m00:29:51.584884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:51.584884 [info ] [MainThread]: 
[0m00:29:51.584884 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:29:51.584884 [debug] [MainThread]: Command `dbt run` succeeded at 00:29:51.584884 after 9.63 seconds
[0m00:29:51.594898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002992123A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029922C2D510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002993DB23970>]}
[0m00:29:51.594898 [debug] [MainThread]: Flushing usage events
[0m00:29:52.846120 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:10.360321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6FB5A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A70BF0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A70BF0D30>]}


============================== 00:34:10.366447 | 3a33388b-e209-42ba-827b-6ccc5d612334 ==============================
[0m00:34:10.366447 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:34:10.366447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_intervals.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:34:11.530785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a33388b-e209-42ba-827b-6ccc5d612334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6CEC5900>]}
[0m00:34:11.577739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a33388b-e209-42ba-827b-6ccc5d612334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A70BF3520>]}
[0m00:34:11.577739 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:34:11.832054 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:34:12.055287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:34:12.055287 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:34:12.332725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a33388b-e209-42ba-827b-6ccc5d612334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A09DA0130>]}
[0m00:34:12.406168 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:34:12.422326 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:34:12.454213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a33388b-e209-42ba-827b-6ccc5d612334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A09B2EE90>]}
[0m00:34:12.465339 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:34:12.465867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a33388b-e209-42ba-827b-6ccc5d612334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A09B2CD90>]}
[0m00:34:12.465867 [info ] [MainThread]: 
[0m00:34:12.465867 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:34:12.470103 [info ] [MainThread]: 
[0m00:34:12.470103 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:34:12.475820 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:34:12.533947 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:34:12.533947 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:34:12.533947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:14.548964 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.014 seconds
[0m00:34:14.571799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:34:14.587898 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:34:14.587898 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:34:14.587898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:16.438107 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.843 seconds
[0m00:34:16.443822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a33388b-e209-42ba-827b-6ccc5d612334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A09B04CD0>]}
[0m00:34:16.443822 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:34:16.443822 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:34:16.443822 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:34:16.459614 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:34:16.459614 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:34:16.459614 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:34:16.491323 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:34:16.491323 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:34:16.491323 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    

    cte as(
        select *
    from F1.PONI.intervals
    where gap_to_leader is not null and "INTERVAL" is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:34:16.491323 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:34:18.240900 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be3cf8-0003-5213-0009-1a0e0003e596
[0m00:34:18.240900 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 9 at position 4 unexpected 'cte'.
[0m00:34:18.242927 [debug] [Thread-1 (]: Database Error in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 4 unexpected 'cte'.
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_intervals.sql
[0m00:34:18.242927 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a33388b-e209-42ba-827b-6ccc5d612334', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6E7E0490>]}
[0m00:34:18.242927 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_intervals ........................ [[31mERROR[0m in 1.80s]
[0m00:34:18.249937 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:34:18.249937 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_intervals' to be skipped because of status 'error'.  Reason: Database Error in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 4 unexpected 'cte'.
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_intervals.sql.
[0m00:34:18.255030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:18.255030 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:34:18.255030 [debug] [MainThread]: On list_F1: Close
[0m00:34:18.936461 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:34:18.938477 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:34:19.613640 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:34:19.621508 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:34:20.238522 [info ] [MainThread]: 
[0m00:34:20.238522 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.77 seconds (7.77s).
[0m00:34:20.247984 [debug] [MainThread]: Command end result
[0m00:34:20.269224 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:34:20.269224 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:34:20.289206 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:34:20.291210 [info ] [MainThread]: 
[0m00:34:20.291210 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:34:20.291210 [info ] [MainThread]: 
[0m00:34:20.291210 [error] [MainThread]: [31mFailure in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)[0m
[0m00:34:20.291210 [error] [MainThread]:   Database Error in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)
  001003 (42000): SQL compilation error:
  syntax error line 9 at position 4 unexpected 'cte'.
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_intervals.sql
[0m00:34:20.291210 [info ] [MainThread]: 
[0m00:34:20.291210 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_intervals.sql
[0m00:34:20.291210 [info ] [MainThread]: 
[0m00:34:20.291210 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:34:20.291210 [debug] [MainThread]: Command `dbt run` failed at 00:34:20.291210 after 10.02 seconds
[0m00:34:20.301197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6FB5A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A6FC14B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025A09DFFC10>]}
[0m00:34:20.301197 [debug] [MainThread]: Flushing usage events
[0m00:34:21.548396 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:31.841046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B444A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B66B0F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B66B0D90>]}


============================== 00:34:31.841046 | 3aae9a41-a7aa-4d5c-b06f-81c69325eee7 ==============================
[0m00:34:31.841046 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:34:31.841046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_intervals.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:34:33.175011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3aae9a41-a7aa-4d5c-b06f-81c69325eee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202CEFCB610>]}
[0m00:34:33.235366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3aae9a41-a7aa-4d5c-b06f-81c69325eee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B66B34F0>]}
[0m00:34:33.248597 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:34:33.534460 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:34:33.788576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:34:33.796343 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:34:34.070897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3aae9a41-a7aa-4d5c-b06f-81c69325eee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202CF7E0130>]}
[0m00:34:34.168704 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:34:34.170968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:34:34.214338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3aae9a41-a7aa-4d5c-b06f-81c69325eee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202CF56A5F0>]}
[0m00:34:34.217596 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:34:34.217596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aae9a41-a7aa-4d5c-b06f-81c69325eee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202CF569030>]}
[0m00:34:34.217596 [info ] [MainThread]: 
[0m00:34:34.217596 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:34:34.217596 [info ] [MainThread]: 
[0m00:34:34.217596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:34:34.217596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:34:34.283800 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:34:34.283800 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:34:34.285806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:36.100945 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.825 seconds
[0m00:34:36.130516 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:34:36.146365 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:34:36.146365 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:34:36.146365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:38.117419 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.960 seconds
[0m00:34:38.129013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3aae9a41-a7aa-4d5c-b06f-81c69325eee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B2A1FA90>]}
[0m00:34:38.133256 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:34:38.149183 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:34:38.153109 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:34:38.153109 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:34:38.155122 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:34:38.164828 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:34:38.180546 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:34:38.180546 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:34:38.180546 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    


        select *
    from F1.PONI.intervals
    where gap_to_leader is not null and "INTERVAL" is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:34:38.180546 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:34:40.198232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.003 seconds
[0m00:34:40.228670 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3aae9a41-a7aa-4d5c-b06f-81c69325eee7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B2954FD0>]}
[0m00:34:40.234391 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 2.08s]
[0m00:34:40.234391 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:34:40.234391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:40.234391 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:34:40.234391 [debug] [MainThread]: On list_F1: Close
[0m00:34:40.906760 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:34:40.918608 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:34:41.545680 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:34:41.549742 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:34:42.152632 [info ] [MainThread]: 
[0m00:34:42.152632 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.94 seconds (7.94s).
[0m00:34:42.152632 [debug] [MainThread]: Command end result
[0m00:34:42.167696 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:34:42.167696 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:34:42.185772 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:34:42.185772 [info ] [MainThread]: 
[0m00:34:42.185772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:42.185772 [info ] [MainThread]: 
[0m00:34:42.185772 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:34:42.185772 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:42.185772 after 10.44 seconds
[0m00:34:42.185772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B444A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202B5711CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000202D0F1FB20>]}
[0m00:34:42.185772 [debug] [MainThread]: Flushing usage events
[0m00:34:43.365847 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:37:31.919422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC465CA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4862CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4862CD00>]}


============================== 00:37:31.927567 | 13fc1386-fb4b-4d94-bbaf-3f9c21953e43 ==============================
[0m00:37:31.927567 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:37:31.927567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_intervals.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:37:33.016101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13fc1386-fb4b-4d94-bbaf-3f9c21953e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC4862EB60>]}
[0m00:37:33.083711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13fc1386-fb4b-4d94-bbaf-3f9c21953e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC47EE9840>]}
[0m00:37:33.083711 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:37:33.303388 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:37:33.585421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:37:33.585421 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:37:33.859955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13fc1386-fb4b-4d94-bbaf-3f9c21953e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC61760100>]}
[0m00:37:33.940048 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:37:33.940048 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:37:33.987216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13fc1386-fb4b-4d94-bbaf-3f9c21953e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC614EA140>]}
[0m00:37:33.987216 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:37:33.987216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13fc1386-fb4b-4d94-bbaf-3f9c21953e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC614E80D0>]}
[0m00:37:33.993278 [info ] [MainThread]: 
[0m00:37:33.993278 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:37:33.993278 [info ] [MainThread]: 
[0m00:37:33.993278 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:37:33.993278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:37:34.050728 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:37:34.050728 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:37:34.050728 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:36.025316 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.967 seconds
[0m00:37:36.040938 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:37:36.049245 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:37:36.049245 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:37:36.049245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:37:37.973720 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.913 seconds
[0m00:37:37.993404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13fc1386-fb4b-4d94-bbaf-3f9c21953e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC614C4A30>]}
[0m00:37:38.003482 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:37:38.003482 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:37:38.003482 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:37:38.003482 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:37:38.019274 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:37:38.021591 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:37:38.035226 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:37:38.035226 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:37:38.035226 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    


        select
            session_key,
            driver_number,
            date,
            round(gap_to_leader,3),
            round("INTERVAL",3),
    from F1.PONI.intervals
    where gap_to_leader is not null and "INTERVAL" is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:37:38.035226 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:37:39.862301 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be3cfb-0003-523b-0009-1a0e0003c5c2
[0m00:37:39.864473 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002022 (42601): SQL compilation error:
Missing column specification
[0m00:37:39.864473 [debug] [Thread-1 (]: Database Error in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_intervals.sql
[0m00:37:39.864473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13fc1386-fb4b-4d94-bbaf-3f9c21953e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC46221D80>]}
[0m00:37:39.864473 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_intervals ........................ [[31mERROR[0m in 1.86s]
[0m00:37:39.864473 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:37:39.864473 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_intervals' to be skipped because of status 'error'.  Reason: Database Error in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_intervals.sql.
[0m00:37:39.864473 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:37:39.864473 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:37:39.864473 [debug] [MainThread]: On list_F1: Close
[0m00:37:40.534191 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:37:40.537237 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:37:41.143790 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:37:41.143790 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:37:41.752100 [info ] [MainThread]: 
[0m00:37:41.752100 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.76 seconds (7.76s).
[0m00:37:41.752100 [debug] [MainThread]: Command end result
[0m00:37:41.784529 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:37:41.791239 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:37:41.800176 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:37:41.800176 [info ] [MainThread]: 
[0m00:37:41.800176 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:37:41.800176 [info ] [MainThread]: 
[0m00:37:41.800176 [error] [MainThread]: [31mFailure in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)[0m
[0m00:37:41.800176 [error] [MainThread]:   Database Error in model stg_intervals (f1_analytics/models\staging\stg_intervals.sql)
  002022 (42601): SQL compilation error:
  Missing column specification
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_intervals.sql
[0m00:37:41.800176 [info ] [MainThread]: 
[0m00:37:41.800176 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_intervals.sql
[0m00:37:41.800176 [info ] [MainThread]: 
[0m00:37:41.800176 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:37:41.800176 [debug] [MainThread]: Command `dbt run` failed at 00:37:41.800176 after 9.98 seconds
[0m00:37:41.812903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC465CA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC47EE9840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC617BFB50>]}
[0m00:37:41.812903 [debug] [MainThread]: Flushing usage events
[0m00:37:43.084963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:14.425788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE44F6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE659CF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE659CD90>]}


============================== 00:38:14.425788 | fb37e518-d19e-4ab3-b4c0-e12f26259e30 ==============================
[0m00:38:14.425788 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:38:14.425788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_intervals.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:38:15.613897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb37e518-d19e-4ab3-b4c0-e12f26259e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE65693F0>]}
[0m00:38:15.685520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb37e518-d19e-4ab3-b4c0-e12f26259e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE659F4F0>]}
[0m00:38:15.687527 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:38:15.951794 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:38:16.170849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:38:16.187483 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:38:16.455584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb37e518-d19e-4ab3-b4c0-e12f26259e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFF6D0130>]}
[0m00:38:16.537316 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:38:16.537316 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:38:16.590689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb37e518-d19e-4ab3-b4c0-e12f26259e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFF458DF0>]}
[0m00:38:16.593462 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:38:16.593462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb37e518-d19e-4ab3-b4c0-e12f26259e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFF458040>]}
[0m00:38:16.593462 [info ] [MainThread]: 
[0m00:38:16.593462 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:38:16.593462 [info ] [MainThread]: 
[0m00:38:16.593462 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:38:16.600317 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:38:16.652519 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:38:16.652519 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:38:16.652519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:18.756787 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.105 seconds
[0m00:38:18.772960 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:38:18.791247 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:38:18.791247 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:38:18.791247 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:20.580895 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.788 seconds
[0m00:38:20.592947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb37e518-d19e-4ab3-b4c0-e12f26259e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFF086950>]}
[0m00:38:20.600338 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:38:20.600338 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:38:20.600338 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:38:20.600338 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:38:20.613049 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:38:20.616066 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:38:20.639376 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:38:20.639376 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:38:20.639376 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    


        select
            session_key,
            driver_number,
            date,
            round(gap_to_leader,3) as gap_to_leader,
            round("INTERVAL",3) as "INTERVAL",
    from F1.PONI.intervals
    where gap_to_leader is not null and "INTERVAL" is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:38:20.647990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:38:22.812855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.170 seconds
[0m00:38:22.855348 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb37e518-d19e-4ab3-b4c0-e12f26259e30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE2847160>]}
[0m00:38:22.859608 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 2.26s]
[0m00:38:22.859608 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:38:22.859608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:22.859608 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:38:22.859608 [debug] [MainThread]: On list_F1: Close
[0m00:38:23.537426 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:38:23.539458 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:38:24.152497 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:38:24.152497 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:38:24.774298 [info ] [MainThread]: 
[0m00:38:24.777388 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.18 seconds (8.18s).
[0m00:38:24.780630 [debug] [MainThread]: Command end result
[0m00:38:24.793863 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:38:24.808843 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:38:24.808843 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:38:24.808843 [info ] [MainThread]: 
[0m00:38:24.808843 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:24.808843 [info ] [MainThread]: 
[0m00:38:24.808843 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:38:24.824661 [debug] [MainThread]: Command `dbt run` succeeded at 00:38:24.824661 after 10.48 seconds
[0m00:38:24.824661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE44F6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DFEFEA1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DE55C8220>]}
[0m00:38:24.824661 [debug] [MainThread]: Flushing usage events
[0m00:38:25.988016 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:41:06.109729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B096D3A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B098D9CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B098D9CD00>]}


============================== 00:41:06.114740 | 1dd28899-52b7-4a71-823b-6aaae0640535 ==============================
[0m00:41:06.114740 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:41:06.114740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_intervals.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:41:07.446627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dd28899-52b7-4a71-823b-6aaae0640535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B097DCA620>]}
[0m00:41:07.510035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dd28899-52b7-4a71-823b-6aaae0640535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B16A0760>]}
[0m00:41:07.513568 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:41:07.763151 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:41:08.066121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:41:08.066121 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:41:08.396513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dd28899-52b7-4a71-823b-6aaae0640535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B1ED0100>]}
[0m00:41:08.504816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:41:08.512112 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:41:08.545757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dd28899-52b7-4a71-823b-6aaae0640535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B1C5B070>]}
[0m00:41:08.547799 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:41:08.547799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd28899-52b7-4a71-823b-6aaae0640535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B1C58CA0>]}
[0m00:41:08.550615 [info ] [MainThread]: 
[0m00:41:08.550615 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:41:08.552353 [info ] [MainThread]: 
[0m00:41:08.552353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:41:08.552353 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:41:08.612299 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:41:08.612299 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:41:08.612299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:10.420303 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.804 seconds
[0m00:41:10.430319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:41:10.443688 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:41:10.449006 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:41:10.449006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:41:13.621464 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 3.178 seconds
[0m00:41:13.637308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dd28899-52b7-4a71-823b-6aaae0640535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0B1C35DB0>]}
[0m00:41:13.653418 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:41:13.653418 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:41:13.653418 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:41:13.653418 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:41:13.653418 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:41:13.653418 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:41:13.687884 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:41:13.701393 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:41:13.701393 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    


        select
            session_key,
            driver_number,
            date,
            round(gap_to_leader,3) as gap_to_leader,
            round("INTERVAL",3) as "INTERVAL",
    from F1.PONI.intervals
    where gap_to_leader is not null and "INTERVAL" is not null or gap_to_leader<>'+1 LAP'
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:41:13.701393 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:41:15.669229 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.963 seconds
[0m00:41:15.693723 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dd28899-52b7-4a71-823b-6aaae0640535', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B095044F40>]}
[0m00:41:15.693723 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 2.04s]
[0m00:41:15.701121 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:41:15.701121 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:41:15.701121 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:41:15.705802 [debug] [MainThread]: On list_F1: Close
[0m00:41:16.294472 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:41:16.294472 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:41:17.047375 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:41:17.051435 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:41:17.706127 [info ] [MainThread]: 
[0m00:41:17.706127 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.15 seconds (9.15s).
[0m00:41:17.714688 [debug] [MainThread]: Command end result
[0m00:41:17.738972 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:41:17.746627 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:41:17.746627 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:41:17.746627 [info ] [MainThread]: 
[0m00:41:17.746627 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:41:17.746627 [info ] [MainThread]: 
[0m00:41:17.746627 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:41:17.762597 [debug] [MainThread]: Command `dbt run` succeeded at 00:41:17.762597 after 11.76 seconds
[0m00:41:17.762597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B096D3A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B094E7B700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B097DDD030>]}
[0m00:41:17.765147 [debug] [MainThread]: Flushing usage events
[0m00:41:19.046571 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:42:41.354166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEAF58A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB17ECF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB17ECD90>]}


============================== 00:42:41.363383 | 1dbe4c24-e043-400a-80e0-721aa825ea3b ==============================
[0m00:42:41.363383 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:42:41.365389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_intervals.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:42:42.505224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dbe4c24-e043-400a-80e0-721aa825ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AECA10B610>]}
[0m00:42:42.568704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dbe4c24-e043-400a-80e0-721aa825ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB17EF4F0>]}
[0m00:42:42.568704 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:42:42.829394 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:42:43.101158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:42:43.103167 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:42:43.379165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dbe4c24-e043-400a-80e0-721aa825ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AECA920130>]}
[0m00:42:43.470965 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:42:43.474722 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:42:43.506826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dbe4c24-e043-400a-80e0-721aa825ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AECA6AA5F0>]}
[0m00:42:43.506826 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:42:43.506826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbe4c24-e043-400a-80e0-721aa825ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AECA6A9030>]}
[0m00:42:43.506826 [info ] [MainThread]: 
[0m00:42:43.522935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:42:43.524077 [info ] [MainThread]: 
[0m00:42:43.524077 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:42:43.526105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:42:43.571800 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:42:43.587834 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:42:43.587834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:45.618189 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.038 seconds
[0m00:42:45.634843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:42:45.665467 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:42:45.665467 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:42:45.665467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:42:47.458532 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.785 seconds
[0m00:42:47.479833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbe4c24-e043-400a-80e0-721aa825ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEADB5BA90>]}
[0m00:42:47.490488 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:42:47.490488 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:42:47.490488 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:42:47.490488 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:42:47.507103 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:42:47.507103 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:42:47.538475 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:42:47.539562 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:42:47.539562 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    


        select
            session_key,
            driver_number,
            date,
            round(gap_to_leader,3) as gap_to_leader,
            round("INTERVAL",3) as "INTERVAL",
    from F1.PONI.intervals
    where gap_to_leader is not null and "INTERVAL" is not null and gap_to_leader<>'+1 LAP'
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:42:47.539562 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:42:49.563627 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.030 seconds
[0m00:42:49.609063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbe4c24-e043-400a-80e0-721aa825ea3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEADA94FD0>]}
[0m00:42:49.609063 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 2.12s]
[0m00:42:49.609063 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:42:49.609063 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:42:49.609063 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:42:49.609063 [debug] [MainThread]: On list_F1: Close
[0m00:42:50.292824 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:42:50.299222 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:42:50.959174 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:42:50.959174 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:42:51.619029 [info ] [MainThread]: 
[0m00:42:51.626038 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.09 seconds (8.09s).
[0m00:42:51.632449 [debug] [MainThread]: Command end result
[0m00:42:51.642010 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:42:51.658794 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:42:51.662401 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:42:51.662401 [info ] [MainThread]: 
[0m00:42:51.662401 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:42:51.662401 [info ] [MainThread]: 
[0m00:42:51.662401 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:42:51.662401 [debug] [MainThread]: Command `dbt run` succeeded at 00:42:51.662401 after 10.40 seconds
[0m00:42:51.662401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEAF58A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB0851CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AECC05BB20>]}
[0m00:42:51.673957 [debug] [MainThread]: Flushing usage events
[0m00:42:52.928704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:43:40.527598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270CEE26350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270CFEF4F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270CFEF4D60>]}


============================== 00:43:40.527598 | 538b5daf-ace9-4473-963d-94c95d7893f7 ==============================
[0m00:43:40.527598 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:43:40.543041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_intervals.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:43:41.748134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '538b5daf-ace9-4473-963d-94c95d7893f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E894BC40>]}
[0m00:43:41.812012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '538b5daf-ace9-4473-963d-94c95d7893f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270CFEF7550>]}
[0m00:43:41.812012 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:43:42.065349 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:43:42.354161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:43:42.354161 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:43:42.624372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '538b5daf-ace9-4473-963d-94c95d7893f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E9030130>]}
[0m00:43:42.722145 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:43:42.722145 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:43:42.762905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '538b5daf-ace9-4473-963d-94c95d7893f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E8DBAF80>]}
[0m00:43:42.762905 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:43:42.762905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '538b5daf-ace9-4473-963d-94c95d7893f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E8DBBBE0>]}
[0m00:43:42.767624 [info ] [MainThread]: 
[0m00:43:42.769634 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:43:42.771639 [info ] [MainThread]: 
[0m00:43:42.771639 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:43:42.773646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:43:42.831027 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:43:42.831027 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:43:42.831027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:44.807134 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.975 seconds
[0m00:43:44.816032 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:43:44.834101 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:43:44.834101 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:43:44.834101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:43:46.552512 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.707 seconds
[0m00:43:46.556532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '538b5daf-ace9-4473-963d-94c95d7893f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270E89E3580>]}
[0m00:43:46.563099 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:43:46.563099 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:43:46.563099 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:43:46.563099 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:43:46.563099 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:43:46.578759 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:43:46.595632 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:43:46.595632 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:43:46.595632 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    


        select
            session_key,
            driver_number,
            date,
            round(gap_to_leader,3) as gap_to_leader,
            round("INTERVAL",3) as "INTERVAL",
    from F1.PONI.intervals
    where gap_to_leader is not null and "INTERVAL" is not null and gap_to_leader<>'+1 LAP' and gap_to_leader<>'+2 LAPS'
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:43:46.595632 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:43:48.561756 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.956 seconds
[0m00:43:48.582055 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '538b5daf-ace9-4473-963d-94c95d7893f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270CC217160>]}
[0m00:43:48.582055 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 2.02s]
[0m00:43:48.582055 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:43:48.582055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:43:48.596952 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:43:48.597833 [debug] [MainThread]: On list_F1: Close
[0m00:43:49.268125 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:43:49.278942 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:43:49.889882 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:43:49.889882 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:43:50.503957 [info ] [MainThread]: 
[0m00:43:50.503957 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m00:43:50.503957 [debug] [MainThread]: Command end result
[0m00:43:50.535782 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:43:50.547292 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:43:50.551527 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:43:50.551527 [info ] [MainThread]: 
[0m00:43:50.551527 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:43:50.551527 [info ] [MainThread]: 
[0m00:43:50.551527 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:43:50.551527 [debug] [MainThread]: Command `dbt run` succeeded at 00:43:50.551527 after 10.11 seconds
[0m00:43:50.551527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270CEE26350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270CEF292D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270EA75BB50>]}
[0m00:43:50.551527 [debug] [MainThread]: Flushing usage events
[0m00:43:51.820726 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:45:36.316255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938C38A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938E3ECF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938E3ECD90>]}


============================== 00:45:36.316255 | 1bf684dd-d5f7-45c0-ba27-306228d25f7e ==============================
[0m00:45:36.316255 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:45:36.316255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_intervals.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:45:37.595228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bf684dd-d5f7-45c0-ba27-306228d25f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A6D0B610>]}
[0m00:45:37.674823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bf684dd-d5f7-45c0-ba27-306228d25f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938E3EF4F0>]}
[0m00:45:37.682964 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:45:37.950636 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:45:38.252981 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:45:38.256687 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:45:38.523429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bf684dd-d5f7-45c0-ba27-306228d25f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A7520130>]}
[0m00:45:38.619113 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:45:38.619113 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:45:38.651192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bf684dd-d5f7-45c0-ba27-306228d25f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A72AA5F0>]}
[0m00:45:38.667315 [info ] [MainThread]: Found 8 models, 4 data tests, 6 sources, 477 macros
[0m00:45:38.667315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bf684dd-d5f7-45c0-ba27-306228d25f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A72A9030>]}
[0m00:45:38.667315 [info ] [MainThread]: 
[0m00:45:38.667315 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:45:38.667315 [info ] [MainThread]: 
[0m00:45:38.667315 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:45:38.667315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:45:38.736352 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:45:38.736352 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:45:38.736352 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:40.771823 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.034 seconds
[0m00:45:40.781715 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:45:40.801374 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:45:40.801374 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:45:40.803379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:42.464220 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.660 seconds
[0m00:45:42.477509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bf684dd-d5f7-45c0-ba27-306228d25f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938A75BA90>]}
[0m00:45:42.482881 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:45:42.482881 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:45:42.482881 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:45:42.482881 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:45:42.497752 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:45:42.497752 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:45:42.529729 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:45:42.533675 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:45:42.533675 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    


        select
            session_key,
            driver_number,
            date,
            round(gap_to_leader,3) as gap_to_leader,
            round("INTERVAL",3) as "INTERVAL",
    from F1.PONI.intervals
    where gap_to_leader is not null and "INTERVAL" is not null and gap_to_leader<>'+1 LAP'
        and gap_to_leader<>'+2 LAPS'
        and gap_to_leader<>'+4 LAPS'
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:45:42.533675 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:45:44.368314 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.835 seconds
[0m00:45:44.384308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bf684dd-d5f7-45c0-ba27-306228d25f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938A694FD0>]}
[0m00:45:44.399957 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 1.90s]
[0m00:45:44.399957 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:45:44.399957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:45:44.399957 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:45:44.399957 [debug] [MainThread]: On list_F1: Close
[0m00:45:45.112596 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:45:45.114324 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:45:45.702974 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:45:45.702974 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:45:46.306695 [info ] [MainThread]: 
[0m00:45:46.306695 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.64 seconds (7.64s).
[0m00:45:46.306695 [debug] [MainThread]: Command end result
[0m00:45:46.344511 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:45:46.344511 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:45:46.354396 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:45:46.359835 [info ] [MainThread]: 
[0m00:45:46.359835 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:45:46.359835 [info ] [MainThread]: 
[0m00:45:46.359835 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:45:46.359835 [debug] [MainThread]: Command `dbt run` succeeded at 00:45:46.359835 after 10.15 seconds
[0m00:45:46.366982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938C38A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002938D451CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000293A8C5BB20>]}
[0m00:45:46.366982 [debug] [MainThread]: Flushing usage events
[0m00:45:47.647254 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:13.047021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71B11A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71D174EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71D174D00>]}


============================== 01:14:13.057257 | 0868a8e7-82e8-4c5e-949c-1e2738946e6c ==============================
[0m01:14:13.057257 [info ] [MainThread]: Running with dbt=1.10.6
[0m01:14:13.059509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_pit.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:14:14.320364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0868a8e7-82e8-4c5e-949c-1e2738946e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71C1AC790>]}
[0m01:14:14.381115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0868a8e7-82e8-4c5e-949c-1e2738946e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71D1774F0>]}
[0m01:14:14.389765 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m01:14:14.658729 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m01:14:14.996143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:14:14.996143 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg_pit.sql
[0m01:14:14.996143 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m01:14:15.475833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0868a8e7-82e8-4c5e-949c-1e2738946e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D736430C70>]}
[0m01:14:15.583090 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:14:15.587612 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:14:15.636129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0868a8e7-82e8-4c5e-949c-1e2738946e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7360169B0>]}
[0m01:14:15.637397 [info ] [MainThread]: Found 9 models, 4 data tests, 7 sources, 477 macros
[0m01:14:15.637397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0868a8e7-82e8-4c5e-949c-1e2738946e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D736015D20>]}
[0m01:14:15.637397 [info ] [MainThread]: 
[0m01:14:15.637397 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:14:15.637397 [info ] [MainThread]: 
[0m01:14:15.644613 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:14:15.646258 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m01:14:15.692917 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m01:14:15.692917 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m01:14:15.692917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:17.591807 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.886 seconds
[0m01:14:17.605514 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m01:14:17.621284 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m01:14:17.622663 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m01:14:17.623812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:19.383652 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.761 seconds
[0m01:14:19.383652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0868a8e7-82e8-4c5e-949c-1e2738946e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D736014F10>]}
[0m01:14:19.398081 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_pit
[0m01:14:19.398081 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_pit ....................................... [RUN]
[0m01:14:19.398081 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_pit'
[0m01:14:19.398081 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_pit
[0m01:14:19.417104 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_pit"
[0m01:14:19.419345 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_pit
[0m01:14:19.446907 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_pit"
[0m01:14:19.446907 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_pit"
[0m01:14:19.446907 [debug] [Thread-1 (]: On model.f1_analytics.stg_pit: create or replace   view F1.PONI.stg_pit
  
  
  
  
  as (
    

    select *
    from F1.PONI.pit
    where pit_duration is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */;
[0m01:14:19.446907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:14:21.344859 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.892 seconds
[0m01:14:21.360835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0868a8e7-82e8-4c5e-949c-1e2738946e6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D719424FA0>]}
[0m01:14:21.360835 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_pit .................................. [[32mSUCCESS 1[0m in 1.96s]
[0m01:14:21.376709 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_pit
[0m01:14:21.376709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:21.376709 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m01:14:21.376709 [debug] [MainThread]: On list_F1: Close
[0m01:14:21.974698 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m01:14:21.974698 [debug] [MainThread]: On list_F1_PONI: Close
[0m01:14:22.581298 [debug] [MainThread]: Connection 'model.f1_analytics.stg_pit' was left open.
[0m01:14:22.581298 [debug] [MainThread]: On model.f1_analytics.stg_pit: Close
[0m01:14:23.193657 [info ] [MainThread]: 
[0m01:14:23.196447 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.56 seconds (7.56s).
[0m01:14:23.196447 [debug] [MainThread]: Command end result
[0m01:14:23.331737 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:14:23.333745 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:14:23.343839 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m01:14:23.343839 [info ] [MainThread]: 
[0m01:14:23.343839 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:14:23.343839 [info ] [MainThread]: 
[0m01:14:23.343839 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:14:23.343839 [debug] [MainThread]: Command `dbt run` succeeded at 01:14:23.343839 after 10.39 seconds
[0m01:14:23.343839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71B11A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71A897130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D71A858FD0>]}
[0m01:14:23.352081 [debug] [MainThread]: Flushing usage events
[0m01:14:24.607536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:47:51.696246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138177E6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013818AB4F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013818AB4D60>]}


============================== 01:47:51.722564 | 908ecd24-0d6e-410b-bdff-c35767f0f027 ==============================
[0m01:47:51.722564 [info ] [MainThread]: Running with dbt=1.10.6
[0m01:47:51.727887 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_position.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:47:56.087545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '908ecd24-0d6e-410b-bdff-c35767f0f027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013815589AE0>]}
[0m01:47:56.519377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '908ecd24-0d6e-410b-bdff-c35767f0f027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013818AB7550>]}
[0m01:47:56.531025 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m01:47:57.481043 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m01:47:58.231055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:47:58.235191 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg_position.sql
[0m01:47:58.235191 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m01:48:00.284597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '908ecd24-0d6e-410b-bdff-c35767f0f027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013831D790C0>]}
[0m01:48:00.857132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:48:00.863418 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:48:01.001123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '908ecd24-0d6e-410b-bdff-c35767f0f027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383195D570>]}
[0m01:48:01.004115 [info ] [MainThread]: Found 10 models, 4 data tests, 8 sources, 477 macros
[0m01:48:01.004115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '908ecd24-0d6e-410b-bdff-c35767f0f027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383195EC80>]}
[0m01:48:01.011099 [info ] [MainThread]: 
[0m01:48:01.012781 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:48:01.012781 [info ] [MainThread]: 
[0m01:48:01.015709 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:48:01.019501 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m01:48:01.253298 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m01:48:01.262641 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m01:48:01.264786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:03.752497 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.486 seconds
[0m01:48:03.790902 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m01:48:03.820921 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m01:48:03.820921 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m01:48:03.822971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:48:05.895902 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 2.074 seconds
[0m01:48:05.943079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '908ecd24-0d6e-410b-bdff-c35767f0f027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001383195DB70>]}
[0m01:48:05.984830 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_position
[0m01:48:05.992759 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_position .................................. [RUN]
[0m01:48:06.002192 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_position'
[0m01:48:06.009601 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_position
[0m01:48:06.061145 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_position"
[0m01:48:06.067791 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_position
[0m01:48:06.271084 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_position"
[0m01:48:06.274673 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_position"
[0m01:48:06.282794 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: create or replace   view F1.PONI.stg_position
  
  
  
  
  as (
    

    select *
    from F1.PONI.position
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */;
[0m01:48:06.282794 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:48:08.494660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.210 seconds
[0m01:48:08.636750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '908ecd24-0d6e-410b-bdff-c35767f0f027', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013833310130>]}
[0m01:48:08.637503 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_position ............................. [[32mSUCCESS 1[0m in 2.64s]
[0m01:48:08.641181 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_position
[0m01:48:08.645594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:48:08.645594 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m01:48:08.645594 [debug] [MainThread]: On list_F1: Close
[0m01:48:09.452702 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m01:48:09.454844 [debug] [MainThread]: On list_F1_PONI: Close
[0m01:48:10.431099 [debug] [MainThread]: Connection 'model.f1_analytics.stg_position' was left open.
[0m01:48:10.436894 [debug] [MainThread]: On model.f1_analytics.stg_position: Close
[0m01:48:11.148326 [info ] [MainThread]: 
[0m01:48:11.154142 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.13 seconds (10.13s).
[0m01:48:11.164999 [debug] [MainThread]: Command end result
[0m01:48:11.550983 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:48:11.561302 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:48:11.602812 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m01:48:11.608369 [info ] [MainThread]: 
[0m01:48:11.614426 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:48:11.619486 [info ] [MainThread]: 
[0m01:48:11.629497 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:48:11.641153 [debug] [MainThread]: Command `dbt run` succeeded at 01:48:11.641153 after 20.19 seconds
[0m01:48:11.648302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138177E6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013814BE37C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013817AEA860>]}
[0m01:48:11.656843 [debug] [MainThread]: Flushing usage events
[0m01:48:12.982673 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:58:43.129089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A67299A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6749F4E50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6749F4C70>]}


============================== 01:58:43.145849 | 9124eba3-a4ab-4509-9020-bc23231bdeca ==============================
[0m01:58:43.145849 [info ] [MainThread]: Running with dbt=1.10.6
[0m01:58:43.148286 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_meeting.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:58:46.555243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9124eba3-a4ab-4509-9020-bc23231bdeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A60D370820>]}
[0m01:58:47.019144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9124eba3-a4ab-4509-9020-bc23231bdeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A60D3706D0>]}
[0m01:58:47.030551 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m01:58:48.428998 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m01:58:49.489165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m01:58:49.493356 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg_meeting.sql
[0m01:58:49.495369 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m01:58:51.088872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9124eba3-a4ab-4509-9020-bc23231bdeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A60DD0D810>]}
[0m01:58:51.452774 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:58:51.455283 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:58:51.505171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9124eba3-a4ab-4509-9020-bc23231bdeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A60DCF6200>]}
[0m01:58:51.514921 [info ] [MainThread]: Found 11 models, 4 data tests, 9 sources, 477 macros
[0m01:58:51.514921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9124eba3-a4ab-4509-9020-bc23231bdeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A60DCF4880>]}
[0m01:58:51.522820 [info ] [MainThread]: 
[0m01:58:51.525339 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:58:51.528392 [info ] [MainThread]: 
[0m01:58:51.531287 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:58:51.535333 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m01:58:51.770516 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m01:58:51.782364 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m01:58:51.785232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:54.352845 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.567 seconds
[0m01:58:54.383773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m01:58:54.405298 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m01:58:54.405298 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m01:58:54.405298 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:58:56.385279 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.979 seconds
[0m01:58:56.408152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9124eba3-a4ab-4509-9020-bc23231bdeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A60DCF4220>]}
[0m01:58:56.425215 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_meeting
[0m01:58:56.425215 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_meeting ................................... [RUN]
[0m01:58:56.425215 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_meeting'
[0m01:58:56.425215 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_meeting
[0m01:58:56.441140 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_meeting"
[0m01:58:56.441814 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_meeting
[0m01:58:56.526259 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_meeting"
[0m01:58:56.528279 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_meeting"
[0m01:58:56.532739 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: create or replace   view F1.PONI.stg_meeting
  
  
  
  
  as (
    

    select
            meeting_key,
            meeting_name,
            meeting_official_name,
            circuit_short_name,
            country_name,
            date_start,
            year
from F1.PONI.meetings
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */;
[0m01:58:56.532739 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:58:58.730423 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.196 seconds
[0m01:58:58.794969 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9124eba3-a4ab-4509-9020-bc23231bdeca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A670CA4F10>]}
[0m01:58:58.796571 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_meeting .............................. [[32mSUCCESS 1[0m in 2.36s]
[0m01:58:58.796571 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_meeting
[0m01:58:58.796571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:58:58.806256 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m01:58:58.806795 [debug] [MainThread]: On list_F1: Close
[0m01:58:59.480157 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m01:58:59.486683 [debug] [MainThread]: On list_F1_PONI: Close
[0m01:59:00.236984 [debug] [MainThread]: Connection 'model.f1_analytics.stg_meeting' was left open.
[0m01:59:00.242683 [debug] [MainThread]: On model.f1_analytics.stg_meeting: Close
[0m01:59:00.940180 [info ] [MainThread]: 
[0m01:59:00.940180 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.41 seconds (9.41s).
[0m01:59:00.940180 [debug] [MainThread]: Command end result
[0m01:59:01.085201 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:59:01.087628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:59:01.101421 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m01:59:01.103431 [info ] [MainThread]: 
[0m01:59:01.104939 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:59:01.104939 [info ] [MainThread]: 
[0m01:59:01.107005 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:59:01.107005 [debug] [MainThread]: Command `dbt run` succeeded at 01:59:01.107005 after 18.56 seconds
[0m01:59:01.107005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A67299A260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A673A2C670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6741E4310>]}
[0m01:59:01.111251 [debug] [MainThread]: Flushing usage events
[0m01:59:02.413538 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:11:35.086140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB9F662C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADBAFFCEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADBAFFCD00>]}


============================== 02:11:35.091020 | 30b68d0f-43ae-41ac-bb08-b9f8c8e9a238 ==============================
[0m02:11:35.091020 [info ] [MainThread]: Running with dbt=1.10.6
[0m02:11:35.092057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_stints.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m02:11:36.099265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30b68d0f-43ae-41ac-bb08-b9f8c8e9a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADBAFFEB60>]}
[0m02:11:36.157864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30b68d0f-43ae-41ac-bb08-b9f8c8e9a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADBA8B9840>]}
[0m02:11:36.160287 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m02:11:36.387772 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m02:11:36.729071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m02:11:36.730609 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\staging\stg_stints.sql
[0m02:11:36.732644 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m02:11:37.132887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30b68d0f-43ae-41ac-bb08-b9f8c8e9a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADD42BA3B0>]}
[0m02:11:37.224060 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m02:11:37.226961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m02:11:37.261277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30b68d0f-43ae-41ac-bb08-b9f8c8e9a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADD3EA3B20>]}
[0m02:11:37.262282 [info ] [MainThread]: Found 12 models, 4 data tests, 10 sources, 477 macros
[0m02:11:37.263222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b68d0f-43ae-41ac-bb08-b9f8c8e9a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADD3EA1000>]}
[0m02:11:37.265266 [info ] [MainThread]: 
[0m02:11:37.266249 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m02:11:37.267263 [info ] [MainThread]: 
[0m02:11:37.268259 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m02:11:37.270952 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m02:11:37.330594 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m02:11:37.331599 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m02:11:37.332608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:39.123455 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.790 seconds
[0m02:11:39.140910 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m02:11:39.155475 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m02:11:39.156465 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m02:11:39.156465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m02:11:41.031552 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 1.874 seconds
[0m02:11:41.045688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30b68d0f-43ae-41ac-bb08-b9f8c8e9a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADD3EA2FB0>]}
[0m02:11:41.059343 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_stints
[0m02:11:41.059343 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_stints .................................... [RUN]
[0m02:11:41.061955 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_stints'
[0m02:11:41.062967 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_stints
[0m02:11:41.072023 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_stints"
[0m02:11:41.074927 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_stints
[0m02:11:41.103876 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_stints"
[0m02:11:41.105755 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_stints"
[0m02:11:41.106856 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: create or replace   view F1.PONI.stg_stints
  
  
  
  
  as (
    

    select *
    from F1.PONI.stints
    where compound is not null and lap_start is not null and lap_end is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */;
[0m02:11:41.107841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m02:11:42.973661 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.866 seconds
[0m02:11:42.999845 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30b68d0f-43ae-41ac-bb08-b9f8c8e9a238', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB7AB4F70>]}
[0m02:11:43.000851 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_stints ............................... [[32mSUCCESS 1[0m in 1.94s]
[0m02:11:43.002221 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_stints
[0m02:11:43.005489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m02:11:43.006487 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m02:11:43.006487 [debug] [MainThread]: On list_F1: Close
[0m02:11:43.600401 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m02:11:43.603687 [debug] [MainThread]: On list_F1_PONI: Close
[0m02:11:44.209946 [debug] [MainThread]: Connection 'model.f1_analytics.stg_stints' was left open.
[0m02:11:44.212275 [debug] [MainThread]: On model.f1_analytics.stg_stints: Close
[0m02:11:44.802737 [info ] [MainThread]: 
[0m02:11:44.805308 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.54 seconds (7.54s).
[0m02:11:44.809297 [debug] [MainThread]: Command end result
[0m02:11:44.918870 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m02:11:44.921707 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m02:11:44.928788 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m02:11:44.928788 [info ] [MainThread]: 
[0m02:11:44.929841 [info ] [MainThread]: [32mCompleted successfully[0m
[0m02:11:44.930858 [info ] [MainThread]: 
[0m02:11:44.933066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m02:11:44.935067 [debug] [MainThread]: Command `dbt run` succeeded at 02:11:44.934080 after 9.95 seconds
[0m02:11:44.935067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADB9F662C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADBA062DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ADD4130820>]}
[0m02:11:44.936149 [debug] [MainThread]: Flushing usage events
[0m02:11:46.039470 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:27:55.809050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE83782380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE85828F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE85828D90>]}


============================== 16:27:55.825239 | ee324309-1a6d-4b35-8df2-417bdc213086 ==============================
[0m16:27:55.825239 [info ] [MainThread]: Running with dbt=1.10.6
[0m16:27:55.825239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int_best_laps.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:28:02.357882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee324309-1a6d-4b35-8df2-417bdc213086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE84F94250>]}
[0m16:28:02.415447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee324309-1a6d-4b35-8df2-417bdc213086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE84FBC700>]}
[0m16:28:02.415447 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m16:28:03.236008 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m16:28:08.445920 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:28:08.445920 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_best_laps.sql
[0m16:28:08.670187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee324309-1a6d-4b35-8df2-417bdc213086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9E961630>]}
[0m16:28:08.751856 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m16:28:08.751856 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m16:28:08.782940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee324309-1a6d-4b35-8df2-417bdc213086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9E6FD2D0>]}
[0m16:28:08.789214 [info ] [MainThread]: Found 13 models, 4 data tests, 10 sources, 477 macros
[0m16:28:08.789214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee324309-1a6d-4b35-8df2-417bdc213086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9E6FEA10>]}
[0m16:28:08.791245 [info ] [MainThread]: 
[0m16:28:08.791245 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:08.791245 [info ] [MainThread]: 
[0m16:28:08.793276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:28:08.793276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m16:28:19.043818 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m16:28:19.043818 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m16:28:19.043818 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:20.876447 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.836 seconds
[0m16:28:20.894410 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m16:28:20.908232 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m16:28:20.908232 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m16:28:20.908232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:22.532229 [debug] [ThreadPool]: SQL status: SUCCESS 21 in 1.632 seconds
[0m16:28:22.547870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee324309-1a6d-4b35-8df2-417bdc213086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9E6D3C70>]}
[0m16:28:22.563657 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_best_laps
[0m16:28:22.563657 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_best_laps ................................. [RUN]
[0m16:28:22.563657 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_best_laps'
[0m16:28:22.563657 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_best_laps
[0m16:28:22.579628 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_best_laps"
[0m16:28:22.579628 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_best_laps
[0m16:28:22.595358 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_best_laps"
[0m16:28:22.611343 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_best_laps"
[0m16:28:22.611343 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: create or replace   view F1.PONI.int_best_laps
  
  
  
  
  as (
    

select
        session_key,
        driver_number,
        min(lap_duration) as fastest_lap
from F1.PONI.stg_laps
group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */;
[0m16:28:22.613804 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:28:24.569950 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.957 seconds
[0m16:28:24.585721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee324309-1a6d-4b35-8df2-417bdc213086', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE81B47190>]}
[0m16:28:24.585721 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_best_laps ............................ [[32mSUCCESS 1[0m in 2.01s]
[0m16:28:24.585721 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_best_laps
[0m16:28:24.585721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:24.585721 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m16:28:24.585721 [debug] [MainThread]: On list_F1: Close
[0m16:28:25.192892 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m16:28:25.208880 [debug] [MainThread]: On list_F1_PONI: Close
[0m16:28:25.806224 [debug] [MainThread]: Connection 'model.f1_analytics.int_best_laps' was left open.
[0m16:28:25.806224 [debug] [MainThread]: On model.f1_analytics.int_best_laps: Close
[0m16:28:26.411496 [info ] [MainThread]: 
[0m16:28:26.411496 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 17.62 seconds (17.62s).
[0m16:28:26.411496 [debug] [MainThread]: Command end result
[0m16:28:26.442952 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m16:28:26.442952 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m16:28:26.463212 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m16:28:26.463212 [info ] [MainThread]: 
[0m16:28:26.463212 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:26.463212 [info ] [MainThread]: 
[0m16:28:26.463212 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:28:26.463212 [debug] [MainThread]: Command `dbt run` succeeded at 16:28:26.463212 after 30.80 seconds
[0m16:28:26.463212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE83782380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9E9F28C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9E9538B0>]}
[0m16:28:26.463212 [debug] [MainThread]: Flushing usage events
[0m16:28:27.585652 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:26.655043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340AC4A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340BCDCEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340BCDCCD0>]}


============================== 17:03:26.661182 | ec6ff135-3eb1-4c47-ba3b-bf92932a65a2 ==============================
[0m17:03:26.661182 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:03:26.661182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_direct.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:03:27.300901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec6ff135-3eb1-4c47-ba3b-bf92932a65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340AD0A620>]}
[0m17:03:27.348578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec6ff135-3eb1-4c47-ba3b-bf92932a65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340B449F60>]}
[0m17:03:27.348578 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:03:27.539374 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:03:27.745559 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:03:27.745559 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_drivers.sql
[0m17:03:27.959126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec6ff135-3eb1-4c47-ba3b-bf92932a65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023424E15630>]}
[0m17:03:28.032023 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:03:28.034029 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:03:28.045892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec6ff135-3eb1-4c47-ba3b-bf92932a65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023424B8F220>]}
[0m17:03:28.045892 [info ] [MainThread]: Found 13 models, 4 data tests, 10 sources, 477 macros
[0m17:03:28.045892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec6ff135-3eb1-4c47-ba3b-bf92932a65a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023424B8E440>]}
[0m17:03:28.045892 [warn ] [MainThread]: The selection criterion 'stg_direct.sql' does not match any enabled nodes
[0m17:03:28.045892 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:03:28.045892 [debug] [MainThread]: Command end result
[0m17:03:28.078927 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:03:28.080935 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:03:28.084953 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:03:28.084953 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:28.084953 after 1.50 seconds
[0m17:03:28.086961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340AC4A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340AD1ABF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002340B449F60>]}
[0m17:03:28.086961 [debug] [MainThread]: Flushing usage events
[0m17:03:29.119082 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:37.437262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA53B1A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA54BB0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA54BB0D60>]}


============================== 17:03:37.437262 | 39dae076-b0ac-4470-b77f-f300ad159248 ==============================
[0m17:03:37.437262 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:03:37.437262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_drivers.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:03:38.139342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39dae076-b0ac-4470-b77f-f300ad159248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA54B75120>]}
[0m17:03:38.187725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39dae076-b0ac-4470-b77f-f300ad159248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA54BB34F0>]}
[0m17:03:38.189789 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:03:38.385788 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:03:38.596572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:03:38.597572 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:03:38.639382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39dae076-b0ac-4470-b77f-f300ad159248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6DB30B50>]}
[0m17:03:38.708366 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:03:38.708366 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:03:38.724383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39dae076-b0ac-4470-b77f-f300ad159248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6DA5BE50>]}
[0m17:03:38.724383 [info ] [MainThread]: Found 13 models, 4 data tests, 10 sources, 477 macros
[0m17:03:38.724383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39dae076-b0ac-4470-b77f-f300ad159248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6DAE4E80>]}
[0m17:03:38.724383 [info ] [MainThread]: 
[0m17:03:38.724383 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:03:38.740139 [info ] [MainThread]: 
[0m17:03:38.741424 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:03:38.742470 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m17:03:38.779928 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m17:03:38.779928 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m17:03:38.779928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:40.604882 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.816 seconds
[0m17:03:40.620999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m17:03:40.636868 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m17:03:40.636868 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m17:03:40.636868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:42.353864 [debug] [ThreadPool]: SQL status: SUCCESS 22 in 1.722 seconds
[0m17:03:42.370008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39dae076-b0ac-4470-b77f-f300ad159248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6DA5B5B0>]}
[0m17:03:42.387851 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_drivers
[0m17:03:42.387851 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_drivers ................................... [RUN]
[0m17:03:42.387851 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_drivers'
[0m17:03:42.387851 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_drivers
[0m17:03:42.401518 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_drivers"
[0m17:03:42.401518 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_drivers
[0m17:03:42.439384 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_drivers"
[0m17:03:42.441397 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_drivers"
[0m17:03:42.441397 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: create or replace   view F1.PONI.stg_drivers
  
  
  
  
  as (
    

with raw as(
    select *,
           row_number() over (partition by driver_number,session_key, full_name,team_name order by full_name) as rn
           from F1.PONI.drivers
)
SELECT
  CAST(driver_number AS INT)           AS driver_number,
  session_key,
  BROADCAST_NAME                       as broadcast_name,
  FULL_NAME                            AS full_name,
  name_acronym,
  team_name,
  team_colour,
  first_name,
  last_name,
  country_code
FROM raw
WHERE rn=1
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */;
[0m17:03:42.441397 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:03:44.352885 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.911 seconds
[0m17:03:44.381867 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39dae076-b0ac-4470-b77f-f300ad159248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA50E54FD0>]}
[0m17:03:44.381867 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_drivers .............................. [[32mSUCCESS 1[0m in 1.99s]
[0m17:03:44.383268 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_drivers
[0m17:03:44.383268 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:44.383268 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m17:03:44.383268 [debug] [MainThread]: On list_F1: Close
[0m17:03:44.990574 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m17:03:44.990574 [debug] [MainThread]: On list_F1_PONI: Close
[0m17:03:45.625987 [debug] [MainThread]: Connection 'model.f1_analytics.stg_drivers' was left open.
[0m17:03:45.625987 [debug] [MainThread]: On model.f1_analytics.stg_drivers: Close
[0m17:03:46.210780 [info ] [MainThread]: 
[0m17:03:46.213913 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m17:03:46.217099 [debug] [MainThread]: Command end result
[0m17:03:46.266223 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:03:46.266223 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:03:46.266223 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:03:46.266223 [info ] [MainThread]: 
[0m17:03:46.281320 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:46.281320 [info ] [MainThread]: 
[0m17:03:46.281320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:03:46.281320 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:46.281320 after 8.92 seconds
[0m17:03:46.281320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA53B1A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA6D5ECD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AA53C124A0>]}
[0m17:03:46.287003 [debug] [MainThread]: Flushing usage events
[0m17:03:47.313636 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:41.179157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E716EA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E72780F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E72780D30>]}


============================== 17:06:41.179157 | 9201a92d-e7c3-40fc-acb4-ba2eb72d9957 ==============================
[0m17:06:41.179157 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:06:41.179157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select int_car_base.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:41.862996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9201a92d-e7c3-40fc-acb4-ba2eb72d9957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E0B0B8730>]}
[0m17:06:41.911250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9201a92d-e7c3-40fc-acb4-ba2eb72d9957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E727834F0>]}
[0m17:06:41.911250 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:06:42.086994 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:06:42.276659 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:06:42.276659 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_car_base.sql
[0m17:06:42.470701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9201a92d-e7c3-40fc-acb4-ba2eb72d9957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E0B8D1AE0>]}
[0m17:06:42.551284 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:06:42.551284 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:06:42.567110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9201a92d-e7c3-40fc-acb4-ba2eb72d9957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E0B64A380>]}
[0m17:06:42.567110 [info ] [MainThread]: Found 14 models, 4 data tests, 10 sources, 477 macros
[0m17:06:42.567110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9201a92d-e7c3-40fc-acb4-ba2eb72d9957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E0B64DAE0>]}
[0m17:06:42.567110 [info ] [MainThread]: 
[0m17:06:42.582966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:42.582966 [info ] [MainThread]: 
[0m17:06:42.582966 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:06:42.582966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m17:06:42.630930 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m17:06:42.630930 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m17:06:42.630930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:44.496634 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.864 seconds
[0m17:06:44.496634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m17:06:44.521870 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m17:06:44.523876 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m17:06:44.523876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:46.146371 [debug] [ThreadPool]: SQL status: SUCCESS 22 in 1.630 seconds
[0m17:06:46.162583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9201a92d-e7c3-40fc-acb4-ba2eb72d9957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E0B64BD60>]}
[0m17:06:46.178508 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_car_base
[0m17:06:46.178508 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_car_base .................................. [RUN]
[0m17:06:46.178508 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_car_base'
[0m17:06:46.178508 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_car_base
[0m17:06:46.194270 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_car_base"
[0m17:06:46.194270 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_car_base
[0m17:06:46.210324 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_car_base"
[0m17:06:46.210324 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_car_base"
[0m17:06:46.210324 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: create or replace   view F1.PONI.int_car_base
  
  
  
  
  as (
    

SELECT
   ts.driver_number,
   ts.session_key,
   d.name_acronym,
   d.team_name,
   d.team_colour,
   ts.date,
   ts.rpm,
   ts.speed,
   ts.throttle,
   ts.brake,
   ts.drs
FROM F1.PONI.stg_car_data ts
LEFT JOIN F1.PONI.stg_drivers d
   ON ts.driver_number = d.driver_number
   AND ts.session_key = d.session_key
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */;
[0m17:06:46.210324 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:48.172937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.947 seconds
[0m17:06:48.192759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9201a92d-e7c3-40fc-acb4-ba2eb72d9957', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E0CF8E140>]}
[0m17:06:48.192759 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_car_base ............................. [[32mSUCCESS 1[0m in 2.01s]
[0m17:06:48.192759 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_car_base
[0m17:06:48.192759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:48.192759 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m17:06:48.192759 [debug] [MainThread]: On list_F1: Close
[0m17:06:48.778895 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m17:06:48.778895 [debug] [MainThread]: On list_F1_PONI: Close
[0m17:06:49.372214 [debug] [MainThread]: Connection 'model.f1_analytics.int_car_base' was left open.
[0m17:06:49.372214 [debug] [MainThread]: On model.f1_analytics.int_car_base: Close
[0m17:06:49.982861 [info ] [MainThread]: 
[0m17:06:49.995691 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.40 seconds (7.40s).
[0m17:06:49.998901 [debug] [MainThread]: Command end result
[0m17:06:50.015124 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:06:50.015124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:06:50.030891 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:06:50.030891 [info ] [MainThread]: 
[0m17:06:50.030891 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:50.030891 [info ] [MainThread]: 
[0m17:06:50.030891 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:06:50.030891 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:50.030891 after 8.92 seconds
[0m17:06:50.030891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E716EA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E727834F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027E0CF73F40>]}
[0m17:06:50.030891 [debug] [MainThread]: Flushing usage events
[0m17:06:51.107633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:26:30.435048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002387E96A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002387FC00F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002387FC00D30>]}


============================== 17:26:30.435048 | 66de6ddf-eafa-4a1c-b23c-c53598cac028 ==============================
[0m17:26:30.435048 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:26:30.435048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select int_intervals.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:26:31.133704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66de6ddf-eafa-4a1c-b23c-c53598cac028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002387BED5900>]}
[0m17:26:31.181601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66de6ddf-eafa-4a1c-b23c-c53598cac028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002387FC03520>]}
[0m17:26:31.181601 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:26:31.373161 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:26:31.546077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:26:31.546077 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_intervals.sql
[0m17:26:31.688121 [error] [MainThread]: Encountered an error:
Compilation Error in model int_intervals (f1_analytics/models\intermediate\int_intervals.sql)
  source() takes exactly two arguments (1 given)
[0m17:26:31.688121 [debug] [MainThread]: Command `dbt run` failed at 17:26:31.688121 after 1.32 seconds
[0m17:26:31.688121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002387E96A2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818B5AE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023818CD6020>]}
[0m17:26:31.688121 [debug] [MainThread]: Flushing usage events
[0m17:26:32.876332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:26:57.178734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019706CFA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019707D8CEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019707D8CD00>]}


============================== 17:26:57.184024 | fdc083ba-23c0-4b94-aca5-d08ebb41e786 ==============================
[0m17:26:57.184024 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:26:57.184024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select int_intervals.sql', 'send_anonymous_usage_stats': 'True'}
[0m17:26:57.845376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdc083ba-23c0-4b94-aca5-d08ebb41e786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019706DBA620>]}
[0m17:26:57.877232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdc083ba-23c0-4b94-aca5-d08ebb41e786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019720690760>]}
[0m17:26:57.892886 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:26:58.068976 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:26:58.240949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:26:58.240949 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_intervals.sql
[0m17:26:58.448035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdc083ba-23c0-4b94-aca5-d08ebb41e786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019720ED1F90>]}
[0m17:26:58.527872 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:26:58.527872 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:26:58.543743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdc083ba-23c0-4b94-aca5-d08ebb41e786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019720ED37C0>]}
[0m17:26:58.543743 [info ] [MainThread]: Found 15 models, 4 data tests, 10 sources, 477 macros
[0m17:26:58.543743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc083ba-23c0-4b94-aca5-d08ebb41e786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019720ED33D0>]}
[0m17:26:58.559814 [info ] [MainThread]: 
[0m17:26:58.559814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:26:58.559814 [info ] [MainThread]: 
[0m17:26:58.559814 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:26:58.559814 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m17:26:58.607483 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m17:26:58.607483 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m17:26:58.607483 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:00.305175 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.696 seconds
[0m17:27:00.321233 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m17:27:00.321233 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m17:27:00.321233 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m17:27:00.321233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:02.034942 [debug] [ThreadPool]: SQL status: SUCCESS 23 in 1.713 seconds
[0m17:27:02.050816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdc083ba-23c0-4b94-aca5-d08ebb41e786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019720C79F00>]}
[0m17:27:02.066453 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_intervals
[0m17:27:02.066453 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_intervals ................................. [RUN]
[0m17:27:02.066453 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_intervals'
[0m17:27:02.066453 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_intervals
[0m17:27:02.082442 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_intervals"
[0m17:27:02.082442 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_intervals
[0m17:27:02.098317 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_intervals"
[0m17:27:02.098317 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_intervals"
[0m17:27:02.098317 [debug] [Thread-1 (]: On model.f1_analytics.int_intervals: create or replace   view F1.PONI.int_intervals
  
  
  
  
  as (
    

    select
        driver_number,
        session_key,
        max(cast(gap_to_leader as float)) as max_gap_to_leader,
        max(cast(interval as float)) as max_gap_to_next,
        from F1.PONI.stg_intervals
        group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_intervals"} */;
[0m17:27:02.098317 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:27:03.978670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.867 seconds
[0m17:27:03.994478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdc083ba-23c0-4b94-aca5-d08ebb41e786', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019704034F40>]}
[0m17:27:03.994478 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_intervals ............................ [[32mSUCCESS 1[0m in 1.93s]
[0m17:27:03.994478 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_intervals
[0m17:27:03.994478 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:03.994478 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m17:27:03.994478 [debug] [MainThread]: On list_F1: Close
[0m17:27:04.558770 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m17:27:04.558770 [debug] [MainThread]: On list_F1_PONI: Close
[0m17:27:05.174408 [debug] [MainThread]: Connection 'model.f1_analytics.int_intervals' was left open.
[0m17:27:05.174408 [debug] [MainThread]: On model.f1_analytics.int_intervals: Close
[0m17:27:05.794653 [info ] [MainThread]: 
[0m17:27:05.794653 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.23 seconds (7.23s).
[0m17:27:05.794653 [debug] [MainThread]: Command end result
[0m17:27:05.826371 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:27:05.826371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:27:05.826371 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:27:05.826371 [info ] [MainThread]: 
[0m17:27:05.826371 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:05.842375 [info ] [MainThread]: 
[0m17:27:05.842375 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:27:05.842375 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:05.842375 after 8.74 seconds
[0m17:27:05.842375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019706CFA290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019703E6B700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019720C526B0>]}
[0m17:27:05.842375 [debug] [MainThread]: Flushing usage events
[0m17:27:06.933731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:59:30.346555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BE496380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C0738F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6C0738D90>]}


============================== 18:59:30.346555 | 4cd8cb58-fadf-4e3e-aa15-a7e73eb6e5fa ==============================
[0m18:59:30.346555 [info ] [MainThread]: Running with dbt=1.10.6
[0m18:59:30.362634 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select int_final_intervals.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:59:31.076065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4cd8cb58-fadf-4e3e-aa15-a7e73eb6e5fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BFEA4250>]}
[0m18:59:31.121672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4cd8cb58-fadf-4e3e-aa15-a7e73eb6e5fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BFECC700>]}
[0m18:59:31.123419 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m18:59:31.297304 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m18:59:31.488356 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m18:59:31.488356 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_final_position.sql
[0m18:59:31.488356 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_final_intervals.sql
[0m18:59:31.488356 [debug] [MainThread]: Partial parsing: deleted file: f1_analytics://f1_analytics/models\intermediate\int_intervals.sql
[0m18:59:31.722241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4cd8cb58-fadf-4e3e-aa15-a7e73eb6e5fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6D988A560>]}
[0m18:59:31.797360 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:59:31.799312 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:59:31.822316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4cd8cb58-fadf-4e3e-aa15-a7e73eb6e5fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6D95EBDC0>]}
[0m18:59:31.822316 [info ] [MainThread]: Found 16 models, 4 data tests, 10 sources, 477 macros
[0m18:59:31.823339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cd8cb58-fadf-4e3e-aa15-a7e73eb6e5fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6D9631CF0>]}
[0m18:59:31.825175 [info ] [MainThread]: 
[0m18:59:31.826628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:59:31.827693 [info ] [MainThread]: 
[0m18:59:31.827693 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:59:31.829845 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m18:59:31.875267 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m18:59:31.876317 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m18:59:31.876317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:34.249543 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.386 seconds
[0m18:59:34.274043 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m18:59:34.283104 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m18:59:34.283928 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m18:59:34.283928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:59:36.172171 [debug] [ThreadPool]: SQL status: SUCCESS 24 in 1.888 seconds
[0m18:59:36.172171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4cd8cb58-fadf-4e3e-aa15-a7e73eb6e5fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6D95E8190>]}
[0m18:59:36.187903 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_intervals
[0m18:59:36.187903 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_final_intervals ........................... [RUN]
[0m18:59:36.187903 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_final_intervals'
[0m18:59:36.187903 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_intervals
[0m18:59:36.203818 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_intervals"
[0m18:59:36.203818 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_intervals
[0m18:59:36.219696 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_intervals"
[0m18:59:36.219696 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_final_intervals"
[0m18:59:36.219696 [debug] [Thread-1 (]: On model.f1_analytics.int_final_intervals: create or replace   view F1.PONI.int_final_intervals
  
  
  
  
  as (
    

    select
        driver_number,
        session_key,
        max(cast(gap_to_leader as float)) as max_gap_to_leader,
        max(cast(interval as float)) as max_gap_to_next,
        from F1.PONI.stg_intervals
        group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */;
[0m18:59:36.219696 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:59:38.392620 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.172 seconds
[0m18:59:38.408543 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4cd8cb58-fadf-4e3e-aa15-a7e73eb6e5fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BC9E7190>]}
[0m18:59:38.408543 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_final_intervals ...................... [[32mSUCCESS 1[0m in 2.22s]
[0m18:59:38.408543 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_intervals
[0m18:59:38.408543 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:59:38.408543 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m18:59:38.408543 [debug] [MainThread]: On list_F1: Close
[0m18:59:39.179014 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m18:59:39.179014 [debug] [MainThread]: On list_F1_PONI: Close
[0m18:59:40.126318 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_intervals' was left open.
[0m18:59:40.126318 [debug] [MainThread]: On model.f1_analytics.int_final_intervals: Close
[0m18:59:40.783835 [info ] [MainThread]: 
[0m18:59:40.783835 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.96 seconds (8.96s).
[0m18:59:40.783835 [debug] [MainThread]: Command end result
[0m18:59:40.815597 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m18:59:40.815597 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m18:59:40.815597 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m18:59:40.815597 [info ] [MainThread]: 
[0m18:59:40.815597 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:59:40.815597 [info ] [MainThread]: 
[0m18:59:40.831592 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m18:59:40.831592 [debug] [MainThread]: Command `dbt run` succeeded at 18:59:40.831592 after 10.54 seconds
[0m18:59:40.831592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BE496380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BF77A6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B6BF76AF80>]}
[0m18:59:40.831592 [debug] [MainThread]: Flushing usage events
[0m18:59:42.365809 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:00:18.535993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9C26A6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9C474CF40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9C474CD60>]}


============================== 19:00:18.551798 | ec4edc85-b6d5-4d48-b905-54d6c60741f1 ==============================
[0m19:00:18.551798 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:00:18.551798 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select int_final_position.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:00:19.235144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ec4edc85-b6d5-4d48-b905-54d6c60741f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DD193C40>]}
[0m19:00:19.282852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ec4edc85-b6d5-4d48-b905-54d6c60741f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9C474F550>]}
[0m19:00:19.282852 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:00:19.485795 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:00:19.677976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:00:19.677976 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\intermediate\int_final_position.sql
[0m19:00:19.895743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec4edc85-b6d5-4d48-b905-54d6c60741f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DD88E5C0>]}
[0m19:00:19.970638 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:00:19.972384 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:00:19.994362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ec4edc85-b6d5-4d48-b905-54d6c60741f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DD603CD0>]}
[0m19:00:19.994362 [info ] [MainThread]: Found 16 models, 4 data tests, 10 sources, 477 macros
[0m19:00:19.994362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec4edc85-b6d5-4d48-b905-54d6c60741f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DD642E90>]}
[0m19:00:19.994362 [info ] [MainThread]: 
[0m19:00:19.994362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:00:19.994362 [info ] [MainThread]: 
[0m19:00:19.994362 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:00:19.994362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:00:20.042720 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:00:20.042720 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:00:20.042720 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:22.424837 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.373 seconds
[0m19:00:22.443810 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:00:22.446374 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:00:22.446374 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:00:22.446374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:00:24.577033 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 2.135 seconds
[0m19:00:24.593148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ec4edc85-b6d5-4d48-b905-54d6c60741f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DD603A60>]}
[0m19:00:24.609178 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_position
[0m19:00:24.609178 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_final_position ............................ [RUN]
[0m19:00:24.609178 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_final_position'
[0m19:00:24.609178 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_position
[0m19:00:24.629227 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_position"
[0m19:00:24.629227 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_position
[0m19:00:24.640700 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_position"
[0m19:00:24.640700 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_final_position"
[0m19:00:24.656577 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: create or replace   view F1.PONI.int_final_position
  
  
  
  
  as (
    

WITH latest_positions AS (
    SELECT
        session_key,
        driver_number,
        position,
        date as latest_date
    FROM F1.PONI.stg_position
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number
        ORDER BY date DESC
    ) = 1
)
SELECT * FROM latest_positions
order by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */;
[0m19:00:24.656577 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:00:27.145941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.493 seconds
[0m19:00:27.233353 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec4edc85-b6d5-4d48-b905-54d6c60741f1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9C09F7160>]}
[0m19:00:27.236992 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_final_position ....................... [[32mSUCCESS 1[0m in 2.61s]
[0m19:00:27.236992 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_position
[0m19:00:27.252296 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:00:27.252296 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:00:27.268434 [debug] [MainThread]: On list_F1: Close
[0m19:00:27.964115 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:00:27.969158 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:00:28.672395 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_position' was left open.
[0m19:00:28.677836 [debug] [MainThread]: On model.f1_analytics.int_final_position: Close
[0m19:00:29.436446 [info ] [MainThread]: 
[0m19:00:29.438835 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.44 seconds (9.44s).
[0m19:00:29.442800 [debug] [MainThread]: Command end result
[0m19:00:29.545133 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:00:29.551788 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:00:29.568051 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:00:29.569467 [info ] [MainThread]: 
[0m19:00:29.571944 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:00:29.572924 [info ] [MainThread]: 
[0m19:00:29.574937 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:00:29.579415 [debug] [MainThread]: Command `dbt run` succeeded at 19:00:29.578424 after 11.10 seconds
[0m19:00:29.580745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9C26A6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9DD193C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9C474F550>]}
[0m19:00:29.583807 [debug] [MainThread]: Flushing usage events
[0m19:00:30.827619 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:01:28.715659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1B55A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1D7C4F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1D7C4D90>]}


============================== 19:01:28.715659 | 549d95a7-d75a-47cb-bf17-bf678624b49c ==============================
[0m19:01:28.715659 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:01:28.731501 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int_final_position.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:01:29.384372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '549d95a7-d75a-47cb-bf17-bf678624b49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE360DB610>]}
[0m19:01:29.432506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '549d95a7-d75a-47cb-bf17-bf678624b49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1D7C74F0>]}
[0m19:01:29.432506 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:01:29.608140 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:01:29.816809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:01:29.816809 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\intermediate\int_final_position.sql
[0m19:01:30.024946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '549d95a7-d75a-47cb-bf17-bf678624b49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE368FE590>]}
[0m19:01:30.089445 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:01:30.089445 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:01:30.121332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '549d95a7-d75a-47cb-bf17-bf678624b49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE36907A00>]}
[0m19:01:30.121332 [info ] [MainThread]: Found 16 models, 4 data tests, 10 sources, 477 macros
[0m19:01:30.125125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '549d95a7-d75a-47cb-bf17-bf678624b49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE366B2500>]}
[0m19:01:30.127158 [info ] [MainThread]: 
[0m19:01:30.127158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:01:30.127158 [info ] [MainThread]: 
[0m19:01:30.127158 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:01:30.129201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:01:30.169427 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:01:30.169427 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:01:30.169427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:32.319789 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.147 seconds
[0m19:01:32.335668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:01:32.335668 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:01:32.335668 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:01:32.335668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:01:34.294277 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 1.945 seconds
[0m19:01:34.310111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '549d95a7-d75a-47cb-bf17-bf678624b49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE36904910>]}
[0m19:01:34.310111 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_position
[0m19:01:34.310111 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_final_position ............................ [RUN]
[0m19:01:34.325826 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_final_position'
[0m19:01:34.325826 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_position
[0m19:01:34.325826 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_position"
[0m19:01:34.325826 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_position
[0m19:01:34.357567 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_position"
[0m19:01:34.357567 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_final_position"
[0m19:01:34.357567 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: create or replace   view F1.PONI.int_final_position
  
  
  
  
  as (
    

WITH latest_positions AS (
    SELECT
        session_key,
        driver_number,
        position,
        date as latest_date
    FROM F1.PONI.stg_position
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number
        ORDER BY date DESC
    ) = 1
)
SELECT * FROM latest_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */;
[0m19:01:34.357567 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:01:36.431253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.068 seconds
[0m19:01:36.447468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '549d95a7-d75a-47cb-bf17-bf678624b49c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE37F08FA0>]}
[0m19:01:36.447468 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_final_position ....................... [[32mSUCCESS 1[0m in 2.12s]
[0m19:01:36.447468 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_position
[0m19:01:36.447468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:01:36.447468 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:01:36.447468 [debug] [MainThread]: On list_F1: Close
[0m19:01:37.124214 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:01:37.124214 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:01:37.848926 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_position' was left open.
[0m19:01:37.848926 [debug] [MainThread]: On model.f1_analytics.int_final_position: Close
[0m19:01:38.536528 [info ] [MainThread]: 
[0m19:01:38.536528 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.41 seconds (8.41s).
[0m19:01:38.536528 [debug] [MainThread]: Command end result
[0m19:01:38.568206 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:01:38.584066 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:01:38.584066 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:01:38.584066 [info ] [MainThread]: 
[0m19:01:38.584066 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:01:38.584066 [info ] [MainThread]: 
[0m19:01:38.584066 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:01:38.584066 [debug] [MainThread]: Command `dbt run` succeeded at 19:01:38.584066 after 9.95 seconds
[0m19:01:38.584066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1B55A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1D786FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE1C821CF0>]}
[0m19:01:38.584066 [debug] [MainThread]: Flushing usage events
[0m19:01:40.107532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:23:35.834827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FD7916350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FD99BCF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FD99BCD30>]}


============================== 19:23:35.838906 | 376fa255-4247-421c-8093-28bb657f12f0 ==============================
[0m19:23:35.838906 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:23:35.838906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_laps.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:23:36.535804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '376fa255-4247-421c-8093-28bb657f12f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FD99893F0>]}
[0m19:23:36.567793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '376fa255-4247-421c-8093-28bb657f12f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FD91006A0>]}
[0m19:23:36.584689 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:23:36.769439 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:23:36.966628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:23:36.966628 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_laps.sql
[0m19:23:37.192385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '376fa255-4247-421c-8093-28bb657f12f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FF2AFE620>]}
[0m19:23:37.267759 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:23:37.269910 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:23:37.292323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '376fa255-4247-421c-8093-28bb657f12f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FF28B1030>]}
[0m19:23:37.293298 [info ] [MainThread]: Found 16 models, 4 data tests, 10 sources, 477 macros
[0m19:23:37.293298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376fa255-4247-421c-8093-28bb657f12f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FF28B1000>]}
[0m19:23:37.295314 [info ] [MainThread]: 
[0m19:23:37.296297 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:23:37.296297 [info ] [MainThread]: 
[0m19:23:37.297299 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:37.298188 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:23:37.348191 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:23:37.348846 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:23:37.348846 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:39.842168 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.492 seconds
[0m19:23:39.846624 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:23:39.867029 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:23:39.868046 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:23:39.868712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:41.945423 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 2.082 seconds
[0m19:23:41.961619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '376fa255-4247-421c-8093-28bb657f12f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FF28B16C0>]}
[0m19:23:41.977450 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_laps
[0m19:23:41.977450 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_laps ...................................... [RUN]
[0m19:23:41.977450 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_laps'
[0m19:23:41.977450 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_laps
[0m19:23:41.993620 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_laps"
[0m19:23:41.993620 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_laps
[0m19:23:42.009826 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_laps"
[0m19:23:42.009826 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_laps"
[0m19:23:42.009826 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: create or replace   view F1.PONI.stg_laps
  
  
  
  
  as (
    

select
        session_key,
        driver_number,
        DATE_TRUNC('second', date_start) AS date_start,
        DATEADD(second, lap_duration, DATE_TRUNC('second', date_start)) AS date_end,
        lap_duration,
        lap_number,
        is_pit_out_lap,
        duration_sector_1,
        duration_sector_2,
        duration_sector_3,
from F1.PONI.laps
where lap_duration is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */;
[0m19:23:42.025952 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:44.271197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.247 seconds
[0m19:23:44.287084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '376fa255-4247-421c-8093-28bb657f12f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FF40EB040>]}
[0m19:23:44.287084 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_laps ................................. [[32mSUCCESS 1[0m in 2.31s]
[0m19:23:44.287084 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_laps
[0m19:23:44.287084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:44.299448 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:23:44.299448 [debug] [MainThread]: On list_F1: Close
[0m19:23:44.958249 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:23:44.958249 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:23:45.729609 [debug] [MainThread]: Connection 'model.f1_analytics.stg_laps' was left open.
[0m19:23:45.729609 [debug] [MainThread]: On model.f1_analytics.stg_laps: Close
[0m19:23:46.424269 [info ] [MainThread]: 
[0m19:23:46.424269 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.13 seconds (9.13s).
[0m19:23:46.424269 [debug] [MainThread]: Command end result
[0m19:23:46.460397 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:23:46.463393 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:23:46.471305 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:23:46.471305 [info ] [MainThread]: 
[0m19:23:46.472301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:46.473304 [info ] [MainThread]: 
[0m19:23:46.474034 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:23:46.474511 [debug] [MainThread]: Command `dbt run` succeeded at 19:23:46.474511 after 10.71 seconds
[0m19:23:46.475893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FD7916350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FF2884E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029FF26CDFF0>]}
[0m19:23:46.475893 [debug] [MainThread]: Flushing usage events
[0m19:23:47.807553 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:27:59.197257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE02476350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE04520F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE04520D30>]}


============================== 19:27:59.203442 | a2a3e16e-1641-44db-bc57-eb10015e8261 ==============================
[0m19:27:59.203442 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:27:59.203442 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_laps.sql', 'send_anonymous_usage_stats': 'True'}
[0m19:27:59.878168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a2a3e16e-1641-44db-bc57-eb10015e8261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE044E53F0>]}
[0m19:27:59.926461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a2a3e16e-1641-44db-bc57-eb10015e8261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE03C5C6A0>]}
[0m19:27:59.928765 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:28:00.122736 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:28:00.340816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:28:00.340816 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_laps.sql
[0m19:28:00.586047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a2a3e16e-1641-44db-bc57-eb10015e8261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE1D65E5F0>]}
[0m19:28:00.665091 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:28:00.668008 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:28:00.686665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a2a3e16e-1641-44db-bc57-eb10015e8261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE1D411570>]}
[0m19:28:00.688098 [info ] [MainThread]: Found 16 models, 4 data tests, 10 sources, 477 macros
[0m19:28:00.688409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a3e16e-1641-44db-bc57-eb10015e8261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE1D4115A0>]}
[0m19:28:00.690068 [info ] [MainThread]: 
[0m19:28:00.691325 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:28:00.691325 [info ] [MainThread]: 
[0m19:28:00.692325 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:28:00.693342 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:28:00.724248 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:28:00.724248 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:28:00.724248 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:02.698963 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.959 seconds
[0m19:28:02.710909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:28:02.721938 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:28:02.722975 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:28:02.722975 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:28:04.604536 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 1.894 seconds
[0m19:28:04.620572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a2a3e16e-1641-44db-bc57-eb10015e8261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE1D410970>]}
[0m19:28:04.636669 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_laps
[0m19:28:04.636669 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_laps ...................................... [RUN]
[0m19:28:04.636669 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_laps'
[0m19:28:04.636669 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_laps
[0m19:28:04.668540 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_laps"
[0m19:28:04.668540 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_laps
[0m19:28:04.686707 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_laps"
[0m19:28:04.686707 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_laps"
[0m19:28:04.686707 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: create or replace   view F1.PONI.stg_laps
  
  
  
  
  as (
    

select
        session_key,
        driver_number,
        DATE_TRUNC('second', date_start) AS date_start,
        DATEADD(second, lap_duration,date_start) AS date_end,
        lap_duration,
        lap_number,
        is_pit_out_lap,
        duration_sector_1,
        duration_sector_2,
        duration_sector_3,
from F1.PONI.laps
where lap_duration is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */;
[0m19:28:04.686707 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:28:06.721697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.029 seconds
[0m19:28:06.753833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a2a3e16e-1641-44db-bc57-eb10015e8261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE1EC4EE00>]}
[0m19:28:06.753833 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_laps ................................. [[32mSUCCESS 1[0m in 2.10s]
[0m19:28:06.753833 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_laps
[0m19:28:06.753833 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:28:06.753833 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:28:06.753833 [debug] [MainThread]: On list_F1: Close
[0m19:28:07.448223 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:28:07.448223 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:28:08.106698 [debug] [MainThread]: Connection 'model.f1_analytics.stg_laps' was left open.
[0m19:28:08.106698 [debug] [MainThread]: On model.f1_analytics.stg_laps: Close
[0m19:28:08.900185 [info ] [MainThread]: 
[0m19:28:08.916405 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m19:28:08.916405 [debug] [MainThread]: Command end result
[0m19:28:08.948378 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:28:08.964264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:28:08.964264 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:28:08.980216 [info ] [MainThread]: 
[0m19:28:08.980216 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:28:08.980216 [info ] [MainThread]: 
[0m19:28:08.980216 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:28:08.980216 [debug] [MainThread]: Command `dbt run` succeeded at 19:28:08.980216 after 9.88 seconds
[0m19:28:08.980216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE02476350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE1D3E53F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE1CEC7580>]}
[0m19:28:08.980216 [debug] [MainThread]: Flushing usage events
[0m19:28:10.470895 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:53:19.331478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13FC16380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F141ED0F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F141ED0D90>]}


============================== 19:53:19.331478 | 164155e3-cc63-4e1b-89f2-277a3c4b3dca ==============================
[0m19:53:19.331478 [info ] [MainThread]: Running with dbt=1.10.6
[0m19:53:19.331478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select int_lap_position.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:53:20.001890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '164155e3-cc63-4e1b-89f2-277a3c4b3dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F141628250>]}
[0m19:53:20.047231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '164155e3-cc63-4e1b-89f2-277a3c4b3dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F14164C700>]}
[0m19:53:20.047231 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m19:53:20.233093 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m19:53:20.427861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:53:20.427861 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_lap_position.sql
[0m19:53:20.634113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '164155e3-cc63-4e1b-89f2-277a3c4b3dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15B007EB0>]}
[0m19:53:20.715463 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:53:20.717470 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:53:20.729194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '164155e3-cc63-4e1b-89f2-277a3c4b3dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15ADBD360>]}
[0m19:53:20.729194 [info ] [MainThread]: Found 17 models, 4 data tests, 10 sources, 477 macros
[0m19:53:20.729194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '164155e3-cc63-4e1b-89f2-277a3c4b3dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15ADBD2D0>]}
[0m19:53:20.729194 [info ] [MainThread]: 
[0m19:53:20.729194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:20.729194 [info ] [MainThread]: 
[0m19:53:20.729194 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:53:20.743521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m19:53:20.777373 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m19:53:20.777373 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m19:53:20.777373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:22.831148 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.039 seconds
[0m19:53:22.847239 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m19:53:22.847239 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m19:53:22.847239 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m19:53:22.847239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:24.598510 [debug] [ThreadPool]: SQL status: SUCCESS 25 in 1.742 seconds
[0m19:53:24.611032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '164155e3-cc63-4e1b-89f2-277a3c4b3dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15ADBCE50>]}
[0m19:53:24.616239 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_lap_position
[0m19:53:24.616239 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_lap_position .............................. [RUN]
[0m19:53:24.616239 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_lap_position'
[0m19:53:24.616239 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_lap_position
[0m19:53:24.630286 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_lap_position"
[0m19:53:24.630286 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_lap_position
[0m19:53:24.646044 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_lap_position"
[0m19:53:24.661701 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_lap_position"
[0m19:53:24.661701 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: create or replace   view F1.PONI.int_lap_position
  
  
  
  
  as (
    

WITH positions AS (
    SELECT
        p.session_key,
        p.driver_number,
        p.position,
        p.date,
        l.lap_number,
        l.date_start,
        l.date_end,
        ABS(DATEDIFF(second, p.date, l.date_start)) AS start_time_diff,
        ABS(DATEDIFF(second, p.date, l.date_end)) AS end_time_diff
    FROM F1.PONI.stg_position p
    JOIN F1.PONI.stg_laps l
        ON p.session_key = l.session_key
        AND p.driver_number = l.driver_number
    WHERE p.date BETWEEN l.date_start AND l.date_end
)
SELECT *,
    ROW_NUMBER() OVER (PARTITION BY session_key, driver_number, lap_number
                       ORDER BY start_time_diff) AS start_position_rank,
    ROW_NUMBER() OVER (PARTITION BY session_key, driver_number, lap_number
                       ORDER BY end_time_diff) AS end_position_rank
FROM positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */;
[0m19:53:24.661701 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:53:26.989544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.325 seconds
[0m19:53:27.005431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '164155e3-cc63-4e1b-89f2-277a3c4b3dca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13E157190>]}
[0m19:53:27.005431 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_lap_position ......................... [[32mSUCCESS 1[0m in 2.39s]
[0m19:53:27.005431 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_lap_position
[0m19:53:27.005431 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:27.005431 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m19:53:27.005431 [debug] [MainThread]: On list_F1: Close
[0m19:53:27.760872 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m19:53:27.760872 [debug] [MainThread]: On list_F1_PONI: Close
[0m19:53:28.469810 [debug] [MainThread]: Connection 'model.f1_analytics.int_lap_position' was left open.
[0m19:53:28.469810 [debug] [MainThread]: On model.f1_analytics.int_lap_position: Close
[0m19:53:29.146931 [info ] [MainThread]: 
[0m19:53:29.153045 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.42 seconds (8.42s).
[0m19:53:29.163235 [debug] [MainThread]: Command end result
[0m19:53:29.203415 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m19:53:29.207699 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m19:53:29.207699 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m19:53:29.207699 [info ] [MainThread]: 
[0m19:53:29.207699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:29.207699 [info ] [MainThread]: 
[0m19:53:29.207699 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:53:29.207699 [debug] [MainThread]: Command `dbt run` succeeded at 19:53:29.207699 after 9.96 seconds
[0m19:53:29.207699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F13FC16380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F15AEF9CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F14164C700>]}
[0m19:53:29.207699 [debug] [MainThread]: Flushing usage events
[0m19:53:30.711699 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:18:09.812209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E39906380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3BBA8F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3BBA8D90>]}


============================== 14:18:09.828231 | c05b005e-1682-48c5-acea-a5920d53dd59 ==============================
[0m14:18:09.828231 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:18:09.828231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_pit_stop.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:18:13.879004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c05b005e-1682-48c5-acea-a5920d53dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3B314250>]}
[0m14:18:13.934513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c05b005e-1682-48c5-acea-a5920d53dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3B33C700>]}
[0m14:18:13.934513 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m14:18:14.701307 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:18:21.278506 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:18:21.278506 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_pit_stop.sql
[0m14:18:21.487298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c05b005e-1682-48c5-acea-a5920d53dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E54CEC130>]}
[0m14:18:21.567749 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:18:21.667892 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:18:21.711792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c05b005e-1682-48c5-acea-a5920d53dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E54AA2170>]}
[0m14:18:21.711792 [info ] [MainThread]: Found 18 models, 4 data tests, 10 sources, 477 macros
[0m14:18:21.711792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c05b005e-1682-48c5-acea-a5920d53dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E54AA20E0>]}
[0m14:18:21.711792 [info ] [MainThread]: 
[0m14:18:21.711792 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:18:21.711792 [info ] [MainThread]: 
[0m14:18:21.711792 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:18:21.711792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m14:18:31.803959 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m14:18:31.803959 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m14:18:31.803959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:33.641680 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.836 seconds
[0m14:18:33.643689 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m14:18:33.657493 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m14:18:33.657493 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m14:18:33.657493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:35.671192 [debug] [ThreadPool]: SQL status: SUCCESS 26 in 2.016 seconds
[0m14:18:35.686964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c05b005e-1682-48c5-acea-a5920d53dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E54AA1690>]}
[0m14:18:35.686964 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_pit_stop
[0m14:18:35.686964 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_pit_stop .................................. [RUN]
[0m14:18:35.702879 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_pit_stop'
[0m14:18:35.702879 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_pit_stop
[0m14:18:35.702879 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_pit_stop"
[0m14:18:35.702879 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_pit_stop
[0m14:18:35.734502 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_pit_stop"
[0m14:18:35.734502 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_pit_stop"
[0m14:18:35.734502 [debug] [Thread-1 (]: On model.f1_analytics.int_pit_stop: create or replace   view F1.PONI.int_pit_stop
  
  
  
  
  as (
    

SELECT
    session_key,
    driver_number,
    COUNT(*) AS pit_stop_count
FROM F1.PONI.stg_pit
GROUP BY session_key, driver_number
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */;
[0m14:18:35.734502 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:37.526740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.784 seconds
[0m14:18:37.550080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c05b005e-1682-48c5-acea-a5920d53dd59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E56252E60>]}
[0m14:18:37.550080 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_pit_stop ............................. [[32mSUCCESS 1[0m in 1.85s]
[0m14:18:37.550080 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_pit_stop
[0m14:18:37.550080 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:37.550080 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m14:18:37.558985 [debug] [MainThread]: On list_F1: Close
[0m14:18:38.132680 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m14:18:38.132680 [debug] [MainThread]: On list_F1_PONI: Close
[0m14:18:38.721799 [debug] [MainThread]: Connection 'model.f1_analytics.int_pit_stop' was left open.
[0m14:18:38.721799 [debug] [MainThread]: On model.f1_analytics.int_pit_stop: Close
[0m14:18:39.343783 [info ] [MainThread]: 
[0m14:18:39.343783 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 17.62 seconds (17.62s).
[0m14:18:39.343783 [debug] [MainThread]: Command end result
[0m14:18:39.407555 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:18:39.407555 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:18:39.407555 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m14:18:39.407555 [info ] [MainThread]: 
[0m14:18:39.407555 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:18:39.423495 [info ] [MainThread]: 
[0m14:18:39.423495 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:18:39.423495 [debug] [MainThread]: Command `dbt run` succeeded at 14:18:39.423495 after 29.71 seconds
[0m14:18:39.429743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E39906380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E54696BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E3B33C700>]}
[0m14:18:39.429743 [debug] [MainThread]: Flushing usage events
[0m14:18:40.494211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:39:44.525754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1975A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1A9F0EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1A9F0CD0>]}


============================== 14:39:44.525754 | 65d9a275-ec38-4c9b-ac01-a221cd5efc67 ==============================
[0m14:39:44.525754 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:39:44.525754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sessions.sql', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:39:45.199374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65d9a275-ec38-4c9b-ac01-a221cd5efc67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF19A1A620>]}
[0m14:39:45.246962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65d9a275-ec38-4c9b-ac01-a221cd5efc67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1A159F60>]}
[0m14:39:45.246962 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m14:39:45.438426 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:39:45.616502 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:39:45.616502 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m14:39:45.824251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65d9a275-ec38-4c9b-ac01-a221cd5efc67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF33B2C100>]}
[0m14:39:45.903857 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:39:45.903857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:39:45.935207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65d9a275-ec38-4c9b-ac01-a221cd5efc67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF338E67A0>]}
[0m14:39:45.935207 [info ] [MainThread]: Found 18 models, 4 data tests, 10 sources, 477 macros
[0m14:39:45.935207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d9a275-ec38-4c9b-ac01-a221cd5efc67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF338E6740>]}
[0m14:39:45.938671 [info ] [MainThread]: 
[0m14:39:45.938671 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:45.938671 [info ] [MainThread]: 
[0m14:39:45.938671 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:39:45.938671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m14:39:45.982973 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m14:39:45.982973 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m14:39:45.982973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:47.770745 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.792 seconds
[0m14:39:47.802631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m14:39:47.802631 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m14:39:47.802631 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m14:39:47.802631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:49.498109 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 1.688 seconds
[0m14:39:49.515270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d9a275-ec38-4c9b-ac01-a221cd5efc67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF338E5AB0>]}
[0m14:39:49.524262 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m14:39:49.529023 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_sessions .................................. [RUN]
[0m14:39:49.529023 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_sessions'
[0m14:39:49.529023 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m14:39:49.529023 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m14:39:49.529023 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m14:39:49.560886 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m14:39:49.560886 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_sessions"
[0m14:39:49.560886 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: create or replace   view F1.PONI.stg_sessions
  
  
  
  
  as (
    

with raw as(
    select * from F1.PONI.sessions
),
    raw1 as(
    select * from F1.PONI.meetings
SELECT
  CAST(s.session_key AS INT)             AS session_key,
  CAST(s.meeting_key AS INT)             AS meeting_key,
  s.session_name                         AS session_name,
  s.session_type                         AS session_type,
  m.circuit_short_name,
  m.country_name,
  TO_TIMESTAMP_NTZ(date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(date_end)           AS date_end,
  location                             AS location
FROM raw s left join raw1 m on s.meeting_key=m.meeting_key
WHERE session_key IS NOT NULL and session_type in('Race', 'Qualifying')
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */;
[0m14:39:49.560886 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:39:51.273629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be45e5-0003-5210-0009-1a0e00040cba
[0m14:39:51.273629 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 0 unexpected 'SELECT'.
[0m14:39:51.289758 [debug] [Thread-1 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'SELECT'.
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m14:39:51.289758 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d9a275-ec38-4c9b-ac01-a221cd5efc67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF3411E710>]}
[0m14:39:51.289758 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_sessions ......................... [[31mERROR[0m in 1.76s]
[0m14:39:51.289758 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m14:39:51.289758 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'SELECT'.
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m14:39:51.289758 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:51.289758 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m14:39:51.289758 [debug] [MainThread]: On list_F1: Close
[0m14:39:51.898025 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m14:39:51.898025 [debug] [MainThread]: On list_F1_PONI: Close
[0m14:39:52.507028 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was left open.
[0m14:39:52.509048 [debug] [MainThread]: On model.f1_analytics.stg_sessions: Close
[0m14:39:53.140095 [info ] [MainThread]: 
[0m14:39:53.145290 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.20 seconds (7.20s).
[0m14:39:53.145290 [debug] [MainThread]: Command end result
[0m14:39:53.186488 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:39:53.188494 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:39:53.192512 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m14:39:53.192512 [info ] [MainThread]: 
[0m14:39:53.192512 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:39:53.192512 [info ] [MainThread]: 
[0m14:39:53.192512 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m14:39:53.192512 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 0 unexpected 'SELECT'.
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m14:39:53.192512 [info ] [MainThread]: 
[0m14:39:53.192512 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m14:39:53.192512 [info ] [MainThread]: 
[0m14:39:53.192512 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:39:53.192512 [debug] [MainThread]: Command `dbt run` failed at 14:39:53.192512 after 8.77 seconds
[0m14:39:53.192512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1975A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF1A159F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF19A2D030>]}
[0m14:39:53.192512 [debug] [MainThread]: Flushing usage events
[0m14:39:54.324223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:29.330220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D50DB6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D51E90F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D51E90D90>]}


============================== 14:40:29.334284 | 56b9b35d-1abf-4d5a-b6d1-7752e8ff8ac4 ==============================
[0m14:40:29.334284 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:40:29.336326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sessions.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:40:30.013934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56b9b35d-1abf-4d5a-b6d1-7752e8ff8ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D51E553F0>]}
[0m14:40:30.062227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56b9b35d-1abf-4d5a-b6d1-7752e8ff8ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D51E934F0>]}
[0m14:40:30.062227 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m14:40:30.238078 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:40:30.480284 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:40:30.480284 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m14:40:30.702236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56b9b35d-1abf-4d5a-b6d1-7752e8ff8ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6AFCC130>]}
[0m14:40:30.766747 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:40:30.766747 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:40:30.798451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56b9b35d-1abf-4d5a-b6d1-7752e8ff8ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6AD78160>]}
[0m14:40:30.798451 [info ] [MainThread]: Found 18 models, 4 data tests, 10 sources, 477 macros
[0m14:40:30.798451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b9b35d-1abf-4d5a-b6d1-7752e8ff8ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6AEB6710>]}
[0m14:40:30.798451 [info ] [MainThread]: 
[0m14:40:30.798451 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:40:30.798451 [info ] [MainThread]: 
[0m14:40:30.798451 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:40:30.798451 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m14:40:30.846844 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m14:40:30.846844 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m14:40:30.846844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:32.669418 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.828 seconds
[0m14:40:32.701620 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m14:40:32.717350 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m14:40:32.717350 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m14:40:32.717350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:40:34.349672 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 1.640 seconds
[0m14:40:34.365721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56b9b35d-1abf-4d5a-b6d1-7752e8ff8ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6AFE3370>]}
[0m14:40:34.365721 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m14:40:34.365721 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_sessions .................................. [RUN]
[0m14:40:34.365721 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_sessions'
[0m14:40:34.365721 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m14:40:34.381381 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m14:40:34.381381 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m14:40:34.397573 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m14:40:34.397573 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_sessions"
[0m14:40:34.397573 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: create or replace   view F1.PONI.stg_sessions
  
  
  
  
  as (
    

with raw as(
    select * from F1.PONI.sessions
),
    raw1 as (select *
             from F1.PONI.meetings
             )
SELECT
  CAST(s.session_key AS INT)             AS session_key,
  CAST(s.meeting_key AS INT)             AS meeting_key,
  s.session_name                         AS session_name,
  s.session_type                         AS session_type,
  m.circuit_short_name,
  m.country_name,
  TO_TIMESTAMP_NTZ(date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(date_end)           AS date_end,
  location                             AS location
FROM raw s left join raw1 m on s.meeting_key=m.meeting_key
WHERE session_key IS NOT NULL and session_type in('Race', 'Qualifying')
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */;
[0m14:40:34.397573 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:40:35.962270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be45e6-0003-5213-0009-1a0e0003ecfe
[0m14:40:35.964285 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'DATE_START'
[0m14:40:35.966035 [debug] [Thread-1 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'DATE_START'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m14:40:35.968041 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56b9b35d-1abf-4d5a-b6d1-7752e8ff8ac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D6B5BF0A0>]}
[0m14:40:35.968041 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_sessions ......................... [[31mERROR[0m in 1.60s]
[0m14:40:35.968041 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m14:40:35.968041 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'DATE_START'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m14:40:35.968041 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:40:35.968041 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m14:40:35.968041 [debug] [MainThread]: On list_F1: Close
[0m14:40:36.573328 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m14:40:36.573328 [debug] [MainThread]: On list_F1_PONI: Close
[0m14:40:37.149164 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was left open.
[0m14:40:37.149164 [debug] [MainThread]: On model.f1_analytics.stg_sessions: Close
[0m14:40:37.741011 [info ] [MainThread]: 
[0m14:40:37.741011 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.94 seconds (6.94s).
[0m14:40:37.741011 [debug] [MainThread]: Command end result
[0m14:40:37.772538 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:40:37.772538 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:40:37.788512 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m14:40:37.788512 [info ] [MainThread]: 
[0m14:40:37.788512 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:40:37.788512 [info ] [MainThread]: 
[0m14:40:37.788512 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m14:40:37.788512 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'DATE_START'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m14:40:37.788512 [info ] [MainThread]: 
[0m14:40:37.788512 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m14:40:37.788512 [info ] [MainThread]: 
[0m14:40:37.788512 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:40:37.788512 [debug] [MainThread]: Command `dbt run` failed at 14:40:37.788512 after 8.55 seconds
[0m14:40:37.788512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D50DB6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D51E934F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016D50EB92D0>]}
[0m14:40:37.788512 [debug] [MainThread]: Flushing usage events
[0m14:40:38.906350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:13.508694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A386DAA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A388E10F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A388E10D60>]}


============================== 14:41:13.508694 | 9726bf52-ca0b-41db-a7a2-1cc30a15b395 ==============================
[0m14:41:13.508694 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:41:13.508694 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_sessions.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:41:14.209381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9726bf52-ca0b-41db-a7a2-1cc30a15b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A388DD5120>]}
[0m14:41:14.256660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9726bf52-ca0b-41db-a7a2-1cc30a15b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A388E134F0>]}
[0m14:41:14.256660 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m14:41:14.447719 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:41:14.687739 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:14.687739 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m14:41:14.909808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9726bf52-ca0b-41db-a7a2-1cc30a15b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A1F4C100>]}
[0m14:41:14.989054 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:41:14.989054 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:41:15.020703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9726bf52-ca0b-41db-a7a2-1cc30a15b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A1CF8430>]}
[0m14:41:15.020703 [info ] [MainThread]: Found 18 models, 4 data tests, 10 sources, 477 macros
[0m14:41:15.020703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9726bf52-ca0b-41db-a7a2-1cc30a15b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A1CF8100>]}
[0m14:41:15.020703 [info ] [MainThread]: 
[0m14:41:15.020703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:15.020703 [info ] [MainThread]: 
[0m14:41:15.020703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:15.020703 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m14:41:15.068228 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m14:41:15.068228 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m14:41:15.068228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:16.953686 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.871 seconds
[0m14:41:16.953686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m14:41:16.985264 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m14:41:16.987272 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m14:41:16.987272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:18.569605 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 1.588 seconds
[0m14:41:18.585609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9726bf52-ca0b-41db-a7a2-1cc30a15b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A1F615A0>]}
[0m14:41:18.601303 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m14:41:18.601303 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_sessions .................................. [RUN]
[0m14:41:18.603756 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_sessions'
[0m14:41:18.603756 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m14:41:18.613787 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m14:41:18.615792 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m14:41:18.637082 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m14:41:18.637082 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_sessions"
[0m14:41:18.639087 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: create or replace   view F1.PONI.stg_sessions
  
  
  
  
  as (
    

with raw as(
    select * from F1.PONI.sessions
),
    raw1 as (select *
             from F1.PONI.meetings
             )
SELECT
  CAST(s.session_key AS INT)             AS session_key,
  CAST(s.meeting_key AS INT)             AS meeting_key,
  s.session_name                         AS session_name,
  s.session_type                         AS session_type,
  m.circuit_short_name,
  m.country_name,
  TO_TIMESTAMP_NTZ(s.date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(s.date_end)           AS date_end,
  location                             AS location
FROM raw s left join raw1 m on s.meeting_key=m.meeting_key
WHERE session_key IS NOT NULL and session_type in('Race', 'Qualifying')
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */;
[0m14:41:18.639087 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:20.312191 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be45e7-0003-51fb-0009-1a0e0003fcca
[0m14:41:20.312191 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'LOCATION'
[0m14:41:20.312191 [debug] [Thread-1 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'LOCATION'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m14:41:20.328354 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9726bf52-ca0b-41db-a7a2-1cc30a15b395', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A3A350FC70>]}
[0m14:41:20.328354 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_sessions ......................... [[31mERROR[0m in 1.71s]
[0m14:41:20.328354 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m14:41:20.328354 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'LOCATION'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m14:41:20.328354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:20.328354 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m14:41:20.328354 [debug] [MainThread]: On list_F1: Close
[0m14:41:20.965190 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m14:41:20.965190 [debug] [MainThread]: On list_F1_PONI: Close
[0m14:41:21.684896 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was left open.
[0m14:41:21.684896 [debug] [MainThread]: On model.f1_analytics.stg_sessions: Close
[0m14:41:22.324705 [info ] [MainThread]: 
[0m14:41:22.324705 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.30 seconds (7.30s).
[0m14:41:22.324705 [debug] [MainThread]: Command end result
[0m14:41:22.356755 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:41:22.356755 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:41:22.376757 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m14:41:22.376757 [info ] [MainThread]: 
[0m14:41:22.376757 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:41:22.376757 [info ] [MainThread]: 
[0m14:41:22.376757 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m14:41:22.376757 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'LOCATION'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m14:41:22.382086 [info ] [MainThread]: 
[0m14:41:22.382086 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m14:41:22.382086 [info ] [MainThread]: 
[0m14:41:22.384092 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:41:22.384092 [debug] [MainThread]: Command `dbt run` failed at 14:41:22.384092 after 8.94 seconds
[0m14:41:22.386097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A386DAA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A388E134F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A387E71CF0>]}
[0m14:41:22.386097 [debug] [MainThread]: Flushing usage events
[0m14:41:23.571091 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:41:47.376260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171760DA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017177164F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017177164D60>]}


============================== 14:41:47.376260 | 2c9eb706-6383-4342-a1da-d1484dd89a55 ==============================
[0m14:41:47.376260 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:41:47.376260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sessions.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:41:48.028266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c9eb706-6383-4342-a1da-d1484dd89a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017177135120>]}
[0m14:41:48.076610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c9eb706-6383-4342-a1da-d1484dd89a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171771674F0>]}
[0m14:41:48.076610 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m14:41:48.268274 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:41:48.536186 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:41:48.537192 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m14:41:48.742939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c9eb706-6383-4342-a1da-d1484dd89a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171102AC100>]}
[0m14:41:48.828052 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:41:48.830056 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:41:48.842350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c9eb706-6383-4342-a1da-d1484dd89a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017110058430>]}
[0m14:41:48.842350 [info ] [MainThread]: Found 18 models, 4 data tests, 10 sources, 477 macros
[0m14:41:48.853526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9eb706-6383-4342-a1da-d1484dd89a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017110058100>]}
[0m14:41:48.853526 [info ] [MainThread]: 
[0m14:41:48.853526 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:41:48.857278 [info ] [MainThread]: 
[0m14:41:48.857278 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:41:48.857278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m14:41:48.900841 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m14:41:48.900841 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m14:41:48.900841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:50.530615 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.632 seconds
[0m14:41:50.546487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m14:41:50.562411 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m14:41:50.562411 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m14:41:50.562411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:41:52.244216 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 1.692 seconds
[0m14:41:52.260009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c9eb706-6383-4342-a1da-d1484dd89a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171102C15A0>]}
[0m14:41:52.279565 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m14:41:52.279565 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_sessions .................................. [RUN]
[0m14:41:52.279565 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_sessions'
[0m14:41:52.279565 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m14:41:52.296989 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m14:41:52.299004 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m14:41:52.308038 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m14:41:52.323860 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_sessions"
[0m14:41:52.323860 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: create or replace   view F1.PONI.stg_sessions
  
  
  
  
  as (
    

with raw as(
    select * from F1.PONI.sessions
),
    raw1 as (select *
             from F1.PONI.meetings
             )
SELECT
  CAST(s.session_key AS INT)             AS session_key,
  CAST(s.meeting_key AS INT)             AS meeting_key,
  s.session_name                         AS session_name,
  s.session_type                         AS session_type,
  m.circuit_short_name,
  m.country_name,
  TO_TIMESTAMP_NTZ(s.date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(s.date_end)           AS date_end,
  s.location                             AS location
FROM raw s left join raw1 m on s.meeting_key=m.meeting_key
WHERE session_key IS NOT NULL and session_type in('Race', 'Qualifying')
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */;
[0m14:41:52.323860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:41:54.063577 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.744 seconds
[0m14:41:54.079617 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2c9eb706-6383-4342-a1da-d1484dd89a55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001711089EFB0>]}
[0m14:41:54.079617 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_sessions ............................. [[32mSUCCESS 1[0m in 1.80s]
[0m14:41:54.079617 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m14:41:54.095929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:41:54.095929 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m14:41:54.095929 [debug] [MainThread]: On list_F1: Close
[0m14:41:54.639174 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m14:41:54.655139 [debug] [MainThread]: On list_F1_PONI: Close
[0m14:41:55.268445 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was left open.
[0m14:41:55.268445 [debug] [MainThread]: On model.f1_analytics.stg_sessions: Close
[0m14:41:55.877602 [info ] [MainThread]: 
[0m14:41:55.877602 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.02 seconds (7.02s).
[0m14:41:55.887181 [debug] [MainThread]: Command end result
[0m14:41:55.902963 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:41:55.902963 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:41:55.918753 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m14:41:55.918753 [info ] [MainThread]: 
[0m14:41:55.918753 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:41:55.918753 [info ] [MainThread]: 
[0m14:41:55.918753 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:41:55.918753 [debug] [MainThread]: Command `dbt run` succeeded at 14:41:55.918753 after 8.62 seconds
[0m14:41:55.918753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171760DA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001710FBB8BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000171103398D0>]}
[0m14:41:55.918753 [debug] [MainThread]: Flushing usage events
[0m14:41:57.005697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:49.784996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A789ECA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78BF24F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78BF24D60>]}


============================== 14:44:49.784996 | 724c3575-6b56-48a8-89fc-b393fd8e2784 ==============================
[0m14:44:49.784996 [info ] [MainThread]: Running with dbt=1.10.6
[0m14:44:49.784996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_tyre_stint.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:44:50.512268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '724c3575-6b56-48a8-89fc-b393fd8e2784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78BEF5120>]}
[0m14:44:50.563181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '724c3575-6b56-48a8-89fc-b393fd8e2784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78BF274F0>]}
[0m14:44:50.565168 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m14:44:50.767624 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m14:44:50.998402 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:44:50.998402 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_tyre_stint.sql
[0m14:44:51.235133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '724c3575-6b56-48a8-89fc-b393fd8e2784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A5074130>]}
[0m14:44:51.314740 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:44:51.314740 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:44:51.330793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '724c3575-6b56-48a8-89fc-b393fd8e2784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A50852D0>]}
[0m14:44:51.346607 [info ] [MainThread]: Found 19 models, 4 data tests, 10 sources, 477 macros
[0m14:44:51.346607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '724c3575-6b56-48a8-89fc-b393fd8e2784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A5087F70>]}
[0m14:44:51.346607 [info ] [MainThread]: 
[0m14:44:51.346607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:44:51.346607 [info ] [MainThread]: 
[0m14:44:51.346607 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:44:51.346607 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m14:44:51.407627 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m14:44:51.408639 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m14:44:51.409624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:53.085118 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.676 seconds
[0m14:44:53.090858 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m14:44:53.101974 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m14:44:53.102974 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m14:44:53.102974 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:54.743420 [debug] [ThreadPool]: SQL status: SUCCESS 27 in 1.640 seconds
[0m14:44:54.750125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '724c3575-6b56-48a8-89fc-b393fd8e2784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A50765C0>]}
[0m14:44:54.760707 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_tyre_stint
[0m14:44:54.761721 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_tyre_stint ................................ [RUN]
[0m14:44:54.762706 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_tyre_stint'
[0m14:44:54.762706 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_tyre_stint
[0m14:44:54.770514 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint"
[0m14:44:54.772090 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_tyre_stint
[0m14:44:54.793754 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint"
[0m14:44:54.795757 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_tyre_stint"
[0m14:44:54.795757 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint: create or replace   view F1.PONI.int_tyre_stint
  
  
  
  
  as (
    

WITH stints_base AS (
    SELECT
        s.*,
        d.team_name,
        ses.circuit_short_name,
        ses.country_name,
        ses.session_type
    FROM F1.PONI.stg_stints s
    LEFT JOIN F1.PONI.stg_drivers d ON s.driver_number = d.driver_number
        AND s.session_key = d.session_key
    LEFT JOIN F1.PONI.stg_sessions ses ON s.session_key = ses.session_key
    WHERE ses.session_type = 'Race' -- Focus on race sessions
),

stint_durations AS (
    SELECT
        *,
        lap_end - lap_start + 1 as stint_length
    FROM stints_base
)

SELECT * FROM stint_durations
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */;
[0m14:44:54.796739 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:44:56.859713 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.073 seconds
[0m14:44:56.891501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '724c3575-6b56-48a8-89fc-b393fd8e2784', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7881D4FD0>]}
[0m14:44:56.891501 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_tyre_stint ........................... [[32mSUCCESS 1[0m in 2.13s]
[0m14:44:56.891501 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_tyre_stint
[0m14:44:56.891501 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:56.891501 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m14:44:56.891501 [debug] [MainThread]: On list_F1: Close
[0m14:44:57.485168 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m14:44:57.500958 [debug] [MainThread]: On list_F1_PONI: Close
[0m14:44:58.091187 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint' was left open.
[0m14:44:58.091187 [debug] [MainThread]: On model.f1_analytics.int_tyre_stint: Close
[0m14:44:58.689614 [info ] [MainThread]: 
[0m14:44:58.689614 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.34 seconds (7.34s).
[0m14:44:58.689614 [debug] [MainThread]: Command end result
[0m14:44:58.737778 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m14:44:58.737778 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m14:44:58.753813 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m14:44:58.753813 [info ] [MainThread]: 
[0m14:44:58.753813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:58.753813 [info ] [MainThread]: 
[0m14:44:58.753813 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:44:58.753813 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:58.753813 after 9.05 seconds
[0m14:44:58.753813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A789ECA320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A7A496CBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A78AF924A0>]}
[0m14:44:58.753813 [debug] [MainThread]: Flushing usage events
[0m14:44:59.871686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:46.153199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294843962F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029485424F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029485424D30>]}


============================== 21:35:46.154231 | a47f93e1-0432-4ef5-9f87-c83321a67dae ==============================
[0m21:35:46.154231 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:35:46.154231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_stints.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:54.004350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a47f93e1-0432-4ef5-9f87-c83321a67dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029484454B80>]}
[0m21:35:54.054288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a47f93e1-0432-4ef5-9f87-c83321a67dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002949DD30730>]}
[0m21:35:54.059303 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m21:35:54.875619 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:35:58.117838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:35:58.117838 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:35:58.169582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a47f93e1-0432-4ef5-9f87-c83321a67dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002949E3C29E0>]}
[0m21:35:58.264136 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m21:35:58.313094 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m21:35:58.349510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a47f93e1-0432-4ef5-9f87-c83321a67dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002949E3B02E0>]}
[0m21:35:58.349510 [info ] [MainThread]: Found 19 models, 4 data tests, 10 sources, 477 macros
[0m21:35:58.349510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a47f93e1-0432-4ef5-9f87-c83321a67dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002949E3B3340>]}
[0m21:35:58.349510 [info ] [MainThread]: 
[0m21:35:58.349510 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:58.349510 [info ] [MainThread]: 
[0m21:35:58.349510 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:58.359378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m21:36:03.071725 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m21:36:03.071725 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m21:36:03.071725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:06.369467 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.291 seconds
[0m21:36:06.394775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m21:36:06.404168 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m21:36:06.404168 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m21:36:06.404168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:08.179414 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.775 seconds
[0m21:36:08.179414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a47f93e1-0432-4ef5-9f87-c83321a67dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002949E3C24D0>]}
[0m21:36:08.189249 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_stints
[0m21:36:08.189249 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_stints .................................... [RUN]
[0m21:36:08.189249 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_stints'
[0m21:36:08.189249 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_stints
[0m21:36:08.209240 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_stints"
[0m21:36:08.211842 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_stints
[0m21:36:08.232504 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_stints"
[0m21:36:08.239535 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_stints"
[0m21:36:08.239535 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: create or replace   view F1.PONI.stg_stints
  
  
  
  
  as (
    

    select *
    from F1.PONI.stints
    where compound is not null and lap_start is not null and lap_end is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */;
[0m21:36:08.239535 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:36:10.173532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.932 seconds
[0m21:36:10.189355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a47f93e1-0432-4ef5-9f87-c83321a67dae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002949FC06B90>]}
[0m21:36:10.189355 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_stints ............................... [[32mSUCCESS 1[0m in 2.00s]
[0m21:36:10.189355 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_stints
[0m21:36:10.189355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:36:10.199318 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m21:36:10.199318 [debug] [MainThread]: On list_F1: Close
[0m21:36:10.799497 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m21:36:10.799497 [debug] [MainThread]: On list_F1_PONI: Close
[0m21:36:11.421503 [debug] [MainThread]: Connection 'model.f1_analytics.stg_stints' was left open.
[0m21:36:11.421503 [debug] [MainThread]: On model.f1_analytics.stg_stints: Close
[0m21:36:12.009213 [info ] [MainThread]: 
[0m21:36:12.009213 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 13.65 seconds (13.65s).
[0m21:36:12.009213 [debug] [MainThread]: Command end result
[0m21:36:12.034017 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m21:36:12.039604 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m21:36:12.041752 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m21:36:12.041752 [info ] [MainThread]: 
[0m21:36:12.041752 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:36:12.049402 [info ] [MainThread]: 
[0m21:36:12.049402 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:36:12.051557 [debug] [MainThread]: Command `dbt run` succeeded at 21:36:12.051557 after 26.01 seconds
[0m21:36:12.051557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294843962F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000294853F9FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002948446A7D0>]}
[0m21:36:12.053792 [debug] [MainThread]: Flushing usage events
[0m21:36:13.152445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:42:54.269188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE35226350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE372C4F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE372C4D60>]}


============================== 21:42:54.274710 | 01d97f3f-7cf7-46c1-a04d-10761065e9c8 ==============================
[0m21:42:54.274710 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:42:54.274710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select int_tyre_stint_laps.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:42:55.081527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01d97f3f-7cf7-46c1-a04d-10761065e9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4FD1BC40>]}
[0m21:42:55.139341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01d97f3f-7cf7-46c1-a04d-10761065e9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE372C7550>]}
[0m21:42:55.139341 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m21:42:55.373502 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:42:55.593772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:42:55.593772 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_tyre_stint_laps.sql
[0m21:42:55.829310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d97f3f-7cf7-46c1-a04d-10761065e9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE50410130>]}
[0m21:42:55.919392 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m21:42:55.921463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m21:42:55.941428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d97f3f-7cf7-46c1-a04d-10761065e9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE50412C80>]}
[0m21:42:55.941428 [info ] [MainThread]: Found 20 models, 4 data tests, 10 sources, 477 macros
[0m21:42:55.941428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d97f3f-7cf7-46c1-a04d-10761065e9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE50425F00>]}
[0m21:42:55.949586 [info ] [MainThread]: 
[0m21:42:55.949586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:42:55.949586 [info ] [MainThread]: 
[0m21:42:55.949586 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:42:55.949586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m21:42:56.003196 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m21:42:56.003196 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m21:42:56.003196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:57.819587 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.817 seconds
[0m21:42:57.829654 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m21:42:57.839329 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m21:42:57.840472 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m21:42:57.841482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:42:59.463618 [debug] [ThreadPool]: SQL status: SUCCESS 28 in 1.622 seconds
[0m21:42:59.479903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d97f3f-7cf7-46c1-a04d-10761065e9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE50410880>]}
[0m21:42:59.483961 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_tyre_stint_laps
[0m21:42:59.483961 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_tyre_stint_laps ........................... [RUN]
[0m21:42:59.483961 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_tyre_stint_laps'
[0m21:42:59.483961 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_tyre_stint_laps
[0m21:42:59.491856 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint_laps"
[0m21:42:59.491856 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_tyre_stint_laps
[0m21:42:59.521860 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint_laps"
[0m21:42:59.521860 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_tyre_stint_laps"
[0m21:42:59.521860 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint_laps: create or replace   view F1.PONI.int_tyre_stint_laps
  
  
  
  
  as (
    

SELECT
        s.session_key,
        s.driver_number,
        s.stint_number,
        s.compound,
        s.lap_start,
        s.lap_end,
        s.lap_end - s.lap_start + 1 as stint_length,
        -- Get the start time from the first lap of the stint
        MIN(l.date_start) as stint_start_time,
        -- Get the end time from the last lap of the stint
        MAX(l.date_start) as stint_end_time
    FROM F1.PONI.stg_stints s
    LEFT JOIN F1.PONI.stg_laps l
        ON s.session_key = l.session_key
        AND s.driver_number = l.driver_number
        AND l.lap_number BETWEEN s.lap_start AND s.lap_end
    GROUP BY 1,2,3,4,5,6
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */;
[0m21:42:59.521860 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:43:01.474185 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.950 seconds
[0m21:43:01.491854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01d97f3f-7cf7-46c1-a04d-10761065e9c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE33577160>]}
[0m21:43:01.491854 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_tyre_stint_laps ...................... [[32mSUCCESS 1[0m in 2.01s]
[0m21:43:01.499551 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_tyre_stint_laps
[0m21:43:01.499551 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:43:01.499551 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m21:43:01.499551 [debug] [MainThread]: On list_F1: Close
[0m21:43:02.109613 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m21:43:02.110763 [debug] [MainThread]: On list_F1_PONI: Close
[0m21:43:02.699405 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint_laps' was left open.
[0m21:43:02.702565 [debug] [MainThread]: On model.f1_analytics.int_tyre_stint_laps: Close
[0m21:43:03.269427 [info ] [MainThread]: 
[0m21:43:03.269427 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m21:43:03.272539 [debug] [MainThread]: Command end result
[0m21:43:03.293845 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m21:43:03.299742 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m21:43:03.301793 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m21:43:03.301793 [info ] [MainThread]: 
[0m21:43:03.301793 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:43:03.301793 [info ] [MainThread]: 
[0m21:43:03.309284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:43:03.309284 [debug] [MainThread]: Command `dbt run` succeeded at 21:43:03.309284 after 9.11 seconds
[0m21:43:03.311860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE35226350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4FD1A950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE362F8220>]}
[0m21:43:03.311860 [debug] [MainThread]: Flushing usage events
[0m21:43:04.403741 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:21.521814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002670F4D6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002671157CF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002671157CD90>]}


============================== 21:53:21.521814 | 322c0297-0539-4875-8c4b-914387e18be0 ==============================
[0m21:53:21.521814 [info ] [MainThread]: Running with dbt=1.10.6
[0m21:53:21.521814 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select int_tyre_stint_laps.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:53:22.227442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '322c0297-0539-4875-8c4b-914387e18be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710CE4250>]}
[0m21:53:22.274808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '322c0297-0539-4875-8c4b-914387e18be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026710D0C700>]}
[0m21:53:22.274808 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m21:53:22.463984 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m21:53:22.637596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m21:53:22.637596 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\intermediate\int_tyre_stint_laps.sql
[0m21:53:22.637596 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_weather.sql
[0m21:53:22.865546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '322c0297-0539-4875-8c4b-914387e18be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002672A6C4130>]}
[0m21:53:22.940644 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m21:53:22.942650 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m21:53:22.954461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '322c0297-0539-4875-8c4b-914387e18be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002672A6C72E0>]}
[0m21:53:22.954461 [info ] [MainThread]: Found 20 models, 4 data tests, 10 sources, 477 macros
[0m21:53:22.954461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '322c0297-0539-4875-8c4b-914387e18be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002672A6DBBB0>]}
[0m21:53:22.954461 [info ] [MainThread]: 
[0m21:53:22.954461 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:53:22.954461 [info ] [MainThread]: 
[0m21:53:22.954461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:53:22.970252 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m21:53:23.018354 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m21:53:23.018354 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m21:53:23.018354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:24.845017 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.831 seconds
[0m21:53:24.861101 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m21:53:24.877233 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m21:53:24.877233 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m21:53:24.877233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:53:26.479936 [debug] [ThreadPool]: SQL status: SUCCESS 29 in 1.598 seconds
[0m21:53:26.495884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '322c0297-0539-4875-8c4b-914387e18be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002672A6C6BC0>]}
[0m21:53:26.495884 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_tyre_stint_laps
[0m21:53:26.495884 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_tyre_stint_laps ........................... [RUN]
[0m21:53:26.495884 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_tyre_stint_laps'
[0m21:53:26.495884 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_tyre_stint_laps
[0m21:53:26.511533 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint_laps"
[0m21:53:26.511533 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_tyre_stint_laps
[0m21:53:26.546452 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint_laps"
[0m21:53:26.546452 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_tyre_stint_laps"
[0m21:53:26.546452 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint_laps: create or replace   view F1.PONI.int_tyre_stint_laps
  
  
  
  
  as (
    

with cte as (SELECT s.session_key,
                    s.driver_number,
                    s.stint_number,
                    s.compound,
                    s.lap_start,
                    s.lap_end,
                    s.lap_end - s.lap_start + 1 as stint_length,
                    -- Get the start time from the first lap of the stint
                    MIN(l.date_start)           as stint_start_time,
                    -- Get the end time from the last lap of the stint
                    MAX(l.date_start)           as stint_end_time
             FROM F1.PONI.stg_stints s
                      LEFT JOIN F1.PONI.stg_laps l
                                ON s.session_key = l.session_key
                                    AND s.driver_number = l.driver_number
                                    AND l.lap_number BETWEEN s.lap_start AND s.lap_end
             GROUP BY 1, 2, 3, 4, 5, 6
             )
select * from cte
         where stint_end_time is not null
           and
             stint_start_time is not null
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */;
[0m21:53:26.546452 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:53:28.387697 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.837 seconds
[0m21:53:28.414834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '322c0297-0539-4875-8c4b-914387e18be0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002672BD849A0>]}
[0m21:53:28.414834 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_tyre_stint_laps ...................... [[32mSUCCESS 1[0m in 1.92s]
[0m21:53:28.414834 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_tyre_stint_laps
[0m21:53:28.414834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:53:28.414834 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m21:53:28.414834 [debug] [MainThread]: On list_F1: Close
[0m21:53:29.040441 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m21:53:29.040441 [debug] [MainThread]: On list_F1_PONI: Close
[0m21:53:29.634487 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint_laps' was left open.
[0m21:53:29.634487 [debug] [MainThread]: On model.f1_analytics.int_tyre_stint_laps: Close
[0m21:53:30.234873 [info ] [MainThread]: 
[0m21:53:30.240423 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m21:53:30.244675 [debug] [MainThread]: Command end result
[0m21:53:30.261304 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m21:53:30.261304 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m21:53:30.277936 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m21:53:30.277936 [info ] [MainThread]: 
[0m21:53:30.277936 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:53:30.277936 [info ] [MainThread]: 
[0m21:53:30.281693 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:53:30.281693 [debug] [MainThread]: Command `dbt run` succeeded at 21:53:30.281693 after 8.85 seconds
[0m21:53:30.281693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002670F4D6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267105BE6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267105AAF80>]}
[0m21:53:30.281693 [debug] [MainThread]: Flushing usage events
[0m21:53:31.367249 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:29:24.164709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F73F6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F86D0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F86D0D60>]}


============================== 22:29:24.164709 | 2beb01d0-ff81-4b01-a223-09ea4662becc ==============================
[0m22:29:24.164709 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:29:24.164709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_weather.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:29:24.865939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2beb01d0-ff81-4b01-a223-09ea4662becc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F499DAE0>]}
[0m22:29:24.913108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2beb01d0-ff81-4b01-a223-09ea4662becc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F86D3550>]}
[0m22:29:24.913108 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:29:25.088298 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:29:25.326116 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:29:25.326116 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_weather.sql
[0m22:29:25.531450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2beb01d0-ff81-4b01-a223-09ea4662becc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1918E0130>]}
[0m22:29:25.610165 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m22:29:25.610165 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m22:29:25.642097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2beb01d0-ff81-4b01-a223-09ea4662becc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1918E3160>]}
[0m22:29:25.642097 [info ] [MainThread]: Found 20 models, 4 data tests, 10 sources, 477 macros
[0m22:29:25.642097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2beb01d0-ff81-4b01-a223-09ea4662becc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1918F62C0>]}
[0m22:29:25.642097 [info ] [MainThread]: 
[0m22:29:25.642097 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:29:25.642097 [info ] [MainThread]: 
[0m22:29:25.642097 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:29:25.642097 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m22:29:25.697049 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m22:29:25.699054 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m22:29:25.699054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:27.634452 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.945 seconds
[0m22:29:27.644994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m22:29:27.671189 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m22:29:27.671189 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m22:29:27.671189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:29:29.282688 [debug] [ThreadPool]: SQL status: SUCCESS 29 in 1.611 seconds
[0m22:29:29.298463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2beb01d0-ff81-4b01-a223-09ea4662becc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1918E1AE0>]}
[0m22:29:29.306872 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_weather
[0m22:29:29.306872 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_weather ................................... [RUN]
[0m22:29:29.307872 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_weather'
[0m22:29:29.308872 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_weather
[0m22:29:29.318132 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_weather"
[0m22:29:29.321922 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_weather
[0m22:29:29.344646 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_weather"
[0m22:29:29.345631 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_weather"
[0m22:29:29.346655 [debug] [Thread-1 (]: On model.f1_analytics.stg_weather: create or replace   view F1.PONI.stg_weather
  
  
  
  
  as (
    


select *
FROM F1.PONI.weather
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */;
[0m22:29:29.346655 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:29:31.162607 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.817 seconds
[0m22:29:31.181964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2beb01d0-ff81-4b01-a223-09ea4662becc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C192FA0BE0>]}
[0m22:29:31.181964 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_weather .............................. [[32mSUCCESS 1[0m in 1.87s]
[0m22:29:31.181964 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_weather
[0m22:29:31.181964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:29:31.181964 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m22:29:31.181964 [debug] [MainThread]: On list_F1: Close
[0m22:29:31.778748 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m22:29:31.778748 [debug] [MainThread]: On list_F1_PONI: Close
[0m22:29:32.391248 [debug] [MainThread]: Connection 'model.f1_analytics.stg_weather' was left open.
[0m22:29:32.391248 [debug] [MainThread]: On model.f1_analytics.stg_weather: Close
[0m22:29:32.998128 [info ] [MainThread]: 
[0m22:29:32.998128 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.36 seconds (7.36s).
[0m22:29:32.998128 [debug] [MainThread]: Command end result
[0m22:29:33.051354 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m22:29:33.051354 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m22:29:33.051354 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m22:29:33.051354 [info ] [MainThread]: 
[0m22:29:33.051354 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:29:33.051354 [info ] [MainThread]: 
[0m22:29:33.051354 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:29:33.062097 [debug] [MainThread]: Command `dbt run` succeeded at 22:29:33.062097 after 8.97 seconds
[0m22:29:33.062097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F73F6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1910DDD80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F76FAF80>]}
[0m22:29:33.062097 [debug] [MainThread]: Flushing usage events
[0m22:29:34.163238 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:02.459377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002050B916380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002050D9C0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002050D9C0D60>]}


============================== 22:47:02.459377 | ccb62576-975b-43ab-b323-2d83576725ee ==============================
[0m22:47:02.459377 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:47:02.459377 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select int_tyre_stints_weather.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:47:03.176006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ccb62576-975b-43ab-b323-2d83576725ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020509C8DAE0>]}
[0m22:47:03.223869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ccb62576-975b-43ab-b323-2d83576725ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002050D9C3550>]}
[0m22:47:03.223869 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:47:03.398667 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:47:03.653950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:47:03.653950 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\intermediate\int_tyre_stints_weather.sql
[0m22:47:03.876681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ccb62576-975b-43ab-b323-2d83576725ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020526B00130>]}
[0m22:47:03.955463 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m22:47:03.955463 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m22:47:03.971504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ccb62576-975b-43ab-b323-2d83576725ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020526B01300>]}
[0m22:47:03.971504 [info ] [MainThread]: Found 21 models, 4 data tests, 10 sources, 477 macros
[0m22:47:03.971504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccb62576-975b-43ab-b323-2d83576725ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020526B01660>]}
[0m22:47:03.987631 [info ] [MainThread]: 
[0m22:47:03.987631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:03.987631 [info ] [MainThread]: 
[0m22:47:03.987631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:47:03.987631 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m22:47:04.034565 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m22:47:04.034565 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m22:47:04.034565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:05.912446 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.867 seconds
[0m22:47:05.927794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m22:47:05.943785 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m22:47:05.943785 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m22:47:05.943785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:07.632455 [debug] [ThreadPool]: SQL status: SUCCESS 29 in 1.682 seconds
[0m22:47:07.653979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ccb62576-975b-43ab-b323-2d83576725ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000205268D0520>]}
[0m22:47:07.659809 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_tyre_stints_weather
[0m22:47:07.659809 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_tyre_stints_weather ....................... [RUN]
[0m22:47:07.659809 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_tyre_stints_weather'
[0m22:47:07.659809 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_tyre_stints_weather
[0m22:47:07.659809 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stints_weather"
[0m22:47:07.659809 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_tyre_stints_weather
[0m22:47:07.693161 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stints_weather"
[0m22:47:07.693161 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_tyre_stints_weather"
[0m22:47:07.693161 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stints_weather: create or replace   view F1.PONI.int_tyre_stints_weather
  
  
  
  
  as (
    

SELECT
        st.session_key,
        st.driver_number,
        st.stint_number,
        st.compound,
        st.lap_start,
        st.lap_end,
        st.stint_length,
        -- Average weather conditions during the stint
        AVG(w.air_temperature) as avg_air_temp,
        AVG(w.track_temperature) as avg_track_temp,
        AVG(w.humidity) as avg_humidity,
        MAX(w.rainfall) as had_rainfall,  -- If there was any rain during stint
        AVG(w.wind_speed) as avg_wind_speed,
        -- Categorize conditions
        CASE
            WHEN AVG(w.track_temperature) < 25 THEN 'Cold'
            WHEN AVG(w.track_temperature) < 35 THEN 'Medium'
            ELSE 'Hot'
        END as track_temp_category,
        CASE
            WHEN MAX(w.rainfall) > 0 THEN 'Wet'
            WHEN AVG(w.humidity) > 70 THEN 'High Humidity'
            ELSE 'Dry'
        END as weather_condition
    FROM F1.PONI.int_tyre_stint_laps st
    LEFT JOIN F1.PONI.stg_weather w
        ON st.session_key = w.session_key
        AND w.date BETWEEN st.stint_start_time AND st.stint_end_time
    GROUP BY 1,2,3,4,5,6,7
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */;
[0m22:47:07.693161 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:09.609580 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.915 seconds
[0m22:47:09.625806 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ccb62576-975b-43ab-b323-2d83576725ee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020509C63190>]}
[0m22:47:09.641821 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_tyre_stints_weather .................. [[32mSUCCESS 1[0m in 1.97s]
[0m22:47:09.641821 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_tyre_stints_weather
[0m22:47:09.641821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:09.641821 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m22:47:09.641821 [debug] [MainThread]: On list_F1: Close
[0m22:47:10.260973 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m22:47:10.268587 [debug] [MainThread]: On list_F1_PONI: Close
[0m22:47:10.846484 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stints_weather' was left open.
[0m22:47:10.846484 [debug] [MainThread]: On model.f1_analytics.int_tyre_stints_weather: Close
[0m22:47:11.442200 [info ] [MainThread]: 
[0m22:47:11.448876 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m22:47:11.448876 [debug] [MainThread]: Command end result
[0m22:47:11.474443 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m22:47:11.474443 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m22:47:11.474443 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m22:47:11.474443 [info ] [MainThread]: 
[0m22:47:11.474443 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:47:11.474443 [info ] [MainThread]: 
[0m22:47:11.474443 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:47:11.474443 [debug] [MainThread]: Command `dbt run` succeeded at 22:47:11.474443 after 9.09 seconds
[0m22:47:11.474443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002050B916380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020526AC2D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002050D9C3550>]}
[0m22:47:11.487536 [debug] [MainThread]: Flushing usage events
[0m22:47:12.643837 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:03:48.374148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271973F6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027199454F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027199454D60>]}


============================== 23:03:48.374148 | 08a3bdbe-9c92-4034-9f75-1c590458c9bd ==============================
[0m23:03:48.374148 [info ] [MainThread]: Running with dbt=1.10.6
[0m23:03:48.374148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select final_car.sql', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:03:49.122071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08a3bdbe-9c92-4034-9f75-1c590458c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027199425120>]}
[0m23:03:49.175547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08a3bdbe-9c92-4034-9f75-1c590458c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271994574F0>]}
[0m23:03:49.175547 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:03:49.365749 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m23:03:49.549934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:03:49.549934 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\marts\final_car.sql
[0m23:03:49.755549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08a3bdbe-9c92-4034-9f75-1c590458c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B25A0490>]}
[0m23:03:49.835345 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m23:03:49.835345 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m23:03:49.867088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08a3bdbe-9c92-4034-9f75-1c590458c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B2591FF0>]}
[0m23:03:49.867088 [info ] [MainThread]: Found 22 models, 4 data tests, 10 sources, 477 macros
[0m23:03:49.867088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a3bdbe-9c92-4034-9f75-1c590458c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B236C550>]}
[0m23:03:49.867088 [info ] [MainThread]: 
[0m23:03:49.867088 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:03:49.867088 [info ] [MainThread]: 
[0m23:03:49.867088 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:03:49.867088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m23:03:49.915328 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m23:03:49.915328 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m23:03:49.915328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:51.646327 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.734 seconds
[0m23:03:51.662282 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m23:03:51.678371 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m23:03:51.678371 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m23:03:51.678371 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:03:53.380583 [debug] [ThreadPool]: SQL status: SUCCESS 30 in 1.702 seconds
[0m23:03:53.396523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a3bdbe-9c92-4034-9f75-1c590458c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B1D78130>]}
[0m23:03:53.396523 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_car
[0m23:03:53.396523 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_car ..................................... [RUN]
[0m23:03:53.412288 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_car'
[0m23:03:53.412288 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_car
[0m23:03:53.439003 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_car"
[0m23:03:53.441019 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_car
[0m23:03:53.476104 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_car"
[0m23:03:53.476104 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_car"
[0m23:03:53.476104 [debug] [Thread-1 (]: On model.f1_analytics.final_car: create or replace   view F1.PONI.final_car
  
  
  
  
  as (
    

SELECT
   t.timestamp,
   CONCAT(t.name_acronym, ' (', t.team_name, ')') as driver,
   t.driver_number,
   ROUND(t.speed) as speed,
   ROUND(t.throttle) as throttle,
   ROUND(t.brake) as brake,
   ROUND(t.drs) as drs,
   t.rpm,
   t.session_key,  -- Add session_key
   s.meeting_key   -- Add meeting_key
FROM F1.PONI.int_car_base t
LEFT JOIN F1.PONI.stg_sessions s ON t.session_key = s.session_key
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */;
[0m23:03:53.476104 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:03:55.258125 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be47dd-0003-51fb-0009-1a0e0003fec2
[0m23:03:55.258125 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 10 at position 3
invalid identifier 'T.TIMESTAMP'
[0m23:03:55.274277 [debug] [Thread-1 (]: Database Error in model final_car (f1_analytics/models\marts\final_car.sql)
  000904 (42000): SQL compilation error: error line 10 at position 3
  invalid identifier 'T.TIMESTAMP'
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_car.sql
[0m23:03:55.274277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a3bdbe-9c92-4034-9f75-1c590458c9bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B3C65720>]}
[0m23:03:55.274277 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.final_car ............................ [[31mERROR[0m in 1.86s]
[0m23:03:55.274277 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_car
[0m23:03:55.274277 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_car' to be skipped because of status 'error'.  Reason: Database Error in model final_car (f1_analytics/models\marts\final_car.sql)
  000904 (42000): SQL compilation error: error line 10 at position 3
  invalid identifier 'T.TIMESTAMP'
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_car.sql.
[0m23:03:55.290107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:03:55.290107 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m23:03:55.290107 [debug] [MainThread]: On list_F1: Close
[0m23:03:55.899445 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m23:03:55.899445 [debug] [MainThread]: On list_F1_PONI: Close
[0m23:03:56.570732 [debug] [MainThread]: Connection 'model.f1_analytics.final_car' was left open.
[0m23:03:56.570732 [debug] [MainThread]: On model.f1_analytics.final_car: Close
[0m23:03:57.247117 [info ] [MainThread]: 
[0m23:03:57.262308 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.38 seconds (7.38s).
[0m23:03:57.262308 [debug] [MainThread]: Command end result
[0m23:03:57.278196 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m23:03:57.278196 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m23:03:57.294148 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m23:03:57.294148 [info ] [MainThread]: 
[0m23:03:57.294148 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:03:57.294148 [info ] [MainThread]: 
[0m23:03:57.294148 [error] [MainThread]: [31mFailure in model final_car (f1_analytics/models\marts\final_car.sql)[0m
[0m23:03:57.294148 [error] [MainThread]:   Database Error in model final_car (f1_analytics/models\marts\final_car.sql)
  000904 (42000): SQL compilation error: error line 10 at position 3
  invalid identifier 'T.TIMESTAMP'
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_car.sql
[0m23:03:57.294148 [info ] [MainThread]: 
[0m23:03:57.294148 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_car.sql
[0m23:03:57.294148 [info ] [MainThread]: 
[0m23:03:57.294148 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m23:03:57.294148 [debug] [MainThread]: Command `dbt run` failed at 23:03:57.294148 after 9.00 seconds
[0m23:03:57.294148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271973F6320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B1EA0D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271B25A3910>]}
[0m23:03:57.294148 [debug] [MainThread]: Flushing usage events
[0m23:03:58.482291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:45.074345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6209B6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E622A5CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E622A5CD30>]}


============================== 23:04:45.074345 | a5b29889-5b1a-4ded-b26f-0c99e36169b5 ==============================
[0m23:04:45.074345 [info ] [MainThread]: Running with dbt=1.10.6
[0m23:04:45.074345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select final_car.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:45.775383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5b29889-5b1a-4ded-b26f-0c99e36169b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E622A253F0>]}
[0m23:04:45.823423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5b29889-5b1a-4ded-b26f-0c99e36169b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6221A06A0>]}
[0m23:04:45.823423 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m23:04:46.014479 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m23:04:46.208498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:04:46.210504 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_car.sql
[0m23:04:46.438531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5b29889-5b1a-4ded-b26f-0c99e36169b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63BBA0580>]}
[0m23:04:46.515629 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m23:04:46.517375 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m23:04:46.537113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5b29889-5b1a-4ded-b26f-0c99e36169b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63BBA1330>]}
[0m23:04:46.537113 [info ] [MainThread]: Found 22 models, 4 data tests, 10 sources, 477 macros
[0m23:04:46.537113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b29889-5b1a-4ded-b26f-0c99e36169b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63BB67520>]}
[0m23:04:46.537113 [info ] [MainThread]: 
[0m23:04:46.537113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:04:46.537113 [info ] [MainThread]: 
[0m23:04:46.537113 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:04:46.537113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m23:04:46.584666 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m23:04:46.584666 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m23:04:46.584666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:48.317069 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.734 seconds
[0m23:04:48.332887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m23:04:48.348961 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m23:04:48.348961 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m23:04:48.348961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:50.039553 [debug] [ThreadPool]: SQL status: SUCCESS 30 in 1.682 seconds
[0m23:04:50.050659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5b29889-5b1a-4ded-b26f-0c99e36169b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63B37A1D0>]}
[0m23:04:50.064768 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_car
[0m23:04:50.064768 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_car ..................................... [RUN]
[0m23:04:50.064768 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_car'
[0m23:04:50.064768 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_car
[0m23:04:50.080166 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_car"
[0m23:04:50.080166 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_car
[0m23:04:50.095895 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_car"
[0m23:04:50.095895 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_car"
[0m23:04:50.095895 [debug] [Thread-1 (]: On model.f1_analytics.final_car: create or replace   view F1.PONI.final_car
  
  
  
  
  as (
    

SELECT
   t.date,
   CONCAT(t.name_acronym, ' (', t.team_name, ')') as driver,
   t.driver_number,
   ROUND(t.speed) as speed,
   ROUND(t.throttle) as throttle,
   ROUND(t.brake) as brake,
   ROUND(t.drs) as drs,
   t.rpm,
   t.session_key,  -- Add session_key
   s.meeting_key   -- Add meeting_key
FROM F1.PONI.int_car_base t
LEFT JOIN F1.PONI.stg_sessions s ON t.session_key = s.session_key
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */;
[0m23:04:50.095895 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:52.150048 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.044 seconds
[0m23:04:52.182514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5b29889-5b1a-4ded-b26f-0c99e36169b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E61ECF7160>]}
[0m23:04:52.182514 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_car ................................ [[32mSUCCESS 1[0m in 2.10s]
[0m23:04:52.182514 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_car
[0m23:04:52.182514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:52.182514 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m23:04:52.182514 [debug] [MainThread]: On list_F1: Close
[0m23:04:52.776378 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m23:04:52.776378 [debug] [MainThread]: On list_F1_PONI: Close
[0m23:04:53.597274 [debug] [MainThread]: Connection 'model.f1_analytics.final_car' was left open.
[0m23:04:53.597274 [debug] [MainThread]: On model.f1_analytics.final_car: Close
[0m23:04:54.237600 [info ] [MainThread]: 
[0m23:04:54.237600 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.70 seconds (7.70s).
[0m23:04:54.253521 [debug] [MainThread]: Command end result
[0m23:04:54.269688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m23:04:54.269688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m23:04:54.285796 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m23:04:54.285796 [info ] [MainThread]: 
[0m23:04:54.285796 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:04:54.285796 [info ] [MainThread]: 
[0m23:04:54.285796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m23:04:54.285796 [debug] [MainThread]: Command `dbt run` succeeded at 23:04:54.285796 after 9.29 seconds
[0m23:04:54.285796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E6209B6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E63B4A21D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E621A892D0>]}
[0m23:04:54.285796 [debug] [MainThread]: Flushing usage events
[0m23:04:55.391307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:11.045880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026864546320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268655DCF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268655DCD90>]}


============================== 13:21:11.045880 | d1ea8505-ed54-4fb5-aaca-af51c017df2f ==============================
[0m13:21:11.045880 [info ] [MainThread]: Running with dbt=1.10.6
[0m13:21:11.061626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_position.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:11.889687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd1ea8505-ed54-4fb5-aaca-af51c017df2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687DEFB610>]}
[0m13:21:11.937071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd1ea8505-ed54-4fb5-aaca-af51c017df2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000268655DF4F0>]}
[0m13:21:11.937071 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m13:21:12.696560 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m13:21:18.692096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:21:18.692096 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_car.sql
[0m13:21:18.910145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1ea8505-ed54-4fb5-aaca-af51c017df2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687E7284C0>]}
[0m13:21:19.006371 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m13:21:19.006371 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m13:21:19.062802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1ea8505-ed54-4fb5-aaca-af51c017df2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687E6E0A30>]}
[0m13:21:19.062802 [info ] [MainThread]: Found 22 models, 4 data tests, 10 sources, 477 macros
[0m13:21:19.062802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ea8505-ed54-4fb5-aaca-af51c017df2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687E6E34F0>]}
[0m13:21:19.062802 [info ] [MainThread]: 
[0m13:21:19.062802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:21:19.078848 [info ] [MainThread]: 
[0m13:21:19.078848 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:21:19.078848 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m13:21:30.428848 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m13:21:30.430859 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m13:21:30.430859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:32.467333 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.042 seconds
[0m13:21:32.483130 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m13:21:32.499108 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m13:21:32.499108 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m13:21:32.499108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:34.465695 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 1.960 seconds
[0m13:21:34.481716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ea8505-ed54-4fb5-aaca-af51c017df2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687E5FD120>]}
[0m13:21:34.497472 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_position
[0m13:21:34.497472 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_position .................................. [RUN]
[0m13:21:34.497472 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_position'
[0m13:21:34.497472 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_position
[0m13:21:34.513676 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_position"
[0m13:21:34.513676 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_position
[0m13:21:34.538922 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_position"
[0m13:21:34.538922 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_position"
[0m13:21:34.538922 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: create or replace   view F1.PONI.stg_position
  
  
  
  
  as (
    

    select *
    from F1.PONI.position
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */;
[0m13:21:34.538922 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:21:36.515600 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.975 seconds
[0m13:21:36.531523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ea8505-ed54-4fb5-aaca-af51c017df2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687FDE5480>]}
[0m13:21:36.531523 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_position ............................. [[32mSUCCESS 1[0m in 2.03s]
[0m13:21:36.531523 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_position
[0m13:21:36.531523 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:36.531523 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m13:21:36.531523 [debug] [MainThread]: On list_F1: Close
[0m13:21:37.127383 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m13:21:37.127383 [debug] [MainThread]: On list_F1_PONI: Close
[0m13:21:37.736192 [debug] [MainThread]: Connection 'model.f1_analytics.stg_position' was left open.
[0m13:21:37.736192 [debug] [MainThread]: On model.f1_analytics.stg_position: Close
[0m13:21:38.363887 [info ] [MainThread]: 
[0m13:21:38.363887 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 19.29 seconds (19.29s).
[0m13:21:38.363887 [debug] [MainThread]: Command end result
[0m13:21:38.396102 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m13:21:38.396102 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m13:21:38.396102 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m13:21:38.396102 [info ] [MainThread]: 
[0m13:21:38.396102 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:38.396102 [info ] [MainThread]: 
[0m13:21:38.396102 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:21:38.396102 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:38.396102 after 27.48 seconds
[0m13:21:38.396102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026864546320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026864641CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002687FE3E530>]}
[0m13:21:38.396102 [debug] [MainThread]: Flushing usage events
[0m13:21:39.690970 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:03.278779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C98C6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CABA0F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CABA0D90>]}


============================== 13:22:03.284978 | ee9b9b00-9ad5-4b8b-b2b0-43099d702346 ==============================
[0m13:22:03.284978 [info ] [MainThread]: Running with dbt=1.10.6
[0m13:22:03.284978 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select int_final_position.sql', 'send_anonymous_usage_stats': 'True'}
[0m13:22:10.647058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee9b9b00-9ad5-4b8b-b2b0-43099d702346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CA304250>]}
[0m13:22:10.695233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee9b9b00-9ad5-4b8b-b2b0-43099d702346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123CA32C700>]}
[0m13:22:10.695233 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m13:22:11.216253 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m13:22:11.858701 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:11.858701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:11.890677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee9b9b00-9ad5-4b8b-b2b0-43099d702346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123E3B3C130>]}
[0m13:22:11.982507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m13:22:11.984250 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m13:22:12.002700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee9b9b00-9ad5-4b8b-b2b0-43099d702346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123E3B106A0>]}
[0m13:22:12.002700 [info ] [MainThread]: Found 22 models, 4 data tests, 10 sources, 477 macros
[0m13:22:12.002700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee9b9b00-9ad5-4b8b-b2b0-43099d702346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123E3B11F90>]}
[0m13:22:12.002700 [info ] [MainThread]: 
[0m13:22:12.002700 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:12.002700 [info ] [MainThread]: 
[0m13:22:12.002700 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:22:12.002700 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m13:22:12.062632 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m13:22:12.062632 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m13:22:12.062632 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:13.907214 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.852 seconds
[0m13:22:13.937918 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m13:22:13.951649 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m13:22:13.951649 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m13:22:13.951649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:15.834539 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 1.882 seconds
[0m13:22:15.834539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee9b9b00-9ad5-4b8b-b2b0-43099d702346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C6F6BA90>]}
[0m13:22:15.850259 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_position
[0m13:22:15.850259 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_final_position ............................ [RUN]
[0m13:22:15.850259 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_final_position'
[0m13:22:15.850259 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_position
[0m13:22:15.859252 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_position"
[0m13:22:15.859252 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_position
[0m13:22:15.891390 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_position"
[0m13:22:15.891390 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_final_position"
[0m13:22:15.891390 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: create or replace   view F1.PONI.int_final_position
  
  
  
  
  as (
    

WITH latest_positions AS (
    SELECT
        session_key,
        driver_number,
        position,
        date as latest_date
    FROM F1.PONI.stg_position
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number
        ORDER BY date DESC
    ) = 1
)
SELECT * FROM latest_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */;
[0m13:22:15.891390 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:17.875975 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.993 seconds
[0m13:22:17.907959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee9b9b00-9ad5-4b8b-b2b0-43099d702346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C6EA7190>]}
[0m13:22:17.907959 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_final_position ....................... [[32mSUCCESS 1[0m in 2.06s]
[0m13:22:17.907959 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_position
[0m13:22:17.907959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:17.907959 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m13:22:17.907959 [debug] [MainThread]: On list_F1: Close
[0m13:22:18.599825 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m13:22:18.599825 [debug] [MainThread]: On list_F1_PONI: Close
[0m13:22:19.225513 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_position' was left open.
[0m13:22:19.225513 [debug] [MainThread]: On model.f1_analytics.int_final_position: Close
[0m13:22:19.953002 [info ] [MainThread]: 
[0m13:22:19.953002 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.95 seconds (7.95s).
[0m13:22:19.953002 [debug] [MainThread]: Command end result
[0m13:22:19.979250 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m13:22:19.979250 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m13:22:19.979250 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m13:22:19.979250 [info ] [MainThread]: 
[0m13:22:19.979250 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:19.979250 [info ] [MainThread]: 
[0m13:22:19.979250 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:22:19.979250 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:19.979250 after 16.79 seconds
[0m13:22:19.979250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C98C6380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123C9BDA6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123E36075E0>]}
[0m13:22:19.979250 [debug] [MainThread]: Flushing usage events
[0m13:22:21.265353 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:22:33.782726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A245E9A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A246F24F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A246F24D30>]}


============================== 13:22:33.798292 | 79749e41-50e2-4051-8e6b-c4d7d8980cfe ==============================
[0m13:22:33.798292 [info ] [MainThread]: Running with dbt=1.10.6
[0m13:22:33.798292 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select int_lap_position.sql', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:22:34.497121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79749e41-50e2-4051-8e6b-c4d7d8980cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25F850730>]}
[0m13:22:34.544440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79749e41-50e2-4051-8e6b-c4d7d8980cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A246F274F0>]}
[0m13:22:34.546444 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m13:22:34.733391 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m13:22:34.918868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:22:34.918868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:22:34.950730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79749e41-50e2-4051-8e6b-c4d7d8980cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25FECC130>]}
[0m13:22:35.029893 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m13:22:35.029893 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m13:22:35.063642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79749e41-50e2-4051-8e6b-c4d7d8980cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25FEA5690>]}
[0m13:22:35.063642 [info ] [MainThread]: Found 22 models, 4 data tests, 10 sources, 477 macros
[0m13:22:35.063642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79749e41-50e2-4051-8e6b-c4d7d8980cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25FEA6A40>]}
[0m13:22:35.066698 [info ] [MainThread]: 
[0m13:22:35.066698 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:22:35.066698 [info ] [MainThread]: 
[0m13:22:35.066698 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:22:35.066698 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m13:22:35.109173 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m13:22:35.109173 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m13:22:35.109173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:37.013577 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.900 seconds
[0m13:22:37.029359 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m13:22:37.045482 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m13:22:37.045482 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m13:22:37.045482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:22:38.774510 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 1.723 seconds
[0m13:22:38.790363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79749e41-50e2-4051-8e6b-c4d7d8980cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25FEDE200>]}
[0m13:22:38.790363 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_lap_position
[0m13:22:38.790363 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_lap_position .............................. [RUN]
[0m13:22:38.790363 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_lap_position'
[0m13:22:38.790363 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_lap_position
[0m13:22:38.806375 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_lap_position"
[0m13:22:38.822282 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_lap_position
[0m13:22:38.838228 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_lap_position"
[0m13:22:38.838228 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_lap_position"
[0m13:22:38.838228 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: create or replace   view F1.PONI.int_lap_position
  
  
  
  
  as (
    

WITH positions AS (
    SELECT
        p.session_key,
        p.driver_number,
        p.position,
        p.date,
        l.lap_number,
        l.date_start,
        l.date_end,
        ABS(DATEDIFF(second, p.date, l.date_start)) AS start_time_diff,
        ABS(DATEDIFF(second, p.date, l.date_end)) AS end_time_diff
    FROM F1.PONI.stg_position p
    JOIN F1.PONI.stg_laps l
        ON p.session_key = l.session_key
        AND p.driver_number = l.driver_number
    WHERE p.date BETWEEN l.date_start AND l.date_end
)
SELECT *,
    ROW_NUMBER() OVER (PARTITION BY session_key, driver_number, lap_number
                       ORDER BY start_time_diff) AS start_position_rank,
    ROW_NUMBER() OVER (PARTITION BY session_key, driver_number, lap_number
                       ORDER BY end_time_diff) AS end_position_rank
FROM positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */;
[0m13:22:38.838228 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:22:40.820851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.975 seconds
[0m13:22:40.841689 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79749e41-50e2-4051-8e6b-c4d7d8980cfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2439D0F70>]}
[0m13:22:40.841689 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_lap_position ......................... [[32mSUCCESS 1[0m in 2.05s]
[0m13:22:40.841689 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_lap_position
[0m13:22:40.841689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:22:40.841689 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m13:22:40.841689 [debug] [MainThread]: On list_F1: Close
[0m13:22:41.441185 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m13:22:41.441185 [debug] [MainThread]: On list_F1_PONI: Close
[0m13:22:42.045259 [debug] [MainThread]: Connection 'model.f1_analytics.int_lap_position' was left open.
[0m13:22:42.061346 [debug] [MainThread]: On model.f1_analytics.int_lap_position: Close
[0m13:22:42.663085 [info ] [MainThread]: 
[0m13:22:42.677592 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.60 seconds (7.60s).
[0m13:22:42.681158 [debug] [MainThread]: Command end result
[0m13:22:42.711083 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m13:22:42.711083 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m13:22:42.711083 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m13:22:42.711083 [info ] [MainThread]: 
[0m13:22:42.711083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:22:42.711083 [info ] [MainThread]: 
[0m13:22:42.711083 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m13:22:42.726936 [debug] [MainThread]: Command `dbt run` succeeded at 13:22:42.726936 after 9.04 seconds
[0m13:22:42.726936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A245E9A2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A25F833DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A245F6C3D0>]}
[0m13:22:42.726936 [debug] [MainThread]: Flushing usage events
[0m13:22:43.990472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:31.812727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F79CEE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7BFC0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7BFC0D60>]}


============================== 15:28:31.830642 | 3ebe52c4-b637-4d9c-8df3-f895426778ac ==============================
[0m15:28:31.830642 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:28:31.830642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_position.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:28:32.640962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ebe52c4-b637-4d9c-8df3-f895426778ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7BF8D120>]}
[0m15:28:32.688142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ebe52c4-b637-4d9c-8df3-f895426778ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7B7013F0>]}
[0m15:28:32.688142 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:28:33.609530 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:28:40.489471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:28:40.489471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:28:40.537851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ebe52c4-b637-4d9c-8df3-f895426778ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F15040130>]}
[0m15:28:40.617816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m15:28:40.617816 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m15:28:40.649866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ebe52c4-b637-4d9c-8df3-f895426778ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F150189D0>]}
[0m15:28:40.649866 [info ] [MainThread]: Found 22 models, 4 data tests, 10 sources, 477 macros
[0m15:28:40.649866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ebe52c4-b637-4d9c-8df3-f895426778ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F150185B0>]}
[0m15:28:40.649866 [info ] [MainThread]: 
[0m15:28:40.665725 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:28:40.665725 [info ] [MainThread]: 
[0m15:28:40.665725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:28:40.665725 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m15:28:53.486974 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m15:28:53.502847 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m15:28:53.502847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:55.283535 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.790 seconds
[0m15:28:55.316957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m15:28:55.316957 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m15:28:55.316957 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m15:28:55.330604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:28:56.983898 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 1.664 seconds
[0m15:28:56.999689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ebe52c4-b637-4d9c-8df3-f895426778ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F15051FC0>]}
[0m15:28:57.015568 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_position
[0m15:28:57.015568 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_position .................................. [RUN]
[0m15:28:57.028431 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_position'
[0m15:28:57.030659 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_position
[0m15:28:57.039691 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_position"
[0m15:28:57.039691 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_position
[0m15:28:57.047449 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_position"
[0m15:28:57.063287 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_position"
[0m15:28:57.063287 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: create or replace   view F1.PONI.stg_position
  
  
  
  
  as (
    

    select *
    from F1.PONI.position
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */;
[0m15:28:57.063287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:28:58.712977 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.660 seconds
[0m15:28:58.745125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ebe52c4-b637-4d9c-8df3-f895426778ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F166E5300>]}
[0m15:28:58.745125 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_position ............................. [[32mSUCCESS 1[0m in 1.72s]
[0m15:28:58.745125 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_position
[0m15:28:58.745125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:28:58.745125 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m15:28:58.745125 [debug] [MainThread]: On list_F1: Close
[0m15:28:59.355226 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m15:28:59.355226 [debug] [MainThread]: On list_F1_PONI: Close
[0m15:28:59.964797 [debug] [MainThread]: Connection 'model.f1_analytics.stg_position' was left open.
[0m15:28:59.964797 [debug] [MainThread]: On model.f1_analytics.stg_position: Close
[0m15:29:00.547509 [info ] [MainThread]: 
[0m15:29:00.552562 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 19.88 seconds (19.88s).
[0m15:29:00.555794 [debug] [MainThread]: Command end result
[0m15:29:00.577327 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m15:29:00.579333 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m15:29:00.585346 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m15:29:00.585346 [info ] [MainThread]: 
[0m15:29:00.587351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:00.587351 [info ] [MainThread]: 
[0m15:29:00.587351 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:29:00.587351 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:00.587351 after 28.91 seconds
[0m15:29:00.587351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F79CEE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F7BF17340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F166F22C0>]}
[0m15:29:00.587351 [debug] [MainThread]: Flushing usage events
[0m15:29:01.700782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:22.323142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BF0C1E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BF1F30E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BF1F30CA0>]}


============================== 15:29:22.338849 | a7ec151e-b785-4b6c-9794-506ae513b80b ==============================
[0m15:29:22.338849 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:29:22.338849 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select int_final_position.sql', 'send_anonymous_usage_stats': 'True'}
[0m15:29:22.997284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7ec151e-b785-4b6c-9794-506ae513b80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BF1ED0BB0>]}
[0m15:29:23.037079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7ec151e-b785-4b6c-9794-506ae513b80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8A9468F0>]}
[0m15:29:23.037079 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:29:23.228469 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:29:23.404778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:23.404778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:23.452695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7ec151e-b785-4b6c-9794-506ae513b80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8AF40130>]}
[0m15:29:23.532346 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m15:29:23.532346 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m15:29:23.548414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7ec151e-b785-4b6c-9794-506ae513b80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8AF1DBA0>]}
[0m15:29:23.548414 [info ] [MainThread]: Found 22 models, 4 data tests, 10 sources, 477 macros
[0m15:29:23.548414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ec151e-b785-4b6c-9794-506ae513b80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8AF1C820>]}
[0m15:29:23.548414 [info ] [MainThread]: 
[0m15:29:23.548414 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:23.548414 [info ] [MainThread]: 
[0m15:29:23.548414 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:23.564089 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m15:29:23.611812 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m15:29:23.611812 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m15:29:23.611812 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:25.417907 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.803 seconds
[0m15:29:25.439468 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m15:29:25.439468 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m15:29:25.439468 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m15:29:25.439468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:27.028294 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 1.578 seconds
[0m15:29:27.028294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7ec151e-b785-4b6c-9794-506ae513b80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8AF40CA0>]}
[0m15:29:27.044379 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_position
[0m15:29:27.044379 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_final_position ............................ [RUN]
[0m15:29:27.044379 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_final_position'
[0m15:29:27.044379 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_position
[0m15:29:27.060251 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_position"
[0m15:29:27.060251 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_position
[0m15:29:27.076375 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_position"
[0m15:29:27.076375 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_final_position"
[0m15:29:27.076375 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: create or replace   view F1.PONI.int_final_position
  
  
  
  
  as (
    

WITH latest_positions AS (
    SELECT
        session_key,
        driver_number,
        position,
        date as latest_date
    FROM F1.PONI.stg_position
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number
        ORDER BY date DESC
    ) = 1
)
SELECT * FROM latest_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */;
[0m15:29:27.076375 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:28.807544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.737 seconds
[0m15:29:28.839774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7ec151e-b785-4b6c-9794-506ae513b80b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BEE1C4580>]}
[0m15:29:28.839774 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_final_position ....................... [[32mSUCCESS 1[0m in 1.80s]
[0m15:29:28.839774 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_position
[0m15:29:28.839774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:28.839774 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m15:29:28.855426 [debug] [MainThread]: On list_F1: Close
[0m15:29:29.466947 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m15:29:29.466947 [debug] [MainThread]: On list_F1_PONI: Close
[0m15:29:30.042442 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_position' was left open.
[0m15:29:30.042442 [debug] [MainThread]: On model.f1_analytics.int_final_position: Close
[0m15:29:30.638902 [info ] [MainThread]: 
[0m15:29:30.638902 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.09 seconds (7.09s).
[0m15:29:30.651268 [debug] [MainThread]: Command end result
[0m15:29:30.683201 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m15:29:30.683201 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m15:29:30.683201 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m15:29:30.683201 [info ] [MainThread]: 
[0m15:29:30.683201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:30.683201 [info ] [MainThread]: 
[0m15:29:30.683201 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:29:30.683201 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:30.683201 after 8.43 seconds
[0m15:29:30.683201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BF0C1E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BF1ED3D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021B8A932290>]}
[0m15:29:30.683201 [debug] [MainThread]: Flushing usage events
[0m15:29:31.854185 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:29:42.254794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D998E9A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99B140FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99B140DF0>]}


============================== 15:29:42.259783 | 8a5f75de-d92c-436e-aa20-49ab731f87b3 ==============================
[0m15:29:42.259783 [info ] [MainThread]: Running with dbt=1.10.6
[0m15:29:42.259783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int_lap_position.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:29:43.320494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8a5f75de-d92c-436e-aa20-49ab731f87b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99A8D6620>]}
[0m15:29:43.534096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8a5f75de-d92c-436e-aa20-49ab731f87b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D99B1434F0>]}
[0m15:29:43.534096 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m15:29:43.869687 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m15:29:44.080397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:44.081391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:44.129504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a5f75de-d92c-436e-aa20-49ab731f87b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B40E0130>]}
[0m15:29:44.194742 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m15:29:44.211879 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m15:29:44.236198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a5f75de-d92c-436e-aa20-49ab731f87b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B40B96F0>]}
[0m15:29:44.236198 [info ] [MainThread]: Found 22 models, 4 data tests, 10 sources, 477 macros
[0m15:29:44.237214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a5f75de-d92c-436e-aa20-49ab731f87b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B40B9A20>]}
[0m15:29:44.239218 [info ] [MainThread]: 
[0m15:29:44.239552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:44.240554 [info ] [MainThread]: 
[0m15:29:44.240554 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:29:44.242552 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m15:29:44.291727 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m15:29:44.291727 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m15:29:44.292713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:45.947923 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.655 seconds
[0m15:29:45.970659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m15:29:45.972037 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m15:29:45.972037 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m15:29:45.972037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:29:47.643288 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 1.660 seconds
[0m15:29:47.679610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a5f75de-d92c-436e-aa20-49ab731f87b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B40E2EF0>]}
[0m15:29:47.693964 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_lap_position
[0m15:29:47.693964 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_lap_position .............................. [RUN]
[0m15:29:47.698448 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_lap_position'
[0m15:29:47.698448 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_lap_position
[0m15:29:47.710496 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_lap_position"
[0m15:29:47.712507 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_lap_position
[0m15:29:47.734101 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_lap_position"
[0m15:29:47.734101 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_lap_position"
[0m15:29:47.734101 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: create or replace   view F1.PONI.int_lap_position
  
  
  
  
  as (
    

WITH positions AS (
    SELECT
        p.session_key,
        p.driver_number,
        p.position,
        p.date,
        l.lap_number,
        l.date_start,
        l.date_end,
        ABS(DATEDIFF(second, p.date, l.date_start)) AS start_time_diff,
        ABS(DATEDIFF(second, p.date, l.date_end)) AS end_time_diff
    FROM F1.PONI.stg_position p
    JOIN F1.PONI.stg_laps l
        ON p.session_key = l.session_key
        AND p.driver_number = l.driver_number
    WHERE p.date BETWEEN l.date_start AND l.date_end
)
SELECT *,
    ROW_NUMBER() OVER (PARTITION BY session_key, driver_number, lap_number
                       ORDER BY start_time_diff) AS start_position_rank,
    ROW_NUMBER() OVER (PARTITION BY session_key, driver_number, lap_number
                       ORDER BY end_time_diff) AS end_position_rank
FROM positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */;
[0m15:29:47.734101 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:29:49.554342 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.809 seconds
[0m15:29:49.582743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8a5f75de-d92c-436e-aa20-49ab731f87b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9973E3190>]}
[0m15:29:49.582743 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_lap_position ......................... [[32mSUCCESS 1[0m in 1.88s]
[0m15:29:49.582743 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_lap_position
[0m15:29:49.582743 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:29:49.582743 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m15:29:49.582743 [debug] [MainThread]: On list_F1: Close
[0m15:29:50.177417 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m15:29:50.193217 [debug] [MainThread]: On list_F1_PONI: Close
[0m15:29:50.786575 [debug] [MainThread]: Connection 'model.f1_analytics.int_lap_position' was left open.
[0m15:29:50.802788 [debug] [MainThread]: On model.f1_analytics.int_lap_position: Close
[0m15:29:51.429917 [info ] [MainThread]: 
[0m15:29:51.440740 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.19 seconds (7.19s).
[0m15:29:51.444730 [debug] [MainThread]: Command end result
[0m15:29:51.496105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m15:29:51.507918 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m15:29:51.514913 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m15:29:51.514913 [info ] [MainThread]: 
[0m15:29:51.515927 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:29:51.516820 [info ] [MainThread]: 
[0m15:29:51.517871 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:29:51.519916 [debug] [MainThread]: Command `dbt run` succeeded at 15:29:51.518883 after 9.34 seconds
[0m15:29:51.519916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D998E9A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B3A47040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D9B3BB0550>]}
[0m15:29:51.520920 [debug] [MainThread]: Flushing usage events
[0m15:29:52.628223 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:18.451560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014659E4E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001465C120F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001465C120D30>]}


============================== 17:06:18.451560 | 8b82f752-4e15-4257-8ee5-717dc65abaec ==============================
[0m17:06:18.451560 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:06:18.451560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select final_historical_analysis.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:06:19.198145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b82f752-4e15-4257-8ee5-717dc65abaec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001465C0E9120>]}
[0m17:06:19.245464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b82f752-4e15-4257-8ee5-717dc65abaec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001465B15F5B0>]}
[0m17:06:19.247468 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:06:19.435198 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:06:19.624788 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:06:19.624788 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\marts\final_historical_analysis.sql
[0m17:06:19.845821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b82f752-4e15-4257-8ee5-717dc65abaec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014675237E50>]}
[0m17:06:19.908846 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:06:19.924579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:06:19.940272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b82f752-4e15-4257-8ee5-717dc65abaec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014674C38CA0>]}
[0m17:06:19.940272 [info ] [MainThread]: Found 23 models, 4 data tests, 10 sources, 477 macros
[0m17:06:19.940272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b82f752-4e15-4257-8ee5-717dc65abaec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014674C3A860>]}
[0m17:06:19.940272 [info ] [MainThread]: 
[0m17:06:19.940272 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:19.940272 [info ] [MainThread]: 
[0m17:06:19.940272 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:06:19.940272 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m17:06:19.988014 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m17:06:19.988014 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m17:06:19.988014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:21.831020 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.830 seconds
[0m17:06:21.846977 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m17:06:21.863020 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m17:06:21.863020 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m17:06:21.863020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:23.530078 [debug] [ThreadPool]: SQL status: SUCCESS 31 in 1.663 seconds
[0m17:06:23.530078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b82f752-4e15-4257-8ee5-717dc65abaec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146750244F0>]}
[0m17:06:23.545931 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_historical_analysis
[0m17:06:23.545931 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_historical_analysis ..................... [RUN]
[0m17:06:23.545931 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_historical_analysis'
[0m17:06:23.545931 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m17:06:23.545931 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m17:06:23.545931 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m17:06:23.561896 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m17:06:23.578023 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_historical_analysis"
[0m17:06:23.578023 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: create or replace   view F1.PONI.final_historical_analysis
  
  
  
  
  as (
    

WITH first_position_record AS (
    SELECT
        session_key,
        driver_number,
        position as first_position,
        date
    FROM stg_position
    QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, driver_number ORDER BY date) = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        MIN(i.interval) AS min_gap_to_next,
        MAX(i.interval) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM F1.PONI.stg_laps l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN F1.PONI.stg_intervals i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND DATE_TRUNC('SECOND', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN F1.PONI.int_lap_position sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN F1.PONI.int_lap_position ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY 1,2,3,4,5,6,7,8,9,10,15,16
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                LAST_VALUE(start_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                LAST_VALUE(end_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
lap_number,
session_key,
driver_number,
date_start as lap_start_time,
date_end as lap_end_time,
is_pit_out_lap,
duration_sector_1,
duration_sector_2,
duration_sector_3,
first_position as race_start_position,
min_gap_to_leader,
max_gap_to_leader,
min_gap_to_next,
max_gap_to_next,
lap_start_position,
lap_end_position,
FIRST_VALUE(lap_end_position) over (partition by session_key,driver_number order by lap_number desc) as race_finish_position
FROM filled_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */;
[0m17:06:23.578023 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:06:25.803765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.222 seconds
[0m17:06:25.825600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b82f752-4e15-4257-8ee5-717dc65abaec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146583C0280>]}
[0m17:06:25.825600 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_historical_analysis ................ [[32mSUCCESS 1[0m in 2.28s]
[0m17:06:25.825600 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m17:06:25.825600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:25.825600 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m17:06:25.825600 [debug] [MainThread]: On list_F1: Close
[0m17:06:26.417337 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m17:06:26.417337 [debug] [MainThread]: On list_F1_PONI: Close
[0m17:06:27.061359 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was left open.
[0m17:06:27.061359 [debug] [MainThread]: On model.f1_analytics.final_historical_analysis: Close
[0m17:06:27.656960 [info ] [MainThread]: 
[0m17:06:27.673039 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.72 seconds (7.72s).
[0m17:06:27.673039 [debug] [MainThread]: Command end result
[0m17:06:27.705046 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:06:27.705046 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:06:27.705046 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:06:27.705046 [info ] [MainThread]: 
[0m17:06:27.705046 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:27.705046 [info ] [MainThread]: 
[0m17:06:27.705046 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:06:27.705046 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:27.705046 after 9.33 seconds
[0m17:06:27.705046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014659E4E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000146583F58A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001465B18BC70>]}
[0m17:06:27.705046 [debug] [MainThread]: Flushing usage events
[0m17:06:28.794232 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:27.300041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277800FE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277824D0EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277824D0D00>]}


============================== 17:10:27.303815 | 779719d2-8aee-46a5-8440-432ffb4a914c ==============================
[0m17:10:27.303815 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:10:27.303815 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select final_historical_analysis.sql', 'send_anonymous_usage_stats': 'True'}
[0m17:10:28.043417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '779719d2-8aee-46a5-8440-432ffb4a914c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FE5CD7E0>]}
[0m17:10:28.091033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '779719d2-8aee-46a5-8440-432ffb4a914c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277824D3520>]}
[0m17:10:28.091033 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:10:28.292172 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:10:28.540098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:28.541098 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_historical_analysis.sql
[0m17:10:28.764523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '779719d2-8aee-46a5-8440-432ffb4a914c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779B614A60>]}
[0m17:10:28.839866 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:10:28.839866 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:10:28.871469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '779719d2-8aee-46a5-8440-432ffb4a914c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779B614EE0>]}
[0m17:10:28.871469 [info ] [MainThread]: Found 23 models, 4 data tests, 10 sources, 477 macros
[0m17:10:28.871469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '779719d2-8aee-46a5-8440-432ffb4a914c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779B39E2C0>]}
[0m17:10:28.871469 [info ] [MainThread]: 
[0m17:10:28.871469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:10:28.871469 [info ] [MainThread]: 
[0m17:10:28.871469 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:10:28.871469 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m17:10:28.925978 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m17:10:28.925978 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m17:10:28.925978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:30.802013 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.882 seconds
[0m17:10:30.817777 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m17:10:30.841867 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m17:10:30.841867 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m17:10:30.841867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:32.455843 [debug] [ThreadPool]: SQL status: SUCCESS 32 in 1.612 seconds
[0m17:10:32.460856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '779719d2-8aee-46a5-8440-432ffb4a914c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002779B617E50>]}
[0m17:10:32.467662 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_historical_analysis
[0m17:10:32.468661 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_historical_analysis ..................... [RUN]
[0m17:10:32.469663 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_historical_analysis'
[0m17:10:32.469663 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m17:10:32.478681 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m17:10:32.478681 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m17:10:32.502773 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m17:10:32.506868 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_historical_analysis"
[0m17:10:32.507774 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: create or replace   view F1.PONI.final_historical_analysis
  
  
  
  
  as (
    

WITH first_position_record AS (
    SELECT
        session_key,
        driver_number,
        position as first_position,
        date
    FROM stg_position
    QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, driver_number ORDER BY date) = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        MIN(i.interval) AS min_gap_to_next,
        MAX(i.interval) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM F1.PONI.stg_laps l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN F1.PONI.stg_intervals i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND DATE_TRUNC('SECOND', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN F1.PONI.int_lap_position sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN F1.PONI.int_lap_position ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY 1,2,3,4,5,6,7,8,9,10,15,16
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                LAST_VALUE(start_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                LAST_VALUE(end_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
lap_number,
session_key,
driver_number,
date_start as lap_start_time,
date_end as lap_end_time,
is_pit_out_lap,
duration_sector_1,
duration_sector_2,
duration_sector_3,
min_gap_to_leader,
max_gap_to_leader,
min_gap_to_next,
max_gap_to_next,
lap_start_position,
lap_end_position,
first_position as race_start_position,
FIRST_VALUE(lap_end_position) over (partition by session_key,driver_number order by lap_number desc) as race_finish_position
FROM filled_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */;
[0m17:10:32.507774 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:10:34.780226 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.272 seconds
[0m17:10:34.803373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '779719d2-8aee-46a5-8440-432ffb4a914c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277FE5A4070>]}
[0m17:10:34.804373 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_historical_analysis ................ [[32mSUCCESS 1[0m in 2.33s]
[0m17:10:34.805377 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m17:10:34.807374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:34.807374 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m17:10:34.808374 [debug] [MainThread]: On list_F1: Close
[0m17:10:35.430105 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m17:10:35.431124 [debug] [MainThread]: On list_F1_PONI: Close
[0m17:10:36.214136 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was left open.
[0m17:10:36.215897 [debug] [MainThread]: On model.f1_analytics.final_historical_analysis: Close
[0m17:10:36.850445 [info ] [MainThread]: 
[0m17:10:36.866565 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m17:10:36.881875 [debug] [MainThread]: Command end result
[0m17:10:36.958864 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:10:36.963807 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:10:36.964377 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:10:36.964377 [info ] [MainThread]: 
[0m17:10:36.979615 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:36.979615 [info ] [MainThread]: 
[0m17:10:36.979615 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:10:36.979615 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:36.979615 after 9.76 seconds
[0m17:10:36.979615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277800FE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002778140DEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277824D3520>]}
[0m17:10:36.979615 [debug] [MainThread]: Flushing usage events
[0m17:10:38.111349 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:08.037414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBC13E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD440E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD440CA0>]}


============================== 17:13:08.038222 | 55f601d6-23d8-4459-8ff7-907e26f3cc0c ==============================
[0m17:13:08.038222 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:13:08.038222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select final_historical_analysis.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:13:08.917089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55f601d6-23d8-4459-8ff7-907e26f3cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD396FB0>]}
[0m17:13:08.980524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55f601d6-23d8-4459-8ff7-907e26f3cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD1AFD60>]}
[0m17:13:08.982229 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:13:09.185618 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:13:09.421783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:09.421783 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_historical_analysis.sql
[0m17:13:09.651206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55f601d6-23d8-4459-8ff7-907e26f3cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED6580A00>]}
[0m17:13:09.730916 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:13:09.730916 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:13:09.762523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55f601d6-23d8-4459-8ff7-907e26f3cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED631C970>]}
[0m17:13:09.762523 [info ] [MainThread]: Found 23 models, 4 data tests, 10 sources, 477 macros
[0m17:13:09.762523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f601d6-23d8-4459-8ff7-907e26f3cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED631D8A0>]}
[0m17:13:09.769030 [info ] [MainThread]: 
[0m17:13:09.769030 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:13:09.769030 [info ] [MainThread]: 
[0m17:13:09.769030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:13:09.769030 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m17:13:09.810136 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m17:13:09.810136 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m17:13:09.810136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:11.532139 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.721 seconds
[0m17:13:11.550984 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m17:13:11.577168 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m17:13:11.578170 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m17:13:11.578170 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:13.263574 [debug] [ThreadPool]: SQL status: SUCCESS 32 in 1.685 seconds
[0m17:13:13.276066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55f601d6-23d8-4459-8ff7-907e26f3cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CED630D5D0>]}
[0m17:13:13.282250 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_historical_analysis
[0m17:13:13.283249 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_historical_analysis ..................... [RUN]
[0m17:13:13.284264 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_historical_analysis'
[0m17:13:13.285264 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m17:13:13.293410 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m17:13:13.294409 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m17:13:13.316293 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m17:13:13.319287 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_historical_analysis"
[0m17:13:13.320280 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: create or replace   view F1.PONI.final_historical_analysis
  
  
  
  
  as (
    

WITH first_position_record AS (
    SELECT
        session_key,
        driver_number,
        position as first_position,
        date
    FROM stg_position
    QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, driver_number ORDER BY date) = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        MIN(i.interval) AS min_gap_to_next,
        MAX(i.interval) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM F1.PONI.stg_laps l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN F1.PONI.stg_intervals i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND DATE_TRUNC('SECOND', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN F1.PONI.int_lap_position sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN F1.PONI.int_lap_position ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY 1,2,3,4,5,6,7,8,9,10,15,16
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                LAST_VALUE(start_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                LAST_VALUE(end_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
lap_number,
session_key,
driver_number,
date_start as lap_start_time,
date_end as lap_end_time,
is_pit_out_lap,
duration_sector_1,
duration_sector_2,
duration_sector_3,
min_gap_to_leader,
max_gap_to_leader,
min_gap_to_next,
max_gap_to_next,
lap_start_position,
lap_end_position,
first_position as race_start_position,
FROM filled_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */;
[0m17:13:13.321278 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:13:15.426656 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.110 seconds
[0m17:13:15.458662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55f601d6-23d8-4459-8ff7-907e26f3cc0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEB96E41C0>]}
[0m17:13:15.458662 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_historical_analysis ................ [[32mSUCCESS 1[0m in 2.17s]
[0m17:13:15.458662 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m17:13:15.458662 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:15.458662 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m17:13:15.458662 [debug] [MainThread]: On list_F1: Close
[0m17:13:16.067648 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m17:13:16.067648 [debug] [MainThread]: On list_F1_PONI: Close
[0m17:13:16.694458 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was left open.
[0m17:13:16.694458 [debug] [MainThread]: On model.f1_analytics.final_historical_analysis: Close
[0m17:13:17.289332 [info ] [MainThread]: 
[0m17:13:17.289332 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.52 seconds (7.52s).
[0m17:13:17.305488 [debug] [MainThread]: Command end result
[0m17:13:17.353491 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:13:17.353491 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:13:17.353491 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:13:17.369639 [info ] [MainThread]: 
[0m17:13:17.369639 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:13:17.369639 [info ] [MainThread]: 
[0m17:13:17.369639 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:13:17.369639 [debug] [MainThread]: Command `dbt run` succeeded at 17:13:17.369639 after 9.42 seconds
[0m17:13:17.369639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBC13E290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBD397700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBC455390>]}
[0m17:13:17.369639 [debug] [MainThread]: Flushing usage events
[0m17:13:18.485281 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:41:24.751885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAA384E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAA4B60EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAA4B60D00>]}


============================== 17:41:24.753921 | eda7635f-d9f0-45e3-b0c0-6b00933818ae ==============================
[0m17:41:24.753921 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:41:24.753921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select final_session_mapping.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:41:25.445702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eda7635f-d9f0-45e3-b0c0-6b00933818ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAA1625900>]}
[0m17:41:25.494368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eda7635f-d9f0-45e3-b0c0-6b00933818ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAA4B63520>]}
[0m17:41:25.494368 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:41:25.686590 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:41:25.881331 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 0 files changed.
[0m17:41:25.881331 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\marts\final_session_mapping.sql
[0m17:41:25.881331 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\marts\final_race_leaderboard.sql
[0m17:41:26.104167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eda7635f-d9f0-45e3-b0c0-6b00933818ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDCA12D0>]}
[0m17:41:26.184659 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:41:26.184659 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:41:26.200650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eda7635f-d9f0-45e3-b0c0-6b00933818ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDA2C5E0>]}
[0m17:41:26.200650 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m17:41:26.200650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eda7635f-d9f0-45e3-b0c0-6b00933818ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDA2C670>]}
[0m17:41:26.200650 [info ] [MainThread]: 
[0m17:41:26.200650 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:41:26.200650 [info ] [MainThread]: 
[0m17:41:26.200650 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:41:26.216889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m17:41:26.264878 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m17:41:26.264878 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m17:41:26.264878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:27.982039 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.723 seconds
[0m17:41:27.998213 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m17:41:28.014347 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m17:41:28.014347 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m17:41:28.014347 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:29.703972 [debug] [ThreadPool]: SQL status: SUCCESS 32 in 1.683 seconds
[0m17:41:29.712044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eda7635f-d9f0-45e3-b0c0-6b00933818ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABDA2F220>]}
[0m17:41:29.725890 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_mapping
[0m17:41:29.725890 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_session_mapping ......................... [RUN]
[0m17:41:29.725890 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_session_mapping'
[0m17:41:29.725890 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_mapping
[0m17:41:29.725890 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_mapping"
[0m17:41:29.742007 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_mapping
[0m17:41:29.757787 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_mapping"
[0m17:41:29.757787 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_session_mapping"
[0m17:41:29.757787 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: create or replace   view F1.PONI.final_session_mapping
  
  
  
  
  as (
    

SELECT DISTINCT
    concat(YEAR(date_start), ' - ', country_name, ' - ', session_name) as session_display_name,
    session_key
FROM F1.PONI.stg_sessions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */;
[0m17:41:29.757787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:41:31.685012 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.917 seconds
[0m17:41:31.700973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eda7635f-d9f0-45e3-b0c0-6b00933818ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAA15F4070>]}
[0m17:41:31.700973 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_session_mapping .................... [[32mSUCCESS 1[0m in 1.98s]
[0m17:41:31.700973 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_mapping
[0m17:41:31.716699 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:31.716699 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m17:41:31.716699 [debug] [MainThread]: On list_F1: Close
[0m17:41:32.294558 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m17:41:32.294558 [debug] [MainThread]: On list_F1_PONI: Close
[0m17:41:32.915976 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_mapping' was left open.
[0m17:41:32.916990 [debug] [MainThread]: On model.f1_analytics.final_session_mapping: Close
[0m17:41:33.516114 [info ] [MainThread]: 
[0m17:41:33.516114 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.32 seconds (7.32s).
[0m17:41:33.516114 [debug] [MainThread]: Command end result
[0m17:41:33.549351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:41:33.549351 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:41:33.549351 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:41:33.549351 [info ] [MainThread]: 
[0m17:41:33.549351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:41:33.564840 [info ] [MainThread]: 
[0m17:41:33.565740 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:41:33.565740 [debug] [MainThread]: Command `dbt run` succeeded at 17:41:33.565740 after 8.90 seconds
[0m17:41:33.565740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAA384E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EABAF85510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EAA4B63520>]}
[0m17:41:33.565740 [debug] [MainThread]: Flushing usage events
[0m17:41:34.656389 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:43.429775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151AD53E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151AE840F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151AE840D30>]}


============================== 17:42:43.429775 | c5aad727-5a28-45ba-b6b0-0e603ce8b75f ==============================
[0m17:42:43.429775 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:42:43.429775 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select final_race_leaderboard.sql', 'send_anonymous_usage_stats': 'True'}
[0m17:42:44.113363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5aad727-5a28-45ba-b6b0-0e603ce8b75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151AE809120>]}
[0m17:42:44.161158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5aad727-5a28-45ba-b6b0-0e603ce8b75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151AD87F5B0>]}
[0m17:42:44.161158 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:42:44.372201 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:42:44.586456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:42:44.587579 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_race_leaderboard.sql
[0m17:42:44.802305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5aad727-5a28-45ba-b6b0-0e603ce8b75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151C79851E0>]}
[0m17:42:44.882136 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:42:44.882136 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:42:44.897990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5aad727-5a28-45ba-b6b0-0e603ce8b75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151C7755C60>]}
[0m17:42:44.897990 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m17:42:44.897990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5aad727-5a28-45ba-b6b0-0e603ce8b75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151C7984970>]}
[0m17:42:44.897990 [info ] [MainThread]: 
[0m17:42:44.897990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:42:44.897990 [info ] [MainThread]: 
[0m17:42:44.897990 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:42:44.897990 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m17:42:44.946024 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m17:42:44.946024 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m17:42:44.946024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:46.776135 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.823 seconds
[0m17:42:46.792102 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m17:42:46.807841 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m17:42:46.807841 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m17:42:46.807841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:42:48.603660 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 1.803 seconds
[0m17:42:48.619365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5aad727-5a28-45ba-b6b0-0e603ce8b75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151C77551B0>]}
[0m17:42:48.637533 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m17:42:48.641646 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_race_leaderboard ........................ [RUN]
[0m17:42:48.643665 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_race_leaderboard'
[0m17:42:48.643665 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_leaderboard
[0m17:42:48.651514 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_leaderboard"
[0m17:42:48.651514 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_leaderboard
[0m17:42:48.667526 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_leaderboard"
[0m17:42:48.667526 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_race_leaderboard"
[0m17:42:48.667526 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: create or replace   view F1.PONI.final_race_leaderboard
  
  
  
  
  as (
    

WITH final_rankings AS (
   SELECT
       session_key,
       driver_number,
       position,
   FROM int_final_position
)
SELECT
   fr.session_key,
   d.driver_number,
   d.broadcast_name AS driver_name,
   fr.position,
   d.team_name,
   d.team_colour AS team_color,
   CASE
       WHEN fr.position = 1 THEN 0
       ELSE fi.max_gap_to_leader
   END as gap_to_leader,
   fi.max_gap_to_next,
   bl.fastest_lap,
   ps.pit_stop_count,

   CASE
       WHEN fr.position = 1 THEN 25
       WHEN fr.position = 2 THEN 18
       WHEN fr.position = 3 THEN 15
       WHEN fr.position = 4 THEN 12
       WHEN fr.position = 5 THEN 10
       WHEN fr.position = 6 THEN 8
       WHEN fr.position = 7 THEN 6
       WHEN fr.position = 8 THEN 4
       WHEN fr.position = 9 THEN 2
       WHEN fr.position = 10 THEN 1
       ELSE 0
   END AS points
FROM final_rankings fr
JOIN F1.PONI.stg_drivers d
   ON fr.driver_number = d.driver_number
   AND fr.session_key = d.session_key
LEFT JOIN F1.PONI.int_final_intervals fi
   ON fr.session_key = fi.session_key
   AND fr.driver_number = fi.driver_number
LEFT JOIN F1.PONI.int_best_laps bl
   ON fr.session_key = bl.session_key
   AND fr.driver_number = bl.driver_number
LEFT JOIN F1.PONI.int_pit_stop ps
   ON fr.session_key = ps.session_key
   AND fr.driver_number = ps.driver_number
JOIN F1.PONI.final_session_mapping m
   ON fr.session_key = m.session_key
ORDER BY fr.rank
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */;
[0m17:42:48.667526 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:42:51.054235 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be4c3c-0003-521c-0009-1a0e000445fe
[0m17:42:51.054235 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 59 at position 9
invalid identifier 'FR.RANK'
[0m17:42:51.118432 [debug] [Thread-1 (]: Database Error in model final_race_leaderboard (f1_analytics/models\marts\final_race_leaderboard.sql)
  000904 (42000): SQL compilation error: error line 59 at position 9
  invalid identifier 'FR.RANK'
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_leaderboard.sql
[0m17:42:51.134497 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5aad727-5a28-45ba-b6b0-0e603ce8b75f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151C7A29300>]}
[0m17:42:51.134497 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.final_race_leaderboard ............... [[31mERROR[0m in 2.47s]
[0m17:42:51.134497 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m17:42:51.134497 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_race_leaderboard' to be skipped because of status 'error'.  Reason: Database Error in model final_race_leaderboard (f1_analytics/models\marts\final_race_leaderboard.sql)
  000904 (42000): SQL compilation error: error line 59 at position 9
  invalid identifier 'FR.RANK'
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_leaderboard.sql.
[0m17:42:51.144411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:42:51.149256 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m17:42:51.149256 [debug] [MainThread]: On list_F1: Close
[0m17:42:51.743179 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m17:42:51.747230 [debug] [MainThread]: On list_F1_PONI: Close
[0m17:42:52.363505 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_leaderboard' was left open.
[0m17:42:52.363505 [debug] [MainThread]: On model.f1_analytics.final_race_leaderboard: Close
[0m17:42:52.969227 [info ] [MainThread]: 
[0m17:42:52.969227 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.07 seconds (8.07s).
[0m17:42:52.969227 [debug] [MainThread]: Command end result
[0m17:42:52.984954 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:42:53.000736 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:42:53.000736 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:42:53.000736 [info ] [MainThread]: 
[0m17:42:53.000736 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:42:53.000736 [info ] [MainThread]: 
[0m17:42:53.000736 [error] [MainThread]: [31mFailure in model final_race_leaderboard (f1_analytics/models\marts\final_race_leaderboard.sql)[0m
[0m17:42:53.000736 [error] [MainThread]:   Database Error in model final_race_leaderboard (f1_analytics/models\marts\final_race_leaderboard.sql)
  000904 (42000): SQL compilation error: error line 59 at position 9
  invalid identifier 'FR.RANK'
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_leaderboard.sql
[0m17:42:53.000736 [info ] [MainThread]: 
[0m17:42:53.000736 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_race_leaderboard.sql
[0m17:42:53.000736 [info ] [MainThread]: 
[0m17:42:53.000736 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m17:42:53.000736 [debug] [MainThread]: Command `dbt run` failed at 17:42:53.000736 after 9.64 seconds
[0m17:42:53.000736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151AD53E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151AD87F5B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000151AD8A8BE0>]}
[0m17:42:53.000736 [debug] [MainThread]: Flushing usage events
[0m17:42:54.183875 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:36.798679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE6EDE290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE91B0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE91B0CA0>]}


============================== 17:43:36.798679 | 1eb38e07-69a2-4e26-a128-d31559efdead ==============================
[0m17:43:36.798679 [info ] [MainThread]: Running with dbt=1.10.6
[0m17:43:36.798679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select final_race_leaderboard.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:43:37.477036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1eb38e07-69a2-4e26-a128-d31559efdead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE9106FB0>]}
[0m17:43:37.524515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1eb38e07-69a2-4e26-a128-d31559efdead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE8F23D60>]}
[0m17:43:37.524515 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:43:37.731575 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m17:43:37.937456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:37.937456 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_race_leaderboard.sql
[0m17:43:38.160627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1eb38e07-69a2-4e26-a128-d31559efdead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F823B5150>]}
[0m17:43:38.240002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:43:38.240002 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:43:38.271946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1eb38e07-69a2-4e26-a128-d31559efdead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F8239D2D0>]}
[0m17:43:38.271946 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m17:43:38.271946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eb38e07-69a2-4e26-a128-d31559efdead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F8239ECB0>]}
[0m17:43:38.271946 [info ] [MainThread]: 
[0m17:43:38.271946 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:43:38.271946 [info ] [MainThread]: 
[0m17:43:38.271946 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:38.271946 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m17:43:38.319473 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m17:43:38.319473 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m17:43:38.325312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:40.257992 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.932 seconds
[0m17:43:40.280927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m17:43:40.292097 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m17:43:40.293095 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m17:43:40.293095 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:41.965733 [debug] [ThreadPool]: SQL status: SUCCESS 33 in 1.671 seconds
[0m17:43:41.971053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1eb38e07-69a2-4e26-a128-d31559efdead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F823B6B30>]}
[0m17:43:41.986430 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m17:43:41.986430 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_race_leaderboard ........................ [RUN]
[0m17:43:41.986430 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_race_leaderboard'
[0m17:43:41.986430 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_leaderboard
[0m17:43:42.002562 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_leaderboard"
[0m17:43:42.002562 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_leaderboard
[0m17:43:42.018461 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_leaderboard"
[0m17:43:42.018461 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_race_leaderboard"
[0m17:43:42.018461 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: create or replace   view F1.PONI.final_race_leaderboard
  
  
  
  
  as (
    

WITH final_rankings AS (
   SELECT
       session_key,
       driver_number,
       position,
   FROM int_final_position
)
SELECT
   fr.session_key,
   d.driver_number,
   d.broadcast_name AS driver_name,
   fr.position,
   d.team_name,
   d.team_colour AS team_color,
   CASE
       WHEN fr.position = 1 THEN 0
       ELSE fi.max_gap_to_leader
   END as gap_to_leader,
   fi.max_gap_to_next as gap_to_next,
   bl.fastest_lap,
   ps.pit_stop_count,

   CASE
       WHEN fr.position = 1 THEN 25
       WHEN fr.position = 2 THEN 18
       WHEN fr.position = 3 THEN 15
       WHEN fr.position = 4 THEN 12
       WHEN fr.position = 5 THEN 10
       WHEN fr.position = 6 THEN 8
       WHEN fr.position = 7 THEN 6
       WHEN fr.position = 8 THEN 4
       WHEN fr.position = 9 THEN 2
       WHEN fr.position = 10 THEN 1
       ELSE 0
   END AS points
FROM final_rankings fr
JOIN F1.PONI.stg_drivers d
   ON fr.driver_number = d.driver_number
   AND fr.session_key = d.session_key
LEFT JOIN F1.PONI.int_final_intervals fi
   ON fr.session_key = fi.session_key
   AND fr.driver_number = fi.driver_number
LEFT JOIN F1.PONI.int_best_laps bl
   ON fr.session_key = bl.session_key
   AND fr.driver_number = bl.driver_number
LEFT JOIN F1.PONI.int_pit_stop ps
   ON fr.session_key = ps.session_key
   AND fr.driver_number = ps.driver_number
JOIN F1.PONI.final_session_mapping m
   ON fr.session_key = m.session_key
ORDER BY fr.position
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */;
[0m17:43:42.018461 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:43:44.042323 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.013 seconds
[0m17:43:44.050220 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1eb38e07-69a2-4e26-a128-d31559efdead', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F8245B1C0>]}
[0m17:43:44.050220 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_race_leaderboard ................... [[32mSUCCESS 1[0m in 2.06s]
[0m17:43:44.050220 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m17:43:44.050220 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:44.050220 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m17:43:44.066017 [debug] [MainThread]: On list_F1: Close
[0m17:43:44.707526 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m17:43:44.707526 [debug] [MainThread]: On list_F1_PONI: Close
[0m17:43:45.300349 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_leaderboard' was left open.
[0m17:43:45.300349 [debug] [MainThread]: On model.f1_analytics.final_race_leaderboard: Close
[0m17:43:45.877936 [info ] [MainThread]: 
[0m17:43:45.877936 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.61 seconds (7.61s).
[0m17:43:45.877936 [debug] [MainThread]: Command end result
[0m17:43:45.909912 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m17:43:45.909912 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m17:43:45.920869 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m17:43:45.920869 [info ] [MainThread]: 
[0m17:43:45.920869 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:45.920869 [info ] [MainThread]: 
[0m17:43:45.920869 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:43:45.920869 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:45.920869 after 9.19 seconds
[0m17:43:45.920869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE6EDE290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE9106FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022FE8F23D60>]}
[0m17:43:45.920869 [debug] [MainThread]: Flushing usage events
[0m17:43:47.063484 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:47:38.822122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E955CDE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E956F70F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E956F70D60>]}


============================== 22:47:38.828325 | fe91294a-3b17-4c82-83d2-b466a9074314 ==============================
[0m22:47:38.828325 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:47:38.828325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_car_data.sql', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:47:44.360322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe91294a-3b17-4c82-83d2-b466a9074314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E95324DA20>]}
[0m22:47:44.418514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe91294a-3b17-4c82-83d2-b466a9074314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E956706C50>]}
[0m22:47:44.420030 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:47:45.224281 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:47:51.284974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:47:51.284974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:47:51.330203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe91294a-3b17-4c82-83d2-b466a9074314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96FF1CB20>]}
[0m22:47:51.420386 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m22:47:51.420386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m22:47:51.475044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe91294a-3b17-4c82-83d2-b466a9074314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96FF1EE60>]}
[0m22:47:51.475044 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m22:47:51.475044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe91294a-3b17-4c82-83d2-b466a9074314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96FEC35B0>]}
[0m22:47:51.480169 [info ] [MainThread]: 
[0m22:47:51.480169 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:51.481212 [info ] [MainThread]: 
[0m22:47:51.481212 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:47:51.483219 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m22:48:00.961029 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m22:48:00.961029 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m22:48:00.961029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:02.880146 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.929 seconds
[0m22:48:02.895969 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m22:48:02.911835 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m22:48:02.911835 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m22:48:02.911835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:48:04.640120 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.717 seconds
[0m22:48:04.651968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe91294a-3b17-4c82-83d2-b466a9074314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96FF1DF30>]}
[0m22:48:04.667811 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_car_data
[0m22:48:04.667811 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_car_data .................................. [RUN]
[0m22:48:04.683491 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_car_data'
[0m22:48:04.683491 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_car_data
[0m22:48:04.683491 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_car_data"
[0m22:48:04.683491 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_car_data
[0m22:48:04.723830 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_car_data"
[0m22:48:04.736441 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_car_data"
[0m22:48:04.736441 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: create or replace   view F1.PONI.stg_car_data
  
  
  
  
  as (
    

SELECT
    session_key,
    driver_number,
    date,
    rpm,
    speed,
    throttle,
    brake,
    drs
FROM F1.PONI.car_data
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */;
[0m22:48:04.736441 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:48:06.982363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.241 seconds
[0m22:48:06.996325 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe91294a-3b17-4c82-83d2-b466a9074314', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96FF407F0>]}
[0m22:48:06.996325 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_car_data ............................. [[32mSUCCESS 1[0m in 2.31s]
[0m22:48:06.996325 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_car_data
[0m22:48:07.012205 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:48:07.012205 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m22:48:07.012205 [debug] [MainThread]: On list_F1: Close
[0m22:48:07.602166 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m22:48:07.602166 [debug] [MainThread]: On list_F1_PONI: Close
[0m22:48:08.224451 [debug] [MainThread]: Connection 'model.f1_analytics.stg_car_data' was left open.
[0m22:48:08.227843 [debug] [MainThread]: On model.f1_analytics.stg_car_data: Close
[0m22:48:08.837157 [info ] [MainThread]: 
[0m22:48:08.837157 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 17.36 seconds (17.36s).
[0m22:48:08.848125 [debug] [MainThread]: Command end result
[0m22:48:08.881832 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m22:48:08.883838 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m22:48:08.889855 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m22:48:08.889855 [info ] [MainThread]: 
[0m22:48:08.889855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:48:08.893446 [info ] [MainThread]: 
[0m22:48:08.893446 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:48:08.893446 [debug] [MainThread]: Command `dbt run` succeeded at 22:48:08.893446 after 30.25 seconds
[0m22:48:08.893446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E955CDE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E956706C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E96FE32530>]}
[0m22:48:08.893446 [debug] [MainThread]: Flushing usage events
[0m22:48:10.044071 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:03.299457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1728C6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A174B70F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A174B70D90>]}


============================== 22:49:03.299457 | 988835c3-2513-4043-91fc-ae4f5d7debdf ==============================
[0m22:49:03.299457 [info ] [MainThread]: Running with dbt=1.10.6
[0m22:49:03.299457 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select int_car_base.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:49:04.057751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '988835c3-2513-4043-91fc-ae4f5d7debdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10D4ADD80>]}
[0m22:49:04.093056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '988835c3-2513-4043-91fc-ae4f5d7debdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A174B73520>]}
[0m22:49:04.108838 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m22:49:04.283223 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m22:49:04.473283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:49:04.473283 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:49:04.522744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '988835c3-2513-4043-91fc-ae4f5d7debdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10DB18B50>]}
[0m22:49:04.600686 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m22:49:04.600686 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m22:49:04.632326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '988835c3-2513-4043-91fc-ae4f5d7debdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10DB3B100>]}
[0m22:49:04.632326 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m22:49:04.632326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '988835c3-2513-4043-91fc-ae4f5d7debdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10DB38BB0>]}
[0m22:49:04.632326 [info ] [MainThread]: 
[0m22:49:04.632326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:49:04.632326 [info ] [MainThread]: 
[0m22:49:04.632326 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:49:04.632326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m22:49:04.679930 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m22:49:04.679930 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m22:49:04.679930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:06.563201 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.871 seconds
[0m22:49:06.563201 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m22:49:06.579321 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m22:49:06.579321 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m22:49:06.579321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:49:08.309865 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.715 seconds
[0m22:49:08.319557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '988835c3-2513-4043-91fc-ae4f5d7debdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10DAC2680>]}
[0m22:49:08.322605 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_car_base
[0m22:49:08.322605 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_car_base .................................. [RUN]
[0m22:49:08.322605 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_car_base'
[0m22:49:08.322605 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_car_base
[0m22:49:08.335448 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_car_base"
[0m22:49:08.335448 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_car_base
[0m22:49:08.351402 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_car_base"
[0m22:49:08.351402 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_car_base"
[0m22:49:08.351402 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: create or replace   view F1.PONI.int_car_base
  
  
  
  
  as (
    

SELECT
   ts.driver_number,
   ts.session_key,
   d.name_acronym,
   d.team_name,
   d.team_colour,
   ts.date,
   ts.rpm,
   ts.speed,
   ts.throttle,
   ts.brake,
   ts.drs
FROM F1.PONI.stg_car_data ts
LEFT JOIN F1.PONI.stg_drivers d
   ON ts.driver_number = d.driver_number
   AND ts.session_key = d.session_key
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */;
[0m22:49:08.351402 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:49:10.271117 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.913 seconds
[0m22:49:10.287217 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '988835c3-2513-4043-91fc-ae4f5d7debdf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10DB3D720>]}
[0m22:49:10.287217 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_car_base ............................. [[32mSUCCESS 1[0m in 1.96s]
[0m22:49:10.287217 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_car_base
[0m22:49:10.287217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:49:10.287217 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m22:49:10.287217 [debug] [MainThread]: On list_F1: Close
[0m22:49:10.916715 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m22:49:10.918731 [debug] [MainThread]: On list_F1_PONI: Close
[0m22:49:11.518326 [debug] [MainThread]: Connection 'model.f1_analytics.int_car_base' was left open.
[0m22:49:11.518326 [debug] [MainThread]: On model.f1_analytics.int_car_base: Close
[0m22:49:12.083530 [info ] [MainThread]: 
[0m22:49:12.083530 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m22:49:12.083530 [debug] [MainThread]: Command end result
[0m22:49:12.107781 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m22:49:12.125757 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m22:49:12.131777 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m22:49:12.131777 [info ] [MainThread]: 
[0m22:49:12.131777 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:49:12.131777 [info ] [MainThread]: 
[0m22:49:12.131777 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m22:49:12.131777 [debug] [MainThread]: Command `dbt run` succeeded at 22:49:12.131777 after 8.93 seconds
[0m22:49:12.131777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A1728C6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A10D4AFA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A173BA3C40>]}
[0m22:49:12.131777 [debug] [MainThread]: Flushing usage events
[0m22:49:13.304697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:45:43.852628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C377E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C4A10F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C4A10D60>]}


============================== 00:45:43.852628 | 1ffbacde-d195-4a8c-98f7-4e823f87a76a ==============================
[0m00:45:43.852628 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:45:43.852628 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_intervals.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:45:44.647413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ffbacde-d195-4a8c-98f7-4e823f87a76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C49DD120>]}
[0m00:45:44.694987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ffbacde-d195-4a8c-98f7-4e823f87a76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C41513F0>]}
[0m00:45:44.694987 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:45:45.172983 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:45:48.668982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:45:48.668982 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m00:45:48.893776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ffbacde-d195-4a8c-98f7-4e823f87a76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3DDB5D180>]}
[0m00:45:48.969226 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:45:48.987216 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:45:49.019220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ffbacde-d195-4a8c-98f7-4e823f87a76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3DDB5FC40>]}
[0m00:45:49.019220 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m00:45:49.019220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ffbacde-d195-4a8c-98f7-4e823f87a76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3DDB5ED70>]}
[0m00:45:49.019220 [info ] [MainThread]: 
[0m00:45:49.019220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:45:49.019220 [info ] [MainThread]: 
[0m00:45:49.019220 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:45:49.019220 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:45:55.326190 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:45:55.326190 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:45:55.326190 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:57.057961 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.729 seconds
[0m00:45:57.073719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:45:57.089657 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:45:57.089657 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:45:57.089657 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:45:58.723517 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.641 seconds
[0m00:45:58.739284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ffbacde-d195-4a8c-98f7-4e823f87a76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3DDB5D060>]}
[0m00:45:58.758239 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m00:45:58.760245 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m00:45:58.760245 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m00:45:58.760245 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m00:45:58.771014 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m00:45:58.771014 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m00:45:58.786808 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m00:45:58.786808 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m00:45:58.786808 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    


        SELECT
    session_key,
    driver_number,
    date,
    NULLIF(gap_to_leader, 'None') as gap_to_leader,
    NULLIF(interval, 'None') as gap_to_next
FROM F1.PONI.intervals
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m00:45:58.786808 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:46:00.578742 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.777 seconds
[0m00:46:00.604611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ffbacde-d195-4a8c-98f7-4e823f87a76a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3DDB89060>]}
[0m00:46:00.604611 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 1.84s]
[0m00:46:00.604611 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m00:46:00.608405 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:00.608405 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:46:00.608405 [debug] [MainThread]: On list_F1: Close
[0m00:46:01.184043 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:46:01.184043 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:46:01.775051 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m00:46:01.790875 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m00:46:02.349790 [info ] [MainThread]: 
[0m00:46:02.362785 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 13.33 seconds (13.33s).
[0m00:46:02.362785 [debug] [MainThread]: Command end result
[0m00:46:02.381740 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:46:02.381740 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:46:02.381740 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:46:02.381740 [info ] [MainThread]: 
[0m00:46:02.397499 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:46:02.397499 [info ] [MainThread]: 
[0m00:46:02.397499 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:46:02.397499 [debug] [MainThread]: Command `dbt run` succeeded at 00:46:02.397499 after 18.66 seconds
[0m00:46:02.397499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C377E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C3A76DD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3C3A4DEA0>]}
[0m00:46:02.397499 [debug] [MainThread]: Flushing usage events
[0m00:46:03.545988 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:46:48.625860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A585156380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A586430FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A586430DF0>]}


============================== 00:46:48.625860 | bca09c6b-3d97-4669-b957-1bfa47492fb2 ==============================
[0m00:46:48.625860 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:46:48.625860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select int_final_intervals.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:46:49.322344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bca09c6b-3d97-4669-b957-1bfa47492fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A585BC6620>]}
[0m00:46:49.369761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bca09c6b-3d97-4669-b957-1bfa47492fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A5864334F0>]}
[0m00:46:49.385465 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:46:49.602843 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:46:49.835971 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:46:49.837976 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:46:49.879306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bca09c6b-3d97-4669-b957-1bfa47492fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59F3D8B80>]}
[0m00:46:49.952454 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:46:49.952454 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:46:49.983965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bca09c6b-3d97-4669-b957-1bfa47492fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59F3D8460>]}
[0m00:46:49.983965 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m00:46:49.983965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca09c6b-3d97-4669-b957-1bfa47492fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59F380910>]}
[0m00:46:49.983965 [info ] [MainThread]: 
[0m00:46:49.983965 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:46:49.983965 [info ] [MainThread]: 
[0m00:46:49.983965 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:46:49.983965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:46:50.032046 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:46:50.032046 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:46:50.032046 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:51.715385 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.684 seconds
[0m00:46:51.730701 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:46:51.746405 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:46:51.746405 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:46:51.746405 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:46:53.374924 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.641 seconds
[0m00:46:53.390992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bca09c6b-3d97-4669-b957-1bfa47492fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59F3DA050>]}
[0m00:46:53.406588 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_intervals
[0m00:46:53.406588 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_final_intervals ........................... [RUN]
[0m00:46:53.406588 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_final_intervals'
[0m00:46:53.406588 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_intervals
[0m00:46:53.416961 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_intervals"
[0m00:46:53.416961 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_intervals
[0m00:46:53.438587 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_intervals"
[0m00:46:53.438587 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_final_intervals"
[0m00:46:53.438587 [debug] [Thread-1 (]: On model.f1_analytics.int_final_intervals: create or replace   view F1.PONI.int_final_intervals
  
  
  
  
  as (
    

    select
        driver_number,
        session_key,
        max(cast(gap_to_leader as float)) as max_gap_to_leader,
        max(cast(interval as float)) as max_gap_to_next,
        from F1.PONI.stg_intervals
        group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */;
[0m00:46:53.438587 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:46:55.225615 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be5384-0003-521c-0009-1a0e00049d1a
[0m00:46:55.225615 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 17
invalid identifier 'INTERVAL'
[0m00:46:55.233513 [debug] [Thread-1 (]: Database Error in model int_final_intervals (f1_analytics/models\intermediate\int_final_intervals.sql)
  000904 (42000): SQL compilation error: error line 13 at position 17
  invalid identifier 'INTERVAL'
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_final_intervals.sql
[0m00:46:55.233513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bca09c6b-3d97-4669-b957-1bfa47492fb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59F400760>]}
[0m00:46:55.233513 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.int_final_intervals .................. [[31mERROR[0m in 1.83s]
[0m00:46:55.233513 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_intervals
[0m00:46:55.233513 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.int_final_intervals' to be skipped because of status 'error'.  Reason: Database Error in model int_final_intervals (f1_analytics/models\intermediate\int_final_intervals.sql)
  000904 (42000): SQL compilation error: error line 13 at position 17
  invalid identifier 'INTERVAL'
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_final_intervals.sql.
[0m00:46:55.233513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:46:55.233513 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:46:55.247532 [debug] [MainThread]: On list_F1: Close
[0m00:46:55.821345 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:46:55.824248 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:46:56.383949 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_intervals' was left open.
[0m00:46:56.383949 [debug] [MainThread]: On model.f1_analytics.int_final_intervals: Close
[0m00:46:56.959003 [info ] [MainThread]: 
[0m00:46:56.959003 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.98 seconds (6.98s).
[0m00:46:56.975065 [debug] [MainThread]: Command end result
[0m00:46:56.990969 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:46:57.007160 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:46:57.007160 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:46:57.007160 [info ] [MainThread]: 
[0m00:46:57.007160 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:46:57.007160 [info ] [MainThread]: 
[0m00:46:57.007160 [error] [MainThread]: [31mFailure in model int_final_intervals (f1_analytics/models\intermediate\int_final_intervals.sql)[0m
[0m00:46:57.007160 [error] [MainThread]:   Database Error in model int_final_intervals (f1_analytics/models\intermediate\int_final_intervals.sql)
  000904 (42000): SQL compilation error: error line 13 at position 17
  invalid identifier 'INTERVAL'
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_final_intervals.sql
[0m00:46:57.007160 [info ] [MainThread]: 
[0m00:46:57.007160 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\intermediate\int_final_intervals.sql
[0m00:46:57.007160 [info ] [MainThread]: 
[0m00:46:57.007160 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:46:57.007160 [debug] [MainThread]: Command `dbt run` failed at 00:46:57.007160 after 8.46 seconds
[0m00:46:57.007160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A585156380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59ED37040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A59F2F2470>]}
[0m00:46:57.007160 [debug] [MainThread]: Flushing usage events
[0m00:46:58.173329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:47:44.106874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A63E6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A8690F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A8690D90>]}


============================== 00:47:44.106874 | c0944cf4-1609-40f6-b2e4-4b2e1f4e834c ==============================
[0m00:47:44.106874 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:47:44.106874 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select int_final_intervals.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:47:44.933717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0944cf4-1609-40f6-b2e4-4b2e1f4e834c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256C0FCDD80>]}
[0m00:47:44.983837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0944cf4-1609-40f6-b2e4-4b2e1f4e834c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A8693520>]}
[0m00:47:44.983837 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:47:45.189180 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:47:45.363759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:47:45.363759 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\intermediate\int_final_intervals.sql
[0m00:47:45.584696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0944cf4-1609-40f6-b2e4-4b2e1f4e834c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256C17DD1E0>]}
[0m00:47:45.654587 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:47:45.654587 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:47:45.686418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0944cf4-1609-40f6-b2e4-4b2e1f4e834c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256C17DF880>]}
[0m00:47:45.686418 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m00:47:45.686418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0944cf4-1609-40f6-b2e4-4b2e1f4e834c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256C17DC6D0>]}
[0m00:47:45.686418 [info ] [MainThread]: 
[0m00:47:45.686418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:47:45.686418 [info ] [MainThread]: 
[0m00:47:45.686418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:47:45.686418 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:47:45.734561 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:47:45.734561 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:47:45.734561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:47.642956 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.909 seconds
[0m00:47:47.672812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:47:47.698160 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:47:47.701453 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:47:47.701453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:47:49.326843 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.634 seconds
[0m00:47:49.342825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0944cf4-1609-40f6-b2e4-4b2e1f4e834c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256C15A5840>]}
[0m00:47:49.342825 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_intervals
[0m00:47:49.342825 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_final_intervals ........................... [RUN]
[0m00:47:49.342825 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_final_intervals'
[0m00:47:49.342825 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_intervals
[0m00:47:49.358791 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_intervals"
[0m00:47:49.358791 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_intervals
[0m00:47:49.397562 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_intervals"
[0m00:47:49.397562 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_final_intervals"
[0m00:47:49.397562 [debug] [Thread-1 (]: On model.f1_analytics.int_final_intervals: create or replace   view F1.PONI.int_final_intervals
  
  
  
  
  as (
    

    select
        driver_number,
        session_key,
        max(cast(gap_to_leader as float)) as max_gap_to_leader,
        max(cast(gap_to_next as float)) as max_gap_to_next,
        from F1.PONI.stg_intervals
        group by 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */;
[0m00:47:49.397562 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:47:51.382709 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.987 seconds
[0m00:47:51.414812 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0944cf4-1609-40f6-b2e4-4b2e1f4e834c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256C187D6F0>]}
[0m00:47:51.414812 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_final_intervals ...................... [[32mSUCCESS 1[0m in 2.07s]
[0m00:47:51.414812 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_intervals
[0m00:47:51.414812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:47:51.414812 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:47:51.414812 [debug] [MainThread]: On list_F1: Close
[0m00:47:52.057247 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:47:52.057247 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:47:52.620414 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_intervals' was left open.
[0m00:47:52.636455 [debug] [MainThread]: On model.f1_analytics.int_final_intervals: Close
[0m00:47:53.243876 [info ] [MainThread]: 
[0m00:47:53.243876 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.56 seconds (7.56s).
[0m00:47:53.243876 [debug] [MainThread]: Command end result
[0m00:47:53.259808 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:47:53.274706 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:47:53.277772 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:47:53.277772 [info ] [MainThread]: 
[0m00:47:53.277772 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:47:53.277772 [info ] [MainThread]: 
[0m00:47:53.277772 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:47:53.277772 [debug] [MainThread]: Command `dbt run` succeeded at 00:47:53.277772 after 9.25 seconds
[0m00:47:53.277772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A63E6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256C0FCFA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256A76C3C40>]}
[0m00:47:53.277772 [debug] [MainThread]: Flushing usage events
[0m00:47:54.397019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:51:36.249876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF8BDC6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF8D0A0F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF8D0A0D90>]}


============================== 00:51:36.249876 | 3d9830e4-0671-411a-a7e8-1ae13cd2c7f5 ==============================
[0m00:51:36.249876 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:51:36.249876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select int_final_intervals.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:51:37.038547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d9830e4-0671-411a-a7e8-1ae13cd2c7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFA59DDD80>]}
[0m00:51:37.087108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d9830e4-0671-411a-a7e8-1ae13cd2c7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF8D0A3520>]}
[0m00:51:37.087108 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:51:37.299040 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:51:37.505463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:51:37.505463 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\intermediate\int_final_intervals.sql
[0m00:51:37.721678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d9830e4-0671-411a-a7e8-1ae13cd2c7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFA61ED1E0>]}
[0m00:51:37.817204 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:51:37.818195 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:51:37.849749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d9830e4-0671-411a-a7e8-1ae13cd2c7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFA61EF880>]}
[0m00:51:37.849749 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m00:51:37.849749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d9830e4-0671-411a-a7e8-1ae13cd2c7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFA61EC6D0>]}
[0m00:51:37.849749 [info ] [MainThread]: 
[0m00:51:37.849749 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:51:37.849749 [info ] [MainThread]: 
[0m00:51:37.849749 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:51:37.849749 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:51:37.914864 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:51:37.915862 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:51:37.916873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:39.646557 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.732 seconds
[0m00:51:39.659003 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:51:39.664896 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:51:39.671829 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:51:39.671829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:51:41.232915 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.560 seconds
[0m00:51:41.247052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d9830e4-0671-411a-a7e8-1ae13cd2c7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFA5FB5840>]}
[0m00:51:41.257213 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_intervals
[0m00:51:41.259807 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_final_intervals ........................... [RUN]
[0m00:51:41.259807 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_final_intervals'
[0m00:51:41.259807 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_intervals
[0m00:51:41.268358 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_intervals"
[0m00:51:41.269663 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_intervals
[0m00:51:41.291978 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_intervals"
[0m00:51:41.294484 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_final_intervals"
[0m00:51:41.294484 [debug] [Thread-1 (]: On model.f1_analytics.int_final_intervals: create or replace   view F1.PONI.int_final_intervals
  
  
  
  
  as (
    SELECT
    session_key,
    driver_number,
    MAX(CASE
        WHEN gap_to_leader LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_leader AS FLOAT)
    END) AS gap_to_leader,
    MAX(CASE
        WHEN gap_to_next LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_next AS FLOAT)
    END) AS gap_to_next
FROM F1.PONI.stg_intervals
GROUP BY session_key, driver_number
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */;
[0m00:51:41.294484 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:51:43.014552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.719 seconds
[0m00:51:43.058068 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d9830e4-0671-411a-a7e8-1ae13cd2c7f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFA628D6F0>]}
[0m00:51:43.059066 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_final_intervals ...................... [[32mSUCCESS 1[0m in 1.80s]
[0m00:51:43.061064 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_intervals
[0m00:51:43.062978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:51:43.063557 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:51:43.064619 [debug] [MainThread]: On list_F1: Close
[0m00:51:43.630786 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:51:43.630786 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:51:44.222138 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_intervals' was left open.
[0m00:51:44.222138 [debug] [MainThread]: On model.f1_analytics.int_final_intervals: Close
[0m00:51:44.821846 [info ] [MainThread]: 
[0m00:51:44.821846 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.97 seconds (6.97s).
[0m00:51:44.838022 [debug] [MainThread]: Command end result
[0m00:51:44.867773 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:51:44.869172 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:51:44.878362 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:51:44.878362 [info ] [MainThread]: 
[0m00:51:44.881586 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:51:44.882587 [info ] [MainThread]: 
[0m00:51:44.882587 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:51:44.882587 [debug] [MainThread]: Command `dbt run` succeeded at 00:51:44.882587 after 8.71 seconds
[0m00:51:44.882587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF8BDC6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BFA59DFA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF8C0D3C40>]}
[0m00:51:44.882587 [debug] [MainThread]: Flushing usage events
[0m00:51:45.976239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:52:47.390722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABC7E1E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABC90B0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABC90B0D60>]}


============================== 00:52:47.390722 | fdada9f5-abe2-4ebb-9631-7294ce1f9195 ==============================
[0m00:52:47.390722 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:52:47.390722 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select int_final_intervals.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:52:48.012935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fdada9f5-abe2-4ebb-9631-7294ce1f9195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABC537DA20>]}
[0m00:52:48.061255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fdada9f5-abe2-4ebb-9631-7294ce1f9195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABC8846C50>]}
[0m00:52:48.061255 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:52:48.252988 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:52:48.472049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:52:48.472049 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\intermediate\int_final_intervals.sql
[0m00:52:48.684102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fdada9f5-abe2-4ebb-9631-7294ce1f9195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE209D4E0>]}
[0m00:52:48.764502 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:52:48.764502 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:52:48.781641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fdada9f5-abe2-4ebb-9631-7294ce1f9195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE21F00A0>]}
[0m00:52:48.781641 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m00:52:48.781641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdada9f5-abe2-4ebb-9631-7294ce1f9195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE21F0670>]}
[0m00:52:48.781641 [info ] [MainThread]: 
[0m00:52:48.781641 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:52:48.781641 [info ] [MainThread]: 
[0m00:52:48.781641 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:52:48.796445 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:52:48.831225 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:52:48.844459 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:52:48.844459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:50.588999 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.747 seconds
[0m00:52:50.588999 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:52:50.604736 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:52:50.604736 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:52:50.604736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:52:52.257442 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.648 seconds
[0m00:52:52.273190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fdada9f5-abe2-4ebb-9631-7294ce1f9195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE1FC26E0>]}
[0m00:52:52.292119 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_intervals
[0m00:52:52.292119 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_final_intervals ........................... [RUN]
[0m00:52:52.292119 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_final_intervals'
[0m00:52:52.292119 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_intervals
[0m00:52:52.309062 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_intervals"
[0m00:52:52.311070 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_intervals
[0m00:52:52.332944 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_intervals"
[0m00:52:52.334950 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_final_intervals"
[0m00:52:52.334950 [debug] [Thread-1 (]: On model.f1_analytics.int_final_intervals: create or replace   view F1.PONI.int_final_intervals
  
  
  
  
  as (
    SELECT
    session_key,
    driver_number,
    MAX(CASE
        WHEN gap_to_leader LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_leader AS FLOAT)
    END) AS max_gap_to_leader,
    MAX(CASE
        WHEN gap_to_next LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_next AS FLOAT)
    END) AS max_gap_to_next
FROM F1.PONI.stg_intervals
GROUP BY session_key, driver_number
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */;
[0m00:52:52.334950 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:52:54.008234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.673 seconds
[0m00:52:54.040199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fdada9f5-abe2-4ebb-9631-7294ce1f9195', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE229D6F0>]}
[0m00:52:54.040199 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_final_intervals ...................... [[32mSUCCESS 1[0m in 1.75s]
[0m00:52:54.040199 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_intervals
[0m00:52:54.040199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:52:54.040199 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:52:54.040199 [debug] [MainThread]: On list_F1: Close
[0m00:52:54.630769 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:52:54.630769 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:52:55.256291 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_intervals' was left open.
[0m00:52:55.256291 [debug] [MainThread]: On model.f1_analytics.int_final_intervals: Close
[0m00:52:55.834208 [info ] [MainThread]: 
[0m00:52:55.834208 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.05 seconds (7.05s).
[0m00:52:55.834208 [debug] [MainThread]: Command end result
[0m00:52:55.866183 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:52:55.866183 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:52:55.866183 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:52:55.866183 [info ] [MainThread]: 
[0m00:52:55.866183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:52:55.866183 [info ] [MainThread]: 
[0m00:52:55.877290 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:52:55.877290 [debug] [MainThread]: Command `dbt run` succeeded at 00:52:55.877290 after 8.56 seconds
[0m00:52:55.877290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABC7E1E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABC8118BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABC8846C50>]}
[0m00:52:55.877290 [debug] [MainThread]: Flushing usage events
[0m00:52:57.040049 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:54:50.037553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F5BE6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F7E8CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F7E8CD30>]}


============================== 00:54:50.041085 | 28eead7e-e316-4a8b-a9e7-49ebf449faa3 ==============================
[0m00:54:50.041085 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:54:50.041085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select final_race_leaderboard.sql', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:54:50.785984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28eead7e-e316-4a8b-a9e7-49ebf449faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F415D990>]}
[0m00:54:50.817861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28eead7e-e316-4a8b-a9e7-49ebf449faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F7E8F550>]}
[0m00:54:50.833606 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:54:51.027694 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:54:51.232281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:54:51.232281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:54:51.264148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28eead7e-e316-4a8b-a9e7-49ebf449faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023990E4CB20>]}
[0m00:54:51.344088 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:54:51.344088 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:54:51.375678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28eead7e-e316-4a8b-a9e7-49ebf449faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023990E4DAE0>]}
[0m00:54:51.375678 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m00:54:51.375678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28eead7e-e316-4a8b-a9e7-49ebf449faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023990DF11B0>]}
[0m00:54:51.375678 [info ] [MainThread]: 
[0m00:54:51.375678 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:54:51.375678 [info ] [MainThread]: 
[0m00:54:51.375678 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:54:51.375678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:54:51.436840 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:54:51.436840 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:54:51.437965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:53.096875 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.660 seconds
[0m00:54:53.112615 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:54:53.128730 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:54:53.128730 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:54:53.128730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:54:54.774629 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.650 seconds
[0m00:54:54.790846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28eead7e-e316-4a8b-a9e7-49ebf449faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023990E4DF60>]}
[0m00:54:54.790846 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m00:54:54.790846 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_race_leaderboard ........................ [RUN]
[0m00:54:54.790846 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_race_leaderboard'
[0m00:54:54.790846 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_leaderboard
[0m00:54:54.790846 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_leaderboard"
[0m00:54:54.790846 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_leaderboard
[0m00:54:54.823145 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_leaderboard"
[0m00:54:54.823145 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_race_leaderboard"
[0m00:54:54.823145 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: create or replace   view F1.PONI.final_race_leaderboard
  
  
  
  
  as (
    

WITH final_rankings AS (
   SELECT
       session_key,
       driver_number,
       position,
   FROM int_final_position
)
SELECT
   fr.session_key,
   d.driver_number,
   d.broadcast_name AS driver_name,
   fr.position,
   d.team_name,
   d.team_colour AS team_color,
   CASE
       WHEN fr.position = 1 THEN 0
       ELSE fi.max_gap_to_leader
   END as gap_to_leader,
   fi.max_gap_to_next as gap_to_next,
   bl.fastest_lap,
   ps.pit_stop_count,

   CASE
       WHEN fr.position = 1 THEN 25
       WHEN fr.position = 2 THEN 18
       WHEN fr.position = 3 THEN 15
       WHEN fr.position = 4 THEN 12
       WHEN fr.position = 5 THEN 10
       WHEN fr.position = 6 THEN 8
       WHEN fr.position = 7 THEN 6
       WHEN fr.position = 8 THEN 4
       WHEN fr.position = 9 THEN 2
       WHEN fr.position = 10 THEN 1
       ELSE 0
   END AS points
FROM final_rankings fr
JOIN F1.PONI.stg_drivers d
   ON fr.driver_number = d.driver_number
   AND fr.session_key = d.session_key
LEFT JOIN F1.PONI.int_final_intervals fi
   ON fr.session_key = fi.session_key
   AND fr.driver_number = fi.driver_number
LEFT JOIN F1.PONI.int_best_laps bl
   ON fr.session_key = bl.session_key
   AND fr.driver_number = bl.driver_number
LEFT JOIN F1.PONI.int_pit_stop ps
   ON fr.session_key = ps.session_key
   AND fr.driver_number = ps.driver_number
JOIN F1.PONI.final_session_mapping m
   ON fr.session_key = m.session_key
ORDER BY fr.position
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */;
[0m00:54:54.823145 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:54:56.818113 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.992 seconds
[0m00:54:56.849921 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '28eead7e-e316-4a8b-a9e7-49ebf449faa3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023990E75930>]}
[0m00:54:56.849921 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_race_leaderboard ................... [[32mSUCCESS 1[0m in 2.06s]
[0m00:54:56.849921 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m00:54:56.849921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:54:56.849921 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:54:56.849921 [debug] [MainThread]: On list_F1: Close
[0m00:54:57.413422 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:54:57.413422 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:54:58.034550 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_leaderboard' was left open.
[0m00:54:58.036229 [debug] [MainThread]: On model.f1_analytics.final_race_leaderboard: Close
[0m00:54:58.589292 [info ] [MainThread]: 
[0m00:54:58.589292 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.21 seconds (7.21s).
[0m00:54:58.605405 [debug] [MainThread]: Command end result
[0m00:54:58.638613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:54:58.638613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:54:58.638613 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:54:58.652457 [info ] [MainThread]: 
[0m00:54:58.652457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:54:58.652457 [info ] [MainThread]: 
[0m00:54:58.652457 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:54:58.652457 [debug] [MainThread]: Command `dbt run` succeeded at 00:54:58.652457 after 8.69 seconds
[0m00:54:58.652457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F5BE6350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239F7E8F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023990D628F0>]}
[0m00:54:58.652457 [debug] [MainThread]: Flushing usage events
[0m00:54:59.739668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:14:16.649397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E90DE2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EA370EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EA370CD0>]}


============================== 01:14:16.649397 | 403b1287-db11-4c77-ac83-e9e0edd70c7e ==============================
[0m01:14:16.649397 [info ] [MainThread]: Running with dbt=1.10.6
[0m01:14:16.649397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select final_historical_analysis.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:14:17.442540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '403b1287-db11-4c77-ac83-e9e0edd70c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EA2CA4D0>]}
[0m01:14:17.492107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '403b1287-db11-4c77-ac83-e9e0edd70c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EA373520>]}
[0m01:14:17.493222 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m01:14:17.692282 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m01:14:17.883927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:14:17.883927 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:14:17.930100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '403b1287-db11-4c77-ac83-e9e0edd70c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483348A90>]}
[0m01:14:18.026403 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:14:18.028748 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:14:18.053878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '403b1287-db11-4c77-ac83-e9e0edd70c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002448336AEF0>]}
[0m01:14:18.053878 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m01:14:18.054884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '403b1287-db11-4c77-ac83-e9e0edd70c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483369930>]}
[0m01:14:18.056887 [info ] [MainThread]: 
[0m01:14:18.056887 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:14:18.057870 [info ] [MainThread]: 
[0m01:14:18.058767 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:14:18.060365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m01:14:18.107373 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m01:14:18.109403 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m01:14:18.109403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:20.392665 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.295 seconds
[0m01:14:20.406298 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m01:14:20.422173 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m01:14:20.422173 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m01:14:20.422173 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:14:21.962392 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.535 seconds
[0m01:14:21.983349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '403b1287-db11-4c77-ac83-e9e0edd70c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244832F36D0>]}
[0m01:14:21.994918 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_historical_analysis
[0m01:14:21.994918 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_historical_analysis ..................... [RUN]
[0m01:14:21.994918 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_historical_analysis'
[0m01:14:21.994918 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m01:14:22.003987 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m01:14:22.014120 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m01:14:22.034191 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m01:14:22.038208 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_historical_analysis"
[0m01:14:22.038208 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: create or replace   view F1.PONI.final_historical_analysis
  
  
  
  
  as (
    

WITH first_position_record AS (
    SELECT
        session_key,
        driver_number,
        position as first_position,
        date
    FROM stg_position
    QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, driver_number ORDER BY date) = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        MIN(i.interval) AS min_gap_to_next,
        MAX(i.interval) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM F1.PONI.stg_laps l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN F1.PONI.stg_intervals i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND DATE_TRUNC('SECOND', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN F1.PONI.int_lap_position sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN F1.PONI.int_lap_position ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY 1,2,3,4,5,6,7,8,9,10,15,16
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                LAST_VALUE(start_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                LAST_VALUE(end_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
lap_number,
session_key,
driver_number,
date_start as lap_start_time,
date_end as lap_end_time,
is_pit_out_lap,
duration_sector_1,
duration_sector_2,
duration_sector_3,
min_gap_to_leader,
max_gap_to_leader,
min_gap_to_next,
max_gap_to_next,
lap_start_position,
lap_end_position,
first_position as race_start_position,
FROM filled_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */;
[0m01:14:22.038208 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:14:23.735106 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be53a0-0003-57c6-0009-1a0e0004ef1e
[0m01:14:23.735106 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 32 at position 12
invalid identifier 'I.INTERVAL'
[0m01:14:23.735106 [debug] [Thread-1 (]: Database Error in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)
  000904 (42000): SQL compilation error: error line 32 at position 12
  invalid identifier 'I.INTERVAL'
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql
[0m01:14:23.735106 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '403b1287-db11-4c77-ac83-e9e0edd70c7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024484A73C10>]}
[0m01:14:23.735106 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.final_historical_analysis ............ [[31mERROR[0m in 1.74s]
[0m01:14:23.735106 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m01:14:23.735106 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_historical_analysis' to be skipped because of status 'error'.  Reason: Database Error in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)
  000904 (42000): SQL compilation error: error line 32 at position 12
  invalid identifier 'I.INTERVAL'
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql.
[0m01:14:23.747741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:14:23.747741 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m01:14:23.747741 [debug] [MainThread]: On list_F1: Close
[0m01:14:24.344159 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m01:14:24.344159 [debug] [MainThread]: On list_F1_PONI: Close
[0m01:14:24.938252 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was left open.
[0m01:14:24.942318 [debug] [MainThread]: On model.f1_analytics.final_historical_analysis: Close
[0m01:14:25.526285 [info ] [MainThread]: 
[0m01:14:25.532093 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m01:14:25.535653 [debug] [MainThread]: Command end result
[0m01:14:25.563583 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:14:25.567338 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:14:25.573362 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m01:14:25.573362 [info ] [MainThread]: 
[0m01:14:25.573362 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m01:14:25.573362 [info ] [MainThread]: 
[0m01:14:25.573362 [error] [MainThread]: [31mFailure in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)[0m
[0m01:14:25.573362 [error] [MainThread]:   Database Error in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)
  000904 (42000): SQL compilation error: error line 32 at position 12
  invalid identifier 'I.INTERVAL'
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql
[0m01:14:25.573362 [info ] [MainThread]: 
[0m01:14:25.573362 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql
[0m01:14:25.573362 [info ] [MainThread]: 
[0m01:14:25.573362 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m01:14:25.573362 [debug] [MainThread]: Command `dbt run` failed at 01:14:25.573362 after 9.00 seconds
[0m01:14:25.573362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244E90DE2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000244EA2C9F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024483262980>]}
[0m01:14:25.581164 [debug] [MainThread]: Flushing usage events
[0m01:14:26.680474 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:15:00.073484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044C36E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044D600EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044D600D00>]}


============================== 01:15:00.089249 | 6ffa7980-8688-446e-9404-a779ff8fefdd ==============================
[0m01:15:00.089249 [info ] [MainThread]: Running with dbt=1.10.6
[0m01:15:00.089249 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select final_historical_analysis.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m01:15:00.788229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ffa7980-8688-446e-9404-a779ff8fefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204498CD7E0>]}
[0m01:15:00.836124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ffa7980-8688-446e-9404-a779ff8fefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044D603520>]}
[0m01:15:00.836124 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m01:15:01.027842 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m01:15:01.202149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:15:01.202149 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_historical_analysis.sql
[0m01:15:01.424560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ffa7980-8688-446e-9404-a779ff8fefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046674D180>]}
[0m01:15:01.503552 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:15:01.505558 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:15:01.519435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ffa7980-8688-446e-9404-a779ff8fefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046679CCA0>]}
[0m01:15:01.519435 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m01:15:01.519435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ffa7980-8688-446e-9404-a779ff8fefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046679E1A0>]}
[0m01:15:01.519435 [info ] [MainThread]: 
[0m01:15:01.519435 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:15:01.519435 [info ] [MainThread]: 
[0m01:15:01.519435 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:15:01.519435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m01:15:01.567586 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m01:15:01.567586 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m01:15:01.567586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:03.347711 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.781 seconds
[0m01:15:03.363827 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m01:15:03.379801 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m01:15:03.379801 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m01:15:03.379801 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:15:04.938162 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.567 seconds
[0m01:15:04.954367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ffa7980-8688-446e-9404-a779ff8fefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002046674F070>]}
[0m01:15:04.970372 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_historical_analysis
[0m01:15:04.970372 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_historical_analysis ..................... [RUN]
[0m01:15:04.970372 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_historical_analysis'
[0m01:15:04.970372 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m01:15:04.993140 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m01:15:04.993140 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m01:15:05.018034 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m01:15:05.018034 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_historical_analysis"
[0m01:15:05.018034 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: create or replace   view F1.PONI.final_historical_analysis
  
  
  
  
  as (
    

WITH first_position_record AS (
    SELECT
        session_key,
        driver_number,
        position as first_position,
        date
    FROM stg_position
    QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, driver_number ORDER BY date) = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        MIN(i.gap_to_next) AS min_gap_to_next,
        MAX(i.gap_to_next) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM F1.PONI.stg_laps l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN F1.PONI.stg_intervals i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND DATE_TRUNC('SECOND', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN F1.PONI.int_lap_position sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN F1.PONI.int_lap_position ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY 1,2,3,4,5,6,7,8,9,10,15,16
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                LAST_VALUE(start_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                LAST_VALUE(end_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
lap_number,
session_key,
driver_number,
date_start as lap_start_time,
date_end as lap_end_time,
is_pit_out_lap,
duration_sector_1,
duration_sector_2,
duration_sector_3,
min_gap_to_leader,
max_gap_to_leader,
min_gap_to_next,
max_gap_to_next,
lap_start_position,
lap_end_position,
first_position as race_start_position,
FROM filled_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */;
[0m01:15:05.018034 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:15:07.122290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.101 seconds
[0m01:15:07.138111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ffa7980-8688-446e-9404-a779ff8fefdd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204667E93F0>]}
[0m01:15:07.138111 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_historical_analysis ................ [[32mSUCCESS 1[0m in 2.17s]
[0m01:15:07.138111 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m01:15:07.138111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:15:07.138111 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m01:15:07.138111 [debug] [MainThread]: On list_F1: Close
[0m01:15:07.724537 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m01:15:07.724537 [debug] [MainThread]: On list_F1_PONI: Close
[0m01:15:08.330986 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was left open.
[0m01:15:08.330986 [debug] [MainThread]: On model.f1_analytics.final_historical_analysis: Close
[0m01:15:08.905238 [info ] [MainThread]: 
[0m01:15:08.906246 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.39 seconds (7.39s).
[0m01:15:08.907234 [debug] [MainThread]: Command end result
[0m01:15:08.931508 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:15:08.935991 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:15:08.944066 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m01:15:08.944066 [info ] [MainThread]: 
[0m01:15:08.945039 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:15:08.946106 [info ] [MainThread]: 
[0m01:15:08.946106 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:15:08.946106 [debug] [MainThread]: Command `dbt run` succeeded at 01:15:08.946106 after 8.93 seconds
[0m01:15:08.946106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044C36E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044C63DEA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002044D603520>]}
[0m01:15:08.946106 [debug] [MainThread]: Flushing usage events
[0m01:15:10.028138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:19:03.282579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F285956350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F286C2CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F286C2CD30>]}


============================== 01:19:03.295049 | eb9b8099-caa1-4045-8e34-e040de4e8590 ==============================
[0m01:19:03.295049 [info ] [MainThread]: Running with dbt=1.10.6
[0m01:19:03.296055 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select final_historical_analysis.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:19:04.203177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb9b8099-caa1-4045-8e34-e040de4e8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F282EFD990>]}
[0m01:19:04.244937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb9b8099-caa1-4045-8e34-e040de4e8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F286C2F550>]}
[0m01:19:04.244937 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m01:19:04.445172 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m01:19:04.686063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:19:04.686063 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_historical_analysis.sql
[0m01:19:04.922682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb9b8099-caa1-4045-8e34-e040de4e8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29FD7D1E0>]}
[0m01:19:05.004347 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:19:05.006405 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:19:05.028216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb9b8099-caa1-4045-8e34-e040de4e8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29FD7E620>]}
[0m01:19:05.029213 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m01:19:05.030194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb9b8099-caa1-4045-8e34-e040de4e8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29FD7E3B0>]}
[0m01:19:05.032194 [info ] [MainThread]: 
[0m01:19:05.032194 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:19:05.033322 [info ] [MainThread]: 
[0m01:19:05.033322 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:19:05.034541 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m01:19:05.084957 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m01:19:05.085955 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m01:19:05.085955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:06.846724 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.761 seconds
[0m01:19:06.858799 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m01:19:06.880532 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m01:19:06.880532 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m01:19:06.880532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:19:08.560443 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.678 seconds
[0m01:19:08.566038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb9b8099-caa1-4045-8e34-e040de4e8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29FD7FC70>]}
[0m01:19:08.572398 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_historical_analysis
[0m01:19:08.573395 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_historical_analysis ..................... [RUN]
[0m01:19:08.574110 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_historical_analysis'
[0m01:19:08.574110 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m01:19:08.582377 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m01:19:08.585378 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m01:19:08.610656 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m01:19:08.614156 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_historical_analysis"
[0m01:19:08.615156 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: create or replace   view F1.PONI.final_historical_analysis
  
  
  
  
  as (
    

WITH first_position_record AS (
    SELECT
        session_key,
        driver_number,
        position as first_position,
        date
    FROM stg_position
    QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, driver_number ORDER BY date) = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        round(MIN(i.gap_to_next),3) AS min_gap_to_next,
        round(MAX(i.gap_to_next),3) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM F1.PONI.stg_laps l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN F1.PONI.stg_intervals i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND DATE_TRUNC('SECOND', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN F1.PONI.int_lap_position sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN F1.PONI.int_lap_position ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY 1,2,3,4,5,6,7,8,9,10,15,16
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                LAST_VALUE(start_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                LAST_VALUE(end_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
lap_number,
session_key,
driver_number,
date_start as lap_start_time,
date_end as lap_end_time,
is_pit_out_lap,
duration_sector_1,
duration_sector_2,
duration_sector_3,
min_gap_to_leader,
max_gap_to_leader,
min_gap_to_next,
max_gap_to_next,
lap_start_position,
lap_end_position,
first_position as race_start_position,
FROM filled_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */;
[0m01:19:08.615156 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:19:10.841867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.225 seconds
[0m01:19:10.891221 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb9b8099-caa1-4045-8e34-e040de4e8590', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29FDA1D50>]}
[0m01:19:10.891221 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_historical_analysis ................ [[32mSUCCESS 1[0m in 2.30s]
[0m01:19:10.891221 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m01:19:10.894613 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:19:10.894613 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m01:19:10.894613 [debug] [MainThread]: On list_F1: Close
[0m01:19:11.453325 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m01:19:11.469505 [debug] [MainThread]: On list_F1_PONI: Close
[0m01:19:12.012195 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was left open.
[0m01:19:12.012195 [debug] [MainThread]: On model.f1_analytics.final_historical_analysis: Close
[0m01:19:12.583124 [info ] [MainThread]: 
[0m01:19:12.587178 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m01:19:12.587178 [debug] [MainThread]: Command end result
[0m01:19:12.618822 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:19:12.618822 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:19:12.634551 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m01:19:12.634551 [info ] [MainThread]: 
[0m01:19:12.634551 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:19:12.634551 [info ] [MainThread]: 
[0m01:19:12.634551 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:19:12.638145 [debug] [MainThread]: Command `dbt run` succeeded at 01:19:12.638145 after 9.43 seconds
[0m01:19:12.638145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F285956350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F29F676590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F285C63C40>]}
[0m01:19:12.640127 [debug] [MainThread]: Flushing usage events
[0m01:19:13.746766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:25:37.710679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC662E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC78C0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC78C0D30>]}


============================== 01:25:37.710679 | 98261559-4680-489e-a604-718674007466 ==============================
[0m01:25:37.710679 [info ] [MainThread]: Running with dbt=1.10.6
[0m01:25:37.710679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select final_historical_analysis.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:25:38.424128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98261559-4680-489e-a604-718674007466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC7889120>]}
[0m01:25:38.473774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98261559-4680-489e-a604-718674007466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC68FF5B0>]}
[0m01:25:38.475795 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m01:25:38.663154 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m01:25:38.855017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:25:38.855017 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:25:38.908081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98261559-4680-489e-a604-718674007466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE086CAF0>]}
[0m01:25:38.987300 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:25:38.989286 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:25:38.998288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98261559-4680-489e-a604-718674007466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE086DB40>]}
[0m01:25:39.013623 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m01:25:39.013623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98261559-4680-489e-a604-718674007466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE080C310>]}
[0m01:25:39.015667 [info ] [MainThread]: 
[0m01:25:39.015667 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:25:39.015667 [info ] [MainThread]: 
[0m01:25:39.015667 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:25:39.015667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m01:25:39.061574 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m01:25:39.061574 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m01:25:39.061574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:40.751036 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.689 seconds
[0m01:25:40.767231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m01:25:40.783438 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m01:25:40.783438 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m01:25:40.783438 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:25:42.267516 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.485 seconds
[0m01:25:42.280760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98261559-4680-489e-a604-718674007466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE086DFC0>]}
[0m01:25:42.286307 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_historical_analysis
[0m01:25:42.286307 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_historical_analysis ..................... [RUN]
[0m01:25:42.286307 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_historical_analysis'
[0m01:25:42.286307 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m01:25:42.296060 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m01:25:42.299115 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m01:25:42.318560 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m01:25:42.318560 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_historical_analysis"
[0m01:25:42.318560 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: create or replace   view F1.PONI.final_historical_analysis
  
  
  
  
  as (
    

WITH first_position_record AS (
    SELECT
        session_key,
        driver_number,
        position as first_position,
        date
    FROM stg_position
    QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, driver_number ORDER BY date) = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        round(MIN(i.gap_to_next),3) AS min_gap_to_next,
        round(MAX(i.gap_to_next),3) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM F1.PONI.stg_laps l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN F1.PONI.stg_intervals i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND DATE_TRUNC('SECOND', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN F1.PONI.int_lap_position sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN F1.PONI.int_lap_position ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY 1,2,3,4,5,6,7,8,9,10,15,16
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                LAST_VALUE(start_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                LAST_VALUE(end_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
lap_number,
session_key,
driver_number,
date_start as lap_start_time,
date_end as lap_end_time,
is_pit_out_lap,
duration_sector_1,
duration_sector_2,
duration_sector_3,
min_gap_to_leader,
max_gap_to_leader,
min_gap_to_next,
max_gap_to_next,
lap_start_position,
lap_end_position,
first_position as race_start_position,
FROM filled_positions
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */;
[0m01:25:42.318560 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:25:44.188393 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.860 seconds
[0m01:25:44.204300 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98261559-4680-489e-a604-718674007466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE0893DC0>]}
[0m01:25:44.204300 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_historical_analysis ................ [[32mSUCCESS 1[0m in 1.92s]
[0m01:25:44.204300 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m01:25:44.204300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:25:44.204300 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m01:25:44.204300 [debug] [MainThread]: On list_F1: Close
[0m01:25:44.803396 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m01:25:44.814149 [debug] [MainThread]: On list_F1_PONI: Close
[0m01:25:45.360445 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was left open.
[0m01:25:45.360445 [debug] [MainThread]: On model.f1_analytics.final_historical_analysis: Close
[0m01:25:45.939006 [info ] [MainThread]: 
[0m01:25:45.939006 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 6.92 seconds (6.92s).
[0m01:25:45.939006 [debug] [MainThread]: Command end result
[0m01:25:45.962120 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:25:45.970773 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:25:45.970773 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m01:25:45.970773 [info ] [MainThread]: 
[0m01:25:45.970773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:25:45.970773 [info ] [MainThread]: 
[0m01:25:45.970773 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:25:45.970773 [debug] [MainThread]: Command `dbt run` succeeded at 01:25:45.970773 after 8.34 seconds
[0m01:25:45.970773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC662E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AC43958A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE0304250>]}
[0m01:25:45.970773 [debug] [MainThread]: Flushing usage events
[0m01:25:47.113792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:34:47.762176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CEA46350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CFD20F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CFD20D90>]}


============================== 01:34:47.762176 | 32ecc41c-6358-4bfe-9103-bb767242f6e8 ==============================
[0m01:34:47.762176 [info ] [MainThread]: Running with dbt=1.10.6
[0m01:34:47.762176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_intervals.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:34:48.490299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32ecc41c-6358-4bfe-9103-bb767242f6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E865DD80>]}
[0m01:34:48.553919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32ecc41c-6358-4bfe-9103-bb767242f6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CFD23520>]}
[0m01:34:48.553919 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m01:34:48.842351 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m01:34:49.063948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:34:49.063948 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_intervals.sql
[0m01:34:49.286363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32ecc41c-6358-4bfe-9103-bb767242f6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E8E65210>]}
[0m01:34:49.366131 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:34:49.366131 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:34:49.397811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32ecc41c-6358-4bfe-9103-bb767242f6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E8E64160>]}
[0m01:34:49.397811 [info ] [MainThread]: Found 25 models, 4 data tests, 10 sources, 477 macros
[0m01:34:49.397811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ecc41c-6358-4bfe-9103-bb767242f6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E8E64670>]}
[0m01:34:49.397811 [info ] [MainThread]: 
[0m01:34:49.397811 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m01:34:49.397811 [info ] [MainThread]: 
[0m01:34:49.397811 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m01:34:49.397811 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m01:34:49.461563 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m01:34:49.461563 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m01:34:49.461563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:51.205197 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.734 seconds
[0m01:34:51.214482 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m01:34:51.219029 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m01:34:51.219029 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m01:34:51.219029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:34:52.948589 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.721 seconds
[0m01:34:52.960750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32ecc41c-6358-4bfe-9103-bb767242f6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E8C357E0>]}
[0m01:34:52.960750 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_intervals
[0m01:34:52.976640 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_intervals ................................. [RUN]
[0m01:34:52.976640 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_intervals'
[0m01:34:52.976640 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_intervals
[0m01:34:52.976640 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m01:34:52.976640 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_intervals
[0m01:34:52.992842 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m01:34:53.008788 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_intervals"
[0m01:34:53.008788 [debug] [Thread-1 (]: On model.f1_analytics.stg_intervals: create or replace   view F1.PONI.stg_intervals
  
  
  
  
  as (
    


   SELECT
    session_key,
    driver_number,
    date,
    CASE
        WHEN gap_to_leader = 'None' OR gap_to_leader LIKE '%L%' THEN NULL
        ELSE gap_to_leader
    END AS gap_to_leader,
    CASE
        WHEN interval = 'None' OR interval LIKE '%L%' THEN NULL
        ELSE interval
    END AS gap_to_next
FROM F1.PONI.intervals
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */;
[0m01:34:53.008788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m01:34:54.768870 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.759 seconds
[0m01:34:54.789636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32ecc41c-6358-4bfe-9103-bb767242f6e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E8F11480>]}
[0m01:34:54.789636 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_intervals ............................ [[32mSUCCESS 1[0m in 1.81s]
[0m01:34:54.789636 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_intervals
[0m01:34:54.789636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:34:54.795532 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m01:34:54.795532 [debug] [MainThread]: On list_F1: Close
[0m01:34:55.383754 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m01:34:55.399717 [debug] [MainThread]: On list_F1_PONI: Close
[0m01:34:56.007466 [debug] [MainThread]: Connection 'model.f1_analytics.stg_intervals' was left open.
[0m01:34:56.007466 [debug] [MainThread]: On model.f1_analytics.stg_intervals: Close
[0m01:34:56.805763 [info ] [MainThread]: 
[0m01:34:56.805763 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.41 seconds (7.41s).
[0m01:34:56.805763 [debug] [MainThread]: Command end result
[0m01:34:56.837032 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m01:34:56.837032 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m01:34:56.837032 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m01:34:56.837032 [info ] [MainThread]: 
[0m01:34:56.837032 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:34:56.837032 [info ] [MainThread]: 
[0m01:34:56.837032 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m01:34:56.853087 [debug] [MainThread]: Command `dbt run` succeeded at 01:34:56.853087 after 9.16 seconds
[0m01:34:56.853087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CEA46350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8E865FA30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8CED53C40>]}
[0m01:34:56.853087 [debug] [MainThread]: Flushing usage events
[0m01:34:57.958825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:21:20.965119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCE66EE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCE7980F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCE7980D60>]}


============================== 00:21:20.972214 | 9407e5ce-4f77-4b81-99c5-66590ee7c7dd ==============================
[0m00:21:20.972214 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:21:20.972214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select final_race_summary.sql', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:21:22.474056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9407e5ce-4f77-4b81-99c5-66590ee7c7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCE444DA20>]}
[0m00:21:22.545146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9407e5ce-4f77-4b81-99c5-66590ee7c7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCE7116C50>]}
[0m00:21:22.550037 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:21:23.362905 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:21:29.694309 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:21:29.710313 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\marts\final_race_summary.sql
[0m00:21:29.981444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9407e5ce-4f77-4b81-99c5-66590ee7c7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC80AB1CC0>]}
[0m00:21:30.083254 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:21:30.095338 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:21:30.182145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9407e5ce-4f77-4b81-99c5-66590ee7c7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC808B9510>]}
[0m00:21:30.184810 [info ] [MainThread]: Found 26 models, 4 data tests, 10 sources, 477 macros
[0m00:21:30.184810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9407e5ce-4f77-4b81-99c5-66590ee7c7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC80AB21A0>]}
[0m00:21:30.187490 [info ] [MainThread]: 
[0m00:21:30.187490 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:21:30.187490 [info ] [MainThread]: 
[0m00:21:30.187490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:21:30.187490 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:21:40.891051 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:21:40.891051 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:21:40.891051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:42.926270 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.035 seconds
[0m00:21:42.940348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:21:42.968541 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:21:42.970582 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:21:42.970582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:44.872497 [debug] [ThreadPool]: SQL status: SUCCESS 34 in 1.905 seconds
[0m00:21:44.887656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9407e5ce-4f77-4b81-99c5-66590ee7c7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC808B8910>]}
[0m00:21:44.887656 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_summary
[0m00:21:44.887656 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_race_summary ............................ [RUN]
[0m00:21:44.887656 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_race_summary'
[0m00:21:44.887656 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_summary
[0m00:21:44.908953 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_summary"
[0m00:21:44.908953 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_summary
[0m00:21:44.935400 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_summary"
[0m00:21:44.951371 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_race_summary"
[0m00:21:44.951371 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: create or replace   view F1.PONI.final_race_summary
  
  
  
  
  as (
    

WITH positions AS (
   SELECT
       session_key,
       COUNT(DISTINCT driver_number) as total_drivers

   FROM F1.PONI.stg_position
   GROUP BY session_key
),
laps AS (
   SELECT
       session_key,
       MAX(lap_number) as total_laps
   FROM F1.PONI.stg_laps
   GROUP BY session_key
),
team_stats AS (
   SELECT
       session_key,
       SUM(pit_stop_count) as total_pit_stops,
        COUNT(DISTINCT team_name) as total_teams,
   FROM F1.PONI.final_race_leaderboard
   GROUP BY session_key
),
driver_stats AS (
   SELECT
       session_key,
       driver_number,
       MAX(speed) as top_speed,
       AVG(speed) as avg_speed,
       SUM(CASE WHEN drs = 1 THEN 1 ELSE 0 END) as drs_activations
   FROM F1.PONI.stg_car_data
   GROUP BY session_key, driver_number
),
cte as(
SELECT
   p.session_key,
   m.session_display_name,
   p.total_drivers,
   l.total_laps,
   MAX(d.top_speed) as fastest_speed,
   round(AVG(d.avg_speed),3) as average_speed
FROM positions p
JOIN laps l ON p.session_key = l.session_key
JOIN F1.PONI.final_session_mapping m ON p.session_key = m.session_key
LEFT JOIN driver_stats d ON p.session_key = d.session_key
GROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps
)
select c.session_key,
   c.session_display_name,
   c.total_drivers,
    t.total_teams,
   c.total_laps,
   t.total_pit_stops,
    c.fastest_speed,
   c.average_speed,
from cte c left join team_stats t on c.session_key=t.session_key
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */;
[0m00:21:44.951371 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:21:47.353246 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.399 seconds
[0m00:21:47.387331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9407e5ce-4f77-4b81-99c5-66590ee7c7dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC80B96110>]}
[0m00:21:47.387331 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_race_summary ....................... [[32mSUCCESS 1[0m in 2.49s]
[0m00:21:47.387331 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_summary
[0m00:21:47.387331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:47.387331 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:21:47.387331 [debug] [MainThread]: On list_F1: Close
[0m00:21:48.041901 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:21:48.041901 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:21:48.684215 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_summary' was left open.
[0m00:21:48.684215 [debug] [MainThread]: On model.f1_analytics.final_race_summary: Close
[0m00:21:49.291235 [info ] [MainThread]: 
[0m00:21:49.291235 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 19.10 seconds (19.10s).
[0m00:21:49.291235 [debug] [MainThread]: Command end result
[0m00:21:49.412846 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:21:49.414593 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:21:49.424847 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:21:49.424847 [info ] [MainThread]: 
[0m00:21:49.424847 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:21:49.424847 [info ] [MainThread]: 
[0m00:21:49.424847 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:21:49.424847 [debug] [MainThread]: Command `dbt run` succeeded at 00:21:49.424847 after 28.61 seconds
[0m00:21:49.424847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCE66EE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CCE69E7C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CC821E6470>]}
[0m00:21:49.430632 [debug] [MainThread]: Flushing usage events
[0m00:21:50.653495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:24:51.443742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F45CE290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F5860E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F5860CA0>]}


============================== 00:24:51.443742 | 4d941452-9b69-4caa-a57a-17613fa12db6 ==============================
[0m00:24:51.443742 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:24:51.452074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select final_session_driver_mapping.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:24:52.502981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d941452-9b69-4caa-a57a-17613fa12db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F57BAFB0>]}
[0m00:24:52.563194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d941452-9b69-4caa-a57a-17613fa12db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F55D3D60>]}
[0m00:24:52.563194 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:24:52.817762 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:24:53.087534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:24:53.087534 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\marts\final_session_driver_mapping.sql
[0m00:24:53.087534 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_car.sql
[0m00:24:53.367932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d941452-9b69-4caa-a57a-17613fa12db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988E9A2380>]}
[0m00:24:53.462583 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:24:53.462583 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:24:53.494792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d941452-9b69-4caa-a57a-17613fa12db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988E9A0F40>]}
[0m00:24:53.496740 [info ] [MainThread]: Found 27 models, 4 data tests, 10 sources, 477 macros
[0m00:24:53.497265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d941452-9b69-4caa-a57a-17613fa12db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988E748EB0>]}
[0m00:24:53.500277 [info ] [MainThread]: 
[0m00:24:53.500277 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:24:53.500277 [info ] [MainThread]: 
[0m00:24:53.500277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:24:53.500277 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:24:53.563551 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:24:53.565556 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:24:53.565556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:55.466522 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.899 seconds
[0m00:24:55.490096 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:24:55.509430 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:24:55.509430 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:24:55.509430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:24:57.260918 [debug] [ThreadPool]: SQL status: SUCCESS 35 in 1.753 seconds
[0m00:24:57.291569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d941452-9b69-4caa-a57a-17613fa12db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988E9A1EA0>]}
[0m00:24:57.291569 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_driver_mapping
[0m00:24:57.291569 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_session_driver_mapping .................. [RUN]
[0m00:24:57.291569 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_session_driver_mapping'
[0m00:24:57.291569 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_driver_mapping
[0m00:24:57.307264 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_driver_mapping"
[0m00:24:57.307264 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_driver_mapping
[0m00:24:57.345191 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_driver_mapping"
[0m00:24:57.345191 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_session_driver_mapping"
[0m00:24:57.345191 [debug] [Thread-1 (]: On model.f1_analytics.final_session_driver_mapping: create or replace   view F1.PONI.final_session_driver_mapping
  
  
  
  
  as (
    

SELECT DISTINCT
    d.session_key,
    concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name,
    d.driver_number
FROM F1.PONI.stg_drivers d
JOIN F1.PONI.stg_sessions s ON d.session_key = s.session_key
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */;
[0m00:24:57.345191 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:24:59.454284 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.108 seconds
[0m00:24:59.479575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d941452-9b69-4caa-a57a-17613fa12db6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F1B04580>]}
[0m00:24:59.479575 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_session_driver_mapping ............. [[32mSUCCESS 1[0m in 2.19s]
[0m00:24:59.479575 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_driver_mapping
[0m00:24:59.495010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:24:59.495010 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:24:59.495010 [debug] [MainThread]: On list_F1: Close
[0m00:25:00.088759 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:25:00.089772 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:25:00.703553 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_driver_mapping' was left open.
[0m00:25:00.703553 [debug] [MainThread]: On model.f1_analytics.final_session_driver_mapping: Close
[0m00:25:01.302178 [info ] [MainThread]: 
[0m00:25:01.302178 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.80 seconds (7.80s).
[0m00:25:01.302178 [debug] [MainThread]: Command end result
[0m00:25:01.428633 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:25:01.428633 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:25:01.444585 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:25:01.444585 [info ] [MainThread]: 
[0m00:25:01.444585 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:25:01.444585 [info ] [MainThread]: 
[0m00:25:01.444585 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:25:01.444585 [debug] [MainThread]: Command `dbt run` succeeded at 00:25:01.444585 after 10.08 seconds
[0m00:25:01.444585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F45CE290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000298F487E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002988FF41B10>]}
[0m00:25:01.444585 [debug] [MainThread]: Flushing usage events
[0m00:25:02.728781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:18.103092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DA7FE2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DCA60F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DCA60D30>]}


============================== 00:34:18.103092 | e71c09fa-bac3-49d3-b231-5e6c8beb4dbb ==============================
[0m00:34:18.103092 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:34:18.116066 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_sessions.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:34:19.560450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e71c09fa-bac3-49d3-b231-5e6c8beb4dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F54A6170>]}
[0m00:34:19.643579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e71c09fa-bac3-49d3-b231-5e6c8beb4dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DCA634F0>]}
[0m00:34:19.646836 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:34:19.961361 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:34:20.325925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:34:20.325925 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m00:34:20.615799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e71c09fa-bac3-49d3-b231-5e6c8beb4dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F5B91DB0>]}
[0m00:34:20.711311 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:34:20.715321 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:34:20.758362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e71c09fa-bac3-49d3-b231-5e6c8beb4dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F5B905B0>]}
[0m00:34:20.760405 [info ] [MainThread]: Found 27 models, 4 data tests, 10 sources, 477 macros
[0m00:34:20.760405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e71c09fa-bac3-49d3-b231-5e6c8beb4dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F5B913F0>]}
[0m00:34:20.760405 [info ] [MainThread]: 
[0m00:34:20.760405 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:34:20.760405 [info ] [MainThread]: 
[0m00:34:20.760405 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:34:20.760405 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:34:20.821104 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:34:20.821104 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:34:20.821104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:22.922037 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.090 seconds
[0m00:34:22.931088 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:34:22.950036 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:34:22.952044 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:34:22.952044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:24.663211 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 1.717 seconds
[0m00:34:24.678547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e71c09fa-bac3-49d3-b231-5e6c8beb4dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F597C460>]}
[0m00:34:24.678547 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m00:34:24.678547 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_sessions .................................. [RUN]
[0m00:34:24.678547 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_sessions'
[0m00:34:24.678547 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m00:34:24.698553 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m00:34:24.698553 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m00:34:24.732899 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m00:34:24.732899 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_sessions"
[0m00:34:24.732899 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: create or replace   view F1.PONI.stg_sessions
  
  
  
  
  as (
    

with raw as(
    select * from F1.PONI.sessions
),
    raw1 as (select *
             from F1.PONI.meetings
             )
SELECT
  CAST(s.session_key AS INT)             AS session_key,
  CAST(s.meeting_key AS INT)             AS meeting_key,
  s.session_name                         AS session_name,
  s.session_type                         AS session_type,
  m.circuit_short_name,
  m.country_name,
  TO_TIMESTAMP_NTZ(s.date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(s.date_end)           AS date_end,
  s.location                             AS location,
  extract(year,date_start)               as year
FROM raw s left join raw1 m on s.meeting_key=m.meeting_key
WHERE session_key IS NOT NULL and session_type in('Race', 'Qualifying')
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */;
[0m00:34:24.732899 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:34:27.028924 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01be5918-0003-59ac-0009-1a0e00062286
[0m00:34:27.028924 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002028 (42601): SQL compilation error:
ambiguous column name 'DATE_START'
[0m00:34:27.061120 [debug] [Thread-1 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'DATE_START'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m00:34:27.063137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e71c09fa-bac3-49d3-b231-5e6c8beb4dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F71BAE30>]}
[0m00:34:27.063137 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model PONI.stg_sessions ......................... [[31mERROR[0m in 2.38s]
[0m00:34:27.063137 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m00:34:27.063137 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'DATE_START'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m00:34:27.063137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:27.063137 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:34:27.063137 [debug] [MainThread]: On list_F1: Close
[0m00:34:27.718350 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:34:27.718350 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:34:28.391059 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was left open.
[0m00:34:28.391059 [debug] [MainThread]: On model.f1_analytics.stg_sessions: Close
[0m00:34:29.014328 [info ] [MainThread]: 
[0m00:34:29.014328 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.25 seconds (8.25s).
[0m00:34:29.014328 [debug] [MainThread]: Command end result
[0m00:34:29.046031 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:34:29.062124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:34:29.066044 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:34:29.066044 [info ] [MainThread]: 
[0m00:34:29.066044 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:34:29.066044 [info ] [MainThread]: 
[0m00:34:29.066044 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m00:34:29.066044 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  002028 (42601): SQL compilation error:
  ambiguous column name 'DATE_START'
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m00:34:29.078467 [info ] [MainThread]: 
[0m00:34:29.078467 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m00:34:29.078467 [info ] [MainThread]: 
[0m00:34:29.078467 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m00:34:29.082197 [debug] [MainThread]: Command `dbt run` failed at 00:34:29.082197 after 11.09 seconds
[0m00:34:29.082197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221DA7FE2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F54A7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221F5938B80>]}
[0m00:34:29.082197 [debug] [MainThread]: Flushing usage events
[0m00:34:30.341413 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:34:47.064839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DABE26350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DAD100F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DAD100D90>]}


============================== 00:34:47.069878 | 7f28f86e-57da-465f-87c8-e08d66c12a7b ==============================
[0m00:34:47.069878 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:34:47.069878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sessions.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:34:48.205413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f28f86e-57da-465f-87c8-e08d66c12a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DC5A3DD80>]}
[0m00:34:48.275498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f28f86e-57da-465f-87c8-e08d66c12a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DAD103520>]}
[0m00:34:48.275498 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:34:48.565031 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:34:48.924332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:34:48.926339 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m00:34:49.241051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f28f86e-57da-465f-87c8-e08d66c12a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DC6231E10>]}
[0m00:34:49.348056 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:34:49.352494 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:34:49.407744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f28f86e-57da-465f-87c8-e08d66c12a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DC601E560>]}
[0m00:34:49.407744 [info ] [MainThread]: Found 27 models, 4 data tests, 10 sources, 477 macros
[0m00:34:49.407744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f28f86e-57da-465f-87c8-e08d66c12a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DC62314B0>]}
[0m00:34:49.417591 [info ] [MainThread]: 
[0m00:34:49.417591 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:34:49.420025 [info ] [MainThread]: 
[0m00:34:49.420025 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:34:49.421973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:34:49.502229 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:34:49.502229 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:34:49.502229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:51.380794 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.886 seconds
[0m00:34:51.410653 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:34:51.428431 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:34:51.442334 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:34:51.444358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:53.350193 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 1.908 seconds
[0m00:34:53.381614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f28f86e-57da-465f-87c8-e08d66c12a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DC601C340>]}
[0m00:34:53.381614 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m00:34:53.392724 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.stg_sessions .................................. [RUN]
[0m00:34:53.392724 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.stg_sessions'
[0m00:34:53.392724 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m00:34:53.403502 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m00:34:53.405512 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m00:34:53.437177 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m00:34:53.437177 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.stg_sessions"
[0m00:34:53.437177 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: create or replace   view F1.PONI.stg_sessions
  
  
  
  
  as (
    

with raw as(
    select * from F1.PONI.sessions
),
    raw1 as (select *
             from F1.PONI.meetings
             )
SELECT
  CAST(s.session_key AS INT)             AS session_key,
  CAST(s.meeting_key AS INT)             AS meeting_key,
  s.session_name                         AS session_name,
  s.session_type                         AS session_type,
  m.circuit_short_name,
  m.country_name,
  TO_TIMESTAMP_NTZ(s.date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(s.date_end)           AS date_end,
  s.location                             AS location,
  extract(year,s.date_start)               as year
FROM raw s left join raw1 m on s.meeting_key=m.meeting_key
WHERE session_key IS NOT NULL and session_type in('Race', 'Qualifying')
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */;
[0m00:34:53.437177 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:34:55.536971 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.089 seconds
[0m00:34:55.573229 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f28f86e-57da-465f-87c8-e08d66c12a7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DC785EEF0>]}
[0m00:34:55.573229 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.stg_sessions ............................. [[32mSUCCESS 1[0m in 2.18s]
[0m00:34:55.573229 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m00:34:55.573229 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:55.573229 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:34:55.573229 [debug] [MainThread]: On list_F1: Close
[0m00:34:56.259274 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:34:56.259274 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:34:56.868132 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was left open.
[0m00:34:56.868132 [debug] [MainThread]: On model.f1_analytics.stg_sessions: Close
[0m00:34:57.482295 [info ] [MainThread]: 
[0m00:34:57.482295 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.06 seconds (8.06s).
[0m00:34:57.482295 [debug] [MainThread]: Command end result
[0m00:34:57.594196 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:34:57.610640 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:34:57.610640 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:34:57.610640 [info ] [MainThread]: 
[0m00:34:57.610640 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:57.610640 [info ] [MainThread]: 
[0m00:34:57.610640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:34:57.610640 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:57.610640 after 10.67 seconds
[0m00:34:57.610640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DABE26350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DAC133C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014DC791BA30>]}
[0m00:34:57.625670 [debug] [MainThread]: Flushing usage events
[0m00:34:58.825230 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:13.370628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAC9AE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAEC20F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAEC20D30>]}


============================== 00:38:13.379443 | 24fa39eb-6167-4bfc-9fae-679223bbe7d8 ==============================
[0m00:38:13.379443 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:38:13.379443 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select final_session_filters.sql', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:38:14.625778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '24fa39eb-6167-4bfc-9fae-679223bbe7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAEBED120>]}
[0m00:38:14.671904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '24fa39eb-6167-4bfc-9fae-679223bbe7d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDADC4C7C0>]}
[0m00:38:14.684013 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:38:14.918261 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:38:15.181685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:38:15.181685 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\marts\final_session_filters.sql
[0m00:38:15.390116 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.f1_analytics.final_session_filters' (f1_analytics/models\marts\final_session_filters.sql) depends on a node named 'stg_f1_sessions' which was not found
[0m00:38:15.393364 [debug] [MainThread]: Command `dbt run` failed at 00:38:15.393364 after 2.11 seconds
[0m00:38:15.393869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDAC9AE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC7D24910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EDC7D24820>]}
[0m00:38:15.394544 [debug] [MainThread]: Flushing usage events
[0m00:38:16.650751 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:38:35.435590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06C56380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D07F30F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D07F30D60>]}


============================== 00:38:35.444462 | e502a6d4-73fa-481c-bdad-f9767bb10032 ==============================
[0m00:38:35.444462 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:38:35.444462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select final_session_filters.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:38:36.668402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e502a6d4-73fa-481c-bdad-f9767bb10032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D04205930>]}
[0m00:38:36.734229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e502a6d4-73fa-481c-bdad-f9767bb10032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D07F33550>]}
[0m00:38:36.734229 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:38:36.992264 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:38:37.245598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:38:37.247603 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\marts\final_session_filters.sql
[0m00:38:37.585802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e502a6d4-73fa-481c-bdad-f9767bb10032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D21046980>]}
[0m00:38:37.696789 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:38:37.700728 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:38:37.748683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e502a6d4-73fa-481c-bdad-f9767bb10032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D21045B40>]}
[0m00:38:37.748683 [info ] [MainThread]: Found 28 models, 4 data tests, 10 sources, 477 macros
[0m00:38:37.748683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e502a6d4-73fa-481c-bdad-f9767bb10032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D21045AB0>]}
[0m00:38:37.754368 [info ] [MainThread]: 
[0m00:38:37.754368 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:38:37.754368 [info ] [MainThread]: 
[0m00:38:37.754368 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:38:37.754368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:38:37.822017 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:38:37.822017 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:38:37.824023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:39.518912 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.700 seconds
[0m00:38:39.534976 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:38:39.534976 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:38:39.534976 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:38:39.534976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:38:41.481473 [debug] [ThreadPool]: SQL status: SUCCESS 36 in 1.939 seconds
[0m00:38:41.499669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e502a6d4-73fa-481c-bdad-f9767bb10032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20E4D210>]}
[0m00:38:41.505215 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_filters
[0m00:38:41.505215 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_session_filters ......................... [RUN]
[0m00:38:41.505215 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_session_filters'
[0m00:38:41.513065 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_filters
[0m00:38:41.524087 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_filters"
[0m00:38:41.524087 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_filters
[0m00:38:41.554983 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_filters"
[0m00:38:41.558218 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_session_filters"
[0m00:38:41.560334 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: create or replace   view F1.PONI.final_session_filters
  
  
  
  
  as (
    WITH session_drivers AS (
   SELECT DISTINCT
       s.session_key,
       s.country_name,
       s.session_name,
       s.year,
       d.driver_number,
       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name
   FROM F1.PONI.stg_sessions s
   JOIN F1.PONI.stg_drivers d ON s.session_key = d.session_key
)
SELECT
   s.session_key,
    s.year,
   s.country_name,
   s.circuit_short_name,
   s.session_name,
   s.session_type,
   concat(s.year, ' - ', s.country_name, ' - ', s.session_name) as session_display_name,
   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,
   m.meeting_name,
   m.meeting_official_name,
   s.date_start
FROM F1.PONI.stg_sessions s
JOIN session_drivers sd ON s.session_key = sd.session_key
JOIN F1.PONI.stg_meeting m ON s.year = m.year
   AND s.country_name = m.country_name
GROUP BY 1,2,3,4,5,6,7,9,10,11
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */;
[0m00:38:41.560334 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:38:43.571657 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.019 seconds
[0m00:38:43.616208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e502a6d4-73fa-481c-bdad-f9767bb10032', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D041D7190>]}
[0m00:38:43.616208 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_session_filters .................... [[32mSUCCESS 1[0m in 2.11s]
[0m00:38:43.616208 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_filters
[0m00:38:43.619668 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:38:43.619668 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:38:43.619668 [debug] [MainThread]: On list_F1: Close
[0m00:38:44.204681 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:38:44.213214 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:38:44.838559 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_filters' was left open.
[0m00:38:44.838559 [debug] [MainThread]: On model.f1_analytics.final_session_filters: Close
[0m00:38:45.431517 [info ] [MainThread]: 
[0m00:38:45.432661 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.68 seconds (7.68s).
[0m00:38:45.432661 [debug] [MainThread]: Command end result
[0m00:38:45.547130 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:38:45.547130 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:38:45.555749 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:38:45.555749 [info ] [MainThread]: 
[0m00:38:45.555749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:38:45.555749 [info ] [MainThread]: 
[0m00:38:45.563087 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:38:45.563087 [debug] [MainThread]: Command `dbt run` succeeded at 00:38:45.563087 after 10.22 seconds
[0m00:38:45.563087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D06C56380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D20188FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D21620070>]}
[0m00:38:45.563087 [debug] [MainThread]: Flushing usage events
[0m00:38:46.703248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:40:47.918825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA122E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA3490F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA3490D60>]}


============================== 00:40:47.920693 | 4ad84397-0861-48a5-9d21-ed5b113abe1f ==============================
[0m00:40:47.920693 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:40:47.924660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select int_tyre_stint.sql', 'send_anonymous_usage_stats': 'True'}
[0m00:40:49.175635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ad84397-0861-48a5-9d21-ed5b113abe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA345D120>]}
[0m00:40:49.243386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ad84397-0861-48a5-9d21-ed5b113abe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA2BD13F0>]}
[0m00:40:49.243386 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:40:49.493007 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:40:49.777660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:40:49.777660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:40:49.833949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ad84397-0861-48a5-9d21-ed5b113abe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBC445EA0>]}
[0m00:40:49.936816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:40:49.936816 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:40:49.981579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ad84397-0861-48a5-9d21-ed5b113abe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBC396DA0>]}
[0m00:40:49.984428 [info ] [MainThread]: Found 28 models, 4 data tests, 10 sources, 477 macros
[0m00:40:49.984932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ad84397-0861-48a5-9d21-ed5b113abe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBC369CC0>]}
[0m00:40:49.984932 [info ] [MainThread]: 
[0m00:40:49.984932 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:40:49.984932 [info ] [MainThread]: 
[0m00:40:49.984932 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:40:49.984932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:40:50.053599 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:40:50.053599 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:40:50.053599 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:52.012035 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.958 seconds
[0m00:40:52.026509 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:40:52.033874 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:40:52.033874 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:40:52.033874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:40:53.841508 [debug] [ThreadPool]: SQL status: SUCCESS 37 in 1.802 seconds
[0m00:40:53.853252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ad84397-0861-48a5-9d21-ed5b113abe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBC3946A0>]}
[0m00:40:53.853252 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_tyre_stint
[0m00:40:53.869107 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.int_tyre_stint ................................ [RUN]
[0m00:40:53.869107 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.int_tyre_stint'
[0m00:40:53.869107 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_tyre_stint
[0m00:40:53.874536 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint"
[0m00:40:53.885009 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_tyre_stint
[0m00:40:53.911669 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint"
[0m00:40:53.911669 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.int_tyre_stint"
[0m00:40:53.915898 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint: create or replace   view F1.PONI.int_tyre_stint
  
  
  
  
  as (
    

WITH stints_base AS (
    SELECT
        s.*,
        d.team_name,
        ses.circuit_short_name,
        ses.country_name,
        ses.session_type
    FROM F1.PONI.stg_stints s
    LEFT JOIN F1.PONI.stg_drivers d ON s.driver_number = d.driver_number
        AND s.session_key = d.session_key
    LEFT JOIN F1.PONI.stg_sessions ses ON s.session_key = ses.session_key
    WHERE ses.session_type = 'Race' -- Focus on race sessions
),

stint_durations AS (
    SELECT
        *,
        lap_end - lap_start + 1 as stint_length
    FROM stints_base
)

SELECT * FROM stint_durations
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */;
[0m00:40:53.915898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:40:55.985820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.072 seconds
[0m00:40:56.017763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ad84397-0861-48a5-9d21-ed5b113abe1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE9F7345B0>]}
[0m00:40:56.017763 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.int_tyre_stint ........................... [[32mSUCCESS 1[0m in 2.15s]
[0m00:40:56.017763 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_tyre_stint
[0m00:40:56.033614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:40:56.033614 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:40:56.037656 [debug] [MainThread]: On list_F1: Close
[0m00:40:56.692353 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:40:56.692353 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:40:57.316631 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint' was left open.
[0m00:40:57.318640 [debug] [MainThread]: On model.f1_analytics.int_tyre_stint: Close
[0m00:40:57.934111 [info ] [MainThread]: 
[0m00:40:57.942694 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.95 seconds (7.95s).
[0m00:40:57.944730 [debug] [MainThread]: Command end result
[0m00:40:57.982002 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:40:57.997920 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:40:58.008745 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:40:58.008745 [info ] [MainThread]: 
[0m00:40:58.008745 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:40:58.008745 [info ] [MainThread]: 
[0m00:40:58.008745 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:40:58.013770 [debug] [MainThread]: Command `dbt run` succeeded at 00:40:58.013770 after 10.19 seconds
[0m00:40:58.016335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA122E2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEA33E7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CEBC4448E0>]}
[0m00:40:58.018349 [debug] [MainThread]: Flushing usage events
[0m00:40:59.316199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:44:00.893492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A28B5E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29DECE50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29DECC70>]}


============================== 00:44:00.893492 | 6bfe824d-cff1-4a78-a96a-f11dbae6d980 ==============================
[0m00:44:00.893492 [info ] [MainThread]: Running with dbt=1.10.6
[0m00:44:00.904700 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select final_tyre_performance.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:44:02.142912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bfe824d-cff1-4a78-a96a-f11dbae6d980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A427947F0>]}
[0m00:44:02.206140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bfe824d-cff1-4a78-a96a-f11dbae6d980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A29C21D20>]}
[0m00:44:02.206140 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m00:44:02.467980 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m00:44:02.784776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m00:44:02.784776 [debug] [MainThread]: Partial parsing: added file: f1_analytics://f1_analytics/models\marts\final_tyre_performance.sql
[0m00:44:03.050152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bfe824d-cff1-4a78-a96a-f11dbae6d980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A42F14130>]}
[0m00:44:03.150018 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:44:03.157857 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:44:03.209372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bfe824d-cff1-4a78-a96a-f11dbae6d980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A42F40580>]}
[0m00:44:03.209756 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 477 macros
[0m00:44:03.209756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bfe824d-cff1-4a78-a96a-f11dbae6d980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A42F15840>]}
[0m00:44:03.213396 [info ] [MainThread]: 
[0m00:44:03.213396 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m00:44:03.213396 [info ] [MainThread]: 
[0m00:44:03.213396 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:44:03.213396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1'
[0m00:44:03.288807 [debug] [ThreadPool]: Using snowflake connection "list_F1"
[0m00:44:03.288807 [debug] [ThreadPool]: On list_F1: show terse schemas in database F1
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1"} */
[0m00:44:03.288807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:05.255481 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.974 seconds
[0m00:44:05.293222 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_F1_PONI'
[0m00:44:05.302935 [debug] [ThreadPool]: Using snowflake connection "list_F1_PONI"
[0m00:44:05.302935 [debug] [ThreadPool]: On list_F1_PONI: show objects in F1.PONI
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_F1_PONI"} */;
[0m00:44:05.302935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:44:07.000833 [debug] [ThreadPool]: SQL status: SUCCESS 37 in 1.690 seconds
[0m00:44:07.000833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bfe824d-cff1-4a78-a96a-f11dbae6d980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A42F40520>]}
[0m00:44:07.014902 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_tyre_performance
[0m00:44:07.014902 [info ] [Thread-1 (]: 1 of 1 START sql view model PONI.final_tyre_performance ........................ [RUN]
[0m00:44:07.014902 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.f1_analytics.final_tyre_performance'
[0m00:44:07.014902 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_tyre_performance
[0m00:44:07.036310 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_tyre_performance"
[0m00:44:07.038317 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_tyre_performance
[0m00:44:07.062978 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_tyre_performance"
[0m00:44:07.062978 [debug] [Thread-1 (]: Using snowflake connection "model.f1_analytics.final_tyre_performance"
[0m00:44:07.062978 [debug] [Thread-1 (]: On model.f1_analytics.final_tyre_performance: create or replace   view F1.PONI.final_tyre_performance
  
  
  
  
  as (
    

WITH tire_performance AS (
    SELECT
        circuit_short_name,
        compound,
        team_name,
        driver_number,
        AVG(stint_length) as avg_stint_length,
        MAX(stint_length) as max_stint_length,
        AVG(tyre_age_at_start) as avg_starting_age,
        COUNT(*) as number_of_stints
    FROM F1.PONI.int_tyre_stint
    GROUP BY 1,2,3,4
)

SELECT
    circuit_short_name,
    compound,
    round(AVG(avg_stint_length),2) as circuit_compound_avg_stint_length,
    MAX(max_stint_length) as circuit_compound_max_stint_length,
    round(AVG(avg_starting_age),2) as avg_tire_age_start,
    SUM(number_of_stints) as total_stints
FROM tire_performance
GROUP BY 1,2
  )
/* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */;
[0m00:44:07.062978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:44:09.016447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.942 seconds
[0m00:44:09.046375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bfe824d-cff1-4a78-a96a-f11dbae6d980', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A26894580>]}
[0m00:44:09.046375 [info ] [Thread-1 (]: 1 of 1 OK created sql view model PONI.final_tyre_performance ................... [[32mSUCCESS 1[0m in 2.03s]
[0m00:44:09.048380 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_tyre_performance
[0m00:44:09.048380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:44:09.048380 [debug] [MainThread]: Connection 'list_F1' was left open.
[0m00:44:09.048380 [debug] [MainThread]: On list_F1: Close
[0m00:44:09.744788 [debug] [MainThread]: Connection 'list_F1_PONI' was left open.
[0m00:44:09.746547 [debug] [MainThread]: On list_F1_PONI: Close
[0m00:44:10.359148 [debug] [MainThread]: Connection 'model.f1_analytics.final_tyre_performance' was left open.
[0m00:44:10.359148 [debug] [MainThread]: On model.f1_analytics.final_tyre_performance: Close
[0m00:44:10.947559 [info ] [MainThread]: 
[0m00:44:10.963295 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.73 seconds (7.73s).
[0m00:44:10.963295 [debug] [MainThread]: Command end result
[0m00:44:11.072534 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m00:44:11.072534 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m00:44:11.088525 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m00:44:11.088525 [info ] [MainThread]: 
[0m00:44:11.096335 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:44:11.096335 [info ] [MainThread]: 
[0m00:44:11.096335 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m00:44:11.096335 [debug] [MainThread]: Command `dbt run` succeeded at 00:44:11.096335 after 10.30 seconds
[0m00:44:11.096335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A28B5E230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A28E2C370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020A444AE890>]}
[0m00:44:11.096335 [debug] [MainThread]: Flushing usage events
[0m00:44:12.340093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:46.818735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA22C5E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA24F40F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA24F40D30>]}


============================== 11:54:46.825800 | 6d9b8f11-a3d9-4fe8-8450-b8d853b9e028 ==============================
[0m11:54:46.825800 [info ] [MainThread]: Running with dbt=1.10.6
[0m11:54:46.826638 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select models/staging/', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:47.015331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d9b8f11-a3d9-4fe8-8450-b8d853b9e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2501DBA0>]}
[0m11:54:47.065741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d9b8f11-a3d9-4fe8-8450-b8d853b9e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA24F42C20>]}
[0m11:54:47.066890 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:54:47.687785 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m11:54:47.854581 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m11:54:47.855559 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m11:54:47.856568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6d9b8f11-a3d9-4fe8-8450-b8d853b9e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA246730A0>]}
[0m11:54:52.608404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d9b8f11-a3d9-4fe8-8450-b8d853b9e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA26970130>]}
[0m11:54:52.735063 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m11:54:52.737074 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m11:54:52.778993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d9b8f11-a3d9-4fe8-8450-b8d853b9e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA266D70A0>]}
[0m11:54:52.778993 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m11:54:52.779995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d9b8f11-a3d9-4fe8-8450-b8d853b9e028', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA266D52A0>]}
[0m11:54:52.780994 [warn ] [MainThread]: The selection criterion 'models/staging/' does not match any enabled nodes
[0m11:54:52.783023 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:54:52.783023 [debug] [MainThread]: Command end result
[0m11:54:52.805757 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m11:54:52.808759 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m11:54:52.811759 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m11:54:52.812758 [debug] [MainThread]: Command `dbt run` succeeded at 11:54:52.812758 after 6.13 seconds
[0m11:54:52.813760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA22A92620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2263CEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA26896860>]}
[0m11:54:52.813760 [debug] [MainThread]: Flushing usage events
[0m11:54:53.153061 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:36.224536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4946A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4A740F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4A740D30>]}


============================== 11:55:36.228542 | f91ecfc3-ebcb-4bfd-8006-225726aef407 ==============================
[0m11:55:36.228542 [info ] [MainThread]: Running with dbt=1.10.6
[0m11:55:36.229541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m11:55:36.402214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4A8D8D30>]}
[0m11:55:36.467846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C49E80070>]}
[0m11:55:36.469851 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:55:36.636712 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m11:55:36.830013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:55:36.830013 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:55:36.879392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4BDC0E80>]}
[0m11:55:37.052051 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m11:55:37.056065 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m11:55:37.087890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4BC67EE0>]}
[0m11:55:37.088890 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m11:55:37.089889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4BC66C80>]}
[0m11:55:37.091889 [info ] [MainThread]: 
[0m11:55:37.092909 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:55:37.093888 [info ] [MainThread]: 
[0m11:55:37.094890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:55:37.103897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m11:55:49.324521 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m11:55:49.327544 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m11:55:49.330287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:49.384798 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.055 seconds
[0m11:55:49.386790 [debug] [ThreadPool]: On list_f1: Close
[0m11:55:49.389749 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m11:55:49.394789 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m11:55:49.395796 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m11:55:49.395796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:55:49.430421 [debug] [ThreadPool]: SQL status: BEGIN in 0.034 seconds
[0m11:55:49.431307 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m11:55:49.431307 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m11:55:49.441410 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.010 seconds
[0m11:55:49.443391 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m11:55:49.444287 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m11:55:49.453390 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:49.454295 [debug] [MainThread]: On master: BEGIN
[0m11:55:49.454295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:55:49.490500 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m11:55:49.490500 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:49.490500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:55:49.499453 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m11:55:49.501460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4BDC2680>]}
[0m11:55:49.501460 [debug] [MainThread]: On master: ROLLBACK
[0m11:55:49.502446 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:49.503549 [debug] [MainThread]: On master: BEGIN
[0m11:55:49.503549 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m11:55:49.504850 [debug] [MainThread]: On master: COMMIT
[0m11:55:49.504850 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:49.505884 [debug] [MainThread]: On master: COMMIT
[0m11:55:49.505884 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:55:49.506955 [debug] [MainThread]: On master: Close
[0m11:55:49.514979 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_car_data
[0m11:55:49.515977 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_drivers
[0m11:55:49.515977 [debug] [Thread-3 (]: Began running node model.f1_analytics.stg_intervals
[0m11:55:49.516978 [debug] [Thread-4 (]: Began running node model.f1_analytics.stg_laps
[0m11:55:49.516978 [info ] [Thread-1 (]: 1 of 10 START sql view model f1_data.stg_car_data .............................. [RUN]
[0m11:55:49.517934 [info ] [Thread-2 (]: 2 of 10 START sql view model f1_data.stg_drivers ............................... [RUN]
[0m11:55:49.518929 [info ] [Thread-3 (]: 3 of 10 START sql view model f1_data.stg_intervals ............................. [RUN]
[0m11:55:49.520036 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_car_data'
[0m11:55:49.518929 [info ] [Thread-4 (]: 4 of 10 START sql view model f1_data.stg_laps .................................. [RUN]
[0m11:55:49.520950 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.stg_drivers'
[0m11:55:49.521924 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.stg_intervals'
[0m11:55:49.521924 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_car_data
[0m11:55:49.523438 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.stg_laps'
[0m11:55:49.523438 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_drivers
[0m11:55:49.523438 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.stg_intervals
[0m11:55:49.530725 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_car_data"
[0m11:55:49.531750 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.stg_laps
[0m11:55:49.539813 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_drivers"
[0m11:55:49.542794 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m11:55:49.548611 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.stg_laps"
[0m11:55:49.549622 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_car_data
[0m11:55:49.552246 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_drivers
[0m11:55:49.579496 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_car_data"
[0m11:55:49.582495 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_drivers"
[0m11:55:49.583393 [debug] [Thread-3 (]: Began executing node model.f1_analytics.stg_intervals
[0m11:55:49.583393 [debug] [Thread-4 (]: Began executing node model.f1_analytics.stg_laps
[0m11:55:49.587741 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m11:55:49.588748 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m11:55:49.589641 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m11:55:49.592643 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.stg_laps"
[0m11:55:49.593654 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: BEGIN
[0m11:55:49.595630 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m11:55:49.595630 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: BEGIN
[0m11:55:49.596669 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:55:49.597648 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m11:55:49.598728 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: BEGIN
[0m11:55:49.599728 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:55:49.599728 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: BEGIN
[0m11:55:49.599728 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m11:55:49.601149 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m11:55:49.649165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m11:55:49.649165 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m11:55:49.649165 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */

  create view "f1"."f1_data"."stg_car_data__dbt_tmp"
    
    
  as (
    

SELECT
    session_key,
    driver_number,
    date,
    rpm,
    speed,
    throttle,
    brake,
    drs
FROM "f1"."f1_data"."car_data"
  );
[0m11:55:49.650766 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m11:55:49.650766 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m11:55:49.651789 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "drs" does not exist
LINE 17:     drs
             ^

[0m11:55:49.651789 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */

  create view "f1"."f1_data"."stg_drivers__dbt_tmp"
    
    
  as (
    

with raw as(
    select *,
           row_number() over (partition by driver_number,session_key, full_name,team_name order by full_name) as rn
           from "f1"."f1_data"."drivers"
)
SELECT
  CAST(driver_number AS INT)           AS driver_number,
  session_key,
  BROADCAST_NAME                       as broadcast_name,
  FULL_NAME                            AS full_name,
  name_acronym,
  team_name,
  team_colour,
  first_name,
  last_name,
  country_code
FROM raw
WHERE rn=1
  );
[0m11:55:49.652835 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: ROLLBACK
[0m11:55:49.652835 [debug] [Thread-4 (]: SQL status: BEGIN in 0.052 seconds
[0m11:55:49.653850 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: Close
[0m11:55:49.655270 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m11:55:49.657101 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */

  create view "f1"."f1_data"."stg_laps__dbt_tmp"
    
    
  as (
    

select
        session_key,
        driver_number,
        DATE_TRUNC('second', date_start) AS date_start,
        DATEADD(second, lap_duration,date_start) AS date_end,
        lap_duration,
        lap_number,
        is_pit_out_lap,
        duration_sector_1,
        duration_sector_2,
        duration_sector_3,
from "f1"."f1_data"."laps"
where lap_duration is not null
  );
[0m11:55:49.658113 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 20: from "f1"."f1_data"."laps"
         ^

[0m11:55:49.659112 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: ROLLBACK
[0m11:55:49.660113 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: Close
[0m11:55:49.671460 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m11:55:49.676972 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m11:55:49.676972 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
alter table "f1"."f1_data"."stg_drivers__dbt_tmp" rename to "stg_drivers"
[0m11:55:49.679137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:55:49.690958 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m11:55:49.691959 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m11:55:49.691959 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m11:55:49.694954 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m11:55:49.701958 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_drivers__dbt_backup"
[0m11:55:49.705956 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m11:55:49.706955 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
drop view if exists "f1"."f1_data"."stg_drivers__dbt_backup" cascade
[0m11:55:49.707951 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:55:49.710001 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: Close
[0m11:55:49.713593 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4BE1D930>]}
[0m11:55:49.716597 [info ] [Thread-2 (]: 2 of 10 OK created sql view model f1_data.stg_drivers .......................... [[32mCREATE VIEW[0m in 0.19s]
[0m11:55:49.717589 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_drivers
[0m11:55:49.718592 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_meeting
[0m11:55:49.719604 [info ] [Thread-2 (]: 5 of 10 START sql view model f1_data.stg_meeting ............................... [RUN]
[0m11:55:49.720590 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_drivers, now model.f1_analytics.stg_meeting)
[0m11:55:49.721595 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_meeting
[0m11:55:49.724129 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_meeting"
[0m11:55:49.725131 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_meeting
[0m11:55:49.729319 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_meeting"
[0m11:55:49.731294 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m11:55:49.731294 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: BEGIN
[0m11:55:49.731294 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:55:49.766796 [debug] [Thread-3 (]: SQL status: BEGIN in 0.166 seconds
[0m11:55:49.766796 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m11:55:49.767821 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */

  create view "f1"."f1_data"."stg_intervals__dbt_tmp"
    
    
  as (
    


   SELECT
    session_key,
    driver_number,
    date,
    CASE
        WHEN gap_to_leader = 'None' OR gap_to_leader LIKE '%L%' THEN NULL
        ELSE gap_to_leader
    END AS gap_to_leader,
    CASE
        WHEN interval = 'None' OR interval LIKE '%L%' THEN NULL
        ELSE interval
    END AS gap_to_next
FROM "f1"."f1_data"."intervals"
  );
[0m11:55:49.773328 [debug] [Thread-2 (]: SQL status: BEGIN in 0.042 seconds
[0m11:55:49.774385 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m11:55:49.775394 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m11:55:49.775394 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */

  create view "f1"."f1_data"."stg_meeting__dbt_tmp"
    
    
  as (
    

    select
            meeting_key,
            meeting_name,
            meeting_official_name,
            circuit_short_name,
            country_name,
            date_start,
            year
from "f1"."f1_data"."meetings"
  );
[0m11:55:49.778436 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m11:55:49.779421 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
alter table "f1"."f1_data"."stg_intervals__dbt_tmp" rename to "stg_intervals"
[0m11:55:49.780119 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:55:49.782146 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: COMMIT
[0m11:55:49.782146 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m11:55:49.783134 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: COMMIT
[0m11:55:49.784676 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m11:55:49.785661 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m11:55:49.785661 [debug] [Thread-4 (]: Database Error in model stg_laps (f1_analytics/models\staging\stg_laps.sql)
  syntax error at or near "from"
  LINE 20: from "f1"."f1_data"."laps"
           ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_laps.sql
[0m11:55:49.786675 [debug] [Thread-1 (]: Database Error in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)
  column "drs" does not exist
  LINE 17:     drs
               ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_car_data.sql
[0m11:55:49.788666 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."stg_intervals__dbt_backup"
[0m11:55:49.791687 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m11:55:49.792679 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4BE1EEF0>]}
[0m11:55:49.792679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4BDC2680>]}
[0m11:55:49.793683 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m11:55:49.794680 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
alter table "f1"."f1_data"."stg_meeting__dbt_tmp" rename to "stg_meeting"
[0m11:55:49.795791 [error] [Thread-4 (]: 4 of 10 ERROR creating sql view model f1_data.stg_laps ......................... [[31mERROR[0m in 0.27s]
[0m11:55:49.796802 [error] [Thread-1 (]: 1 of 10 ERROR creating sql view model f1_data.stg_car_data ..................... [[31mERROR[0m in 0.27s]
[0m11:55:49.796802 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
drop view if exists "f1"."f1_data"."stg_intervals__dbt_backup" cascade
[0m11:55:49.798255 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:55:49.799341 [debug] [Thread-4 (]: Finished running node model.f1_analytics.stg_laps
[0m11:55:49.799341 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_car_data
[0m11:55:49.801468 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: COMMIT
[0m11:55:49.801468 [debug] [Thread-4 (]: Began running node model.f1_analytics.stg_pit
[0m11:55:49.802558 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m11:55:49.803515 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_laps' to be skipped because of status 'error'.  Reason: Database Error in model stg_laps (f1_analytics/models\staging\stg_laps.sql)
  syntax error at or near "from"
  LINE 20: from "f1"."f1_data"."laps"
           ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_laps.sql.
[0m11:55:49.804027 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_position
[0m11:55:49.804027 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m11:55:49.806375 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: Close
[0m11:55:49.805043 [info ] [Thread-4 (]: 6 of 10 START sql view model f1_data.stg_pit ................................... [RUN]
[0m11:55:49.807496 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_car_data' to be skipped because of status 'error'.  Reason: Database Error in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)
  column "drs" does not exist
  LINE 17:     drs
               ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_car_data.sql.
[0m11:55:49.808533 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: COMMIT
[0m11:55:49.808533 [info ] [Thread-1 (]: 7 of 10 START sql view model f1_data.stg_position .............................. [RUN]
[0m11:55:49.809508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4C2CDC90>]}
[0m11:55:49.811514 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_laps, now model.f1_analytics.stg_pit)
[0m11:55:49.816028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_car_data, now model.f1_analytics.stg_position)
[0m11:55:49.817045 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m11:55:49.818103 [info ] [Thread-3 (]: 3 of 10 OK created sql view model f1_data.stg_intervals ........................ [[32mCREATE VIEW[0m in 0.29s]
[0m11:55:49.819077 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.stg_pit
[0m11:55:49.820126 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_position
[0m11:55:49.823120 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_meeting__dbt_backup"
[0m11:55:49.823711 [debug] [Thread-3 (]: Finished running node model.f1_analytics.stg_intervals
[0m11:55:49.827648 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.stg_pit"
[0m11:55:49.831651 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_position"
[0m11:55:49.833636 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m11:55:49.833636 [debug] [Thread-3 (]: Began running node model.f1_analytics.stg_sessions
[0m11:55:49.835554 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
drop view if exists "f1"."f1_data"."stg_meeting__dbt_backup" cascade
[0m11:55:49.835554 [debug] [Thread-4 (]: Began executing node model.f1_analytics.stg_pit
[0m11:55:49.837614 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_position
[0m11:55:49.836615 [info ] [Thread-3 (]: 8 of 10 START sql view model f1_data.stg_sessions .............................. [RUN]
[0m11:55:49.843063 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.stg_pit"
[0m11:55:49.843063 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m11:55:49.848116 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_position"
[0m11:55:49.849062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_intervals, now model.f1_analytics.stg_sessions)
[0m11:55:49.851157 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: Close
[0m11:55:49.852067 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m11:55:49.853599 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.stg_sessions
[0m11:55:49.853995 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m11:55:49.855104 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4C40A440>]}
[0m11:55:49.856007 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: BEGIN
[0m11:55:49.859180 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m11:55:49.860284 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: BEGIN
[0m11:55:49.861293 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m11:55:49.860284 [info ] [Thread-2 (]: 5 of 10 OK created sql view model f1_data.stg_meeting .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m11:55:49.862145 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:55:49.862145 [debug] [Thread-3 (]: Began executing node model.f1_analytics.stg_sessions
[0m11:55:49.863157 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_meeting
[0m11:55:49.867171 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m11:55:49.868174 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_stints
[0m11:55:49.869176 [info ] [Thread-2 (]: 9 of 10 START sql view model f1_data.stg_stints ................................ [RUN]
[0m11:55:49.871177 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m11:55:49.872183 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_meeting, now model.f1_analytics.stg_stints)
[0m11:55:49.873756 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m11:55:49.874939 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_stints
[0m11:55:49.876956 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:55:49.883661 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_stints"
[0m11:55:49.886857 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_stints
[0m11:55:49.892481 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_stints"
[0m11:55:49.894526 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m11:55:49.895568 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: BEGIN
[0m11:55:49.896839 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m11:55:49.910967 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m11:55:49.910967 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m11:55:49.912328 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */

  create view "f1"."f1_data"."stg_pit__dbt_tmp"
    
    
  as (
    

    select *
    from "f1"."f1_data"."pit"
    where pit_duration is not null
  );
[0m11:55:49.912328 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m11:55:49.913361 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m11:55:49.913361 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */

  create view "f1"."f1_data"."stg_position__dbt_tmp"
    
    
  as (
    

    select *
    from "f1"."f1_data"."position"
  );
[0m11:55:49.916888 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:55:49.919892 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m11:55:49.920891 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m11:55:49.920891 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
alter table "f1"."f1_data"."stg_pit__dbt_tmp" rename to "stg_pit"
[0m11:55:49.924645 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m11:55:49.925642 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
alter table "f1"."f1_data"."stg_position__dbt_tmp" rename to "stg_position"
[0m11:55:49.926598 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m11:55:49.926598 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:55:49.927656 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:55:49.927656 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m11:55:49.929646 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: COMMIT
[0m11:55:49.930644 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: COMMIT
[0m11:55:49.930644 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    

with raw as(
    select * from "f1"."f1_data"."sessions"
),
    raw1 as (select *
             from "f1"."f1_data"."meetings"
             )
SELECT
  CAST(s.session_key AS INT)             AS session_key,
  CAST(s.meeting_key AS INT)             AS meeting_key,
  s.session_name                         AS session_name,
  s.session_type                         AS session_type,
  m.circuit_short_name,
  m.country_name,
  TO_TIMESTAMP_NTZ(s.date_start)         AS date_start,
  TO_TIMESTAMP_NTZ(s.date_end)           AS date_end,
  s.location                             AS location,
  extract(year,s.date_start)               as year
FROM raw s left join raw1 m on s.meeting_key=m.meeting_key
WHERE session_key IS NOT NULL and session_type in('Race', 'Qualifying')
  );
[0m11:55:49.931599 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m11:55:49.931599 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m11:55:49.932598 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: COMMIT
[0m11:55:49.932598 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 25:   extract(year,s.date_start)               as year
                       ^

[0m11:55:49.933589 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: COMMIT
[0m11:55:49.934587 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: ROLLBACK
[0m11:55:49.934587 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m11:55:49.935655 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: Close
[0m11:55:49.936302 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m11:55:49.938377 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."stg_pit__dbt_backup"
[0m11:55:49.941368 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_position__dbt_backup"
[0m11:55:49.942379 [debug] [Thread-3 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  syntax error at or near ","
  LINE 25:   extract(year,s.date_start)               as year
                         ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m11:55:49.943321 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m11:55:49.944321 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m11:55:49.945329 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4C2F3FA0>]}
[0m11:55:49.945329 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
drop view if exists "f1"."f1_data"."stg_pit__dbt_backup" cascade
[0m11:55:49.946318 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
drop view if exists "f1"."f1_data"."stg_position__dbt_backup" cascade
[0m11:55:49.946318 [error] [Thread-3 (]: 8 of 10 ERROR creating sql view model f1_data.stg_sessions ..................... [[31mERROR[0m in 0.10s]
[0m11:55:49.947343 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:55:49.948352 [debug] [Thread-3 (]: Finished running node model.f1_analytics.stg_sessions
[0m11:55:49.948352 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m11:55:49.950390 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: Close
[0m11:55:49.950390 [debug] [Thread-3 (]: Began running node model.f1_analytics.stg_weather
[0m11:55:49.951433 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  syntax error at or near ","
  LINE 25:   extract(year,s.date_start)               as year
                         ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m11:55:49.953362 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: Close
[0m11:55:49.954728 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4C2AEEC0>]}
[0m11:55:49.955779 [info ] [Thread-3 (]: 10 of 10 START sql view model f1_data.stg_weather .............................. [RUN]
[0m11:55:49.958011 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4C41E770>]}
[0m11:55:49.958011 [info ] [Thread-1 (]: 7 of 10 OK created sql view model f1_data.stg_position ......................... [[32mCREATE VIEW[0m in 0.14s]
[0m11:55:49.959070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_sessions, now model.f1_analytics.stg_weather)
[0m11:55:49.960433 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_position
[0m11:55:49.960433 [info ] [Thread-4 (]: 6 of 10 OK created sql view model f1_data.stg_pit .............................. [[32mCREATE VIEW[0m in 0.15s]
[0m11:55:49.961451 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.stg_weather
[0m11:55:49.962484 [debug] [Thread-4 (]: Finished running node model.f1_analytics.stg_pit
[0m11:55:49.965449 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.stg_weather"
[0m11:55:49.967485 [debug] [Thread-3 (]: Began executing node model.f1_analytics.stg_weather
[0m11:55:49.971520 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.stg_weather"
[0m11:55:49.973029 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m11:55:49.974280 [debug] [Thread-3 (]: On model.f1_analytics.stg_weather: BEGIN
[0m11:55:49.974792 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m11:55:50.011963 [debug] [Thread-3 (]: SQL status: BEGIN in 0.037 seconds
[0m11:55:50.012880 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m11:55:50.013849 [debug] [Thread-3 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */

  create view "f1"."f1_data"."stg_weather__dbt_tmp"
    
    
  as (
    


select *
FROM "f1"."f1_data"."weather"
  );
[0m11:55:50.017992 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m11:55:50.021389 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m11:55:50.021389 [debug] [Thread-3 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
alter table "f1"."f1_data"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m11:55:50.022397 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m11:55:50.024465 [debug] [Thread-3 (]: On model.f1_analytics.stg_weather: COMMIT
[0m11:55:50.024465 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m11:55:50.024465 [debug] [Thread-3 (]: On model.f1_analytics.stg_weather: COMMIT
[0m11:55:50.026823 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m11:55:50.029574 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."stg_weather__dbt_backup"
[0m11:55:50.031591 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m11:55:50.032362 [debug] [Thread-3 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
drop view if exists "f1"."f1_data"."stg_weather__dbt_backup" cascade
[0m11:55:50.033528 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:55:50.034655 [debug] [Thread-3 (]: On model.f1_analytics.stg_weather: Close
[0m11:55:50.035771 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4C49EC50>]}
[0m11:55:50.036323 [info ] [Thread-3 (]: 10 of 10 OK created sql view model f1_data.stg_weather ......................... [[32mCREATE VIEW[0m in 0.08s]
[0m11:55:50.037904 [debug] [Thread-3 (]: Finished running node model.f1_analytics.stg_weather
[0m11:55:50.038439 [debug] [Thread-2 (]: SQL status: BEGIN in 0.141 seconds
[0m11:55:50.039617 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m11:55:50.040145 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */

  create view "f1"."f1_data"."stg_stints__dbt_tmp"
    
    
  as (
    

    select *
    from "f1"."f1_data"."stints"
    where compound is not null and lap_start is not null and lap_end is not null
  );
[0m11:55:50.044568 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m11:55:50.048074 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m11:55:50.049195 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
alter table "f1"."f1_data"."stg_stints__dbt_tmp" rename to "stg_stints"
[0m11:55:50.050349 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m11:55:50.052122 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: COMMIT
[0m11:55:50.052771 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m11:55:50.053414 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: COMMIT
[0m11:55:50.055174 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m11:55:50.057706 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_stints__dbt_backup"
[0m11:55:50.058352 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m11:55:50.058932 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
drop view if exists "f1"."f1_data"."stg_stints__dbt_backup" cascade
[0m11:55:50.059490 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m11:55:50.061097 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: Close
[0m11:55:50.062089 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f91ecfc3-ebcb-4bfd-8006-225726aef407', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4C40A440>]}
[0m11:55:50.063097 [info ] [Thread-2 (]: 9 of 10 OK created sql view model f1_data.stg_stints ........................... [[32mCREATE VIEW[0m in 0.19s]
[0m11:55:50.064105 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_stints
[0m11:55:50.066586 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:50.067599 [debug] [MainThread]: On master: BEGIN
[0m11:55:50.067599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:55:50.104664 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m11:55:50.105662 [debug] [MainThread]: On master: COMMIT
[0m11:55:50.105662 [debug] [MainThread]: Using postgres connection "master"
[0m11:55:50.106682 [debug] [MainThread]: On master: COMMIT
[0m11:55:50.106682 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m11:55:50.108069 [debug] [MainThread]: On master: Close
[0m11:55:50.108577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:55:50.109129 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m11:55:50.109129 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m11:55:50.110141 [debug] [MainThread]: Connection 'model.f1_analytics.stg_position' was properly closed.
[0m11:55:50.110141 [debug] [MainThread]: Connection 'model.f1_analytics.stg_stints' was properly closed.
[0m11:55:50.110141 [debug] [MainThread]: Connection 'model.f1_analytics.stg_weather' was properly closed.
[0m11:55:50.110141 [debug] [MainThread]: Connection 'model.f1_analytics.stg_pit' was properly closed.
[0m11:55:50.111594 [info ] [MainThread]: 
[0m11:55:50.112619 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 13.02 seconds (13.02s).
[0m11:55:50.114615 [debug] [MainThread]: Command end result
[0m11:55:50.134816 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m11:55:50.138229 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m11:55:50.144215 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m11:55:50.144215 [info ] [MainThread]: 
[0m11:55:50.145212 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:55:50.145212 [info ] [MainThread]: 
[0m11:55:50.146200 [error] [MainThread]: [31mFailure in model stg_laps (f1_analytics/models\staging\stg_laps.sql)[0m
[0m11:55:50.147212 [error] [MainThread]:   Database Error in model stg_laps (f1_analytics/models\staging\stg_laps.sql)
  syntax error at or near "from"
  LINE 20: from "f1"."f1_data"."laps"
           ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_laps.sql
[0m11:55:50.147212 [info ] [MainThread]: 
[0m11:55:50.148196 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_laps.sql
[0m11:55:50.149238 [info ] [MainThread]: 
[0m11:55:50.149238 [error] [MainThread]: [31mFailure in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)[0m
[0m11:55:50.150251 [error] [MainThread]:   Database Error in model stg_car_data (f1_analytics/models\staging\stg_car_data.sql)
  column "drs" does not exist
  LINE 17:     drs
               ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_car_data.sql
[0m11:55:50.151237 [info ] [MainThread]: 
[0m11:55:50.151237 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_car_data.sql
[0m11:55:50.152277 [info ] [MainThread]: 
[0m11:55:50.152277 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m11:55:50.152277 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  syntax error at or near ","
  LINE 25:   extract(year,s.date_start)               as year
                         ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m11:55:50.153618 [info ] [MainThread]: 
[0m11:55:50.154525 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m11:55:50.155532 [info ] [MainThread]: 
[0m11:55:50.155532 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=10
[0m11:55:50.157226 [debug] [MainThread]: Command `dbt run` failed at 11:55:50.157226 after 14.02 seconds
[0m11:55:50.158280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4946A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4A8DAB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027C4976D5A0>]}
[0m11:55:50.159817 [debug] [MainThread]: Flushing usage events
[0m11:55:50.621967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:18.925608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F544BA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5579CF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5579CD30>]}


============================== 12:00:18.931829 | 0c3f8cd4-1937-48c2-972e-9c592e3e257c ==============================
[0m12:00:18.931829 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:00:18.933351 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_laps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:00:19.109713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c3f8cd4-1937-48c2-972e-9c592e3e257c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5592CFA0>]}
[0m12:00:19.164251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c3f8cd4-1937-48c2-972e-9c592e3e257c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F54ED0070>]}
[0m12:00:19.165550 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:00:19.313396 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:00:19.460796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:00:19.461783 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_laps.sql
[0m12:00:19.753525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c3f8cd4-1937-48c2-972e-9c592e3e257c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F55BC1600>]}
[0m12:00:19.838215 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:00:19.841728 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:00:19.867210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c3f8cd4-1937-48c2-972e-9c592e3e257c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5592DCC0>]}
[0m12:00:19.868210 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:00:19.868210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c3f8cd4-1937-48c2-972e-9c592e3e257c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5592EF20>]}
[0m12:00:19.869713 [info ] [MainThread]: 
[0m12:00:19.870718 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:00:19.871719 [info ] [MainThread]: 
[0m12:00:19.871719 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:19.873754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:00:19.923350 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:00:19.923947 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:00:19.924952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:19.962650 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.037 seconds
[0m12:00:19.964234 [debug] [ThreadPool]: On list_f1: Close
[0m12:00:19.972068 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:00:19.980754 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:00:19.981858 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:00:19.981858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:20.018451 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m12:00:20.018451 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:00:20.018451 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:00:20.024494 [debug] [ThreadPool]: SQL status: SELECT 18 in 0.004 seconds
[0m12:00:20.025489 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:00:20.026504 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:00:20.035643 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:20.035643 [debug] [MainThread]: On master: BEGIN
[0m12:00:20.036658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:20.070700 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m12:00:20.071803 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:20.071803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:00:20.086112 [debug] [MainThread]: SQL status: SELECT 7 in 0.013 seconds
[0m12:00:20.088219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c3f8cd4-1937-48c2-972e-9c592e3e257c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F51AFD540>]}
[0m12:00:20.088219 [debug] [MainThread]: On master: ROLLBACK
[0m12:00:20.089794 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:20.090909 [debug] [MainThread]: On master: BEGIN
[0m12:00:20.091816 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:00:20.092428 [debug] [MainThread]: On master: COMMIT
[0m12:00:20.093962 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:20.093962 [debug] [MainThread]: On master: COMMIT
[0m12:00:20.094972 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:00:20.095981 [debug] [MainThread]: On master: Close
[0m12:00:20.103712 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_laps
[0m12:00:20.103712 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.stg_laps ................................... [RUN]
[0m12:00:20.105158 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_laps'
[0m12:00:20.106144 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_laps
[0m12:00:20.115175 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_laps"
[0m12:00:20.116183 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_laps
[0m12:00:20.148824 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_laps"
[0m12:00:20.149825 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m12:00:20.149825 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: BEGIN
[0m12:00:20.150832 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:00:20.197542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m12:00:20.198575 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m12:00:20.199559 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */

  create view "f1"."f1_data"."stg_laps__dbt_tmp"
    
    
  as (
    

select
    session_key,
    driver_number,
    date_trunc('second', date_start) as date_start,
    date_start + interval '1 second' * lap_duration as date_end,
    lap_duration,
    lap_number,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3
from "f1"."f1_data"."laps"
where lap_duration is not null
  );
[0m12:00:20.207060 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:00:20.214241 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m12:00:20.215251 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
alter table "f1"."f1_data"."stg_laps__dbt_tmp" rename to "stg_laps"
[0m12:00:20.216235 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:00:20.227898 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: COMMIT
[0m12:00:20.228915 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m12:00:20.228915 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: COMMIT
[0m12:00:20.230877 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:00:20.238185 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_laps__dbt_backup"
[0m12:00:20.242729 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m12:00:20.242729 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
drop view if exists "f1"."f1_data"."stg_laps__dbt_backup" cascade
[0m12:00:20.244233 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:00:20.246249 [debug] [Thread-1 (]: On model.f1_analytics.stg_laps: Close
[0m12:00:20.248237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c3f8cd4-1937-48c2-972e-9c592e3e257c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5592C880>]}
[0m12:00:20.249742 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.stg_laps .............................. [[32mCREATE VIEW[0m in 0.14s]
[0m12:00:20.250750 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_laps
[0m12:00:20.253379 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:20.253379 [debug] [MainThread]: On master: BEGIN
[0m12:00:20.253379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:20.290975 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:00:20.291974 [debug] [MainThread]: On master: COMMIT
[0m12:00:20.291974 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:20.293479 [debug] [MainThread]: On master: COMMIT
[0m12:00:20.294483 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:00:20.295496 [debug] [MainThread]: On master: Close
[0m12:00:20.297649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:20.298202 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:00:20.299729 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:00:20.301744 [debug] [MainThread]: Connection 'model.f1_analytics.stg_laps' was properly closed.
[0m12:00:20.302744 [info ] [MainThread]: 
[0m12:00:20.304253 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:00:20.305765 [debug] [MainThread]: Command end result
[0m12:00:20.330530 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:00:20.333549 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:00:20.340570 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:00:20.341396 [info ] [MainThread]: 
[0m12:00:20.342699 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:20.343222 [info ] [MainThread]: 
[0m12:00:20.343734 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:00:20.344738 [debug] [MainThread]: Command `dbt run` succeeded at 12:00:20.344738 after 1.50 seconds
[0m12:00:20.345740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F544BA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F56F74DF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F5575E050>]}
[0m12:00:20.345740 [debug] [MainThread]: Flushing usage events
[0m12:00:20.653948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:48.936768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E2C6E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E3F60F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E3F60D90>]}


============================== 12:00:48.939860 | 0a9c590b-6c98-4762-a11e-253401c7372a ==============================
[0m12:00:48.939860 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:00:48.940873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select stg_car_data', 'send_anonymous_usage_stats': 'True'}
[0m12:00:49.118390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a9c590b-6c98-4762-a11e-253401c7372a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E403D480>]}
[0m12:00:49.170529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a9c590b-6c98-4762-a11e-253401c7372a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E3F62C80>]}
[0m12:00:49.171529 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:00:49.322677 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:00:49.495032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:00:49.496037 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_car_data.sql
[0m12:00:49.784489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a9c590b-6c98-4762-a11e-253401c7372a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E4011D50>]}
[0m12:00:49.869635 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:00:49.873680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:00:49.898217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a9c590b-6c98-4762-a11e-253401c7372a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E403CE80>]}
[0m12:00:49.898217 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:00:49.899750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9c590b-6c98-4762-a11e-253401c7372a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E412A2F0>]}
[0m12:00:49.900778 [info ] [MainThread]: 
[0m12:00:49.901771 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:00:49.901771 [info ] [MainThread]: 
[0m12:00:49.902757 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:49.905273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:00:49.957472 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:00:49.958488 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:00:49.958488 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:49.996849 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m12:00:49.998849 [debug] [ThreadPool]: On list_f1: Close
[0m12:00:50.011293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:00:50.018838 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:00:50.018838 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:00:50.019824 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:50.057253 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m12:00:50.057253 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:00:50.058301 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:00:50.065429 [debug] [ThreadPool]: SQL status: SELECT 19 in 0.007 seconds
[0m12:00:50.067461 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:00:50.068429 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:00:50.076458 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:50.076458 [debug] [MainThread]: On master: BEGIN
[0m12:00:50.077458 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:50.114322 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:00:50.115341 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:50.115341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:00:50.123959 [debug] [MainThread]: SQL status: SELECT 8 in 0.008 seconds
[0m12:00:50.126984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a9c590b-6c98-4762-a11e-253401c7372a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E3F03DF0>]}
[0m12:00:50.126984 [debug] [MainThread]: On master: ROLLBACK
[0m12:00:50.127972 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:50.127972 [debug] [MainThread]: On master: BEGIN
[0m12:00:50.128983 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:00:50.130004 [debug] [MainThread]: On master: COMMIT
[0m12:00:50.130004 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:50.130991 [debug] [MainThread]: On master: COMMIT
[0m12:00:50.130991 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:00:50.132378 [debug] [MainThread]: On master: Close
[0m12:00:50.137039 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_car_data
[0m12:00:50.137039 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.stg_car_data ............................... [RUN]
[0m12:00:50.138354 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_car_data'
[0m12:00:50.138354 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_car_data
[0m12:00:50.145443 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_car_data"
[0m12:00:50.146475 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_car_data
[0m12:00:50.176553 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_car_data"
[0m12:00:50.177516 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m12:00:50.177516 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: BEGIN
[0m12:00:50.178559 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:00:50.215482 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:00:50.216502 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m12:00:50.216502 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */

  create view "f1"."f1_data"."stg_car_data__dbt_tmp"
    
    
  as (
    

SELECT
    session_key,
    driver_number,
    date,
    rpm,
    speed,
    throttle,
    brake
FROM "f1"."f1_data"."car_data"
  );
[0m12:00:50.222531 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:00:50.228111 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m12:00:50.229737 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
alter table "f1"."f1_data"."stg_car_data__dbt_tmp" rename to "stg_car_data"
[0m12:00:50.230836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:00:50.243681 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: COMMIT
[0m12:00:50.244721 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m12:00:50.245728 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: COMMIT
[0m12:00:50.247721 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:00:50.253776 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_car_data__dbt_backup"
[0m12:00:50.258408 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m12:00:50.258408 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
drop view if exists "f1"."f1_data"."stg_car_data__dbt_backup" cascade
[0m12:00:50.259959 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:00:50.261980 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: Close
[0m12:00:50.264934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a9c590b-6c98-4762-a11e-253401c7372a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E5B53EE0>]}
[0m12:00:50.266306 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.stg_car_data .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:00:50.267313 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_car_data
[0m12:00:50.268313 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:50.269868 [debug] [MainThread]: On master: BEGIN
[0m12:00:50.269868 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:50.306621 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:00:50.308196 [debug] [MainThread]: On master: COMMIT
[0m12:00:50.308196 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:50.309719 [debug] [MainThread]: On master: COMMIT
[0m12:00:50.310762 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:00:50.311731 [debug] [MainThread]: On master: Close
[0m12:00:50.313737 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:50.314265 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:00:50.314265 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:00:50.315435 [debug] [MainThread]: Connection 'model.f1_analytics.stg_car_data' was properly closed.
[0m12:00:50.316003 [info ] [MainThread]: 
[0m12:00:50.316003 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m12:00:50.318595 [debug] [MainThread]: Command end result
[0m12:00:50.343509 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:00:50.345579 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:00:50.353658 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:00:50.353658 [info ] [MainThread]: 
[0m12:00:50.355060 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:50.356003 [info ] [MainThread]: 
[0m12:00:50.357044 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:00:50.357044 [debug] [MainThread]: Command `dbt run` succeeded at 12:00:50.357044 after 1.50 seconds
[0m12:00:50.358098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E2C6E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E2D2D4E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E45C7EE0>]}
[0m12:00:50.358098 [debug] [MainThread]: Flushing usage events
[0m12:00:50.671211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:02:33.616648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769347E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027694780F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027694780D90>]}


============================== 12:02:33.625682 | b5b78c6c-2060-4fd9-a737-f673b371225a ==============================
[0m12:02:33.625682 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:02:33.626681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select stg_sessions', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:02:33.806202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5b78c6c-2060-4fd9-a737-f673b371225a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769485D480>]}
[0m12:02:33.860574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5b78c6c-2060-4fd9-a737-f673b371225a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027694782C80>]}
[0m12:02:33.862574 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:02:34.023493 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:02:34.176573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:02:34.178574 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m12:02:34.493757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5b78c6c-2060-4fd9-a737-f673b371225a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027694833040>]}
[0m12:02:34.578961 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:02:34.581058 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:02:34.608744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5b78c6c-2060-4fd9-a737-f673b371225a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027694DE67D0>]}
[0m12:02:34.608744 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:02:34.609745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b78c6c-2060-4fd9-a737-f673b371225a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027695E82860>]}
[0m12:02:34.611750 [info ] [MainThread]: 
[0m12:02:34.611750 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:02:34.612834 [info ] [MainThread]: 
[0m12:02:34.613753 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:02:34.615307 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:02:34.669828 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:02:34.670835 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:02:34.671835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:34.712501 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.041 seconds
[0m12:02:34.714114 [debug] [ThreadPool]: On list_f1: Close
[0m12:02:34.720223 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:02:34.726716 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:02:34.727699 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:02:34.727699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:34.765699 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m12:02:34.766217 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:02:34.766217 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:02:34.775617 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.009 seconds
[0m12:02:34.777651 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:02:34.778623 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:02:34.785741 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:34.786756 [debug] [MainThread]: On master: BEGIN
[0m12:02:34.787749 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:34.823552 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:02:34.824558 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:34.825562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:02:34.833614 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m12:02:34.836499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5b78c6c-2060-4fd9-a737-f673b371225a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276949701F0>]}
[0m12:02:34.837418 [debug] [MainThread]: On master: ROLLBACK
[0m12:02:34.837418 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:34.838478 [debug] [MainThread]: On master: BEGIN
[0m12:02:34.838478 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:02:34.838478 [debug] [MainThread]: On master: COMMIT
[0m12:02:34.839986 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:34.839986 [debug] [MainThread]: On master: COMMIT
[0m12:02:34.841044 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:02:34.841044 [debug] [MainThread]: On master: Close
[0m12:02:34.845803 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m12:02:34.846810 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.stg_sessions ............................... [RUN]
[0m12:02:34.847870 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_sessions'
[0m12:02:34.847870 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m12:02:34.854653 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m12:02:34.856610 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m12:02:34.893826 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m12:02:34.895860 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m12:02:34.897679 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m12:02:34.898616 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:02:34.938886 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:02:34.939867 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m12:02:34.939867 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    

with raw as (
    select * from "f1"."f1_data"."sessions"
),
raw1 as (
    select * from "f1"."f1_data"."meetings"
)
select
  cast(s.session_key as int)           as session_key,
  cast(s.meeting_key as int)           as meeting_key,
  s.session_name                       as session_name,
  s.session_type                       as session_type,
  m.circuit_short_name,
  m.country_name,
  s.date_start::timestamp              as date_start,
  s.date_end::timestamp                as date_end,
  s.location                           as location,
  extract(year from s.date_start)      as year
from raw s
left join raw1 m on s.meeting_key = m.meeting_key
where session_key is not null
  and session_type in ('Race', 'Qualifying')
  );
[0m12:02:34.940882 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column s.session_name does not exist
LINE 18:   s.session_name                       as session_name,
           ^
HINT:  Perhaps you meant to reference the column "s.session_type".

[0m12:02:34.941881 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: ROLLBACK
[0m12:02:34.942882 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: Close
[0m12:02:34.946442 [debug] [Thread-1 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column s.session_name does not exist
  LINE 18:   s.session_name                       as session_name,
             ^
  HINT:  Perhaps you meant to reference the column "s.session_type".
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m12:02:34.948433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5b78c6c-2060-4fd9-a737-f673b371225a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276963F3E20>]}
[0m12:02:34.948433 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.stg_sessions ...................... [[31mERROR[0m in 0.10s]
[0m12:02:34.949947 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m12:02:34.950974 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column s.session_name does not exist
  LINE 18:   s.session_name                       as session_name,
             ^
  HINT:  Perhaps you meant to reference the column "s.session_type".
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m12:02:34.953541 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:34.953541 [debug] [MainThread]: On master: BEGIN
[0m12:02:34.954559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:34.998027 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m12:02:34.999026 [debug] [MainThread]: On master: COMMIT
[0m12:02:35.000037 [debug] [MainThread]: Using postgres connection "master"
[0m12:02:35.001034 [debug] [MainThread]: On master: COMMIT
[0m12:02:35.002034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:02:35.003549 [debug] [MainThread]: On master: Close
[0m12:02:35.005217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:35.006236 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:02:35.007235 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:02:35.008233 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was properly closed.
[0m12:02:35.009052 [info ] [MainThread]: 
[0m12:02:35.010068 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:02:35.011086 [debug] [MainThread]: Command end result
[0m12:02:35.040971 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:02:35.044522 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:02:35.049836 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:02:35.051366 [info ] [MainThread]: 
[0m12:02:35.052388 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:02:35.053884 [info ] [MainThread]: 
[0m12:02:35.054904 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m12:02:35.055897 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column s.session_name does not exist
  LINE 18:   s.session_name                       as session_name,
             ^
  HINT:  Perhaps you meant to reference the column "s.session_type".
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m12:02:35.055897 [info ] [MainThread]: 
[0m12:02:35.056906 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m12:02:35.057897 [info ] [MainThread]: 
[0m12:02:35.058911 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:02:35.059897 [debug] [MainThread]: Command `dbt run` failed at 12:02:35.059897 after 1.54 seconds
[0m12:02:35.060922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769347E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002769485FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000276937DAF20>]}
[0m12:02:35.061966 [debug] [MainThread]: Flushing usage events
[0m12:02:35.373343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:03:06.278438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FBCB2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FDF80F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FDF80D90>]}


============================== 12:03:06.284022 | c28548a2-6755-434b-ba7e-ef36fcdc638e ==============================
[0m12:03:06.284022 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:03:06.285029 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_sessions', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:03:06.467392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c28548a2-6755-434b-ba7e-ef36fcdc638e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FE05C250>]}
[0m12:03:06.524110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c28548a2-6755-434b-ba7e-ef36fcdc638e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FDF48FA0>]}
[0m12:03:06.526124 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:03:06.683633 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:03:06.887219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:03:06.888205 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m12:03:07.191989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c28548a2-6755-434b-ba7e-ef36fcdc638e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FD767310>]}
[0m12:03:07.278964 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:03:07.281968 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:03:07.306736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c28548a2-6755-434b-ba7e-ef36fcdc638e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FDF49540>]}
[0m12:03:07.307753 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:03:07.308743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c28548a2-6755-434b-ba7e-ef36fcdc638e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FF5B6020>]}
[0m12:03:07.310752 [info ] [MainThread]: 
[0m12:03:07.311740 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:03:07.312756 [info ] [MainThread]: 
[0m12:03:07.313741 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:03:07.315800 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:03:07.373483 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:03:07.374491 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:03:07.374491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:07.412837 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m12:03:07.414347 [debug] [ThreadPool]: On list_f1: Close
[0m12:03:07.420862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:03:07.427632 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:03:07.427632 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:03:07.428640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:07.465000 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m12:03:07.465000 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:03:07.466042 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:03:07.473219 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.007 seconds
[0m12:03:07.474818 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:03:07.475819 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:03:07.482827 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:07.483828 [debug] [MainThread]: On master: BEGIN
[0m12:03:07.483828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:07.520906 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:03:07.521911 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:07.523423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:03:07.530534 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m12:03:07.532529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c28548a2-6755-434b-ba7e-ef36fcdc638e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FDF24BE0>]}
[0m12:03:07.533530 [debug] [MainThread]: On master: ROLLBACK
[0m12:03:07.534778 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:07.534778 [debug] [MainThread]: On master: BEGIN
[0m12:03:07.535779 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:03:07.535779 [debug] [MainThread]: On master: COMMIT
[0m12:03:07.535779 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:07.536779 [debug] [MainThread]: On master: COMMIT
[0m12:03:07.537382 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:03:07.538422 [debug] [MainThread]: On master: Close
[0m12:03:07.541964 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m12:03:07.541964 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.stg_sessions ............................... [RUN]
[0m12:03:07.543490 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_sessions'
[0m12:03:07.544528 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m12:03:07.550584 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m12:03:07.552588 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m12:03:07.585700 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m12:03:07.587708 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m12:03:07.588737 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m12:03:07.588737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:03:07.625878 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:03:07.627398 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m12:03:07.628019 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    

with raw as (
    select * from "f1"."f1_data"."sessions"
),
raw1 as (
    select * from "f1"."f1_data"."meetings"
)
select
  cast(s.session_key as int)           as session_key,
  cast(s.meeting_key as int)           as meeting_key,
  s.session_type                       as session_type,
  m.circuit_short_name,
  m.country_name,
  s.date_start::timestamp              as date_start,
  s.date_end::timestamp                as date_end,
  s.location                           as location,
  extract(year from s.date_start)      as year
from raw s
left join raw1 m on s.meeting_key = m.meeting_key
where session_key is not null
  and session_type in ('Race', 'Qualifying')
  );
[0m12:03:07.629536 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column s.location does not exist
LINE 23:   s.location                           as location,
           ^
HINT:  Perhaps you meant to reference the column "m.location".

[0m12:03:07.629536 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: ROLLBACK
[0m12:03:07.630567 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: Close
[0m12:03:07.633647 [debug] [Thread-1 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column s.location does not exist
  LINE 23:   s.location                           as location,
             ^
  HINT:  Perhaps you meant to reference the column "m.location".
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m12:03:07.636674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c28548a2-6755-434b-ba7e-ef36fcdc638e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FFBF3DC0>]}
[0m12:03:07.637676 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.stg_sessions ...................... [[31mERROR[0m in 0.09s]
[0m12:03:07.638654 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m12:03:07.638654 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column s.location does not exist
  LINE 23:   s.location                           as location,
             ^
  HINT:  Perhaps you meant to reference the column "m.location".
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m12:03:07.640654 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:07.641673 [debug] [MainThread]: On master: BEGIN
[0m12:03:07.641673 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:07.683931 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:03:07.684947 [debug] [MainThread]: On master: COMMIT
[0m12:03:07.684947 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:07.685950 [debug] [MainThread]: On master: COMMIT
[0m12:03:07.686946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:03:07.686946 [debug] [MainThread]: On master: Close
[0m12:03:07.687942 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:07.687942 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:03:07.688941 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:03:07.688941 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was properly closed.
[0m12:03:07.688941 [info ] [MainThread]: 
[0m12:03:07.689943 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m12:03:07.691954 [debug] [MainThread]: Command end result
[0m12:03:07.715179 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:03:07.718177 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:03:07.726309 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:03:07.727315 [info ] [MainThread]: 
[0m12:03:07.727315 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:03:07.728415 [info ] [MainThread]: 
[0m12:03:07.728415 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m12:03:07.729927 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column s.location does not exist
  LINE 23:   s.location                           as location,
             ^
  HINT:  Perhaps you meant to reference the column "m.location".
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m12:03:07.729927 [info ] [MainThread]: 
[0m12:03:07.730941 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m12:03:07.731941 [info ] [MainThread]: 
[0m12:03:07.731941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:03:07.732940 [debug] [MainThread]: Command `dbt run` failed at 12:03:07.732940 after 1.53 seconds
[0m12:03:07.733940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FBCB2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FF74F7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C4FCFB0940>]}
[0m12:03:07.734453 [debug] [MainThread]: Flushing usage events
[0m12:03:08.052594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:03:22.177361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9FCB2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA1F80F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA1F80D30>]}


============================== 12:03:22.180706 | d9de75c9-113f-43f1-bcd6-eb0f862345ff ==============================
[0m12:03:22.180706 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:03:22.181702 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_sessions', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:03:22.356166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd9de75c9-113f-43f1-bcd6-eb0f862345ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA205DBA0>]}
[0m12:03:22.411111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd9de75c9-113f-43f1-bcd6-eb0f862345ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA1F82C20>]}
[0m12:03:22.413617 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:03:22.559724 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:03:22.761887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:03:22.762887 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m12:03:23.057077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd9de75c9-113f-43f1-bcd6-eb0f862345ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA1F24C40>]}
[0m12:03:23.141802 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:03:23.145320 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:03:23.169877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd9de75c9-113f-43f1-bcd6-eb0f862345ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA216F850>]}
[0m12:03:23.170879 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:03:23.170879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9de75c9-113f-43f1-bcd6-eb0f862345ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA216EB30>]}
[0m12:03:23.173946 [info ] [MainThread]: 
[0m12:03:23.174962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:03:23.174962 [info ] [MainThread]: 
[0m12:03:23.175968 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:03:23.177973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:03:23.226950 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:03:23.227953 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:03:23.227953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:23.279638 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.051 seconds
[0m12:03:23.280750 [debug] [ThreadPool]: On list_f1: Close
[0m12:03:23.288134 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:03:23.295182 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:03:23.296197 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:03:23.297184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:03:23.338090 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m12:03:23.339187 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:03:23.339187 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:03:23.347075 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.007 seconds
[0m12:03:23.349073 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:03:23.349073 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:03:23.356592 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:23.357643 [debug] [MainThread]: On master: BEGIN
[0m12:03:23.357643 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:03:23.394818 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:03:23.395815 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:23.395815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:03:23.406414 [debug] [MainThread]: SQL status: SELECT 9 in 0.010 seconds
[0m12:03:23.410077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd9de75c9-113f-43f1-bcd6-eb0f862345ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9E2EC700>]}
[0m12:03:23.411090 [debug] [MainThread]: On master: ROLLBACK
[0m12:03:23.411090 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:23.412126 [debug] [MainThread]: On master: BEGIN
[0m12:03:23.413630 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:03:23.413630 [debug] [MainThread]: On master: COMMIT
[0m12:03:23.413630 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:23.414747 [debug] [MainThread]: On master: COMMIT
[0m12:03:23.415638 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:03:23.415638 [debug] [MainThread]: On master: Close
[0m12:03:23.420642 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m12:03:23.421645 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.stg_sessions ............................... [RUN]
[0m12:03:23.421645 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_sessions'
[0m12:03:23.423161 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m12:03:23.430880 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m12:03:23.432783 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m12:03:23.463666 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m12:03:23.464793 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m12:03:23.465736 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m12:03:23.466765 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:03:23.506119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:03:23.507118 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m12:03:23.508176 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    

with raw as (
    select * from "f1"."f1_data"."sessions"
),
raw1 as (
    select * from "f1"."f1_data"."meetings"
)
select
  cast(s.session_key as int)           as session_key,
  cast(s.meeting_key as int)           as meeting_key,
  s.session_type                       as session_type,
  m.circuit_short_name,
  m.country_name,
  s.date_start::timestamp              as date_start,
  s.date_end::timestamp                as date_end,
  extract(year from s.date_start)      as year
from raw s
left join raw1 m on s.meeting_key = m.meeting_key
where session_key is not null
  and session_type in ('Race', 'Qualifying')
  );
[0m12:03:23.515712 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:03:23.521717 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m12:03:23.523230 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
alter table "f1"."f1_data"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m12:03:23.523756 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:03:23.535979 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: COMMIT
[0m12:03:23.537977 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m12:03:23.537977 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: COMMIT
[0m12:03:23.540490 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:03:23.546060 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_sessions__dbt_backup"
[0m12:03:23.550873 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m12:03:23.550873 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
drop view if exists "f1"."f1_data"."stg_sessions__dbt_backup" cascade
[0m12:03:23.551860 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:03:23.554412 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: Close
[0m12:03:23.557407 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd9de75c9-113f-43f1-bcd6-eb0f862345ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA3B57B50>]}
[0m12:03:23.558407 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.stg_sessions .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:03:23.559914 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m12:03:23.562740 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:23.563743 [debug] [MainThread]: On master: BEGIN
[0m12:03:23.564253 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:03:23.610638 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m12:03:23.610638 [debug] [MainThread]: On master: COMMIT
[0m12:03:23.611636 [debug] [MainThread]: Using postgres connection "master"
[0m12:03:23.611636 [debug] [MainThread]: On master: COMMIT
[0m12:03:23.612637 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:03:23.612637 [debug] [MainThread]: On master: Close
[0m12:03:23.613637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:03:23.613637 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:03:23.614671 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:03:23.616184 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was properly closed.
[0m12:03:23.617194 [info ] [MainThread]: 
[0m12:03:23.617194 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:03:23.618194 [debug] [MainThread]: Command end result
[0m12:03:23.641775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:03:23.646323 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:03:23.652412 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:03:23.652412 [info ] [MainThread]: 
[0m12:03:23.654605 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:03:23.654605 [info ] [MainThread]: 
[0m12:03:23.656123 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:03:23.657133 [debug] [MainThread]: Command `dbt run` succeeded at 12:03:23.657133 after 1.56 seconds
[0m12:03:23.658137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9FCB2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ECA1D1D120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EC9F68D750>]}
[0m12:03:23.658137 [debug] [MainThread]: Flushing usage events
[0m12:03:23.979560 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:05:49.025801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277ABD1E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AD020F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AD020D90>]}


============================== 12:05:49.031511 | ffd70f40-c5da-4dac-870b-e8fdc3948947 ==============================
[0m12:05:49.031511 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:05:49.032515 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select intermediate', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:05:49.208618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AD0F0250>]}
[0m12:05:49.264794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277ACFE8FA0>]}
[0m12:05:49.265794 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:05:49.427833 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:05:49.575063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:05:49.579480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:05:49.627824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AE6A4E50>]}
[0m12:05:49.768494 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:05:49.771006 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:05:49.795662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AD5760B0>]}
[0m12:05:49.796685 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:05:49.797667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AD5762F0>]}
[0m12:05:49.799684 [info ] [MainThread]: 
[0m12:05:49.800099 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:05:49.800099 [info ] [MainThread]: 
[0m12:05:49.801153 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:05:49.805627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:05:49.858602 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:05:49.858602 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:05:49.860112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:49.902659 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m12:05:49.904165 [debug] [ThreadPool]: On list_f1: Close
[0m12:05:49.909817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:05:49.915372 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:05:49.916374 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:05:49.917372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:05:49.958474 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m12:05:49.958474 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:05:49.960016 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:05:49.966583 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.007 seconds
[0m12:05:49.968582 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:05:49.970088 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:05:49.978405 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:49.978405 [debug] [MainThread]: On master: BEGIN
[0m12:05:49.979924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:05:50.029836 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m12:05:50.030840 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.030840 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:05:50.040904 [debug] [MainThread]: SQL status: SELECT 11 in 0.010 seconds
[0m12:05:50.045132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AD577580>]}
[0m12:05:50.045132 [debug] [MainThread]: On master: ROLLBACK
[0m12:05:50.046132 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.046636 [debug] [MainThread]: On master: BEGIN
[0m12:05:50.046636 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:05:50.047641 [debug] [MainThread]: On master: COMMIT
[0m12:05:50.047641 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.048743 [debug] [MainThread]: On master: COMMIT
[0m12:05:50.049643 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:05:50.049643 [debug] [MainThread]: On master: Close
[0m12:05:50.053642 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_best_laps
[0m12:05:50.054736 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_car_base
[0m12:05:50.054736 [debug] [Thread-3 (]: Began running node model.f1_analytics.int_final_intervals
[0m12:05:50.055750 [debug] [Thread-4 (]: Began running node model.f1_analytics.int_final_position
[0m12:05:50.056729 [info ] [Thread-1 (]: 1 of 9 START sql view model f1_data.int_best_laps .............................. [RUN]
[0m12:05:50.056729 [info ] [Thread-2 (]: 2 of 9 START sql view model f1_data.int_car_base ............................... [RUN]
[0m12:05:50.057727 [info ] [Thread-3 (]: 3 of 9 START sql view model f1_data.int_final_intervals ........................ [RUN]
[0m12:05:50.058729 [info ] [Thread-4 (]: 4 of 9 START sql view model f1_data.int_final_position ......................... [RUN]
[0m12:05:50.059735 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.int_best_laps'
[0m12:05:50.061730 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.int_car_base'
[0m12:05:50.062741 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.int_final_intervals'
[0m12:05:50.063733 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.int_final_position'
[0m12:05:50.065043 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_best_laps
[0m12:05:50.065043 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_car_base
[0m12:05:50.066041 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.int_final_intervals
[0m12:05:50.067039 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.int_final_position
[0m12:05:50.076119 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_best_laps"
[0m12:05:50.080226 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_car_base"
[0m12:05:50.082119 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.int_final_intervals"
[0m12:05:50.086153 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.int_final_position"
[0m12:05:50.088397 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_best_laps
[0m12:05:50.089924 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_car_base
[0m12:05:50.090933 [debug] [Thread-3 (]: Began executing node model.f1_analytics.int_final_intervals
[0m12:05:50.121098 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_best_laps"
[0m12:05:50.127137 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_car_base"
[0m12:05:50.128138 [debug] [Thread-4 (]: Began executing node model.f1_analytics.int_final_position
[0m12:05:50.133691 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.int_final_intervals"
[0m12:05:50.134704 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m12:05:50.139785 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.int_final_position"
[0m12:05:50.140896 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: BEGIN
[0m12:05:50.141796 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:05:50.142794 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m12:05:50.142794 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:05:50.143840 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: BEGIN
[0m12:05:50.143840 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m12:05:50.145265 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: BEGIN
[0m12:05:50.145265 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:05:50.146220 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: BEGIN
[0m12:05:50.146220 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:05:50.147226 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:05:50.186767 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m12:05:50.187766 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m12:05:50.188272 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */

  create view "f1"."f1_data"."int_best_laps__dbt_tmp"
    
    
  as (
    

select
        session_key,
        driver_number,
        min(lap_duration) as fastest_lap
from "f1"."f1_data"."stg_laps"
group by 1,2
  );
[0m12:05:50.189784 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m12:05:50.190893 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m12:05:50.191798 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:05:50.192796 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m12:05:50.192796 [debug] [Thread-4 (]: SQL status: BEGIN in 0.046 seconds
[0m12:05:50.193799 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */

  create view "f1"."f1_data"."int_car_base__dbt_tmp"
    
    
  as (
    

SELECT
   ts.driver_number,
   ts.session_key,
   d.name_acronym,
   d.team_name,
   d.team_colour,
   ts.date,
   ts.rpm,
   ts.speed,
   ts.throttle,
   ts.brake,
   ts.drs
FROM "f1"."f1_data"."stg_car_data" ts
LEFT JOIN "f1"."f1_data"."stg_drivers" d
   ON ts.driver_number = d.driver_number
   AND ts.session_key = d.session_key
  );
[0m12:05:50.193799 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */

  create view "f1"."f1_data"."int_final_intervals__dbt_tmp"
    
    
  as (
    SELECT
    session_key,
    driver_number,
    MAX(CASE
        WHEN gap_to_leader LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_leader AS FLOAT)
    END) AS max_gap_to_leader,
    MAX(CASE
        WHEN gap_to_next LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_next AS FLOAT)
    END) AS max_gap_to_next
FROM "f1"."f1_data"."stg_intervals"
GROUP BY session_key, driver_number
  );
[0m12:05:50.195080 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m12:05:50.196089 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:05:50.197085 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */

  create view "f1"."f1_data"."int_final_position__dbt_tmp"
    
    
  as (
    

WITH latest_positions AS (
    SELECT
        session_key,
        driver_number,
        position,
        date as latest_date
    FROM "f1"."f1_data"."stg_position"
    QUALIFY ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number
        ORDER BY date DESC
    ) = 1
)
SELECT * FROM latest_positions
  );
[0m12:05:50.197085 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column ts.drs does not exist
LINE 20:    ts.drs
            ^

[0m12:05:50.203785 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m12:05:50.203785 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:05:50.204792 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: ROLLBACK
[0m12:05:50.205829 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "ROW_NUMBER"
LINE 16:     QUALIFY ROW_NUMBER() OVER (
                     ^

[0m12:05:50.205829 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */
alter table "f1"."f1_data"."int_best_laps__dbt_tmp" rename to "int_best_laps"
[0m12:05:50.209798 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m12:05:50.210809 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: Close
[0m12:05:50.211792 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: ROLLBACK
[0m12:05:50.212795 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */
alter table "f1"."f1_data"."int_final_intervals__dbt_tmp" rename to "int_final_intervals"
[0m12:05:50.212795 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:50.215040 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: Close
[0m12:05:50.226555 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: COMMIT
[0m12:05:50.227556 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m12:05:50.228556 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m12:05:50.231171 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: COMMIT
[0m12:05:50.232894 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: COMMIT
[0m12:05:50.234394 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m12:05:50.236401 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: COMMIT
[0m12:05:50.237403 [debug] [Thread-2 (]: Database Error in model int_car_base (f1_analytics/models\intermediate\int_car_base.sql)
  column ts.drs does not exist
  LINE 20:    ts.drs
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_car_base.sql
[0m12:05:50.238404 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:05:50.240919 [debug] [Thread-4 (]: Database Error in model int_final_position (f1_analytics/models\intermediate\int_final_position.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 16:     QUALIFY ROW_NUMBER() OVER (
                       ^
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_final_position.sql
[0m12:05:50.240919 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m12:05:50.247450 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_best_laps__dbt_backup"
[0m12:05:50.248446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AABE7100>]}
[0m12:05:50.249962 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AC04B520>]}
[0m12:05:50.251984 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."int_final_intervals__dbt_backup"
[0m12:05:50.256549 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m12:05:50.257534 [error] [Thread-2 (]: 2 of 9 ERROR creating sql view model f1_data.int_car_base ...................... [[31mERROR[0m in 0.18s]
[0m12:05:50.258539 [error] [Thread-4 (]: 4 of 9 ERROR creating sql view model f1_data.int_final_position ................ [[31mERROR[0m in 0.18s]
[0m12:05:50.260051 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m12:05:50.261061 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */
drop view if exists "f1"."f1_data"."int_best_laps__dbt_backup" cascade
[0m12:05:50.262059 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_car_base
[0m12:05:50.264187 [debug] [Thread-4 (]: Finished running node model.f1_analytics.int_final_position
[0m12:05:50.265193 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */
drop view if exists "f1"."f1_data"."int_final_intervals__dbt_backup" cascade
[0m12:05:50.266194 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_lap_position
[0m12:05:50.267192 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.int_car_base' to be skipped because of status 'error'.  Reason: Database Error in model int_car_base (f1_analytics/models\intermediate\int_car_base.sql)
  column ts.drs does not exist
  LINE 20:    ts.drs
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_car_base.sql.
[0m12:05:50.268190 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:05:50.269701 [debug] [Thread-4 (]: Began running node model.f1_analytics.int_pit_stop
[0m12:05:50.271712 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:05:50.271712 [info ] [Thread-2 (]: 5 of 9 START sql view model f1_data.int_lap_position ........................... [RUN]
[0m12:05:50.274782 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.int_final_position' to be skipped because of status 'error'.  Reason: Database Error in model int_final_position (f1_analytics/models\intermediate\int_final_position.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 16:     QUALIFY ROW_NUMBER() OVER (
                       ^
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_final_position.sql.
[0m12:05:50.278030 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: Close
[0m12:05:50.279048 [info ] [Thread-4 (]: 6 of 9 START sql view model f1_data.int_pit_stop ............................... [RUN]
[0m12:05:50.282038 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: Close
[0m12:05:50.284219 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_car_base, now model.f1_analytics.int_lap_position)
[0m12:05:50.285233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277A9AC0280>]}
[0m12:05:50.286784 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_final_position, now model.f1_analytics.int_pit_stop)
[0m12:05:50.288924 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AEBAE9E0>]}
[0m12:05:50.288924 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_lap_position
[0m12:05:50.289922 [info ] [Thread-1 (]: 1 of 9 OK created sql view model f1_data.int_best_laps ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m12:05:50.291927 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.int_pit_stop
[0m12:05:50.292936 [info ] [Thread-3 (]: 3 of 9 OK created sql view model f1_data.int_final_intervals ................... [[32mCREATE VIEW[0m in 0.23s]
[0m12:05:50.301454 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_lap_position"
[0m12:05:50.302454 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_best_laps
[0m12:05:50.306509 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.int_pit_stop"
[0m12:05:50.309288 [debug] [Thread-3 (]: Finished running node model.f1_analytics.int_final_intervals
[0m12:05:50.310772 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_tyre_stint
[0m12:05:50.311776 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_lap_position
[0m12:05:50.312774 [debug] [Thread-3 (]: Began running node model.f1_analytics.int_tyre_stint_laps
[0m12:05:50.314293 [debug] [Thread-4 (]: Began executing node model.f1_analytics.int_pit_stop
[0m12:05:50.316337 [info ] [Thread-1 (]: 7 of 9 START sql view model f1_data.int_tyre_stint ............................. [RUN]
[0m12:05:50.321119 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_lap_position"
[0m12:05:50.323088 [info ] [Thread-3 (]: 8 of 9 START sql view model f1_data.int_tyre_stint_laps ........................ [RUN]
[0m12:05:50.327824 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.int_pit_stop"
[0m12:05:50.328813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_best_laps, now model.f1_analytics.int_tyre_stint)
[0m12:05:50.329819 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_final_intervals, now model.f1_analytics.int_tyre_stint_laps)
[0m12:05:50.331810 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_tyre_stint
[0m12:05:50.332820 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m12:05:50.334321 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m12:05:50.334321 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.int_tyre_stint_laps
[0m12:05:50.339835 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint"
[0m12:05:50.341852 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: BEGIN
[0m12:05:50.343963 [debug] [Thread-4 (]: On model.f1_analytics.int_pit_stop: BEGIN
[0m12:05:50.349067 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint_laps"
[0m12:05:50.351053 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:05:50.351053 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:05:50.352055 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_tyre_stint
[0m12:05:50.354584 [debug] [Thread-3 (]: Began executing node model.f1_analytics.int_tyre_stint_laps
[0m12:05:50.361105 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint"
[0m12:05:50.368252 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint_laps"
[0m12:05:50.371773 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m12:05:50.373813 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m12:05:50.374822 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint: BEGIN
[0m12:05:50.375832 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint_laps: BEGIN
[0m12:05:50.377344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:05:50.378352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:05:50.406019 [debug] [Thread-2 (]: SQL status: BEGIN in 0.055 seconds
[0m12:05:50.407022 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m12:05:50.407529 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */

  create view "f1"."f1_data"."int_lap_position__dbt_tmp"
    
    
  as (
    

WITH positions AS (
    SELECT
        p.session_key,
        p.driver_number,
        p.position,
        p.date,
        l.lap_number,
        l.date_start,
        l.date_end,
        ABS(DATEDIFF(second, p.date, l.date_start)) AS start_time_diff,
        ABS(DATEDIFF(second, p.date, l.date_end)) AS end_time_diff
    FROM "f1"."f1_data"."stg_position" p
    JOIN "f1"."f1_data"."stg_laps" l
        ON p.session_key = l.session_key
        AND p.driver_number = l.driver_number
    WHERE p.date BETWEEN l.date_start AND l.date_end
)
SELECT *,
    ROW_NUMBER() OVER (PARTITION BY session_key, driver_number, lap_number
                       ORDER BY start_time_diff) AS start_position_rank,
    ROW_NUMBER() OVER (PARTITION BY session_key, driver_number, lap_number
                       ORDER BY end_time_diff) AS end_position_rank
FROM positions
  );
[0m12:05:50.409233 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m12:05:50.409233 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m12:05:50.410240 [debug] [Thread-4 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */

  create view "f1"."f1_data"."int_pit_stop__dbt_tmp"
    
    
  as (
    

SELECT
    session_key,
    driver_number,
    COUNT(*) AS pit_stop_count
FROM "f1"."f1_data"."stg_pit"
GROUP BY session_key, driver_number
  );
[0m12:05:50.410240 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "second" does not exist
LINE 18:         ABS(DATEDIFF(second, p.date, l.date_start)) AS start...
                              ^

[0m12:05:50.411241 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: ROLLBACK
[0m12:05:50.412242 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: Close
[0m12:05:50.414765 [debug] [Thread-2 (]: Database Error in model int_lap_position (f1_analytics/models\intermediate\int_lap_position.sql)
  column "second" does not exist
  LINE 18:         ABS(DATEDIFF(second, p.date, l.date_start)) AS start...
                                ^
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_lap_position.sql
[0m12:05:50.415766 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AABE7100>]}
[0m12:05:50.417117 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:05:50.415766 [error] [Thread-2 (]: 5 of 9 ERROR creating sql view model f1_data.int_lap_position .................. [[31mERROR[0m in 0.13s]
[0m12:05:50.421121 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m12:05:50.422125 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_lap_position
[0m12:05:50.422125 [debug] [Thread-4 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */
alter table "f1"."f1_data"."int_pit_stop__dbt_tmp" rename to "int_pit_stop"
[0m12:05:50.423626 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.int_lap_position' to be skipped because of status 'error'.  Reason: Database Error in model int_lap_position (f1_analytics/models\intermediate\int_lap_position.sql)
  column "second" does not exist
  LINE 18:         ABS(DATEDIFF(second, p.date, l.date_start)) AS start...
                                ^
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_lap_position.sql.
[0m12:05:50.425163 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:50.425163 [debug] [Thread-3 (]: SQL status: BEGIN in 0.047 seconds
[0m12:05:50.426163 [debug] [Thread-4 (]: On model.f1_analytics.int_pit_stop: COMMIT
[0m12:05:50.427165 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m12:05:50.428166 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m12:05:50.428166 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */

  create view "f1"."f1_data"."int_tyre_stint_laps__dbt_tmp"
    
    
  as (
    

with cte as (SELECT s.session_key,
                    s.driver_number,
                    s.stint_number,
                    s.compound,
                    s.lap_start,
                    s.lap_end,
                    s.lap_end - s.lap_start + 1 as stint_length,
                    -- Get the start time from the first lap of the stint
                    MIN(l.date_start)           as stint_start_time,
                    -- Get the end time from the last lap of the stint
                    MAX(l.date_start)           as stint_end_time
             FROM "f1"."f1_data"."stg_stints" s
                      LEFT JOIN "f1"."f1_data"."stg_laps" l
                                ON s.session_key = l.session_key
                                    AND s.driver_number = l.driver_number
                                    AND l.lap_number BETWEEN s.lap_start AND s.lap_end
             GROUP BY 1, 2, 3, 4, 5, 6
             )
select * from cte
         where stint_end_time is not null
           and
             stint_start_time is not null
  );
[0m12:05:50.429165 [debug] [Thread-4 (]: On model.f1_analytics.int_pit_stop: COMMIT
[0m12:05:50.430163 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m12:05:50.433670 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."int_pit_stop__dbt_backup"
[0m12:05:50.436010 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m12:05:50.437023 [debug] [Thread-4 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */
drop view if exists "f1"."f1_data"."int_pit_stop__dbt_backup" cascade
[0m12:05:50.438210 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:05:50.439724 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m12:05:50.440739 [debug] [Thread-4 (]: On model.f1_analytics.int_pit_stop: Close
[0m12:05:50.444295 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m12:05:50.445806 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AC04B520>]}
[0m12:05:50.445806 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */
alter table "f1"."f1_data"."int_tyre_stint_laps__dbt_tmp" rename to "int_tyre_stint_laps"
[0m12:05:50.446846 [info ] [Thread-4 (]: 6 of 9 OK created sql view model f1_data.int_pit_stop .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m12:05:50.447814 [debug] [Thread-4 (]: Finished running node model.f1_analytics.int_pit_stop
[0m12:05:50.448814 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:50.451550 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint_laps: COMMIT
[0m12:05:50.453558 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m12:05:50.454067 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint_laps: COMMIT
[0m12:05:50.457070 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m12:05:50.459066 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stint_laps__dbt_backup"
[0m12:05:50.461070 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m12:05:50.461070 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */
drop view if exists "f1"."f1_data"."int_tyre_stint_laps__dbt_backup" cascade
[0m12:05:50.462070 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:05:50.463582 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint_laps: Close
[0m12:05:50.466594 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AC760490>]}
[0m12:05:50.468604 [info ] [Thread-3 (]: 8 of 9 OK created sql view model f1_data.int_tyre_stint_laps ................... [[32mCREATE VIEW[0m in 0.14s]
[0m12:05:50.470112 [debug] [Thread-3 (]: Finished running node model.f1_analytics.int_tyre_stint_laps
[0m12:05:50.471122 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_tyre_stints_weather
[0m12:05:50.472123 [info ] [Thread-2 (]: 9 of 9 START sql view model f1_data.int_tyre_stints_weather .................... [RUN]
[0m12:05:50.473636 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_lap_position, now model.f1_analytics.int_tyre_stints_weather)
[0m12:05:50.474169 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_tyre_stints_weather
[0m12:05:50.477189 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stints_weather"
[0m12:05:50.478189 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_tyre_stints_weather
[0m12:05:50.484013 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stints_weather"
[0m12:05:50.486032 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m12:05:50.486551 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: BEGIN
[0m12:05:50.486551 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:05:50.526859 [debug] [Thread-1 (]: SQL status: BEGIN in 0.150 seconds
[0m12:05:50.527858 [debug] [Thread-2 (]: SQL status: BEGIN in 0.040 seconds
[0m12:05:50.528490 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m12:05:50.530131 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m12:05:50.530131 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */

  create view "f1"."f1_data"."int_tyre_stint__dbt_tmp"
    
    
  as (
    

WITH stints_base AS (
    SELECT
        s.*,
        d.team_name,
        ses.circuit_short_name,
        ses.country_name,
        ses.session_type
    FROM "f1"."f1_data"."stg_stints" s
    LEFT JOIN "f1"."f1_data"."stg_drivers" d ON s.driver_number = d.driver_number
        AND s.session_key = d.session_key
    LEFT JOIN "f1"."f1_data"."stg_sessions" ses ON s.session_key = ses.session_key
    WHERE ses.session_type = 'Race' -- Focus on race sessions
),

stint_durations AS (
    SELECT
        *,
        lap_end - lap_start + 1 as stint_length
    FROM stints_base
)

SELECT * FROM stint_durations
  );
[0m12:05:50.531140 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */

  create view "f1"."f1_data"."int_tyre_stints_weather__dbt_tmp"
    
    
  as (
    

SELECT
        st.session_key,
        st.driver_number,
        st.stint_number,
        st.compound,
        st.lap_start,
        st.lap_end,
        st.stint_length,
        -- Average weather conditions during the stint
        AVG(w.air_temperature) as avg_air_temp,
        AVG(w.track_temperature) as avg_track_temp,
        AVG(w.humidity) as avg_humidity,
        MAX(w.rainfall) as had_rainfall,  -- If there was any rain during stint
        AVG(w.wind_speed) as avg_wind_speed,
        -- Categorize conditions
        CASE
            WHEN AVG(w.track_temperature) < 25 THEN 'Cold'
            WHEN AVG(w.track_temperature) < 35 THEN 'Medium'
            ELSE 'Hot'
        END as track_temp_category,
        CASE
            WHEN MAX(w.rainfall) > 0 THEN 'Wet'
            WHEN AVG(w.humidity) > 70 THEN 'High Humidity'
            ELSE 'Dry'
        END as weather_condition
    FROM "f1"."f1_data"."int_tyre_stint_laps" st
    LEFT JOIN "f1"."f1_data"."stg_weather" w
        ON st.session_key = w.session_key
        AND w.date BETWEEN st.stint_start_time AND st.stint_end_time
    GROUP BY 1,2,3,4,5,6,7
  );
[0m12:05:50.537653 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:05:50.538653 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:05:50.541204 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m12:05:50.544727 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m12:05:50.546614 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */
alter table "f1"."f1_data"."int_tyre_stint__dbt_tmp" rename to "int_tyre_stint"
[0m12:05:50.548186 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */
alter table "f1"."f1_data"."int_tyre_stints_weather__dbt_tmp" rename to "int_tyre_stints_weather"
[0m12:05:50.549773 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:50.550306 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:05:50.551916 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint: COMMIT
[0m12:05:50.554404 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: COMMIT
[0m12:05:50.554404 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m12:05:50.555436 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m12:05:50.555436 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint: COMMIT
[0m12:05:50.556443 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: COMMIT
[0m12:05:50.557407 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:05:50.558405 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m12:05:50.561952 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stint__dbt_backup"
[0m12:05:50.565479 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stints_weather__dbt_backup"
[0m12:05:50.566493 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m12:05:50.567290 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m12:05:50.568299 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */
drop view if exists "f1"."f1_data"."int_tyre_stint__dbt_backup" cascade
[0m12:05:50.568299 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */
drop view if exists "f1"."f1_data"."int_tyre_stints_weather__dbt_backup" cascade
[0m12:05:50.569366 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:05:50.571374 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stint: Close
[0m12:05:50.571374 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:05:50.572376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AEC8A4A0>]}
[0m12:05:50.573985 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: Close
[0m12:05:50.574992 [info ] [Thread-1 (]: 7 of 9 OK created sql view model f1_data.int_tyre_stint ........................ [[32mCREATE VIEW[0m in 0.24s]
[0m12:05:50.576589 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_tyre_stint
[0m12:05:50.576589 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffd70f40-c5da-4dac-870b-e8fdc3948947', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AEB7A7D0>]}
[0m12:05:50.578596 [info ] [Thread-2 (]: 9 of 9 OK created sql view model f1_data.int_tyre_stints_weather ............... [[32mCREATE VIEW[0m in 0.10s]
[0m12:05:50.578596 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_tyre_stints_weather
[0m12:05:50.581159 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.581159 [debug] [MainThread]: On master: BEGIN
[0m12:05:50.582166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:05:50.621848 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m12:05:50.623353 [debug] [MainThread]: On master: COMMIT
[0m12:05:50.623938 [debug] [MainThread]: Using postgres connection "master"
[0m12:05:50.624946 [debug] [MainThread]: On master: COMMIT
[0m12:05:50.625946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:05:50.626945 [debug] [MainThread]: On master: Close
[0m12:05:50.628043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:05:50.628944 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:05:50.628944 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:05:50.629959 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint' was properly closed.
[0m12:05:50.629959 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stints_weather' was properly closed.
[0m12:05:50.630969 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint_laps' was properly closed.
[0m12:05:50.630969 [debug] [MainThread]: Connection 'model.f1_analytics.int_pit_stop' was properly closed.
[0m12:05:50.631968 [info ] [MainThread]: 
[0m12:05:50.633581 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m12:05:50.635105 [debug] [MainThread]: Command end result
[0m12:05:50.659789 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:05:50.662887 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:05:50.669807 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:05:50.669807 [info ] [MainThread]: 
[0m12:05:50.670815 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:05:50.671821 [info ] [MainThread]: 
[0m12:05:50.673331 [error] [MainThread]: [31mFailure in model int_car_base (f1_analytics/models\intermediate\int_car_base.sql)[0m
[0m12:05:50.673856 [error] [MainThread]:   Database Error in model int_car_base (f1_analytics/models\intermediate\int_car_base.sql)
  column ts.drs does not exist
  LINE 20:    ts.drs
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_car_base.sql
[0m12:05:50.675863 [info ] [MainThread]: 
[0m12:05:50.676865 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\intermediate\int_car_base.sql
[0m12:05:50.677862 [info ] [MainThread]: 
[0m12:05:50.678863 [error] [MainThread]: [31mFailure in model int_final_position (f1_analytics/models\intermediate\int_final_position.sql)[0m
[0m12:05:50.679865 [error] [MainThread]:   Database Error in model int_final_position (f1_analytics/models\intermediate\int_final_position.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 16:     QUALIFY ROW_NUMBER() OVER (
                       ^
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_final_position.sql
[0m12:05:50.680879 [info ] [MainThread]: 
[0m12:05:50.681986 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\intermediate\int_final_position.sql
[0m12:05:50.682998 [info ] [MainThread]: 
[0m12:05:50.683503 [error] [MainThread]: [31mFailure in model int_lap_position (f1_analytics/models\intermediate\int_lap_position.sql)[0m
[0m12:05:50.684511 [error] [MainThread]:   Database Error in model int_lap_position (f1_analytics/models\intermediate\int_lap_position.sql)
  column "second" does not exist
  LINE 18:         ABS(DATEDIFF(second, p.date, l.date_start)) AS start...
                                ^
  compiled code at target\run\f1_analytics\f1_analytics/models\intermediate\int_lap_position.sql
[0m12:05:50.684511 [info ] [MainThread]: 
[0m12:05:50.685509 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\intermediate\int_lap_position.sql
[0m12:05:50.685509 [info ] [MainThread]: 
[0m12:05:50.687197 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=9
[0m12:05:50.689468 [debug] [MainThread]: Command `dbt run` failed at 12:05:50.689468 after 1.75 seconds
[0m12:05:50.690474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277ABD1E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AE6CC6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000277AC050940>]}
[0m12:05:50.691463 [debug] [MainThread]: Flushing usage events
[0m12:05:51.147210 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:06:37.290073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019251EEE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192531F0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192531F0D30>]}


============================== 12:06:37.294012 | 5169b2f6-f2f0-40e6-8446-2de89b4f558b ==============================
[0m12:06:37.294012 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:06:37.294012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int_car_base', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:06:37.464220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5169b2f6-f2f0-40e6-8446-2de89b4f558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192532CDBA0>]}
[0m12:06:37.519769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5169b2f6-f2f0-40e6-8446-2de89b4f558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192531F2C20>]}
[0m12:06:37.521775 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:06:37.676739 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:06:37.832677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:06:37.833687 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\intermediate\int_car_base.sql
[0m12:06:38.137074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5169b2f6-f2f0-40e6-8446-2de89b4f558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924F5F2D10>]}
[0m12:06:38.219938 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:06:38.223896 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:06:38.255528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5169b2f6-f2f0-40e6-8446-2de89b4f558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192548252D0>]}
[0m12:06:38.256527 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:06:38.256527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5169b2f6-f2f0-40e6-8446-2de89b4f558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192548701F0>]}
[0m12:06:38.258527 [info ] [MainThread]: 
[0m12:06:38.260060 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:06:38.261066 [info ] [MainThread]: 
[0m12:06:38.262070 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:06:38.264582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:06:38.319903 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:06:38.320917 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:06:38.321916 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:38.362859 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m12:06:38.364374 [debug] [ThreadPool]: On list_f1: Close
[0m12:06:38.372103 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:06:38.377628 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:06:38.378630 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:06:38.378630 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:06:38.415795 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m12:06:38.416781 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:06:38.417781 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:06:38.424412 [debug] [ThreadPool]: SQL status: SELECT 27 in 0.006 seconds
[0m12:06:38.426434 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:06:38.426434 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:06:38.436150 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.437149 [debug] [MainThread]: On master: BEGIN
[0m12:06:38.437149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:06:38.475661 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:06:38.475661 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.476660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:06:38.485409 [debug] [MainThread]: SQL status: SELECT 21 in 0.008 seconds
[0m12:06:38.489836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5169b2f6-f2f0-40e6-8446-2de89b4f558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001924F55C700>]}
[0m12:06:38.489836 [debug] [MainThread]: On master: ROLLBACK
[0m12:06:38.490936 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.490936 [debug] [MainThread]: On master: BEGIN
[0m12:06:38.491843 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:06:38.491843 [debug] [MainThread]: On master: COMMIT
[0m12:06:38.492843 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.492843 [debug] [MainThread]: On master: COMMIT
[0m12:06:38.493845 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:06:38.493845 [debug] [MainThread]: On master: Close
[0m12:06:38.499895 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_car_base
[0m12:06:38.500852 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.int_car_base ............................... [RUN]
[0m12:06:38.501947 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.int_car_base'
[0m12:06:38.501947 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_car_base
[0m12:06:38.508303 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_car_base"
[0m12:06:38.509808 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_car_base
[0m12:06:38.540279 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_car_base"
[0m12:06:38.541285 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:06:38.542283 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: BEGIN
[0m12:06:38.542283 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:06:38.580930 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:06:38.581974 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:06:38.581974 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */

  create view "f1"."f1_data"."int_car_base__dbt_tmp"
    
    
  as (
    

SELECT
   ts.driver_number,
   ts.session_key,
   d.name_acronym,
   d.team_name,
   d.team_colour,
   ts.date,
   ts.rpm,
   ts.speed,
   ts.throttle,
   ts.brake
FROM "f1"."f1_data"."stg_car_data" ts
LEFT JOIN "f1"."f1_data"."stg_drivers" d
   ON ts.driver_number = d.driver_number
   AND ts.session_key = d.session_key
  );
[0m12:06:38.587471 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:06:38.598530 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:06:38.598530 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
alter table "f1"."f1_data"."int_car_base__dbt_tmp" rename to "int_car_base"
[0m12:06:38.600057 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:06:38.612158 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: COMMIT
[0m12:06:38.613664 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:06:38.613664 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: COMMIT
[0m12:06:38.615701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:06:38.621683 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_car_base__dbt_backup"
[0m12:06:38.624787 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:06:38.625786 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
drop view if exists "f1"."f1_data"."int_car_base__dbt_backup" cascade
[0m12:06:38.626791 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:06:38.628770 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: Close
[0m12:06:38.631769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5169b2f6-f2f0-40e6-8446-2de89b4f558b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019254DB2FE0>]}
[0m12:06:38.632772 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.int_car_base .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:06:38.633800 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_car_base
[0m12:06:38.635118 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.635118 [debug] [MainThread]: On master: BEGIN
[0m12:06:38.636133 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:06:38.678193 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m12:06:38.679708 [debug] [MainThread]: On master: COMMIT
[0m12:06:38.680723 [debug] [MainThread]: Using postgres connection "master"
[0m12:06:38.681718 [debug] [MainThread]: On master: COMMIT
[0m12:06:38.682719 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:06:38.682719 [debug] [MainThread]: On master: Close
[0m12:06:38.685261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:06:38.686252 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:06:38.686759 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:06:38.686759 [debug] [MainThread]: Connection 'model.f1_analytics.int_car_base' was properly closed.
[0m12:06:38.687769 [info ] [MainThread]: 
[0m12:06:38.689278 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:06:38.690354 [debug] [MainThread]: Command end result
[0m12:06:38.712045 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:06:38.715173 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:06:38.722177 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:06:38.723177 [info ] [MainThread]: 
[0m12:06:38.724726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:06:38.725716 [info ] [MainThread]: 
[0m12:06:38.725716 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:06:38.726724 [debug] [MainThread]: Command `dbt run` succeeded at 12:06:38.726724 after 1.55 seconds
[0m12:06:38.727722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019251EEE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192532CDBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019254791B40>]}
[0m12:06:38.727722 [debug] [MainThread]: Flushing usage events
[0m12:06:39.015371 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:07:43.878322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B713EC2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B716190F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B716190D30>]}


============================== 12:07:43.884385 | 65bd320a-97e9-4c32-b264-0343270fdc82 ==============================
[0m12:07:43.884385 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:07:43.885378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select int_final_position', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:07:44.068269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65bd320a-97e9-4c32-b264-0343270fdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B71632EAD0>]}
[0m12:07:44.127599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65bd320a-97e9-4c32-b264-0343270fdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B715F03EB0>]}
[0m12:07:44.129109 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:07:44.273113 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:07:44.425038 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:07:44.425038 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\intermediate\int_final_position.sql
[0m12:07:44.726918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65bd320a-97e9-4c32-b264-0343270fdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B71528F610>]}
[0m12:07:44.814346 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:07:44.817356 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:07:44.846692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65bd320a-97e9-4c32-b264-0343270fdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B716359CF0>]}
[0m12:07:44.847710 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:07:44.847710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bd320a-97e9-4c32-b264-0343270fdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B7176B7670>]}
[0m12:07:44.848702 [info ] [MainThread]: 
[0m12:07:44.850228 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:07:44.851256 [info ] [MainThread]: 
[0m12:07:44.851256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:07:44.853778 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:07:44.902851 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:07:44.903851 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:07:44.904356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:44.943732 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m12:07:44.944741 [debug] [ThreadPool]: On list_f1: Close
[0m12:07:44.954386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:07:44.960021 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:07:44.960021 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:07:44.961103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:07:45.001230 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m12:07:45.002162 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:07:45.002162 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:07:45.010062 [debug] [ThreadPool]: SQL status: SELECT 28 in 0.007 seconds
[0m12:07:45.012822 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:07:45.013853 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:07:45.021996 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:45.023598 [debug] [MainThread]: On master: BEGIN
[0m12:07:45.023598 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:07:45.061171 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:07:45.062119 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:45.062119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:07:45.074063 [debug] [MainThread]: SQL status: SELECT 23 in 0.011 seconds
[0m12:07:45.078474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bd320a-97e9-4c32-b264-0343270fdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B716130460>]}
[0m12:07:45.078474 [debug] [MainThread]: On master: ROLLBACK
[0m12:07:45.080498 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:45.080498 [debug] [MainThread]: On master: BEGIN
[0m12:07:45.081519 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:07:45.082554 [debug] [MainThread]: On master: COMMIT
[0m12:07:45.082554 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:45.082554 [debug] [MainThread]: On master: COMMIT
[0m12:07:45.084163 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:45.084163 [debug] [MainThread]: On master: Close
[0m12:07:45.092441 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_final_position
[0m12:07:45.093992 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.int_final_position ......................... [RUN]
[0m12:07:45.095038 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.int_final_position'
[0m12:07:45.096373 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_final_position
[0m12:07:45.105901 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_final_position"
[0m12:07:45.108084 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_final_position
[0m12:07:45.144579 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_final_position"
[0m12:07:45.145582 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m12:07:45.146906 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: BEGIN
[0m12:07:45.146906 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:07:45.180828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m12:07:45.181833 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m12:07:45.181833 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */

  create view "f1"."f1_data"."int_final_position__dbt_tmp"
    
    
  as (
    

WITH ranked AS (
    SELECT
        session_key,
        driver_number,
        position,
        date AS latest_date,
        ROW_NUMBER() OVER (
            PARTITION BY session_key, driver_number
            ORDER BY date DESC
        ) AS rn
    FROM "f1"."f1_data"."stg_position"
)
SELECT
    session_key,
    driver_number,
    position,
    latest_date
FROM ranked
WHERE rn = 1
  );
[0m12:07:45.187075 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:07:45.192633 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m12:07:45.194147 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */
alter table "f1"."f1_data"."int_final_position__dbt_tmp" rename to "int_final_position"
[0m12:07:45.195154 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:07:45.208262 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: COMMIT
[0m12:07:45.209772 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m12:07:45.210849 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: COMMIT
[0m12:07:45.212385 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:07:45.218949 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_final_position__dbt_backup"
[0m12:07:45.221949 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m12:07:45.223459 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */
drop view if exists "f1"."f1_data"."int_final_position__dbt_backup" cascade
[0m12:07:45.224028 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:07:45.226653 [debug] [Thread-1 (]: On model.f1_analytics.int_final_position: Close
[0m12:07:45.228550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65bd320a-97e9-4c32-b264-0343270fdc82', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B717D46FE0>]}
[0m12:07:45.230056 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.int_final_position .................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:07:45.231062 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_final_position
[0m12:07:45.232065 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:45.233590 [debug] [MainThread]: On master: BEGIN
[0m12:07:45.233590 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:07:45.271162 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:07:45.272160 [debug] [MainThread]: On master: COMMIT
[0m12:07:45.273163 [debug] [MainThread]: Using postgres connection "master"
[0m12:07:45.273668 [debug] [MainThread]: On master: COMMIT
[0m12:07:45.273668 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:07:45.274673 [debug] [MainThread]: On master: Close
[0m12:07:45.275678 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:07:45.276222 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:07:45.277225 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:07:45.277225 [debug] [MainThread]: Connection 'model.f1_analytics.int_final_position' was properly closed.
[0m12:07:45.277225 [info ] [MainThread]: 
[0m12:07:45.278223 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:07:45.279229 [debug] [MainThread]: Command end result
[0m12:07:45.302984 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:07:45.306504 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:07:45.312523 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:07:45.312523 [info ] [MainThread]: 
[0m12:07:45.312523 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:07:45.314349 [info ] [MainThread]: 
[0m12:07:45.314349 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:07:45.315465 [debug] [MainThread]: Command `dbt run` succeeded at 12:07:45.315465 after 1.52 seconds
[0m12:07:45.316383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B713EC2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B71632EAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B717783BE0>]}
[0m12:07:45.317359 [debug] [MainThread]: Flushing usage events
[0m12:07:45.640967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:08:48.379014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F02CCE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F03FC0FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F03FC0DC0>]}


============================== 12:08:48.383806 | 1ccb4930-0a4c-4b87-a7b8-1a1511c09282 ==============================
[0m12:08:48.383806 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:08:48.384461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select int_lap_position', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:08:48.558196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ccb4930-0a4c-4b87-a7b8-1a1511c09282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F0409C250>]}
[0m12:08:48.611960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ccb4930-0a4c-4b87-a7b8-1a1511c09282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F03D33F40>]}
[0m12:08:48.613995 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:08:48.762121 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:08:48.911534 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:08:48.912546 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\intermediate\int_lap_position.sql
[0m12:08:49.214087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ccb4930-0a4c-4b87-a7b8-1a1511c09282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F002EB940>]}
[0m12:08:49.300913 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:08:49.303930 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:08:49.330148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ccb4930-0a4c-4b87-a7b8-1a1511c09282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F0415B4C0>]}
[0m12:08:49.331158 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:08:49.332160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ccb4930-0a4c-4b87-a7b8-1a1511c09282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F055F2BF0>]}
[0m12:08:49.333665 [info ] [MainThread]: 
[0m12:08:49.334673 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:08:49.334673 [info ] [MainThread]: 
[0m12:08:49.335725 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:08:49.336991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:08:49.391064 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:08:49.392063 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:08:49.393066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:49.431195 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m12:08:49.433992 [debug] [ThreadPool]: On list_f1: Close
[0m12:08:49.444136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:08:49.449984 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:08:49.450994 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:08:49.451995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:08:49.486412 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m12:08:49.486412 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:08:49.487417 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:08:49.494464 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.007 seconds
[0m12:08:49.497470 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:08:49.498470 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:08:49.507499 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.508501 [debug] [MainThread]: On master: BEGIN
[0m12:08:49.508501 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:08:49.548778 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m12:08:49.548778 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.548778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:08:49.561131 [debug] [MainThread]: SQL status: SELECT 24 in 0.011 seconds
[0m12:08:49.564635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ccb4930-0a4c-4b87-a7b8-1a1511c09282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F03F67DF0>]}
[0m12:08:49.565638 [debug] [MainThread]: On master: ROLLBACK
[0m12:08:49.566644 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.566644 [debug] [MainThread]: On master: BEGIN
[0m12:08:49.567645 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:08:49.568760 [debug] [MainThread]: On master: COMMIT
[0m12:08:49.568760 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.568760 [debug] [MainThread]: On master: COMMIT
[0m12:08:49.569749 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:08:49.569749 [debug] [MainThread]: On master: Close
[0m12:08:49.578357 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_lap_position
[0m12:08:49.578357 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.int_lap_position ........................... [RUN]
[0m12:08:49.579905 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.int_lap_position'
[0m12:08:49.579905 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_lap_position
[0m12:08:49.588467 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_lap_position"
[0m12:08:49.589979 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_lap_position
[0m12:08:49.619015 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_lap_position"
[0m12:08:49.621022 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m12:08:49.622015 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: BEGIN
[0m12:08:49.622015 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:08:49.659925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:08:49.659925 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m12:08:49.660925 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */

  create view "f1"."f1_data"."int_lap_position__dbt_tmp"
    
    
  as (
    

WITH positions AS (
    SELECT
        p.session_key,
        p.driver_number,
        p.position,
        p.date,
        l.lap_number,
        l.date_start,
        l.date_end,
        ABS(EXTRACT(EPOCH FROM (p.date - l.date_start))) AS start_time_diff,
        ABS(EXTRACT(EPOCH FROM (p.date - l.date_end)))   AS end_time_diff
    FROM "f1"."f1_data"."stg_position" p
    JOIN "f1"."f1_data"."stg_laps" l
        ON p.session_key = l.session_key
        AND p.driver_number = l.driver_number
    WHERE p.date BETWEEN l.date_start AND l.date_end
)
SELECT *,
    ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number, lap_number
        ORDER BY start_time_diff
    ) AS start_position_rank,
    ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number, lap_number
        ORDER BY end_time_diff
    ) AS end_position_rank
FROM positions
  );
[0m12:08:49.675413 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m12:08:49.681675 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m12:08:49.682675 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */
alter table "f1"."f1_data"."int_lap_position__dbt_tmp" rename to "int_lap_position"
[0m12:08:49.684340 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:08:49.696222 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: COMMIT
[0m12:08:49.697222 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m12:08:49.698221 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: COMMIT
[0m12:08:49.699730 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:08:49.706350 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_lap_position__dbt_backup"
[0m12:08:49.709959 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m12:08:49.711007 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */
drop view if exists "f1"."f1_data"."int_lap_position__dbt_backup" cascade
[0m12:08:49.711007 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:08:49.714082 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: Close
[0m12:08:49.716632 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ccb4930-0a4c-4b87-a7b8-1a1511c09282', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F05B8EFE0>]}
[0m12:08:49.717640 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.int_lap_position ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:08:49.718632 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_lap_position
[0m12:08:49.720185 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.721192 [debug] [MainThread]: On master: BEGIN
[0m12:08:49.721192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:08:49.868399 [debug] [MainThread]: SQL status: BEGIN in 0.147 seconds
[0m12:08:49.868399 [debug] [MainThread]: On master: COMMIT
[0m12:08:49.869911 [debug] [MainThread]: Using postgres connection "master"
[0m12:08:49.869911 [debug] [MainThread]: On master: COMMIT
[0m12:08:49.869911 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:08:49.870920 [debug] [MainThread]: On master: Close
[0m12:08:49.870920 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:08:49.871916 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:08:49.871916 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:08:49.871916 [debug] [MainThread]: Connection 'model.f1_analytics.int_lap_position' was properly closed.
[0m12:08:49.873427 [info ] [MainThread]: 
[0m12:08:49.873952 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m12:08:49.874959 [debug] [MainThread]: Command end result
[0m12:08:49.902899 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:08:49.904489 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:08:49.910934 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:08:49.910934 [info ] [MainThread]: 
[0m12:08:49.911953 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:08:49.912852 [info ] [MainThread]: 
[0m12:08:49.913852 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:08:49.915919 [debug] [MainThread]: Command `dbt run` succeeded at 12:08:49.915919 after 1.62 seconds
[0m12:08:49.916915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F02CCE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F0409C250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026F037A7280>]}
[0m12:08:49.916915 [debug] [MainThread]: Flushing usage events
[0m12:08:50.233138 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:09:35.501865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBAB2E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBBE20F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBBE20D90>]}


============================== 12:09:35.505204 | 94f55463-e52d-4491-a15a-1ef02568e3a9 ==============================
[0m12:09:35.505204 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:09:35.506245 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select marts', 'send_anonymous_usage_stats': 'True'}
[0m12:09:35.675855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBBEFD480>]}
[0m12:09:35.732793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBBE22C80>]}
[0m12:09:35.733789 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:09:35.885690 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:09:36.077601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:09:36.078601 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:09:36.130096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBD4A4EB0>]}
[0m12:09:36.278269 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:09:36.281826 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:09:36.313864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBD39FB20>]}
[0m12:09:36.314369 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:09:36.314369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBC252F80>]}
[0m12:09:36.316980 [info ] [MainThread]: 
[0m12:09:36.317980 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:09:36.318885 [info ] [MainThread]: 
[0m12:09:36.319892 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:09:36.326912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:09:36.376511 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:09:36.377510 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:09:36.377510 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:36.420004 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m12:09:36.421017 [debug] [ThreadPool]: On list_f1: Close
[0m12:09:36.425055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:09:36.430786 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:09:36.431777 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:09:36.431777 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:36.470543 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m12:09:36.471583 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:09:36.471583 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:09:36.478355 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.006 seconds
[0m12:09:36.479889 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:09:36.480915 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:09:36.488418 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:36.489929 [debug] [MainThread]: On master: BEGIN
[0m12:09:36.489929 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:36.525099 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m12:09:36.525099 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:36.526108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:09:36.533622 [debug] [MainThread]: SQL status: SELECT 26 in 0.007 seconds
[0m12:09:36.539141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBC293610>]}
[0m12:09:36.539141 [debug] [MainThread]: On master: ROLLBACK
[0m12:09:36.540160 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:36.541163 [debug] [MainThread]: On master: BEGIN
[0m12:09:36.541163 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:09:36.542143 [debug] [MainThread]: On master: COMMIT
[0m12:09:36.542143 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:36.542143 [debug] [MainThread]: On master: COMMIT
[0m12:09:36.543654 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:09:36.543654 [debug] [MainThread]: On master: Close
[0m12:09:36.550165 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_car
[0m12:09:36.550165 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_historical_analysis
[0m12:09:36.551171 [debug] [Thread-3 (]: Began running node model.f1_analytics.final_session_driver_mapping
[0m12:09:36.551171 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_session_filters
[0m12:09:36.551171 [info ] [Thread-1 (]: 1 of 8 START sql view model f1_data.final_car .................................. [RUN]
[0m12:09:36.552170 [info ] [Thread-2 (]: 2 of 8 START sql view model f1_data.final_historical_analysis .................. [RUN]
[0m12:09:36.552170 [info ] [Thread-3 (]: 3 of 8 START sql view model f1_data.final_session_driver_mapping ............... [RUN]
[0m12:09:36.554700 [info ] [Thread-4 (]: 4 of 8 START sql view model f1_data.final_session_filters ...................... [RUN]
[0m12:09:36.556644 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_car'
[0m12:09:36.558199 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.final_historical_analysis'
[0m12:09:36.559195 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_driver_mapping'
[0m12:09:36.560199 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_filters'
[0m12:09:36.561196 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_car
[0m12:09:36.563723 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m12:09:36.564285 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.final_session_driver_mapping
[0m12:09:36.565871 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_session_filters
[0m12:09:36.574933 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_car"
[0m12:09:36.579759 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m12:09:36.584296 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.final_session_driver_mapping"
[0m12:09:36.589110 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_session_filters"
[0m12:09:36.593644 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_car
[0m12:09:36.615362 [debug] [Thread-3 (]: Began executing node model.f1_analytics.final_session_driver_mapping
[0m12:09:36.625021 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_car"
[0m12:09:36.625021 [debug] [Thread-2 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m12:09:36.630125 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.final_session_driver_mapping"
[0m12:09:36.630125 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_session_filters
[0m12:09:36.636237 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m12:09:36.638238 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:09:36.642352 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_session_filters"
[0m12:09:36.642352 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:09:36.643858 [debug] [Thread-1 (]: On model.f1_analytics.final_car: BEGIN
[0m12:09:36.644270 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:09:36.645278 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: BEGIN
[0m12:09:36.645278 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:09:36.646275 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:09:36.646275 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: BEGIN
[0m12:09:36.647276 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:09:36.647276 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: BEGIN
[0m12:09:36.648278 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:09:36.649790 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:09:36.687935 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m12:09:36.688936 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:09:36.690937 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */

  create view "f1"."f1_data"."final_car__dbt_tmp"
    
    
  as (
    

SELECT
   t.date,
   CONCAT(t.name_acronym, ' (', t.team_name, ')') as driver,
   t.driver_number,
   ROUND(t.speed) as speed,
   ROUND(t.throttle) as throttle,
   ROUND(t.brake) as brake,
   ROUND(t.drs) as drs,
   t.rpm,
   t.session_key,  -- Add session_key
   m.meeting_key   -- Add meeting_key
FROM "f1"."f1_data"."int_car_base" t
LEFT JOIN "f1"."f1_data"."stg_sessions" s ON t.session_key = s.session_key
LEFT JOIN "f1"."f1_data"."stg_meeting" m ON s.meeting_key = m.meeting_key
  );
[0m12:09:36.692941 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column t.drs does not exist
LINE 16:    ROUND(t.drs) as drs,
                  ^

[0m12:09:36.694449 [debug] [Thread-1 (]: On model.f1_analytics.final_car: ROLLBACK
[0m12:09:36.695959 [debug] [Thread-2 (]: SQL status: BEGIN in 0.047 seconds
[0m12:09:36.696966 [debug] [Thread-1 (]: On model.f1_analytics.final_car: Close
[0m12:09:36.697991 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:09:36.697991 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m12:09:36.698967 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */

  create view "f1"."f1_data"."final_historical_analysis__dbt_tmp"
    
    
  as (
    

WITH first_position_record AS (
    SELECT
        session_key,
        driver_number,
        position as first_position,
        date
    FROM stg_position
    QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, driver_number ORDER BY date) = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        round(MIN(i.gap_to_next),3) AS min_gap_to_next,
        round(MAX(i.gap_to_next),3) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM "f1"."f1_data"."stg_laps" l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN "f1"."f1_data"."stg_intervals" i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND DATE_TRUNC('SECOND', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN "f1"."f1_data"."int_lap_position" sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN "f1"."f1_data"."int_lap_position" ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY 1,2,3,4,5,6,7,8,9,10,15,16
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                LAST_VALUE(start_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                LAST_VALUE(end_position IGNORE NULLS) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
lap_number,
session_key,
driver_number,
date_start as lap_start_time,
date_end as lap_end_time,
is_pit_out_lap,
duration_sector_1,
duration_sector_2,
duration_sector_3,
min_gap_to_leader,
max_gap_to_leader,
min_gap_to_next,
max_gap_to_next,
lap_start_position,
lap_end_position,
first_position as race_start_position,
FROM filled_positions
  );
[0m12:09:36.699967 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:09:36.701966 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */

  create view "f1"."f1_data"."final_session_filters__dbt_tmp"
    
    
  as (
    WITH session_drivers AS (
   SELECT DISTINCT
       s.session_key,
       s.country_name,
       s.session_name,
       s.year,
       d.driver_number,
       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name
   FROM "f1"."f1_data"."stg_sessions" s
   JOIN "f1"."f1_data"."stg_drivers" d ON s.session_key = d.session_key
)
SELECT
   s.session_key,
    s.year,
   s.country_name,
   s.circuit_short_name,
   s.session_name,
   s.session_type,
   concat(s.year, ' - ', s.country_name, ' - ', s.session_name) as session_display_name,
   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,
   m.meeting_name,
   m.meeting_official_name,
   s.date_start
FROM "f1"."f1_data"."stg_sessions" s
JOIN session_drivers sd ON s.session_key = sd.session_key
JOIN "f1"."f1_data"."stg_meeting" m ON s.year = m.year
   AND s.country_name = m.country_name
GROUP BY 1,2,3,4,5,6,7,9,10,11
  );
[0m12:09:36.701966 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "ROW_NUMBER"
LINE 16:     QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, dri...
                     ^

[0m12:09:36.702967 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: ROLLBACK
[0m12:09:36.703966 [debug] [Thread-4 (]: Postgres adapter: Postgres error: column s.session_name does not exist
LINE 11:        s.session_name,
                ^
HINT:  Perhaps you meant to reference the column "s.session_type".

[0m12:09:36.704984 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: Close
[0m12:09:36.704984 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: ROLLBACK
[0m12:09:36.707099 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: Close
[0m12:09:36.711100 [debug] [Thread-2 (]: Database Error in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 16:     QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, dri...
                       ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql
[0m12:09:36.712100 [debug] [Thread-1 (]: Database Error in model final_car (f1_analytics/models\marts\final_car.sql)
  column t.drs does not exist
  LINE 16:    ROUND(t.drs) as drs,
                    ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_car.sql
[0m12:09:36.713099 [debug] [Thread-4 (]: Database Error in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)
  column s.session_name does not exist
  LINE 11:        s.session_name,
                  ^
  HINT:  Perhaps you meant to reference the column "s.session_type".
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_filters.sql
[0m12:09:36.715608 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB99FEE60>]}
[0m12:09:36.716616 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBBEFF700>]}
[0m12:09:36.716616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBD94FA00>]}
[0m12:09:36.717612 [error] [Thread-2 (]: 2 of 8 ERROR creating sql view model f1_data.final_historical_analysis ......... [[31mERROR[0m in 0.16s]
[0m12:09:36.718613 [error] [Thread-4 (]: 4 of 8 ERROR creating sql view model f1_data.final_session_filters ............. [[31mERROR[0m in 0.16s]
[0m12:09:36.718613 [error] [Thread-1 (]: 1 of 8 ERROR creating sql view model f1_data.final_car ......................... [[31mERROR[0m in 0.16s]
[0m12:09:36.720120 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m12:09:36.721130 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_session_filters
[0m12:09:36.722130 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_car
[0m12:09:36.723132 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_session_mapping
[0m12:09:36.724329 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_historical_analysis' to be skipped because of status 'error'.  Reason: Database Error in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 16:     QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, dri...
                       ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql.
[0m12:09:36.725344 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_tyre_performance
[0m12:09:36.728357 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_session_filters' to be skipped because of status 'error'.  Reason: Database Error in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)
  column s.session_name does not exist
  LINE 11:        s.session_name,
                  ^
  HINT:  Perhaps you meant to reference the column "s.session_type".
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_filters.sql.
[0m12:09:36.727362 [info ] [Thread-2 (]: 5 of 8 START sql view model f1_data.final_session_mapping ...................... [RUN]
[0m12:09:36.730878 [info ] [Thread-4 (]: 6 of 8 START sql view model f1_data.final_tyre_performance ..................... [RUN]
[0m12:09:36.731878 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_car' to be skipped because of status 'error'.  Reason: Database Error in model final_car (f1_analytics/models\marts\final_car.sql)
  column t.drs does not exist
  LINE 16:    ROUND(t.drs) as drs,
                    ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_car.sql.
[0m12:09:36.732875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_historical_analysis, now model.f1_analytics.final_session_mapping)
[0m12:09:36.732875 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_filters, now model.f1_analytics.final_tyre_performance)
[0m12:09:36.733878 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.final_session_mapping
[0m12:09:36.733878 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_tyre_performance
[0m12:09:36.738395 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.final_session_mapping"
[0m12:09:36.742925 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_tyre_performance"
[0m12:09:36.744432 [debug] [Thread-2 (]: Began executing node model.f1_analytics.final_session_mapping
[0m12:09:36.749965 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.final_session_mapping"
[0m12:09:36.750978 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_tyre_performance
[0m12:09:36.755508 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_tyre_performance"
[0m12:09:36.757488 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:09:36.758485 [debug] [Thread-2 (]: On model.f1_analytics.final_session_mapping: BEGIN
[0m12:09:36.758485 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:09:36.759998 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:09:36.761007 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: BEGIN
[0m12:09:36.762008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:09:36.803713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.044 seconds
[0m12:09:36.804735 [debug] [Thread-3 (]: SQL status: BEGIN in 0.157 seconds
[0m12:09:36.804735 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:09:36.804735 [debug] [Thread-4 (]: SQL status: BEGIN in 0.044 seconds
[0m12:09:36.806256 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:09:36.806256 [debug] [Thread-2 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */

  create view "f1"."f1_data"."final_session_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    concat(YEAR(date_start), ' - ', country_name, ' - ', session_name) as session_display_name,
    session_key
FROM "f1"."f1_data"."stg_sessions"
  );
[0m12:09:36.807282 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:09:36.807282 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */

  create view "f1"."f1_data"."final_session_driver_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    d.session_key,
    concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name,
    d.driver_number
FROM "f1"."f1_data"."stg_drivers" d
JOIN "f1"."f1_data"."stg_sessions" s ON d.session_key = s.session_key
  );
[0m12:09:36.808281 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */

  create view "f1"."f1_data"."final_tyre_performance__dbt_tmp"
    
    
  as (
    

WITH tire_performance AS (
    SELECT
        circuit_short_name,
        compound,
        team_name,
        driver_number,
        AVG(stint_length) as avg_stint_length,
        MAX(stint_length) as max_stint_length,
        AVG(tyre_age_at_start) as avg_starting_age,
        COUNT(*) as number_of_stints
    FROM "f1"."f1_data"."int_tyre_stint"
    GROUP BY 1,2,3,4
)

SELECT
    circuit_short_name,
    compound,
    round(AVG(avg_stint_length),2) as circuit_compound_avg_stint_length,
    MAX(max_stint_length) as circuit_compound_max_stint_length,
    round(AVG(avg_starting_age),2) as avg_tire_age_start,
    SUM(number_of_stints) as total_stints
FROM tire_performance
GROUP BY 1,2
  );
[0m12:09:36.809792 [debug] [Thread-2 (]: Postgres adapter: Postgres error: function year(timestamp without time zone) does not exist
LINE 10:     concat(YEAR(date_start), ' - ', country_name, ' - ', ses...
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m12:09:36.810812 [debug] [Thread-2 (]: On model.f1_analytics.final_session_mapping: ROLLBACK
[0m12:09:36.811821 [debug] [Thread-2 (]: On model.f1_analytics.final_session_mapping: Close
[0m12:09:36.813803 [debug] [Thread-2 (]: Database Error in model final_session_mapping (f1_analytics/models\marts\final_session_mapping.sql)
  function year(timestamp without time zone) does not exist
  LINE 10:     concat(YEAR(date_start), ' - ', country_name, ' - ', ses...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_mapping.sql
[0m12:09:36.814308 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBD94FA00>]}
[0m12:09:36.816346 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:09:36.817349 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:09:36.815336 [error] [Thread-2 (]: 5 of 8 ERROR creating sql view model f1_data.final_session_mapping ............. [[31mERROR[0m in 0.08s]
[0m12:09:36.823457 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:09:36.827047 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:09:36.828046 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_session_mapping
[0m12:09:36.829033 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
alter table "f1"."f1_data"."final_tyre_performance__dbt_tmp" rename to "final_tyre_performance"
[0m12:09:36.829328 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
alter table "f1"."f1_data"."final_session_driver_mapping__dbt_tmp" rename to "final_session_driver_mapping"
[0m12:09:36.829842 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_session_mapping' to be skipped because of status 'error'.  Reason: Database Error in model final_session_mapping (f1_analytics/models\marts\final_session_mapping.sql)
  function year(timestamp without time zone) does not exist
  LINE 10:     concat(YEAR(date_start), ' - ', country_name, ' - ', ses...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_mapping.sql.
[0m12:09:36.830855 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m12:09:36.831853 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:09:36.832544 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:09:36.832544 [info ] [Thread-1 (]: 7 of 8 SKIP relation f1_data.final_race_leaderboard ............................ [[33mSKIP[0m]
[0m12:09:36.846001 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m12:09:36.850098 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m12:09:36.851110 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m12:09:36.852104 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:09:36.852104 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:09:36.854155 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m12:09:36.855161 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_race_summary
[0m12:09:36.855565 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m12:09:36.856582 [info ] [Thread-2 (]: 8 of 8 SKIP relation f1_data.final_race_summary ................................ [[33mSKIP[0m]
[0m12:09:36.856582 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_race_summary
[0m12:09:36.857579 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m12:09:36.857579 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m12:09:36.864489 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."final_session_driver_mapping__dbt_backup"
[0m12:09:36.867101 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."final_tyre_performance__dbt_backup"
[0m12:09:36.871114 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:09:36.872106 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:09:36.873052 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
drop view if exists "f1"."f1_data"."final_session_driver_mapping__dbt_backup" cascade
[0m12:09:36.873052 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
drop view if exists "f1"."f1_data"."final_tyre_performance__dbt_backup" cascade
[0m12:09:36.874349 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:09:36.875357 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:09:36.878376 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: Close
[0m12:09:36.880530 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: Close
[0m12:09:36.881537 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDB88C3190>]}
[0m12:09:36.882539 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94f55463-e52d-4491-a15a-1ef02568e3a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBDA95B70>]}
[0m12:09:36.885058 [info ] [Thread-3 (]: 3 of 8 OK created sql view model f1_data.final_session_driver_mapping .......... [[32mCREATE VIEW[0m in 0.32s]
[0m12:09:36.886067 [info ] [Thread-4 (]: 6 of 8 OK created sql view model f1_data.final_tyre_performance ................ [[32mCREATE VIEW[0m in 0.15s]
[0m12:09:36.887065 [debug] [Thread-3 (]: Finished running node model.f1_analytics.final_session_driver_mapping
[0m12:09:36.888065 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_tyre_performance
[0m12:09:36.889599 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:36.890707 [debug] [MainThread]: On master: BEGIN
[0m12:09:36.890707 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:36.933810 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m12:09:36.934817 [debug] [MainThread]: On master: COMMIT
[0m12:09:36.934817 [debug] [MainThread]: Using postgres connection "master"
[0m12:09:36.935817 [debug] [MainThread]: On master: COMMIT
[0m12:09:36.936324 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:09:36.937424 [debug] [MainThread]: On master: Close
[0m12:09:36.937424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:36.937424 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:09:36.938928 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:09:36.938928 [debug] [MainThread]: Connection 'model.f1_analytics.final_car' was properly closed.
[0m12:09:36.938928 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_mapping' was properly closed.
[0m12:09:36.939981 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_driver_mapping' was properly closed.
[0m12:09:36.940938 [debug] [MainThread]: Connection 'model.f1_analytics.final_tyre_performance' was properly closed.
[0m12:09:36.942936 [info ] [MainThread]: 
[0m12:09:36.944447 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m12:09:36.946455 [debug] [MainThread]: Command end result
[0m12:09:36.970073 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:09:36.973083 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:09:36.981158 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:09:36.982174 [info ] [MainThread]: 
[0m12:09:36.983684 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m12:09:36.983684 [info ] [MainThread]: 
[0m12:09:36.984749 [error] [MainThread]: [31mFailure in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)[0m
[0m12:09:36.984749 [error] [MainThread]:   Database Error in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)
  syntax error at or near "ROW_NUMBER"
  LINE 16:     QUALIFY ROW_NUMBER() OVER (PARTITION BY session_key, dri...
                       ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql
[0m12:09:36.985691 [info ] [MainThread]: 
[0m12:09:36.986693 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql
[0m12:09:36.987803 [info ] [MainThread]: 
[0m12:09:36.990154 [error] [MainThread]: [31mFailure in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)[0m
[0m12:09:36.991279 [error] [MainThread]:   Database Error in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)
  column s.session_name does not exist
  LINE 11:        s.session_name,
                  ^
  HINT:  Perhaps you meant to reference the column "s.session_type".
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_filters.sql
[0m12:09:36.992947 [info ] [MainThread]: 
[0m12:09:36.994037 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_session_filters.sql
[0m12:09:36.995049 [info ] [MainThread]: 
[0m12:09:36.997047 [error] [MainThread]: [31mFailure in model final_car (f1_analytics/models\marts\final_car.sql)[0m
[0m12:09:36.998046 [error] [MainThread]:   Database Error in model final_car (f1_analytics/models\marts\final_car.sql)
  column t.drs does not exist
  LINE 16:    ROUND(t.drs) as drs,
                    ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_car.sql
[0m12:09:36.999046 [info ] [MainThread]: 
[0m12:09:36.999046 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_car.sql
[0m12:09:37.000046 [info ] [MainThread]: 
[0m12:09:37.001046 [error] [MainThread]: [31mFailure in model final_session_mapping (f1_analytics/models\marts\final_session_mapping.sql)[0m
[0m12:09:37.002179 [error] [MainThread]:   Database Error in model final_session_mapping (f1_analytics/models\marts\final_session_mapping.sql)
  function year(timestamp without time zone) does not exist
  LINE 10:     concat(YEAR(date_start), ' - ', country_name, ' - ', ses...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_mapping.sql
[0m12:09:37.002179 [info ] [MainThread]: 
[0m12:09:37.003685 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_session_mapping.sql
[0m12:09:37.004696 [info ] [MainThread]: 
[0m12:09:37.005692 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=4 SKIP=2 NO-OP=0 TOTAL=8
[0m12:09:37.007779 [debug] [MainThread]: Command `dbt run` failed at 12:09:37.007779 after 1.58 seconds
[0m12:09:37.008792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBAB2E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBD450BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FDBD450D60>]}
[0m12:09:37.010784 [debug] [MainThread]: Flushing usage events
[0m12:09:37.411294 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:32.112027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195381EE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953A4C0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953A4C0D30>]}


============================== 12:11:32.116082 | c86ce1eb-774d-4d53-8604-b7cba9f0c45c ==============================
[0m12:11:32.116082 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:11:32.117104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select final_historical_analysis', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:11:32.301030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c86ce1eb-774d-4d53-8604-b7cba9f0c45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953A59DBA0>]}
[0m12:11:32.358864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c86ce1eb-774d-4d53-8604-b7cba9f0c45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953A4C2C20>]}
[0m12:11:32.359868 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:11:32.506068 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:11:32.664169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:32.664678 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_historical_analysis.sql
[0m12:11:32.956615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c86ce1eb-774d-4d53-8604-b7cba9f0c45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953A4C1AE0>]}
[0m12:11:33.044184 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:11:33.047575 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:11:33.074025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c86ce1eb-774d-4d53-8604-b7cba9f0c45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953A59E920>]}
[0m12:11:33.074025 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:11:33.075036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c86ce1eb-774d-4d53-8604-b7cba9f0c45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953A59F0A0>]}
[0m12:11:33.077044 [info ] [MainThread]: 
[0m12:11:33.077044 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:11:33.078031 [info ] [MainThread]: 
[0m12:11:33.078031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:11:33.080029 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:11:33.130824 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:11:33.131873 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:11:33.131873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:33.175898 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.044 seconds
[0m12:11:33.176792 [debug] [ThreadPool]: On list_f1: Close
[0m12:11:33.185102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:11:33.190198 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:11:33.190198 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:11:33.191201 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:33.236070 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m12:11:33.237067 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:11:33.238077 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:11:33.246603 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.008 seconds
[0m12:11:33.248602 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:11:33.248602 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:11:33.260338 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:33.261404 [debug] [MainThread]: On master: BEGIN
[0m12:11:33.261933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:33.298207 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:11:33.299208 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:33.299208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:11:33.305768 [debug] [MainThread]: SQL status: SELECT 29 in 0.006 seconds
[0m12:11:33.310323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c86ce1eb-774d-4d53-8604-b7cba9f0c45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953A41AB30>]}
[0m12:11:33.311350 [debug] [MainThread]: On master: ROLLBACK
[0m12:11:33.312335 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:33.312335 [debug] [MainThread]: On master: BEGIN
[0m12:11:33.312335 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:11:33.313840 [debug] [MainThread]: On master: COMMIT
[0m12:11:33.313840 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:33.314844 [debug] [MainThread]: On master: COMMIT
[0m12:11:33.314844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:11:33.314844 [debug] [MainThread]: On master: Close
[0m12:11:33.319877 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_historical_analysis
[0m12:11:33.320559 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_historical_analysis .................. [RUN]
[0m12:11:33.321565 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_historical_analysis'
[0m12:11:33.321565 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m12:11:33.329090 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m12:11:33.331100 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m12:11:33.367042 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m12:11:33.369887 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:11:33.370451 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: BEGIN
[0m12:11:33.370451 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:11:33.407763 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:11:33.408763 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:11:33.408763 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */

  create view "f1"."f1_data"."final_historical_analysis__dbt_tmp"
    
    
  as (
    

WITH first_position_record AS (
    SELECT *
    FROM (
        SELECT
            session_key,
            driver_number,
            position AS first_position,
            date,
            ROW_NUMBER() OVER (
                PARTITION BY session_key, driver_number
                ORDER BY date
            ) AS rn
        FROM stg_position
    ) t
    WHERE rn = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        ROUND(MIN(i.gap_to_next)::numeric,3) AS min_gap_to_next,
        ROUND(MAX(i.gap_to_next)::numeric,3) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM "f1"."f1_data"."stg_laps" l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN "f1"."f1_data"."stg_intervals" i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND date_trunc('second', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN "f1"."f1_data"."int_lap_position" sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN "f1"."f1_data"."int_lap_position" ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY
        l.lap_number, l.session_key, l.driver_number, l.date_start,
        l.date_end, l.is_pit_out_lap,
        l.duration_sector_1, l.duration_sector_2, l.duration_sector_3,
        fpr.first_position, sp.position, ep.position
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                MAX(start_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                MAX(end_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
    lap_number,
    session_key,
    driver_number,
    date_start AS lap_start_time,
    date_end AS lap_end_time,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3,
    min_gap_to_leader,
    max_gap_to_leader,
    min_gap_to_next,
    max_gap_to_next,
    lap_start_position,
    lap_end_position,
    first_position AS race_start_position
FROM filled_positions;
  );
[0m12:11:33.411311 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 113: FROM filled_positions;
                               ^

[0m12:11:33.411311 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: ROLLBACK
[0m12:11:33.412295 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: Close
[0m12:11:33.417547 [debug] [Thread-1 (]: Database Error in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)
  syntax error at or near ";"
  LINE 113: FROM filled_positions;
                                 ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql
[0m12:11:33.423070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c86ce1eb-774d-4d53-8604-b7cba9f0c45c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953C08AFE0>]}
[0m12:11:33.424368 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.final_historical_analysis ......... [[31mERROR[0m in 0.10s]
[0m12:11:33.426380 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m12:11:33.427408 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_historical_analysis' to be skipped because of status 'error'.  Reason: Database Error in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)
  syntax error at or near ";"
  LINE 113: FROM filled_positions;
                                 ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql.
[0m12:11:33.430663 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:33.432679 [debug] [MainThread]: On master: BEGIN
[0m12:11:33.432679 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:33.482395 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m12:11:33.483915 [debug] [MainThread]: On master: COMMIT
[0m12:11:33.485930 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:33.486993 [debug] [MainThread]: On master: COMMIT
[0m12:11:33.487938 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:11:33.487938 [debug] [MainThread]: On master: Close
[0m12:11:33.488944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:33.489940 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:11:33.490938 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:11:33.491941 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was properly closed.
[0m12:11:33.494220 [info ] [MainThread]: 
[0m12:11:33.495235 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m12:11:33.497236 [debug] [MainThread]: Command end result
[0m12:11:33.520226 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:11:33.525269 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:11:33.531268 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:11:33.532272 [info ] [MainThread]: 
[0m12:11:33.532272 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:11:33.533810 [info ] [MainThread]: 
[0m12:11:33.534938 [error] [MainThread]: [31mFailure in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)[0m
[0m12:11:33.536064 [error] [MainThread]:   Database Error in model final_historical_analysis (f1_analytics/models\marts\final_historical_analysis.sql)
  syntax error at or near ";"
  LINE 113: FROM filled_positions;
                                 ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql
[0m12:11:33.537088 [info ] [MainThread]: 
[0m12:11:33.537761 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_historical_analysis.sql
[0m12:11:33.538769 [info ] [MainThread]: 
[0m12:11:33.540283 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:11:33.542305 [debug] [MainThread]: Command `dbt run` failed at 12:11:33.542305 after 1.54 seconds
[0m12:11:33.543817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000195381EE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953BC819C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001953BCB5150>]}
[0m12:11:33.544391 [debug] [MainThread]: Flushing usage events
[0m12:11:33.889186 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:12:03.130817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002967F5CE2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296019D0E80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000296019D0CA0>]}


============================== 12:12:03.134909 | f27d2872-2d13-40f5-8cbb-15373efa6644 ==============================
[0m12:12:03.134909 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:12:03.135909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select final_historical_analysis', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:12:03.422338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f27d2872-2d13-40f5-8cbb-15373efa6644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029601AAEF80>]}
[0m12:12:03.481187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f27d2872-2d13-40f5-8cbb-15373efa6644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002960199EF50>]}
[0m12:12:03.483125 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:12:03.644161 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:12:03.827975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:03.828630 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_historical_analysis.sql
[0m12:12:04.200147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f27d2872-2d13-40f5-8cbb-15373efa6644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029601972170>]}
[0m12:12:04.305301 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:12:04.309136 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:12:04.339861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f27d2872-2d13-40f5-8cbb-15373efa6644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029601801C30>]}
[0m12:12:04.340869 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:12:04.341878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27d2872-2d13-40f5-8cbb-15373efa6644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002960199F370>]}
[0m12:12:04.345125 [info ] [MainThread]: 
[0m12:12:04.346126 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:12:04.347130 [info ] [MainThread]: 
[0m12:12:04.348131 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:12:04.349137 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:12:04.406142 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:12:04.406703 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:12:04.406703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:04.446999 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m12:12:04.449067 [debug] [ThreadPool]: On list_f1: Close
[0m12:12:04.455664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:12:04.461746 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:12:04.462753 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:12:04.462753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:04.503012 [debug] [ThreadPool]: SQL status: BEGIN in 0.040 seconds
[0m12:12:04.503983 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:12:04.503983 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:12:04.510243 [debug] [ThreadPool]: SQL status: SELECT 32 in 0.005 seconds
[0m12:12:04.511264 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:12:04.512272 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:12:04.520801 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:04.521784 [debug] [MainThread]: On master: BEGIN
[0m12:12:04.521784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:04.556868 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:12:04.557872 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:04.558868 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:12:04.567928 [debug] [MainThread]: SQL status: SELECT 29 in 0.009 seconds
[0m12:12:04.576492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f27d2872-2d13-40f5-8cbb-15373efa6644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029601AD5840>]}
[0m12:12:04.577247 [debug] [MainThread]: On master: ROLLBACK
[0m12:12:04.578728 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:04.578728 [debug] [MainThread]: On master: BEGIN
[0m12:12:04.580235 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:12:04.581244 [debug] [MainThread]: On master: COMMIT
[0m12:12:04.581244 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:04.582270 [debug] [MainThread]: On master: COMMIT
[0m12:12:04.582270 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:12:04.583786 [debug] [MainThread]: On master: Close
[0m12:12:04.587024 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_historical_analysis
[0m12:12:04.588073 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_historical_analysis .................. [RUN]
[0m12:12:04.589033 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_historical_analysis'
[0m12:12:04.590072 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m12:12:04.602200 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m12:12:04.603741 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m12:12:04.635972 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m12:12:04.636981 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:12:04.638035 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: BEGIN
[0m12:12:04.638035 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:12:04.678296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:12:04.680817 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:12:04.680817 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */

  create view "f1"."f1_data"."final_historical_analysis__dbt_tmp"
    
    
  as (
    

WITH first_position_record AS (
    SELECT *
    FROM (
        SELECT
            session_key,
            driver_number,
            position AS first_position,
            date,
            ROW_NUMBER() OVER (
                PARTITION BY session_key, driver_number
                ORDER BY date
            ) AS rn
        FROM stg_position
    ) t
    WHERE rn = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        ROUND(MIN(i.gap_to_next)::numeric,3) AS min_gap_to_next,
        ROUND(MAX(i.gap_to_next)::numeric,3) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM "f1"."f1_data"."stg_laps" l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN "f1"."f1_data"."stg_intervals" i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND date_trunc('second', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN "f1"."f1_data"."int_lap_position" sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN "f1"."f1_data"."int_lap_position" ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY
        l.lap_number, l.session_key, l.driver_number, l.date_start,
        l.date_end, l.is_pit_out_lap,
        l.duration_sector_1, l.duration_sector_2, l.duration_sector_3,
        fpr.first_position, sp.position, ep.position
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                MAX(start_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                MAX(end_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
    lap_number,
    session_key,
    driver_number,
    date_start AS lap_start_time,
    date_end AS lap_end_time,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3,
    min_gap_to_leader,
    max_gap_to_leader,
    min_gap_to_next,
    max_gap_to_next,
    lap_start_position,
    lap_end_position,
    first_position AS race_start_position
FROM filled_positions
  );
[0m12:12:04.694611 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m12:12:04.701134 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:12:04.702134 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
alter table "f1"."f1_data"."final_historical_analysis__dbt_tmp" rename to "final_historical_analysis"
[0m12:12:04.704136 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:12:04.716525 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m12:12:04.717518 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:12:04.717518 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m12:12:04.720157 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:12:04.724998 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_historical_analysis__dbt_backup"
[0m12:12:04.728974 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:12:04.728974 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
drop view if exists "f1"."f1_data"."final_historical_analysis__dbt_backup" cascade
[0m12:12:04.729971 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:12:04.732911 [debug] [Thread-1 (]: On model.f1_analytics.final_historical_analysis: Close
[0m12:12:04.737134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f27d2872-2d13-40f5-8cbb-15373efa6644', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002960359AFE0>]}
[0m12:12:04.738135 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.final_historical_analysis ............. [[32mCREATE VIEW[0m in 0.15s]
[0m12:12:04.739140 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m12:12:04.741410 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:04.742412 [debug] [MainThread]: On master: BEGIN
[0m12:12:04.742412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:12:04.783852 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:12:04.785010 [debug] [MainThread]: On master: COMMIT
[0m12:12:04.785010 [debug] [MainThread]: Using postgres connection "master"
[0m12:12:04.786010 [debug] [MainThread]: On master: COMMIT
[0m12:12:04.786010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:12:04.787044 [debug] [MainThread]: On master: Close
[0m12:12:04.787044 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:04.788009 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:12:04.788009 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:12:04.788009 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was properly closed.
[0m12:12:04.789009 [info ] [MainThread]: 
[0m12:12:04.789009 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:12:04.790011 [debug] [MainThread]: Command end result
[0m12:12:04.819778 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:12:04.821340 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:12:04.828658 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:12:04.830162 [info ] [MainThread]: 
[0m12:12:04.830162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:04.831171 [info ] [MainThread]: 
[0m12:12:04.832170 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:12:04.833174 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:04.833174 after 1.79 seconds
[0m12:12:04.834171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002967F5CE2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029601AAC340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029601A84910>]}
[0m12:12:04.834171 [debug] [MainThread]: Flushing usage events
[0m12:12:05.162434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:13:56.039952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531ABAE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531BEA0FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531BEA0DC0>]}


============================== 12:13:56.046015 | 4afbcc46-0a89-4a39-a0df-e0ff2617d601 ==============================
[0m12:13:56.046015 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:13:56.047545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select final_session_filters', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:13:56.217916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4afbcc46-0a89-4a39-a0df-e0ff2617d601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531BF7C250>]}
[0m12:13:56.276362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4afbcc46-0a89-4a39-a0df-e0ff2617d601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531BC13F40>]}
[0m12:13:56.278365 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:13:56.426254 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:13:56.576963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:13:56.578481 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_session_filters.sql
[0m12:13:56.886051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4afbcc46-0a89-4a39-a0df-e0ff2617d601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531C139F00>]}
[0m12:13:56.975107 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:13:56.977629 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:13:57.003214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4afbcc46-0a89-4a39-a0df-e0ff2617d601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531BF7F6D0>]}
[0m12:13:57.004231 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:13:57.004231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afbcc46-0a89-4a39-a0df-e0ff2617d601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531BF7C220>]}
[0m12:13:57.006643 [info ] [MainThread]: 
[0m12:13:57.007643 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:13:57.008660 [info ] [MainThread]: 
[0m12:13:57.008660 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:13:57.013572 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:13:57.070985 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:13:57.070985 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:13:57.071984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:57.117074 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.046 seconds
[0m12:13:57.119035 [debug] [ThreadPool]: On list_f1: Close
[0m12:13:57.126975 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:13:57.132074 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:13:57.132980 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:13:57.132980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:13:57.175966 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m12:13:57.176515 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:13:57.176515 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:13:57.185309 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.008 seconds
[0m12:13:57.187310 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:13:57.188343 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:13:57.197824 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:57.198823 [debug] [MainThread]: On master: BEGIN
[0m12:13:57.198823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:13:57.236964 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:13:57.237965 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:57.237965 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:13:57.245486 [debug] [MainThread]: SQL status: SELECT 33 in 0.006 seconds
[0m12:13:57.251042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4afbcc46-0a89-4a39-a0df-e0ff2617d601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531BEA14E0>]}
[0m12:13:57.251042 [debug] [MainThread]: On master: ROLLBACK
[0m12:13:57.252029 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:57.253012 [debug] [MainThread]: On master: BEGIN
[0m12:13:57.254005 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:13:57.254559 [debug] [MainThread]: On master: COMMIT
[0m12:13:57.254559 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:57.254559 [debug] [MainThread]: On master: COMMIT
[0m12:13:57.256071 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:13:57.256071 [debug] [MainThread]: On master: Close
[0m12:13:57.261535 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_filters
[0m12:13:57.262537 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_session_filters ...................... [RUN]
[0m12:13:57.264044 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_filters'
[0m12:13:57.264044 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_filters
[0m12:13:57.272072 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_filters"
[0m12:13:57.273565 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_filters
[0m12:13:57.306148 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_filters"
[0m12:13:57.307398 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:13:57.307398 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: BEGIN
[0m12:13:57.308364 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:13:57.350165 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m12:13:57.351169 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:13:57.352158 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */

  create view "f1"."f1_data"."final_session_filters__dbt_tmp"
    
    
  as (
    WITH session_drivers AS (
   SELECT DISTINCT
       s.session_key,
       s.country_name,
       s.session_type,
       s.year,
       d.driver_number,
       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name
   FROM "f1"."f1_data"."stg_sessions" s
   JOIN "f1"."f1_data"."stg_drivers" d ON s.session_key = d.session_key
)
SELECT
   s.session_key,
    s.year,
   s.country_name,
   s.circuit_short_name,
   s.session_type,
   concat(s.year, ' - ', s.country_name, ' - ', s.session_type) as session_display_name,
   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,
   m.meeting_name,
   m.meeting_official_name,
   s.date_start
FROM "f1"."f1_data"."stg_sessions" s
JOIN session_drivers sd ON s.session_key = sd.session_key
JOIN "f1"."f1_data"."stg_meeting" m ON s.year = m.year
   AND s.country_name = m.country_name
GROUP BY 1,2,3,4,5,6,7,9,10,11
  );
[0m12:13:57.354163 [debug] [Thread-1 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in GROUP BY
LINE 25:    array_agg(DISTINCT sd.driver_display_name) as available_d...
            ^

[0m12:13:57.354681 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: ROLLBACK
[0m12:13:57.355756 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: Close
[0m12:13:57.359045 [debug] [Thread-1 (]: Database Error in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 25:    array_agg(DISTINCT sd.driver_display_name) as available_d...
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_filters.sql
[0m12:13:57.361049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4afbcc46-0a89-4a39-a0df-e0ff2617d601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531DA6AFE0>]}
[0m12:13:57.362035 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.final_session_filters ............. [[31mERROR[0m in 0.10s]
[0m12:13:57.363046 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_filters
[0m12:13:57.363046 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_session_filters' to be skipped because of status 'error'.  Reason: Database Error in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 25:    array_agg(DISTINCT sd.driver_display_name) as available_d...
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_filters.sql.
[0m12:13:57.365603 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:57.365603 [debug] [MainThread]: On master: BEGIN
[0m12:13:57.366626 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:13:57.405869 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m12:13:57.406916 [debug] [MainThread]: On master: COMMIT
[0m12:13:57.407867 [debug] [MainThread]: Using postgres connection "master"
[0m12:13:57.407867 [debug] [MainThread]: On master: COMMIT
[0m12:13:57.407867 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:13:57.409126 [debug] [MainThread]: On master: Close
[0m12:13:57.410139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:13:57.410139 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:13:57.411454 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:13:57.411963 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_filters' was properly closed.
[0m12:13:57.413340 [info ] [MainThread]: 
[0m12:13:57.414479 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:13:57.416543 [debug] [MainThread]: Command end result
[0m12:13:57.438565 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:13:57.442148 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:13:57.450385 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:13:57.451729 [info ] [MainThread]: 
[0m12:13:57.454272 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:13:57.454272 [info ] [MainThread]: 
[0m12:13:57.456324 [error] [MainThread]: [31mFailure in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)[0m
[0m12:13:57.456324 [error] [MainThread]:   Database Error in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 25:    array_agg(DISTINCT sd.driver_display_name) as available_d...
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_filters.sql
[0m12:13:57.457317 [info ] [MainThread]: 
[0m12:13:57.457317 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_session_filters.sql
[0m12:13:57.457317 [info ] [MainThread]: 
[0m12:13:57.458330 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:13:57.459328 [debug] [MainThread]: Command `dbt run` failed at 12:13:57.459328 after 1.56 seconds
[0m12:13:57.459328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531ABAE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531D520430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001531D6632E0>]}
[0m12:13:57.460329 [debug] [MainThread]: Flushing usage events
[0m12:13:57.764836 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:59.747495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117442E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021176700F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021176700D30>]}


============================== 12:14:59.751058 | ea865de4-399b-4ffa-b6d1-c85a07fa4501 ==============================
[0m12:14:59.751058 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:14:59.752062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select final_session_filters', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:14:59.934749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ea865de4-399b-4ffa-b6d1-c85a07fa4501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117689AAD0>]}
[0m12:14:59.995577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ea865de4-399b-4ffa-b6d1-c85a07fa4501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021176473EB0>]}
[0m12:14:59.996579 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:15:00.151044 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:15:00.306174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:00.307154 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_session_filters.sql
[0m12:15:00.611110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea865de4-399b-4ffa-b6d1-c85a07fa4501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021176701AE0>]}
[0m12:15:00.700891 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:15:00.704300 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:15:00.728312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ea865de4-399b-4ffa-b6d1-c85a07fa4501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021177C24CA0>]}
[0m12:15:00.729294 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:15:00.730294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea865de4-399b-4ffa-b6d1-c85a07fa4501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117689AB90>]}
[0m12:15:00.731310 [info ] [MainThread]: 
[0m12:15:00.732294 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:15:00.732294 [info ] [MainThread]: 
[0m12:15:00.734299 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:15:00.737551 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:15:00.793052 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:15:00.794054 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:15:00.794566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:00.837494 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.044 seconds
[0m12:15:00.838486 [debug] [ThreadPool]: On list_f1: Close
[0m12:15:00.850075 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:15:00.858202 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:15:00.859106 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:15:00.860175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:00.901082 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m12:15:00.902089 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:15:00.902089 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:15:00.910101 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.007 seconds
[0m12:15:00.911112 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:15:00.912111 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:15:00.923440 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:00.923983 [debug] [MainThread]: On master: BEGIN
[0m12:15:00.923983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:00.967158 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m12:15:00.968133 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:00.968133 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:15:00.984007 [debug] [MainThread]: SQL status: SELECT 33 in 0.015 seconds
[0m12:15:00.995166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ea865de4-399b-4ffa-b6d1-c85a07fa4501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211766A4460>]}
[0m12:15:00.995166 [debug] [MainThread]: On master: ROLLBACK
[0m12:15:00.996681 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:00.996681 [debug] [MainThread]: On master: BEGIN
[0m12:15:00.997688 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:15:00.998747 [debug] [MainThread]: On master: COMMIT
[0m12:15:00.998747 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:00.998747 [debug] [MainThread]: On master: COMMIT
[0m12:15:01.000256 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:01.000256 [debug] [MainThread]: On master: Close
[0m12:15:01.007442 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_filters
[0m12:15:01.008446 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_session_filters ...................... [RUN]
[0m12:15:01.010964 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_filters'
[0m12:15:01.011961 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_filters
[0m12:15:01.021525 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_filters"
[0m12:15:01.023602 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_filters
[0m12:15:01.055847 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_filters"
[0m12:15:01.057146 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:15:01.058133 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: BEGIN
[0m12:15:01.058133 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:15:01.092566 [debug] [Thread-1 (]: SQL status: BEGIN in 0.034 seconds
[0m12:15:01.093840 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:15:01.095186 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */

  create view "f1"."f1_data"."final_session_filters__dbt_tmp"
    
    
  as (
    WITH session_drivers AS (
   SELECT DISTINCT
       s.session_key,
       s.country_name,
       s.session_type,
       s.year,
       d.driver_number,
       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name
   FROM "f1"."f1_data"."stg_sessions" s
   JOIN "f1"."f1_data"."stg_drivers" d ON s.session_key = d.session_key
)
SELECT
   s.session_key,
    s.year,
   s.country_name,
   s.circuit_short_name,
   s.session_type,
   concat(s.year, ' - ', s.country_name, ' - ', s.session_type) as session_display_name,
   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,
   m.meeting_name,
   m.meeting_official_name,
   s.date_start
FROM "f1"."f1_data"."stg_sessions" s
JOIN session_drivers sd ON s.session_key = sd.session_key
JOIN "f1"."f1_data"."stg_meeting" m ON s.year = m.year
   AND s.country_name = m.country_name
GROUP BY 1,2,3,4,5,7,9,10
  );
[0m12:15:01.097766 [debug] [Thread-1 (]: Postgres adapter: Postgres error: aggregate functions are not allowed in GROUP BY
LINE 25:    array_agg(DISTINCT sd.driver_display_name) as available_d...
            ^

[0m12:15:01.097766 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: ROLLBACK
[0m12:15:01.098770 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: Close
[0m12:15:01.101317 [debug] [Thread-1 (]: Database Error in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 25:    array_agg(DISTINCT sd.driver_display_name) as available_d...
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_filters.sql
[0m12:15:01.103870 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ea865de4-399b-4ffa-b6d1-c85a07fa4501', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211782CAFE0>]}
[0m12:15:01.106255 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.final_session_filters ............. [[31mERROR[0m in 0.09s]
[0m12:15:01.107324 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_filters
[0m12:15:01.108375 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_session_filters' to be skipped because of status 'error'.  Reason: Database Error in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 25:    array_agg(DISTINCT sd.driver_display_name) as available_d...
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_filters.sql.
[0m12:15:01.110949 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:01.110949 [debug] [MainThread]: On master: BEGIN
[0m12:15:01.111952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:01.156567 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m12:15:01.157632 [debug] [MainThread]: On master: COMMIT
[0m12:15:01.157632 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:01.158678 [debug] [MainThread]: On master: COMMIT
[0m12:15:01.158678 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:01.160248 [debug] [MainThread]: On master: Close
[0m12:15:01.160248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:01.160248 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:15:01.161344 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:15:01.161344 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_filters' was properly closed.
[0m12:15:01.161344 [info ] [MainThread]: 
[0m12:15:01.162767 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:15:01.164284 [debug] [MainThread]: Command end result
[0m12:15:01.188313 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:15:01.191341 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:15:01.196928 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:15:01.196928 [info ] [MainThread]: 
[0m12:15:01.199104 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:15:01.200113 [info ] [MainThread]: 
[0m12:15:01.202243 [error] [MainThread]: [31mFailure in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)[0m
[0m12:15:01.203246 [error] [MainThread]:   Database Error in model final_session_filters (f1_analytics/models\marts\final_session_filters.sql)
  aggregate functions are not allowed in GROUP BY
  LINE 25:    array_agg(DISTINCT sd.driver_display_name) as available_d...
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_filters.sql
[0m12:15:01.204757 [info ] [MainThread]: 
[0m12:15:01.205762 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_session_filters.sql
[0m12:15:01.206765 [info ] [MainThread]: 
[0m12:15:01.207792 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:15:01.208792 [debug] [MainThread]: Command `dbt run` failed at 12:15:01.208792 after 1.56 seconds
[0m12:15:01.208792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002117442E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211768EF700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021176937280>]}
[0m12:15:01.208792 [debug] [MainThread]: Flushing usage events
[0m12:15:01.536770 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:20.511280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209752FE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020976600F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020976600D30>]}


============================== 12:15:20.515238 | df467891-6fc1-487a-b0f4-932e028701cf ==============================
[0m12:15:20.515238 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:15:20.516140 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select final_session_filters', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:15:20.686984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df467891-6fc1-487a-b0f4-932e028701cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002097679AAD0>]}
[0m12:15:20.740453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df467891-6fc1-487a-b0f4-932e028701cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020976373EB0>]}
[0m12:15:20.744369 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:15:20.887650 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:15:21.078823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:21.080349 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_session_filters.sql
[0m12:15:21.411278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df467891-6fc1-487a-b0f4-932e028701cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020976601AE0>]}
[0m12:15:21.501039 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:15:21.504576 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:15:21.534818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df467891-6fc1-487a-b0f4-932e028701cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020976A5CCA0>]}
[0m12:15:21.535827 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:15:21.536825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df467891-6fc1-487a-b0f4-932e028701cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002097679AB90>]}
[0m12:15:21.539091 [info ] [MainThread]: 
[0m12:15:21.539638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:15:21.540648 [info ] [MainThread]: 
[0m12:15:21.541644 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:15:21.542497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:15:21.600454 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:15:21.600959 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:15:21.601463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:21.642319 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.041 seconds
[0m12:15:21.645478 [debug] [ThreadPool]: On list_f1: Close
[0m12:15:21.654655 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:15:21.660128 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:15:21.661144 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:15:21.661144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:21.702056 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m12:15:21.703166 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:15:21.704057 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:15:21.714099 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.009 seconds
[0m12:15:21.715635 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:15:21.716612 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:15:21.726867 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:21.726867 [debug] [MainThread]: On master: BEGIN
[0m12:15:21.727867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:21.764840 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:15:21.765844 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:21.765844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:15:21.776483 [debug] [MainThread]: SQL status: SELECT 33 in 0.009 seconds
[0m12:15:21.784205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df467891-6fc1-487a-b0f4-932e028701cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209765A4460>]}
[0m12:15:21.785220 [debug] [MainThread]: On master: ROLLBACK
[0m12:15:21.786215 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:21.786720 [debug] [MainThread]: On master: BEGIN
[0m12:15:21.787727 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:15:21.787727 [debug] [MainThread]: On master: COMMIT
[0m12:15:21.788726 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:21.788726 [debug] [MainThread]: On master: COMMIT
[0m12:15:21.788726 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:21.790235 [debug] [MainThread]: On master: Close
[0m12:15:21.795580 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_filters
[0m12:15:21.796599 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_session_filters ...................... [RUN]
[0m12:15:21.798580 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_filters'
[0m12:15:21.798580 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_filters
[0m12:15:21.806609 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_filters"
[0m12:15:21.808612 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_filters
[0m12:15:21.837800 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_filters"
[0m12:15:21.838799 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:15:21.838799 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: BEGIN
[0m12:15:21.840308 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:15:21.876654 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:15:21.877688 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:15:21.877688 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */

  create view "f1"."f1_data"."final_session_filters__dbt_tmp"
    
    
  as (
    WITH session_drivers AS (
   SELECT DISTINCT
       s.session_key,
       s.country_name,
       s.session_type,
       s.year,
       d.driver_number,
       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name
   FROM "f1"."f1_data"."stg_sessions" s
   JOIN "f1"."f1_data"."stg_drivers" d ON s.session_key = d.session_key
)
SELECT
   s.session_key,
    s.year,
   s.country_name,
   s.circuit_short_name,
   s.session_type,
   concat(s.year, ' - ', s.country_name, ' - ', s.session_type) as session_display_name,
   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,
   m.meeting_name,
   m.meeting_official_name,
   s.date_start
FROM "f1"."f1_data"."stg_sessions" s
JOIN session_drivers sd ON s.session_key = sd.session_key
JOIN "f1"."f1_data"."stg_meeting" m ON s.year = m.year
   AND s.country_name = m.country_name
GROUP BY 1,2,3,4,5,8,9,10
  );
[0m12:15:21.884720 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:15:21.892264 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:15:21.893267 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
alter table "f1"."f1_data"."final_session_filters__dbt_tmp" rename to "final_session_filters"
[0m12:15:21.894777 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:15:21.907198 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m12:15:21.908204 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:15:21.908204 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m12:15:21.910197 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:15:21.915759 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_session_filters__dbt_backup"
[0m12:15:21.920282 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:15:21.920282 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
drop view if exists "f1"."f1_data"."final_session_filters__dbt_backup" cascade
[0m12:15:21.921310 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:15:21.923803 [debug] [Thread-1 (]: On model.f1_analytics.final_session_filters: Close
[0m12:15:21.927086 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df467891-6fc1-487a-b0f4-932e028701cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209781CAFE0>]}
[0m12:15:21.928096 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.final_session_filters ................. [[32mCREATE VIEW[0m in 0.13s]
[0m12:15:21.929098 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_filters
[0m12:15:21.930351 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:21.930351 [debug] [MainThread]: On master: BEGIN
[0m12:15:21.931461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:21.970675 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m12:15:21.970675 [debug] [MainThread]: On master: COMMIT
[0m12:15:21.971237 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:21.971237 [debug] [MainThread]: On master: COMMIT
[0m12:15:21.972345 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:21.972345 [debug] [MainThread]: On master: Close
[0m12:15:21.973843 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:21.974445 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:15:21.975067 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:15:21.975067 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_filters' was properly closed.
[0m12:15:21.976081 [info ] [MainThread]: 
[0m12:15:21.976081 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:15:21.977216 [debug] [MainThread]: Command end result
[0m12:15:22.004057 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:15:22.006599 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:15:22.012164 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:15:22.013158 [info ] [MainThread]: 
[0m12:15:22.014191 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:22.014732 [info ] [MainThread]: 
[0m12:15:22.015765 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:15:22.018757 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:22.018757 after 1.60 seconds
[0m12:15:22.020269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209752FE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020977C997B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020976837280>]}
[0m12:15:22.021277 [debug] [MainThread]: Flushing usage events
[0m12:15:22.320193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:15:50.144740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C30DE350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C53B0F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C53B0D90>]}


============================== 12:15:50.147758 | c1121da5-53f1-4144-8c41-8435d309497e ==============================
[0m12:15:50.147758 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:15:50.148755 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select final_car', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:15:50.323145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1121da5-53f1-4144-8c41-8435d309497e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C548C250>]}
[0m12:15:50.376952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c1121da5-53f1-4144-8c41-8435d309497e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C5378FA0>]}
[0m12:15:50.378932 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:15:50.527500 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:15:50.754302 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:50.755388 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_car.sql
[0m12:15:51.062394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1121da5-53f1-4144-8c41-8435d309497e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C5352800>]}
[0m12:15:51.148924 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:15:51.150920 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:15:51.177129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1121da5-53f1-4144-8c41-8435d309497e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C53B1930>]}
[0m12:15:51.178116 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:15:51.178116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1121da5-53f1-4144-8c41-8435d309497e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C548F940>]}
[0m12:15:51.180119 [info ] [MainThread]: 
[0m12:15:51.180788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:15:51.181802 [info ] [MainThread]: 
[0m12:15:51.182797 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:15:51.184304 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:15:51.235591 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:15:51.236685 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:15:51.236685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:51.280096 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.043 seconds
[0m12:15:51.281106 [debug] [ThreadPool]: On list_f1: Close
[0m12:15:51.290161 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:15:51.294873 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:15:51.295979 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:15:51.295979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:51.334483 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m12:15:51.334483 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:15:51.335550 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:15:51.347306 [debug] [ThreadPool]: SQL status: SELECT 34 in 0.010 seconds
[0m12:15:51.349315 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:15:51.350301 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:15:51.360326 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.360326 [debug] [MainThread]: On master: BEGIN
[0m12:15:51.361338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:15:51.517504 [debug] [MainThread]: SQL status: BEGIN in 0.156 seconds
[0m12:15:51.517504 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.518531 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:15:51.528088 [debug] [MainThread]: SQL status: SELECT 36 in 0.009 seconds
[0m12:15:51.534173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1121da5-53f1-4144-8c41-8435d309497e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C4B463E0>]}
[0m12:15:51.534173 [debug] [MainThread]: On master: ROLLBACK
[0m12:15:51.535184 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.535184 [debug] [MainThread]: On master: BEGIN
[0m12:15:51.536186 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:15:51.536186 [debug] [MainThread]: On master: COMMIT
[0m12:15:51.537202 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.537945 [debug] [MainThread]: On master: COMMIT
[0m12:15:51.539184 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:51.539184 [debug] [MainThread]: On master: Close
[0m12:15:51.546808 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_car
[0m12:15:51.547813 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_car .................................. [RUN]
[0m12:15:51.548815 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_car'
[0m12:15:51.548815 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_car
[0m12:15:51.556616 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_car"
[0m12:15:51.558623 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_car
[0m12:15:51.587715 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_car"
[0m12:15:51.590216 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:15:51.591225 [debug] [Thread-1 (]: On model.f1_analytics.final_car: BEGIN
[0m12:15:51.591225 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:15:51.623952 [debug] [Thread-1 (]: SQL status: BEGIN in 0.032 seconds
[0m12:15:51.624992 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:15:51.624992 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */

  create view "f1"."f1_data"."final_car__dbt_tmp"
    
    
  as (
    

SELECT
   t.date,
   CONCAT(t.name_acronym, ' (', t.team_name, ')') as driver,
   t.driver_number,
   ROUND(t.speed) as speed,
   ROUND(t.throttle) as throttle,
   ROUND(t.brake) as brake,
   t.rpm,
   t.session_key,  -- Add session_key
   m.meeting_key   -- Add meeting_key
FROM "f1"."f1_data"."int_car_base" t
LEFT JOIN "f1"."f1_data"."stg_sessions" s ON t.session_key = s.session_key
LEFT JOIN "f1"."f1_data"."stg_meeting" m ON s.meeting_key = m.meeting_key
  );
[0m12:15:51.631108 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:15:51.639192 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:15:51.640193 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
alter table "f1"."f1_data"."final_car__dbt_tmp" rename to "final_car"
[0m12:15:51.641183 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:15:51.654280 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m12:15:51.654883 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:15:51.654883 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m12:15:51.657886 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:15:51.662945 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_car__dbt_backup"
[0m12:15:51.667397 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:15:51.667397 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
drop view if exists "f1"."f1_data"."final_car__dbt_backup" cascade
[0m12:15:51.668391 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:15:51.670382 [debug] [Thread-1 (]: On model.f1_analytics.final_car: Close
[0m12:15:51.673873 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c1121da5-53f1-4144-8c41-8435d309497e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C6F6EFE0>]}
[0m12:15:51.675502 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.final_car ............................. [[32mCREATE VIEW[0m in 0.12s]
[0m12:15:51.676513 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_car
[0m12:15:51.678510 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.678510 [debug] [MainThread]: On master: BEGIN
[0m12:15:51.678510 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:15:51.719172 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m12:15:51.720197 [debug] [MainThread]: On master: COMMIT
[0m12:15:51.721246 [debug] [MainThread]: Using postgres connection "master"
[0m12:15:51.721246 [debug] [MainThread]: On master: COMMIT
[0m12:15:51.721844 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:15:51.721844 [debug] [MainThread]: On master: Close
[0m12:15:51.723359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:51.723359 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:15:51.724370 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:15:51.724370 [debug] [MainThread]: Connection 'model.f1_analytics.final_car' was properly closed.
[0m12:15:51.724883 [info ] [MainThread]: 
[0m12:15:51.725891 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.54 seconds (0.54s).
[0m12:15:51.725891 [debug] [MainThread]: Command end result
[0m12:15:51.748411 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:15:51.750973 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:15:51.759373 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:15:51.760351 [info ] [MainThread]: 
[0m12:15:51.761347 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:15:51.762373 [info ] [MainThread]: 
[0m12:15:51.762972 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:15:51.763980 [debug] [MainThread]: Command `dbt run` succeeded at 12:15:51.763980 after 1.70 seconds
[0m12:15:51.764984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C30DE350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C5305C00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6C53074F0>]}
[0m12:15:51.764984 [debug] [MainThread]: Flushing usage events
[0m12:15:52.088019 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:16:44.775051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A905DD2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9070D0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9070D0D30>]}


============================== 12:16:44.779054 | ba3b9023-bda2-400d-bc50-641209220e7b ==============================
[0m12:16:44.779054 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:16:44.780054 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select final_session_mapping', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:44.957555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba3b9023-bda2-400d-bc50-641209220e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A90726EAD0>]}
[0m12:16:45.011444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba3b9023-bda2-400d-bc50-641209220e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A906E43EB0>]}
[0m12:16:45.012377 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:16:45.160268 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:16:45.368722 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:16:45.370250 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_session_mapping.sql
[0m12:16:45.664598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba3b9023-bda2-400d-bc50-641209220e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A903C6A9B0>]}
[0m12:16:45.753097 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:16:45.755587 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:16:45.779821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba3b9023-bda2-400d-bc50-641209220e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9071AF370>]}
[0m12:16:45.780836 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:16:45.780836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba3b9023-bda2-400d-bc50-641209220e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A9071AC310>]}
[0m12:16:45.782873 [info ] [MainThread]: 
[0m12:16:45.783872 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:16:45.783872 [info ] [MainThread]: 
[0m12:16:45.785370 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:16:45.786369 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:16:45.839949 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:16:45.841879 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:16:45.842958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:45.884113 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m12:16:45.886157 [debug] [ThreadPool]: On list_f1: Close
[0m12:16:45.896187 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:16:45.901161 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:16:45.901161 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:16:45.902161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:45.938776 [debug] [ThreadPool]: SQL status: BEGIN in 0.037 seconds
[0m12:16:45.938776 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:16:45.940283 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:16:45.948446 [debug] [ThreadPool]: SQL status: SELECT 35 in 0.007 seconds
[0m12:16:45.950459 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:16:45.951454 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:16:45.961186 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:45.961186 [debug] [MainThread]: On master: BEGIN
[0m12:16:45.962166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:45.999241 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:16:46.000236 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:46.000236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:16:46.009293 [debug] [MainThread]: SQL status: SELECT 39 in 0.008 seconds
[0m12:16:46.017446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba3b9023-bda2-400d-bc50-641209220e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A90702B310>]}
[0m12:16:46.018446 [debug] [MainThread]: On master: ROLLBACK
[0m12:16:46.018446 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:46.019447 [debug] [MainThread]: On master: BEGIN
[0m12:16:46.020051 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:16:46.021055 [debug] [MainThread]: On master: COMMIT
[0m12:16:46.021055 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:46.021055 [debug] [MainThread]: On master: COMMIT
[0m12:16:46.022054 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:46.022054 [debug] [MainThread]: On master: Close
[0m12:16:46.027077 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_mapping
[0m12:16:46.028153 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_session_mapping ...................... [RUN]
[0m12:16:46.028800 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_mapping'
[0m12:16:46.028800 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_mapping
[0m12:16:46.037684 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_mapping"
[0m12:16:46.038683 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_mapping
[0m12:16:46.075917 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_mapping"
[0m12:16:46.078182 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:16:46.078182 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: BEGIN
[0m12:16:46.079182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:16:46.118668 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:16:46.119668 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:16:46.120205 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */

  create view "f1"."f1_data"."final_session_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    EXTRACT(YEAR FROM date_start)::text || ' - ' || country_name || ' - ' || session_name AS session_display_name,
    session_key
FROM "f1"."f1_data"."stg_sessions"
  );
[0m12:16:46.121301 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "session_name" does not exist
LINE 10: ...start)::text || ' - ' || country_name || ' - ' || session_na...
                                                              ^
HINT:  Perhaps you meant to reference the column "stg_sessions.session_type".

[0m12:16:46.122200 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: ROLLBACK
[0m12:16:46.123211 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: Close
[0m12:16:46.128234 [debug] [Thread-1 (]: Database Error in model final_session_mapping (f1_analytics/models\marts\final_session_mapping.sql)
  column "session_name" does not exist
  LINE 10: ...start)::text || ' - ' || country_name || ' - ' || session_na...
                                                                ^
  HINT:  Perhaps you meant to reference the column "stg_sessions.session_type".
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_mapping.sql
[0m12:16:46.132230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba3b9023-bda2-400d-bc50-641209220e7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A904C943A0>]}
[0m12:16:46.134237 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.final_session_mapping ............. [[31mERROR[0m in 0.10s]
[0m12:16:46.134237 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_mapping
[0m12:16:46.136790 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_session_mapping' to be skipped because of status 'error'.  Reason: Database Error in model final_session_mapping (f1_analytics/models\marts\final_session_mapping.sql)
  column "session_name" does not exist
  LINE 10: ...start)::text || ' - ' || country_name || ' - ' || session_na...
                                                                ^
  HINT:  Perhaps you meant to reference the column "stg_sessions.session_type".
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_mapping.sql.
[0m12:16:46.138789 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:46.140305 [debug] [MainThread]: On master: BEGIN
[0m12:16:46.140305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:46.181048 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:16:46.182055 [debug] [MainThread]: On master: COMMIT
[0m12:16:46.182055 [debug] [MainThread]: Using postgres connection "master"
[0m12:16:46.183033 [debug] [MainThread]: On master: COMMIT
[0m12:16:46.184034 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:16:46.184568 [debug] [MainThread]: On master: Close
[0m12:16:46.184568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:46.185565 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:16:46.186786 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:16:46.188422 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_mapping' was properly closed.
[0m12:16:46.190100 [info ] [MainThread]: 
[0m12:16:46.191799 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:16:46.192812 [debug] [MainThread]: Command end result
[0m12:16:46.220980 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:16:46.227016 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:16:46.236856 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:16:46.237862 [info ] [MainThread]: 
[0m12:16:46.238906 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:16:46.238906 [info ] [MainThread]: 
[0m12:16:46.240434 [error] [MainThread]: [31mFailure in model final_session_mapping (f1_analytics/models\marts\final_session_mapping.sql)[0m
[0m12:16:46.241449 [error] [MainThread]:   Database Error in model final_session_mapping (f1_analytics/models\marts\final_session_mapping.sql)
  column "session_name" does not exist
  LINE 10: ...start)::text || ' - ' || country_name || ' - ' || session_na...
                                                                ^
  HINT:  Perhaps you meant to reference the column "stg_sessions.session_type".
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_session_mapping.sql
[0m12:16:46.241449 [info ] [MainThread]: 
[0m12:16:46.242472 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_session_mapping.sql
[0m12:16:46.242472 [info ] [MainThread]: 
[0m12:16:46.242472 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:16:46.243980 [debug] [MainThread]: Command `dbt run` failed at 12:16:46.243980 after 1.56 seconds
[0m12:16:46.245062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A905DD2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A908D574C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A908D57280>]}
[0m12:16:46.245062 [debug] [MainThread]: Flushing usage events
[0m12:16:46.538745 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:04.044494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FEB5A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFE30F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFE30D60>]}


============================== 12:17:04.049012 | f5503c74-40d5-4521-97b8-ed004ef9f4c9 ==============================
[0m12:17:04.049012 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:17:04.050010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select final_session_mapping', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:04.224658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5503c74-40d5-4521-97b8-ed004ef9f4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFF0B940>]}
[0m12:17:04.283212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5503c74-40d5-4521-97b8-ed004ef9f4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFE32C50>]}
[0m12:17:04.284205 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:17:04.431105 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:17:04.641265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:17:04.642284 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_session_mapping.sql
[0m12:17:04.944297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5503c74-40d5-4521-97b8-ed004ef9f4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002358151E440>]}
[0m12:17:05.031682 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:17:05.034283 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:17:05.062237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5503c74-40d5-4521-97b8-ed004ef9f4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFC61C00>]}
[0m12:17:05.063227 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:17:05.064208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5503c74-40d5-4521-97b8-ed004ef9f4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235814A3A30>]}
[0m12:17:05.066447 [info ] [MainThread]: 
[0m12:17:05.067445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:05.067445 [info ] [MainThread]: 
[0m12:17:05.068440 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:05.069440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:17:05.126183 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:17:05.127196 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:17:05.127196 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:05.168847 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m12:17:05.171438 [debug] [ThreadPool]: On list_f1: Close
[0m12:17:05.181119 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:17:05.188264 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:17:05.189265 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:17:05.189265 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:05.236577 [debug] [ThreadPool]: SQL status: BEGIN in 0.047 seconds
[0m12:17:05.236577 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:17:05.237578 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:17:05.244848 [debug] [ThreadPool]: SQL status: SELECT 35 in 0.007 seconds
[0m12:17:05.247457 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:17:05.248452 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:17:05.258148 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:05.259151 [debug] [MainThread]: On master: BEGIN
[0m12:17:05.259151 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:05.294155 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m12:17:05.295355 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:05.296354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:05.306353 [debug] [MainThread]: SQL status: SELECT 39 in 0.010 seconds
[0m12:17:05.314012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5503c74-40d5-4521-97b8-ed004ef9f4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFDD7700>]}
[0m12:17:05.314012 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:05.315109 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:05.316116 [debug] [MainThread]: On master: BEGIN
[0m12:17:05.316116 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:05.317022 [debug] [MainThread]: On master: COMMIT
[0m12:17:05.317022 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:05.317022 [debug] [MainThread]: On master: COMMIT
[0m12:17:05.318020 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:05.318020 [debug] [MainThread]: On master: Close
[0m12:17:05.322089 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_mapping
[0m12:17:05.324385 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_session_mapping ...................... [RUN]
[0m12:17:05.326385 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_mapping'
[0m12:17:05.326969 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_mapping
[0m12:17:05.334105 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_mapping"
[0m12:17:05.335149 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_mapping
[0m12:17:05.370030 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_mapping"
[0m12:17:05.371061 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:17:05.372052 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: BEGIN
[0m12:17:05.372052 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:17:05.412440 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:17:05.412440 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:17:05.413955 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */

  create view "f1"."f1_data"."final_session_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    EXTRACT(YEAR FROM date_start)::text || ' - ' || country_name || ' - ' || session_type AS session_display_name,
    session_key
FROM "f1"."f1_data"."stg_sessions"
  );
[0m12:17:05.420012 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:17:05.427571 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:17:05.428577 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
alter table "f1"."f1_data"."final_session_mapping__dbt_tmp" rename to "final_session_mapping"
[0m12:17:05.430087 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:17:05.446400 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m12:17:05.446400 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:17:05.447495 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m12:17:05.449516 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:17:05.457030 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_session_mapping__dbt_backup"
[0m12:17:05.461015 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:17:05.462014 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
drop view if exists "f1"."f1_data"."final_session_mapping__dbt_backup" cascade
[0m12:17:05.462014 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:17:05.466126 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: Close
[0m12:17:05.469134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5503c74-40d5-4521-97b8-ed004ef9f4c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023581A2EFE0>]}
[0m12:17:05.470131 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.final_session_mapping ................. [[32mCREATE VIEW[0m in 0.14s]
[0m12:17:05.471132 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_mapping
[0m12:17:05.472131 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:05.473157 [debug] [MainThread]: On master: BEGIN
[0m12:17:05.473690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:05.518139 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m12:17:05.519137 [debug] [MainThread]: On master: COMMIT
[0m12:17:05.519137 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:05.520160 [debug] [MainThread]: On master: COMMIT
[0m12:17:05.520160 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:05.521198 [debug] [MainThread]: On master: Close
[0m12:17:05.522157 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:05.522157 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:17:05.523215 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:17:05.524374 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_mapping' was properly closed.
[0m12:17:05.524374 [info ] [MainThread]: 
[0m12:17:05.526626 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m12:17:05.526626 [debug] [MainThread]: Command end result
[0m12:17:05.548648 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:17:05.552168 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:17:05.561105 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:17:05.561105 [info ] [MainThread]: 
[0m12:17:05.562317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:17:05.563327 [info ] [MainThread]: 
[0m12:17:05.564324 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:17:05.564324 [debug] [MainThread]: Command `dbt run` succeeded at 12:17:05.564324 after 1.63 seconds
[0m12:17:05.565879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FEB5A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFF0BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235FFC633D0>]}
[0m12:17:05.565879 [debug] [MainThread]: Flushing usage events
[0m12:17:05.898511 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:18.902994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FA84E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FCB20F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FCB20D60>]}


============================== 12:17:18.907004 | dd22e50f-fa22-4fd8-8d15-f439c8dde259 ==============================
[0m12:17:18.907004 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:17:18.907876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select final_race_leaderboard', 'send_anonymous_usage_stats': 'True'}
[0m12:17:19.084520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd22e50f-fa22-4fd8-8d15-f439c8dde259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FCBFDB10>]}
[0m12:17:19.140203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd22e50f-fa22-4fd8-8d15-f439c8dde259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FCBFFAF0>]}
[0m12:17:19.142216 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:17:19.294298 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:17:19.498657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:17:19.500168 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:17:19.552524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd22e50f-fa22-4fd8-8d15-f439c8dde259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FE1A4E80>]}
[0m12:17:19.694582 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:17:19.698137 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:17:19.723177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd22e50f-fa22-4fd8-8d15-f439c8dde259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FE153430>]}
[0m12:17:19.724187 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:17:19.724187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd22e50f-fa22-4fd8-8d15-f439c8dde259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FE1534F0>]}
[0m12:17:19.726202 [info ] [MainThread]: 
[0m12:17:19.727207 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:17:19.728208 [info ] [MainThread]: 
[0m12:17:19.728208 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:17:19.730213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:17:19.782249 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:17:19.783922 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:17:19.783922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:19.823214 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.039 seconds
[0m12:17:19.824242 [debug] [ThreadPool]: On list_f1: Close
[0m12:17:19.831422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:17:19.836932 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:17:19.836932 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:17:19.837936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:17:19.880390 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m12:17:19.881403 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:17:19.882401 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:17:19.888028 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.006 seconds
[0m12:17:19.890013 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:17:19.891012 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:17:19.900084 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.901097 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.901097 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:17:19.938894 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:17:19.938894 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.940404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:17:19.951121 [debug] [MainThread]: SQL status: SELECT 40 in 0.010 seconds
[0m12:17:19.958198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd22e50f-fa22-4fd8-8d15-f439c8dde259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FCD12620>]}
[0m12:17:19.959206 [debug] [MainThread]: On master: ROLLBACK
[0m12:17:19.960110 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.960110 [debug] [MainThread]: On master: BEGIN
[0m12:17:19.961368 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:17:19.962371 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.962371 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:19.962371 [debug] [MainThread]: On master: COMMIT
[0m12:17:19.963891 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:19.964531 [debug] [MainThread]: On master: Close
[0m12:17:19.972059 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m12:17:19.973578 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_race_leaderboard ..................... [RUN]
[0m12:17:19.975117 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_race_leaderboard'
[0m12:17:19.976114 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_leaderboard
[0m12:17:19.983138 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_leaderboard"
[0m12:17:19.986660 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_leaderboard
[0m12:17:20.022166 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_leaderboard"
[0m12:17:20.023746 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:17:20.024299 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: BEGIN
[0m12:17:20.024299 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:17:20.173663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.149 seconds
[0m12:17:20.174307 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:17:20.174307 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */

  create view "f1"."f1_data"."final_race_leaderboard__dbt_tmp"
    
    
  as (
    

WITH final_rankings AS (
   SELECT
       session_key,
       driver_number,
       position,
   FROM int_final_position
)
SELECT
   fr.session_key,
   d.driver_number,
   d.broadcast_name AS driver_name,
   fr.position,
   d.team_name,
   d.team_colour AS team_color,
   CASE
       WHEN fr.position = 1 THEN 0
       ELSE fi.max_gap_to_leader
   END as gap_to_leader,
   fi.max_gap_to_next as gap_to_next,
   bl.fastest_lap,
   ps.pit_stop_count,

   CASE
       WHEN fr.position = 1 THEN 25
       WHEN fr.position = 2 THEN 18
       WHEN fr.position = 3 THEN 15
       WHEN fr.position = 4 THEN 12
       WHEN fr.position = 5 THEN 10
       WHEN fr.position = 6 THEN 8
       WHEN fr.position = 7 THEN 6
       WHEN fr.position = 8 THEN 4
       WHEN fr.position = 9 THEN 2
       WHEN fr.position = 10 THEN 1
       ELSE 0
   END AS points
FROM final_rankings fr
JOIN "f1"."f1_data"."stg_drivers" d
   ON fr.driver_number = d.driver_number
   AND fr.session_key = d.session_key
LEFT JOIN "f1"."f1_data"."int_final_intervals" fi
   ON fr.session_key = fi.session_key
   AND fr.driver_number = fi.driver_number
LEFT JOIN "f1"."f1_data"."int_best_laps" bl
   ON fr.session_key = bl.session_key
   AND fr.driver_number = bl.driver_number
LEFT JOIN "f1"."f1_data"."int_pit_stop" ps
   ON fr.session_key = ps.session_key
   AND fr.driver_number = ps.driver_number
JOIN "f1"."f1_data"."final_session_mapping" m
   ON fr.session_key = m.session_key
ORDER BY fr.position
  );
[0m12:17:20.175313 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 14:    FROM int_final_position
            ^

[0m12:17:20.176317 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: ROLLBACK
[0m12:17:20.176317 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: Close
[0m12:17:20.179317 [debug] [Thread-1 (]: Database Error in model final_race_leaderboard (f1_analytics/models\marts\final_race_leaderboard.sql)
  syntax error at or near "FROM"
  LINE 14:    FROM int_final_position
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_leaderboard.sql
[0m12:17:20.182315 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd22e50f-fa22-4fd8-8d15-f439c8dde259', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FA6E7100>]}
[0m12:17:20.182315 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.final_race_leaderboard ............ [[31mERROR[0m in 0.21s]
[0m12:17:20.184411 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m12:17:20.184411 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_race_leaderboard' to be skipped because of status 'error'.  Reason: Database Error in model final_race_leaderboard (f1_analytics/models\marts\final_race_leaderboard.sql)
  syntax error at or near "FROM"
  LINE 14:    FROM int_final_position
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_leaderboard.sql.
[0m12:17:20.187519 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:20.187519 [debug] [MainThread]: On master: BEGIN
[0m12:17:20.188518 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:17:20.225328 [debug] [MainThread]: SQL status: BEGIN in 0.037 seconds
[0m12:17:20.226322 [debug] [MainThread]: On master: COMMIT
[0m12:17:20.227338 [debug] [MainThread]: Using postgres connection "master"
[0m12:17:20.228325 [debug] [MainThread]: On master: COMMIT
[0m12:17:20.229325 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:17:20.229325 [debug] [MainThread]: On master: Close
[0m12:17:20.230321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:17:20.231326 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:17:20.232322 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:17:20.232322 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_leaderboard' was properly closed.
[0m12:17:20.233324 [info ] [MainThread]: 
[0m12:17:20.234833 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m12:17:20.236338 [debug] [MainThread]: Command end result
[0m12:17:20.258990 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:17:20.262505 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:17:20.269017 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:17:20.270522 [info ] [MainThread]: 
[0m12:17:20.271527 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:17:20.271527 [info ] [MainThread]: 
[0m12:17:20.272528 [error] [MainThread]: [31mFailure in model final_race_leaderboard (f1_analytics/models\marts\final_race_leaderboard.sql)[0m
[0m12:17:20.274037 [error] [MainThread]:   Database Error in model final_race_leaderboard (f1_analytics/models\marts\final_race_leaderboard.sql)
  syntax error at or near "FROM"
  LINE 14:    FROM int_final_position
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_leaderboard.sql
[0m12:17:20.274037 [info ] [MainThread]: 
[0m12:17:20.275043 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_race_leaderboard.sql
[0m12:17:20.276084 [info ] [MainThread]: 
[0m12:17:20.276084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:17:20.277044 [debug] [MainThread]: Command `dbt run` failed at 12:17:20.277044 after 1.48 seconds
[0m12:17:20.278057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FA84E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FE11EEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000246FBB50940>]}
[0m12:17:20.278057 [debug] [MainThread]: Flushing usage events
[0m12:17:20.588517 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:27.508731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DE4BA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0760F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0760D60>]}


============================== 12:18:27.512289 | 2e770073-e7b2-4996-80a1-4f123374ce0e ==============================
[0m12:18:27.512289 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:18:27.513280 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select final_race_leaderboard', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:18:27.688940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e770073-e7b2-4996-80a1-4f123374ce0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E083F940>]}
[0m12:18:27.744000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e770073-e7b2-4996-80a1-4f123374ce0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0762C50>]}
[0m12:18:27.746027 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:18:27.897985 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:18:28.040255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:18:28.041277 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_race_leaderboard.sql
[0m12:18:28.341586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e770073-e7b2-4996-80a1-4f123374ce0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0761B10>]}
[0m12:18:28.433986 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:18:28.437113 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:18:28.462126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e770073-e7b2-4996-80a1-4f123374ce0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E1EBEDA0>]}
[0m12:18:28.463125 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:18:28.463125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e770073-e7b2-4996-80a1-4f123374ce0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E1D921D0>]}
[0m12:18:28.465331 [info ] [MainThread]: 
[0m12:18:28.465331 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:28.466317 [info ] [MainThread]: 
[0m12:18:28.468320 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:28.470319 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:18:28.524059 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:18:28.525070 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:18:28.525070 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:28.567363 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m12:18:28.569335 [debug] [ThreadPool]: On list_f1: Close
[0m12:18:28.576265 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:18:28.581248 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:18:28.582270 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:18:28.582270 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:28.617612 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m12:18:28.618639 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:18:28.618639 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:18:28.628191 [debug] [ThreadPool]: SQL status: SELECT 36 in 0.008 seconds
[0m12:18:28.630196 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:18:28.630196 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:18:28.640317 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:28.641345 [debug] [MainThread]: On master: BEGIN
[0m12:18:28.641345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:28.678143 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:18:28.678143 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:28.679143 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:28.692235 [debug] [MainThread]: SQL status: SELECT 40 in 0.012 seconds
[0m12:18:28.699257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e770073-e7b2-4996-80a1-4f123374ce0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E0707700>]}
[0m12:18:28.700258 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:28.700258 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:28.701263 [debug] [MainThread]: On master: BEGIN
[0m12:18:28.701263 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:18:28.702264 [debug] [MainThread]: On master: COMMIT
[0m12:18:28.702264 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:28.703263 [debug] [MainThread]: On master: COMMIT
[0m12:18:28.703263 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:18:28.704308 [debug] [MainThread]: On master: Close
[0m12:18:28.707441 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m12:18:28.708535 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_race_leaderboard ..................... [RUN]
[0m12:18:28.709446 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_race_leaderboard'
[0m12:18:28.709446 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_leaderboard
[0m12:18:28.717755 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_leaderboard"
[0m12:18:28.720264 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_leaderboard
[0m12:18:28.752274 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_leaderboard"
[0m12:18:28.754282 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:18:28.755357 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: BEGIN
[0m12:18:28.756405 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:18:28.796748 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:18:28.796748 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:18:28.797747 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */

  create view "f1"."f1_data"."final_race_leaderboard__dbt_tmp"
    
    
  as (
    

WITH final_rankings AS (
   SELECT
       session_key,
       driver_number,
       position
   FROM int_final_position
)
SELECT
   fr.session_key,
   d.driver_number,
   d.broadcast_name AS driver_name,
   fr.position,
   d.team_name,
   d.team_colour AS team_color,
   CASE
       WHEN fr.position = 1 THEN 0
       ELSE fi.max_gap_to_leader
   END as gap_to_leader,
   fi.max_gap_to_next as gap_to_next,
   bl.fastest_lap,
   ps.pit_stop_count,

   CASE
       WHEN fr.position = 1 THEN 25
       WHEN fr.position = 2 THEN 18
       WHEN fr.position = 3 THEN 15
       WHEN fr.position = 4 THEN 12
       WHEN fr.position = 5 THEN 10
       WHEN fr.position = 6 THEN 8
       WHEN fr.position = 7 THEN 6
       WHEN fr.position = 8 THEN 4
       WHEN fr.position = 9 THEN 2
       WHEN fr.position = 10 THEN 1
       ELSE 0
   END AS points
FROM final_rankings fr
JOIN "f1"."f1_data"."stg_drivers" d
   ON fr.driver_number = d.driver_number
   AND fr.session_key = d.session_key
LEFT JOIN "f1"."f1_data"."int_final_intervals" fi
   ON fr.session_key = fi.session_key
   AND fr.driver_number = fi.driver_number
LEFT JOIN "f1"."f1_data"."int_best_laps" bl
   ON fr.session_key = bl.session_key
   AND fr.driver_number = bl.driver_number
LEFT JOIN "f1"."f1_data"."int_pit_stop" ps
   ON fr.session_key = ps.session_key
   AND fr.driver_number = ps.driver_number
JOIN "f1"."f1_data"."final_session_mapping" m
   ON fr.session_key = m.session_key
ORDER BY fr.position
  );
[0m12:18:28.803303 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m12:18:28.811136 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:18:28.811136 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
alter table "f1"."f1_data"."final_race_leaderboard__dbt_tmp" rename to "final_race_leaderboard"
[0m12:18:28.813146 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:18:28.827254 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m12:18:28.827254 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:18:28.828255 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m12:18:28.830353 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:18:28.836609 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_race_leaderboard__dbt_backup"
[0m12:18:28.840322 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:18:28.840322 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
drop view if exists "f1"."f1_data"."final_race_leaderboard__dbt_backup" cascade
[0m12:18:28.842373 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:18:28.844896 [debug] [Thread-1 (]: On model.f1_analytics.final_race_leaderboard: Close
[0m12:18:28.847890 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e770073-e7b2-4996-80a1-4f123374ce0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E233A5C0>]}
[0m12:18:28.848892 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.final_race_leaderboard ................ [[32mCREATE VIEW[0m in 0.14s]
[0m12:18:28.848892 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m12:18:28.851150 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:28.852157 [debug] [MainThread]: On master: BEGIN
[0m12:18:28.852157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:28.890444 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m12:18:28.891464 [debug] [MainThread]: On master: COMMIT
[0m12:18:28.892454 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:28.892454 [debug] [MainThread]: On master: COMMIT
[0m12:18:28.893964 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:18:28.894563 [debug] [MainThread]: On master: Close
[0m12:18:28.895564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:28.895564 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:18:28.895564 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:18:28.896583 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_leaderboard' was properly closed.
[0m12:18:28.896583 [info ] [MainThread]: 
[0m12:18:28.897565 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:18:28.898566 [debug] [MainThread]: Command end result
[0m12:18:28.924226 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:18:28.925743 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:18:28.932261 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:18:28.932261 [info ] [MainThread]: 
[0m12:18:28.933257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:28.934047 [info ] [MainThread]: 
[0m12:18:28.936062 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:18:28.937077 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:28.937077 after 1.51 seconds
[0m12:18:28.938072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155DE4BA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E083FEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000155E2348D90>]}
[0m12:18:28.939069 [debug] [MainThread]: Flushing usage events
[0m12:18:29.357419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:18:39.531332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FAAFE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FCDD0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FCDD0D30>]}


============================== 12:18:39.538599 | e44a76a7-6495-4450-8266-dea902196e93 ==============================
[0m12:18:39.538599 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:18:39.540106 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select final_race_summary', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:18:39.716236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e44a76a7-6495-4450-8266-dea902196e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FCF6AAD0>]}
[0m12:18:39.771113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e44a76a7-6495-4450-8266-dea902196e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FCB43EB0>]}
[0m12:18:39.774239 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:18:39.920225 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:18:40.116451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:18:40.117450 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:18:40.165018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e44a76a7-6495-4450-8266-dea902196e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FE450E50>]}
[0m12:18:40.308271 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:18:40.311220 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:18:40.336433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e44a76a7-6495-4450-8266-dea902196e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FD22F280>]}
[0m12:18:40.336433 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:18:40.338436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e44a76a7-6495-4450-8266-dea902196e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FD22F250>]}
[0m12:18:40.340435 [info ] [MainThread]: 
[0m12:18:40.341444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:18:40.341444 [info ] [MainThread]: 
[0m12:18:40.342446 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:18:40.343950 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:18:40.398537 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:18:40.398537 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:18:40.400048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:40.440772 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m12:18:40.442778 [debug] [ThreadPool]: On list_f1: Close
[0m12:18:40.449291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:18:40.454942 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:18:40.454942 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:18:40.455945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:40.496863 [debug] [ThreadPool]: SQL status: BEGIN in 0.041 seconds
[0m12:18:40.497903 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:18:40.497903 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:18:40.504392 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.005 seconds
[0m12:18:40.505922 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:18:40.506918 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:18:40.515957 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:40.515957 [debug] [MainThread]: On master: BEGIN
[0m12:18:40.516962 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:40.557680 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:18:40.558677 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:40.558677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:18:40.571439 [debug] [MainThread]: SQL status: SELECT 46 in 0.012 seconds
[0m12:18:40.579923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e44a76a7-6495-4450-8266-dea902196e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3F993C700>]}
[0m12:18:40.580971 [debug] [MainThread]: On master: ROLLBACK
[0m12:18:40.582017 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:40.582627 [debug] [MainThread]: On master: BEGIN
[0m12:18:40.583786 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:18:40.584301 [debug] [MainThread]: On master: COMMIT
[0m12:18:40.584301 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:40.584822 [debug] [MainThread]: On master: COMMIT
[0m12:18:40.585941 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:18:40.586459 [debug] [MainThread]: On master: Close
[0m12:18:40.591846 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_summary
[0m12:18:40.592889 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_race_summary ......................... [RUN]
[0m12:18:40.595800 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_race_summary'
[0m12:18:40.597462 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_summary
[0m12:18:40.606917 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_summary"
[0m12:18:40.608054 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_summary
[0m12:18:40.641985 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_summary"
[0m12:18:40.643987 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:18:40.643987 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: BEGIN
[0m12:18:40.645113 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:18:40.680296 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:18:40.681296 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:18:40.681296 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */

  create view "f1"."f1_data"."final_race_summary__dbt_tmp"
    
    
  as (
    

WITH positions AS (
   SELECT
       session_key,
       COUNT(DISTINCT driver_number) as total_drivers

   FROM "f1"."f1_data"."stg_position"
   GROUP BY session_key
),
laps AS (
   SELECT
       session_key,
       MAX(lap_number) as total_laps
   FROM "f1"."f1_data"."stg_laps"
   GROUP BY session_key
),
team_stats AS (
   SELECT
       session_key,
       SUM(pit_stop_count) as total_pit_stops,
        COUNT(DISTINCT team_name) as total_teams,
   FROM "f1"."f1_data"."final_race_leaderboard"
   GROUP BY session_key
),
driver_stats AS (
   SELECT
       session_key,
       driver_number,
       MAX(speed) as top_speed,
       AVG(speed) as avg_speed,
       SUM(CASE WHEN drs = 1 THEN 1 ELSE 0 END) as drs_activations
   FROM "f1"."f1_data"."stg_car_data"
   GROUP BY session_key, driver_number
),
cte as(
SELECT
   p.session_key,
   m.session_display_name,
   p.total_drivers,
   l.total_laps,
   MAX(d.top_speed) as fastest_speed,
   round(AVG(d.avg_speed),3) as average_speed
FROM positions p
JOIN laps l ON p.session_key = l.session_key
JOIN "f1"."f1_data"."final_session_mapping" m ON p.session_key = m.session_key
LEFT JOIN driver_stats d ON p.session_key = d.session_key
GROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps
)
select c.session_key,
   c.session_display_name,
   c.total_drivers,
    t.total_teams,
   c.total_laps,
   t.total_pit_stops,
    c.fastest_speed,
   c.average_speed,
from cte c left join team_stats t on c.session_key=t.session_key
  );
[0m12:18:40.682295 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "FROM"
LINE 29:    FROM "f1"."f1_data"."final_race_leaderboard"
            ^

[0m12:18:40.683281 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: ROLLBACK
[0m12:18:40.684280 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: Close
[0m12:18:40.688211 [debug] [Thread-1 (]: Database Error in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)
  syntax error at or near "FROM"
  LINE 29:    FROM "f1"."f1_data"."final_race_leaderboard"
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_summary.sql
[0m12:18:40.691334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e44a76a7-6495-4450-8266-dea902196e93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FA99C3A0>]}
[0m12:18:40.692362 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.final_race_summary ................ [[31mERROR[0m in 0.09s]
[0m12:18:40.693335 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_summary
[0m12:18:40.694333 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_race_summary' to be skipped because of status 'error'.  Reason: Database Error in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)
  syntax error at or near "FROM"
  LINE 29:    FROM "f1"."f1_data"."final_race_leaderboard"
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_summary.sql.
[0m12:18:40.696743 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:40.696743 [debug] [MainThread]: On master: BEGIN
[0m12:18:40.697761 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:40.740003 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m12:18:40.741011 [debug] [MainThread]: On master: COMMIT
[0m12:18:40.742019 [debug] [MainThread]: Using postgres connection "master"
[0m12:18:40.742019 [debug] [MainThread]: On master: COMMIT
[0m12:18:40.743010 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:18:40.743010 [debug] [MainThread]: On master: Close
[0m12:18:40.744010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:40.744010 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:18:40.744010 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:18:40.744010 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_summary' was properly closed.
[0m12:18:40.745358 [info ] [MainThread]: 
[0m12:18:40.745358 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m12:18:40.747363 [debug] [MainThread]: Command end result
[0m12:18:40.772046 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:18:40.775083 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:18:40.782495 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:18:40.782495 [info ] [MainThread]: 
[0m12:18:40.784001 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:18:40.785007 [info ] [MainThread]: 
[0m12:18:40.785007 [error] [MainThread]: [31mFailure in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)[0m
[0m12:18:40.786006 [error] [MainThread]:   Database Error in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)
  syntax error at or near "FROM"
  LINE 29:    FROM "f1"."f1_data"."final_race_leaderboard"
              ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_summary.sql
[0m12:18:40.786006 [info ] [MainThread]: 
[0m12:18:40.787005 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_race_summary.sql
[0m12:18:40.787005 [info ] [MainThread]: 
[0m12:18:40.788006 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:18:40.789028 [debug] [MainThread]: Command `dbt run` failed at 12:18:40.789028 after 1.35 seconds
[0m12:18:40.789028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FAAFE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FE4512A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3FD22F130>]}
[0m12:18:40.790016 [debug] [MainThread]: Flushing usage events
[0m12:18:41.107022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:21.260155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C73AA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C9650F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C9650D60>]}


============================== 12:19:21.264173 | 6007e48c-2915-48d0-9ed8-b49ffab0a519 ==============================
[0m12:19:21.264173 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:19:21.265647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select final_race_summary', 'send_anonymous_usage_stats': 'True'}
[0m12:19:21.454702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6007e48c-2915-48d0-9ed8-b49ffab0a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C972F940>]}
[0m12:19:21.515072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6007e48c-2915-48d0-9ed8-b49ffab0a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C9652C50>]}
[0m12:19:21.517078 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:19:21.661262 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:19:21.811583 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:21.812583 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_race_summary.sql
[0m12:19:22.154129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6007e48c-2915-48d0-9ed8-b49ffab0a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C95A76D0>]}
[0m12:19:22.257373 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:19:22.261382 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:19:22.297324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6007e48c-2915-48d0-9ed8-b49ffab0a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CADAE200>]}
[0m12:19:22.298324 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:19:22.298324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6007e48c-2915-48d0-9ed8-b49ffab0a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CAC81BD0>]}
[0m12:19:22.300325 [info ] [MainThread]: 
[0m12:19:22.301332 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:19:22.303338 [info ] [MainThread]: 
[0m12:19:22.304842 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:19:22.308855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:19:22.370495 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:19:22.371504 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:19:22.371504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:22.419336 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.047 seconds
[0m12:19:22.421336 [debug] [ThreadPool]: On list_f1: Close
[0m12:19:22.428568 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:19:22.434640 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:19:22.435633 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:19:22.435633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:22.474364 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m12:19:22.474874 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:19:22.474874 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:19:22.482390 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.006 seconds
[0m12:19:22.484546 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:19:22.485557 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:19:22.495730 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:22.496768 [debug] [MainThread]: On master: BEGIN
[0m12:19:22.496768 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:22.538424 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:19:22.538424 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:22.539423 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:19:22.548651 [debug] [MainThread]: SQL status: SELECT 46 in 0.009 seconds
[0m12:19:22.556684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6007e48c-2915-48d0-9ed8-b49ffab0a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C95F3700>]}
[0m12:19:22.557686 [debug] [MainThread]: On master: ROLLBACK
[0m12:19:22.557686 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:22.558688 [debug] [MainThread]: On master: BEGIN
[0m12:19:22.558688 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:19:22.558688 [debug] [MainThread]: On master: COMMIT
[0m12:19:22.560219 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:22.560219 [debug] [MainThread]: On master: COMMIT
[0m12:19:22.561234 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:19:22.561932 [debug] [MainThread]: On master: Close
[0m12:19:22.568459 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_summary
[0m12:19:22.569460 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_race_summary ......................... [RUN]
[0m12:19:22.570469 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_race_summary'
[0m12:19:22.571466 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_summary
[0m12:19:22.580059 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_summary"
[0m12:19:22.582067 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_summary
[0m12:19:22.611247 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_summary"
[0m12:19:22.614247 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:19:22.614752 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: BEGIN
[0m12:19:22.614752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:19:22.650742 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m12:19:22.651764 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:19:22.651764 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */

  create view "f1"."f1_data"."final_race_summary__dbt_tmp"
    
    
  as (
    

WITH positions AS (
   SELECT
       session_key,
       COUNT(DISTINCT driver_number) as total_drivers

   FROM "f1"."f1_data"."stg_position"
   GROUP BY session_key
),
laps AS (
   SELECT
       session_key,
       MAX(lap_number) as total_laps
   FROM "f1"."f1_data"."stg_laps"
   GROUP BY session_key
),
team_stats AS (
   SELECT
       session_key,
       SUM(pit_stop_count) as total_pit_stops,
        COUNT(DISTINCT team_name) as total_teams
   FROM "f1"."f1_data"."final_race_leaderboard"
   GROUP BY session_key
),
driver_stats AS (
   SELECT
       session_key,
       driver_number,
       MAX(speed) as top_speed,
       AVG(speed) as avg_speed,
       SUM(CASE WHEN drs = 1 THEN 1 ELSE 0 END) as drs_activations
   FROM "f1"."f1_data"."stg_car_data"
   GROUP BY session_key, driver_number
),
cte as(
SELECT
   p.session_key,
   m.session_display_name,
   p.total_drivers,
   l.total_laps,
   MAX(d.top_speed) as fastest_speed,
   round(AVG(d.avg_speed),3) as average_speed
FROM positions p
JOIN laps l ON p.session_key = l.session_key
JOIN "f1"."f1_data"."final_session_mapping" m ON p.session_key = m.session_key
LEFT JOIN driver_stats d ON p.session_key = d.session_key
GROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps
)
select c.session_key,
   c.session_display_name,
   c.total_drivers,
    t.total_teams,
   c.total_laps,
   t.total_pit_stops,
    c.fastest_speed,
   c.average_speed,
from cte c left join team_stats t on c.session_key=t.session_key
  );
[0m12:19:22.652757 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 64: from cte c left join team_stats t on c.session_key=t.session...
         ^

[0m12:19:22.654270 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: ROLLBACK
[0m12:19:22.654969 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: Close
[0m12:19:22.661175 [debug] [Thread-1 (]: Database Error in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)
  syntax error at or near "from"
  LINE 64: from cte c left join team_stats t on c.session_key=t.session...
           ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_summary.sql
[0m12:19:22.664705 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6007e48c-2915-48d0-9ed8-b49ffab0a519', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CB2265C0>]}
[0m12:19:22.665711 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.final_race_summary ................ [[31mERROR[0m in 0.09s]
[0m12:19:22.666719 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_summary
[0m12:19:22.667731 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_race_summary' to be skipped because of status 'error'.  Reason: Database Error in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)
  syntax error at or near "from"
  LINE 64: from cte c left join team_stats t on c.session_key=t.session...
           ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_summary.sql.
[0m12:19:22.668717 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:22.670225 [debug] [MainThread]: On master: BEGIN
[0m12:19:22.671074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:22.829483 [debug] [MainThread]: SQL status: BEGIN in 0.159 seconds
[0m12:19:22.830490 [debug] [MainThread]: On master: COMMIT
[0m12:19:22.831491 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:22.831491 [debug] [MainThread]: On master: COMMIT
[0m12:19:22.832489 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:19:22.832489 [debug] [MainThread]: On master: Close
[0m12:19:22.834557 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:22.835570 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:19:22.836576 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:19:22.836576 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_summary' was properly closed.
[0m12:19:22.836576 [info ] [MainThread]: 
[0m12:19:22.837578 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m12:19:22.841119 [debug] [MainThread]: Command end result
[0m12:19:22.867240 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:19:22.872550 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:19:22.879349 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:19:22.879349 [info ] [MainThread]: 
[0m12:19:22.880346 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:19:22.881348 [info ] [MainThread]: 
[0m12:19:22.881348 [error] [MainThread]: [31mFailure in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)[0m
[0m12:19:22.882350 [error] [MainThread]:   Database Error in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)
  syntax error at or near "from"
  LINE 64: from cte c left join team_stats t on c.session_key=t.session...
           ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_summary.sql
[0m12:19:22.883354 [info ] [MainThread]: 
[0m12:19:22.884354 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_race_summary.sql
[0m12:19:22.886614 [info ] [MainThread]: 
[0m12:19:22.888612 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:19:22.888612 [debug] [MainThread]: Command `dbt run` failed at 12:19:22.888612 after 1.71 seconds
[0m12:19:22.890118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C73AA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CAC8E380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3C86835E0>]}
[0m12:19:22.891150 [debug] [MainThread]: Flushing usage events
[0m12:19:23.283137 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:40.935828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEF52E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF0830F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF0830D30>]}


============================== 12:19:40.940362 | 827b010e-566e-419e-af91-0e7426534ba5 ==============================
[0m12:19:40.940362 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:19:40.941386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select final_race_summary', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:19:41.116310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '827b010e-566e-419e-af91-0e7426534ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF09CAAD0>]}
[0m12:19:41.174141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '827b010e-566e-419e-af91-0e7426534ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF05A3EB0>]}
[0m12:19:41.176199 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:19:41.323057 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:19:41.508172 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:19:41.509171 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_race_summary.sql
[0m12:19:41.812739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '827b010e-566e-419e-af91-0e7426534ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF0831AE0>]}
[0m12:19:41.905661 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:19:41.908702 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:19:41.938702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '827b010e-566e-419e-af91-0e7426534ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF090E5C0>]}
[0m12:19:41.939312 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:19:41.939904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '827b010e-566e-419e-af91-0e7426534ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF1F63490>]}
[0m12:19:41.943520 [info ] [MainThread]: 
[0m12:19:41.945175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:19:41.946287 [info ] [MainThread]: 
[0m12:19:41.946886 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:19:41.948738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:19:42.007232 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:19:42.007232 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:19:42.008226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:42.049278 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.041 seconds
[0m12:19:42.052088 [debug] [ThreadPool]: On list_f1: Close
[0m12:19:42.063117 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:19:42.073051 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:19:42.074161 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:19:42.074161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:19:42.117140 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m12:19:42.117140 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:19:42.118141 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:19:42.123653 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.005 seconds
[0m12:19:42.125626 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:19:42.126649 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:19:42.140303 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:42.140303 [debug] [MainThread]: On master: BEGIN
[0m12:19:42.140303 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:42.180385 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m12:19:42.180385 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:42.181378 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:19:42.189376 [debug] [MainThread]: SQL status: SELECT 46 in 0.007 seconds
[0m12:19:42.196935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '827b010e-566e-419e-af91-0e7426534ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAED3BC700>]}
[0m12:19:42.197935 [debug] [MainThread]: On master: ROLLBACK
[0m12:19:42.198945 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:42.198945 [debug] [MainThread]: On master: BEGIN
[0m12:19:42.200464 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:19:42.200464 [debug] [MainThread]: On master: COMMIT
[0m12:19:42.201485 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:42.201485 [debug] [MainThread]: On master: COMMIT
[0m12:19:42.202857 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:19:42.202857 [debug] [MainThread]: On master: Close
[0m12:19:42.210345 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_summary
[0m12:19:42.211857 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_race_summary ......................... [RUN]
[0m12:19:42.214408 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_race_summary'
[0m12:19:42.215424 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_summary
[0m12:19:42.225588 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_summary"
[0m12:19:42.227103 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_summary
[0m12:19:42.256774 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_summary"
[0m12:19:42.257789 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:19:42.259024 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: BEGIN
[0m12:19:42.259024 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:19:42.304712 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m12:19:42.305726 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:19:42.306718 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */

  create view "f1"."f1_data"."final_race_summary__dbt_tmp"
    
    
  as (
    

WITH positions AS (
   SELECT
       session_key,
       COUNT(DISTINCT driver_number) as total_drivers

   FROM "f1"."f1_data"."stg_position"
   GROUP BY session_key
),
laps AS (
   SELECT
       session_key,
       MAX(lap_number) as total_laps
   FROM "f1"."f1_data"."stg_laps"
   GROUP BY session_key
),
team_stats AS (
   SELECT
       session_key,
       SUM(pit_stop_count) as total_pit_stops,
        COUNT(DISTINCT team_name) as total_teams
   FROM "f1"."f1_data"."final_race_leaderboard"
   GROUP BY session_key
),
driver_stats AS (
   SELECT
       session_key,
       driver_number,
       MAX(speed) as top_speed,
       AVG(speed) as avg_speed,
       SUM(CASE WHEN drs = 1 THEN 1 ELSE 0 END) as drs_activations
   FROM "f1"."f1_data"."stg_car_data"
   GROUP BY session_key, driver_number
),
cte as(
SELECT
   p.session_key,
   m.session_display_name,
   p.total_drivers,
   l.total_laps,
   MAX(d.top_speed) as fastest_speed,
   round(AVG(d.avg_speed),3) as average_speed
FROM positions p
JOIN laps l ON p.session_key = l.session_key
JOIN "f1"."f1_data"."final_session_mapping" m ON p.session_key = m.session_key
LEFT JOIN driver_stats d ON p.session_key = d.session_key
GROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps
)
select c.session_key,
   c.session_display_name,
   c.total_drivers,
    t.total_teams,
   c.total_laps,
   t.total_pit_stops,
    c.fastest_speed,
   c.average_speed
from cte c left join team_stats t on c.session_key=t.session_key
  );
[0m12:19:42.310250 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "drs" does not exist
LINE 38:        SUM(CASE WHEN drs = 1 THEN 1 ELSE 0 END) as drs_activ...
                              ^

[0m12:19:42.310250 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: ROLLBACK
[0m12:19:42.311792 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: Close
[0m12:19:42.318351 [debug] [Thread-1 (]: Database Error in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)
  column "drs" does not exist
  LINE 38:        SUM(CASE WHEN drs = 1 THEN 1 ELSE 0 END) as drs_activ...
                                ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_summary.sql
[0m12:19:42.322376 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '827b010e-566e-419e-af91-0e7426534ba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF24025C0>]}
[0m12:19:42.323389 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.final_race_summary ................ [[31mERROR[0m in 0.11s]
[0m12:19:42.325500 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_summary
[0m12:19:42.325500 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.final_race_summary' to be skipped because of status 'error'.  Reason: Database Error in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)
  column "drs" does not exist
  LINE 38:        SUM(CASE WHEN drs = 1 THEN 1 ELSE 0 END) as drs_activ...
                                ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_summary.sql.
[0m12:19:42.328515 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:42.329167 [debug] [MainThread]: On master: BEGIN
[0m12:19:42.329167 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:19:42.376946 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m12:19:42.377956 [debug] [MainThread]: On master: COMMIT
[0m12:19:42.377956 [debug] [MainThread]: Using postgres connection "master"
[0m12:19:42.378959 [debug] [MainThread]: On master: COMMIT
[0m12:19:42.378959 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:19:42.378959 [debug] [MainThread]: On master: Close
[0m12:19:42.380468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:19:42.381479 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:19:42.381479 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:19:42.382482 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_summary' was properly closed.
[0m12:19:42.382482 [info ] [MainThread]: 
[0m12:19:42.384458 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m12:19:42.385562 [debug] [MainThread]: Command end result
[0m12:19:42.411937 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:19:42.414467 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:19:42.420483 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:19:42.420483 [info ] [MainThread]: 
[0m12:19:42.421502 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m12:19:42.422497 [info ] [MainThread]: 
[0m12:19:42.423488 [error] [MainThread]: [31mFailure in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)[0m
[0m12:19:42.425121 [error] [MainThread]:   Database Error in model final_race_summary (f1_analytics/models\marts\final_race_summary.sql)
  column "drs" does not exist
  LINE 38:        SUM(CASE WHEN drs = 1 THEN 1 ELSE 0 END) as drs_activ...
                                ^
  compiled code at target\run\f1_analytics\f1_analytics/models\marts\final_race_summary.sql
[0m12:19:42.425668 [info ] [MainThread]: 
[0m12:19:42.426764 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\marts\final_race_summary.sql
[0m12:19:42.427774 [info ] [MainThread]: 
[0m12:19:42.427774 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m12:19:42.430287 [debug] [MainThread]: Command `dbt run` failed at 12:19:42.430287 after 1.57 seconds
[0m12:19:42.431296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAEF52E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF1F8E260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DAF09CB640>]}
[0m12:19:42.432306 [debug] [MainThread]: Flushing usage events
[0m12:19:42.776684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:07.114115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238934DA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238947B0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238947B0D60>]}


============================== 12:20:07.118172 | f050bbfe-491a-4233-957c-accb875bc36b ==============================
[0m12:20:07.118172 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:20:07.119156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select final_race_summary', 'send_anonymous_usage_stats': 'True'}
[0m12:20:07.292342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f050bbfe-491a-4233-957c-accb875bc36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002389488B940>]}
[0m12:20:07.350226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f050bbfe-491a-4233-957c-accb875bc36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238947B2C50>]}
[0m12:20:07.352240 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:20:07.499333 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:20:07.706933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:20:07.707933 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_race_summary.sql
[0m12:20:08.014705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f050bbfe-491a-4233-957c-accb875bc36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238947B1B10>]}
[0m12:20:08.107982 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:20:08.111496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:20:08.138662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f050bbfe-491a-4233-957c-accb875bc36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023895F0E230>]}
[0m12:20:08.138662 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:20:08.138662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f050bbfe-491a-4233-957c-accb875bc36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238945E2B30>]}
[0m12:20:08.141186 [info ] [MainThread]: 
[0m12:20:08.143173 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:20:08.144188 [info ] [MainThread]: 
[0m12:20:08.145562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:20:08.148083 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:20:08.207504 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:20:08.208410 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:20:08.208410 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:08.254934 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.046 seconds
[0m12:20:08.256951 [debug] [ThreadPool]: On list_f1: Close
[0m12:20:08.265129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:20:08.270132 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:20:08.270132 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:20:08.271640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:08.320068 [debug] [ThreadPool]: SQL status: BEGIN in 0.048 seconds
[0m12:20:08.321078 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:20:08.321078 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:20:08.329820 [debug] [ThreadPool]: SQL status: SELECT 37 in 0.007 seconds
[0m12:20:08.331825 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:20:08.331825 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:20:08.341369 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.342369 [debug] [MainThread]: On master: BEGIN
[0m12:20:08.342369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:20:08.383097 [debug] [MainThread]: SQL status: BEGIN in 0.041 seconds
[0m12:20:08.384097 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.386137 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:20:08.400193 [debug] [MainThread]: SQL status: SELECT 46 in 0.013 seconds
[0m12:20:08.409215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f050bbfe-491a-4233-957c-accb875bc36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023894753700>]}
[0m12:20:08.410281 [debug] [MainThread]: On master: ROLLBACK
[0m12:20:08.411359 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.411359 [debug] [MainThread]: On master: BEGIN
[0m12:20:08.412974 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:20:08.413479 [debug] [MainThread]: On master: COMMIT
[0m12:20:08.414535 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.415059 [debug] [MainThread]: On master: COMMIT
[0m12:20:08.415600 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:20:08.416650 [debug] [MainThread]: On master: Close
[0m12:20:08.423841 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_summary
[0m12:20:08.424349 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.final_race_summary ......................... [RUN]
[0m12:20:08.425489 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_race_summary'
[0m12:20:08.426030 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_summary
[0m12:20:08.433218 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_summary"
[0m12:20:08.434764 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_summary
[0m12:20:08.468886 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_summary"
[0m12:20:08.470392 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:08.470392 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: BEGIN
[0m12:20:08.470392 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:20:08.510321 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m12:20:08.511367 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:08.512428 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */

  create view "f1"."f1_data"."final_race_summary__dbt_tmp"
    
    
  as (
    

WITH positions AS (
   SELECT
       session_key,
       COUNT(DISTINCT driver_number) as total_drivers

   FROM "f1"."f1_data"."stg_position"
   GROUP BY session_key
),
laps AS (
   SELECT
       session_key,
       MAX(lap_number) as total_laps
   FROM "f1"."f1_data"."stg_laps"
   GROUP BY session_key
),
team_stats AS (
   SELECT
       session_key,
       SUM(pit_stop_count) as total_pit_stops,
        COUNT(DISTINCT team_name) as total_teams
   FROM "f1"."f1_data"."final_race_leaderboard"
   GROUP BY session_key
),
driver_stats AS (
   SELECT
       session_key,
       driver_number,
       MAX(speed) as top_speed,
       AVG(speed) as avg_speed
   FROM "f1"."f1_data"."stg_car_data"
   GROUP BY session_key, driver_number
),
cte as(
SELECT
   p.session_key,
   m.session_display_name,
   p.total_drivers,
   l.total_laps,
   MAX(d.top_speed) as fastest_speed,
   round(AVG(d.avg_speed),3) as average_speed
FROM positions p
JOIN laps l ON p.session_key = l.session_key
JOIN "f1"."f1_data"."final_session_mapping" m ON p.session_key = m.session_key
LEFT JOIN driver_stats d ON p.session_key = d.session_key
GROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps
)
select c.session_key,
   c.session_display_name,
   c.total_drivers,
    t.total_teams,
   c.total_laps,
   t.total_pit_stops,
    c.fastest_speed,
   c.average_speed
from cte c left join team_stats t on c.session_key=t.session_key
  );
[0m12:20:08.523358 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m12:20:08.537315 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:08.539315 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
alter table "f1"."f1_data"."final_race_summary__dbt_tmp" rename to "final_race_summary"
[0m12:20:08.541330 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:20:08.560105 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m12:20:08.562113 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:08.563113 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m12:20:08.565625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:20:08.571943 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_race_summary__dbt_backup"
[0m12:20:08.575164 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:08.575164 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
drop view if exists "f1"."f1_data"."final_race_summary__dbt_backup" cascade
[0m12:20:08.577287 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:20:08.579293 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: Close
[0m12:20:08.582346 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f050bbfe-491a-4233-957c-accb875bc36b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002389637E5C0>]}
[0m12:20:08.583295 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.final_race_summary .................... [[32mCREATE VIEW[0m in 0.15s]
[0m12:20:08.584294 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_summary
[0m12:20:08.585565 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.586676 [debug] [MainThread]: On master: BEGIN
[0m12:20:08.586676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:20:08.628582 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m12:20:08.630095 [debug] [MainThread]: On master: COMMIT
[0m12:20:08.631107 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:08.632172 [debug] [MainThread]: On master: COMMIT
[0m12:20:08.633202 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:20:08.634112 [debug] [MainThread]: On master: Close
[0m12:20:08.636178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:08.636178 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:20:08.636178 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:20:08.637504 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_summary' was properly closed.
[0m12:20:08.637504 [info ] [MainThread]: 
[0m12:20:08.639243 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m12:20:08.641274 [debug] [MainThread]: Command end result
[0m12:20:08.668758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:20:08.671782 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:20:08.678842 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:20:08.678842 [info ] [MainThread]: 
[0m12:20:08.680365 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:20:08.680365 [info ] [MainThread]: 
[0m12:20:08.681475 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:20:08.682418 [debug] [MainThread]: Command `dbt run` succeeded at 12:20:08.682418 after 1.66 seconds
[0m12:20:08.682418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238934DA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002389488BEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023896389030>]}
[0m12:20:08.683372 [debug] [MainThread]: Flushing usage events
[0m12:20:09.008119 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:15.783193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D328DCE350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32B0A0F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32B0A0D90>]}


============================== 12:20:15.787622 | aa024f77-fcd9-493a-810d-d3c019caf70a ==============================
[0m12:20:15.787622 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:20:15.788622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:20:15.972124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32B17C250>]}
[0m12:20:16.034418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32B06C550>]}
[0m12:20:16.036424 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:20:16.194170 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:20:16.412471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:20:16.413457 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:20:16.465586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32C720E50>]}
[0m12:20:16.612097 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:20:16.614637 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:20:16.644817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32B4E8880>]}
[0m12:20:16.645825 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:20:16.646832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32B4EA050>]}
[0m12:20:16.648931 [info ] [MainThread]: 
[0m12:20:16.648931 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:20:16.648931 [info ] [MainThread]: 
[0m12:20:16.650439 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:20:16.655489 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:20:16.715540 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:20:16.716545 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:20:16.717546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:16.761112 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.044 seconds
[0m12:20:16.762095 [debug] [ThreadPool]: On list_f1: Close
[0m12:20:16.767293 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:20:16.772287 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:20:16.773288 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:20:16.773806 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:16.815856 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m12:20:16.815856 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:20:16.816949 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:20:16.823308 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.007 seconds
[0m12:20:16.826521 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:20:16.827626 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:20:16.840336 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:16.841253 [debug] [MainThread]: On master: BEGIN
[0m12:20:16.841253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:20:16.881376 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m12:20:16.882401 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:16.883371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:20:16.897601 [debug] [MainThread]: SQL status: SELECT 51 in 0.015 seconds
[0m12:20:16.908793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32C6D1330>]}
[0m12:20:16.908793 [debug] [MainThread]: On master: ROLLBACK
[0m12:20:16.910349 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:16.910349 [debug] [MainThread]: On master: BEGIN
[0m12:20:16.911855 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:20:16.911855 [debug] [MainThread]: On master: COMMIT
[0m12:20:16.912860 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:16.912860 [debug] [MainThread]: On master: COMMIT
[0m12:20:16.912860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:20:16.914365 [debug] [MainThread]: On master: Close
[0m12:20:16.918889 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_car
[0m12:20:16.920410 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_historical_analysis
[0m12:20:16.920410 [debug] [Thread-3 (]: Began running node model.f1_analytics.final_session_driver_mapping
[0m12:20:16.921418 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_session_filters
[0m12:20:16.921418 [info ] [Thread-1 (]: 1 of 8 START sql view model f1_data.final_car .................................. [RUN]
[0m12:20:16.922415 [info ] [Thread-2 (]: 2 of 8 START sql view model f1_data.final_historical_analysis .................. [RUN]
[0m12:20:16.923415 [info ] [Thread-3 (]: 3 of 8 START sql view model f1_data.final_session_driver_mapping ............... [RUN]
[0m12:20:16.924455 [info ] [Thread-4 (]: 4 of 8 START sql view model f1_data.final_session_filters ...................... [RUN]
[0m12:20:16.925464 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_car'
[0m12:20:16.925464 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.final_historical_analysis'
[0m12:20:16.926459 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_driver_mapping'
[0m12:20:16.927459 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_filters'
[0m12:20:16.927459 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_car
[0m12:20:16.928460 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m12:20:16.928460 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.final_session_driver_mapping
[0m12:20:16.929461 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_session_filters
[0m12:20:16.938801 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_car"
[0m12:20:16.946134 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m12:20:16.950540 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.final_session_driver_mapping"
[0m12:20:16.954699 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_session_filters"
[0m12:20:16.956716 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_car
[0m12:20:16.957717 [debug] [Thread-2 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m12:20:16.958715 [debug] [Thread-3 (]: Began executing node model.f1_analytics.final_session_driver_mapping
[0m12:20:16.981486 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_session_filters
[0m12:20:16.992190 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_car"
[0m12:20:16.996559 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m12:20:17.001780 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.final_session_driver_mapping"
[0m12:20:17.005323 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_session_filters"
[0m12:20:17.007328 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:20:17.008326 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:20:17.009326 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:20:17.010329 [debug] [Thread-1 (]: On model.f1_analytics.final_car: BEGIN
[0m12:20:17.011358 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: BEGIN
[0m12:20:17.012328 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:20:17.013326 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: BEGIN
[0m12:20:17.014344 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:20:17.014344 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:20:17.015799 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: BEGIN
[0m12:20:17.016784 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:20:17.017782 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:20:17.067593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m12:20:17.068593 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:20:17.068593 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */

  create view "f1"."f1_data"."final_car__dbt_tmp"
    
    
  as (
    

SELECT
   t.date,
   CONCAT(t.name_acronym, ' (', t.team_name, ')') as driver,
   t.driver_number,
   ROUND(t.speed) as speed,
   ROUND(t.throttle) as throttle,
   ROUND(t.brake) as brake,
   t.rpm,
   t.session_key,  -- Add session_key
   m.meeting_key   -- Add meeting_key
FROM "f1"."f1_data"."int_car_base" t
LEFT JOIN "f1"."f1_data"."stg_sessions" s ON t.session_key = s.session_key
LEFT JOIN "f1"."f1_data"."stg_meeting" m ON s.meeting_key = m.meeting_key
  );
[0m12:20:17.071615 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m12:20:17.073124 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:20:17.074158 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */

  create view "f1"."f1_data"."final_historical_analysis__dbt_tmp"
    
    
  as (
    

WITH first_position_record AS (
    SELECT *
    FROM (
        SELECT
            session_key,
            driver_number,
            position AS first_position,
            date,
            ROW_NUMBER() OVER (
                PARTITION BY session_key, driver_number
                ORDER BY date
            ) AS rn
        FROM stg_position
    ) t
    WHERE rn = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        ROUND(MIN(i.gap_to_next)::numeric,3) AS min_gap_to_next,
        ROUND(MAX(i.gap_to_next)::numeric,3) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM "f1"."f1_data"."stg_laps" l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN "f1"."f1_data"."stg_intervals" i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND date_trunc('second', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN "f1"."f1_data"."int_lap_position" sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN "f1"."f1_data"."int_lap_position" ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY
        l.lap_number, l.session_key, l.driver_number, l.date_start,
        l.date_end, l.is_pit_out_lap,
        l.duration_sector_1, l.duration_sector_2, l.duration_sector_3,
        fpr.first_position, sp.position, ep.position
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                MAX(start_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                MAX(end_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
    lap_number,
    session_key,
    driver_number,
    date_start AS lap_start_time,
    date_end AS lap_end_time,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3,
    min_gap_to_leader,
    max_gap_to_leader,
    min_gap_to_next,
    max_gap_to_next,
    lap_start_position,
    lap_end_position,
    first_position AS race_start_position
FROM filled_positions
  );
[0m12:20:17.076074 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m12:20:17.076074 [debug] [Thread-4 (]: SQL status: BEGIN in 0.059 seconds
[0m12:20:17.077625 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:20:17.078130 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:20:17.078668 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:20:17.086065 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:20:17.087070 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m12:20:17.087070 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */

  create view "f1"."f1_data"."final_session_driver_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    d.session_key,
    concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name,
    d.driver_number
FROM "f1"."f1_data"."stg_drivers" d
JOIN "f1"."f1_data"."stg_sessions" s ON d.session_key = s.session_key
  );
[0m12:20:17.088070 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */

  create view "f1"."f1_data"."final_session_filters__dbt_tmp"
    
    
  as (
    WITH session_drivers AS (
   SELECT DISTINCT
       s.session_key,
       s.country_name,
       s.session_type,
       s.year,
       d.driver_number,
       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name
   FROM "f1"."f1_data"."stg_sessions" s
   JOIN "f1"."f1_data"."stg_drivers" d ON s.session_key = d.session_key
)
SELECT
   s.session_key,
    s.year,
   s.country_name,
   s.circuit_short_name,
   s.session_type,
   concat(s.year, ' - ', s.country_name, ' - ', s.session_type) as session_display_name,
   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,
   m.meeting_name,
   m.meeting_official_name,
   s.date_start
FROM "f1"."f1_data"."stg_sessions" s
JOIN session_drivers sd ON s.session_key = sd.session_key
JOIN "f1"."f1_data"."stg_meeting" m ON s.year = m.year
   AND s.country_name = m.country_name
GROUP BY 1,2,3,4,5,8,9,10
  );
[0m12:20:17.089093 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
alter table "f1"."f1_data"."final_car" rename to "final_car__dbt_backup"
[0m12:20:17.095586 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:20:17.097593 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
alter table "f1"."f1_data"."final_historical_analysis" rename to "final_historical_analysis__dbt_backup"
[0m12:20:17.099106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:20:17.104626 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:20:17.104626 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:20:17.105634 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m12:20:17.106633 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
alter table "f1"."f1_data"."final_car__dbt_tmp" rename to "final_car"
[0m12:20:17.106633 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m12:20:17.108876 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:20:17.112494 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:20:17.118013 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:20:17.118013 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:20:17.119008 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
alter table "f1"."f1_data"."final_historical_analysis__dbt_tmp" rename to "final_historical_analysis"
[0m12:20:17.119008 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
alter table "f1"."f1_data"."final_session_driver_mapping" rename to "final_session_driver_mapping__dbt_backup"
[0m12:20:17.121086 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
alter table "f1"."f1_data"."final_session_filters" rename to "final_session_filters__dbt_backup"
[0m12:20:17.136565 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m12:20:17.138078 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:20:17.139079 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:20:17.140074 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m12:20:17.140074 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:20:17.141071 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m12:20:17.145597 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:20:17.148603 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:20:17.151126 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m12:20:17.153131 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
alter table "f1"."f1_data"."final_session_driver_mapping__dbt_tmp" rename to "final_session_driver_mapping"
[0m12:20:17.154146 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
alter table "f1"."f1_data"."final_session_filters__dbt_tmp" rename to "final_session_filters"
[0m12:20:17.154658 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:20:17.155660 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m12:20:17.157167 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:20:17.157167 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:20:17.159173 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m12:20:17.161173 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m12:20:17.162172 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:20:17.162172 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:20:17.163146 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m12:20:17.163653 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m12:20:17.215148 [debug] [Thread-1 (]: SQL status: COMMIT in 0.063 seconds
[0m12:20:17.217945 [debug] [Thread-2 (]: SQL status: COMMIT in 0.059 seconds
[0m12:20:17.218927 [debug] [Thread-4 (]: SQL status: COMMIT in 0.055 seconds
[0m12:20:17.220453 [debug] [Thread-3 (]: SQL status: COMMIT in 0.056 seconds
[0m12:20:17.226566 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_car__dbt_backup"
[0m12:20:17.230097 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."final_historical_analysis__dbt_backup"
[0m12:20:17.232969 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."final_session_filters__dbt_backup"
[0m12:20:17.238541 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."final_session_driver_mapping__dbt_backup"
[0m12:20:17.244071 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m12:20:17.244990 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m12:20:17.246606 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m12:20:17.247581 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m12:20:17.248654 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
drop view if exists "f1"."f1_data"."final_car__dbt_backup" cascade
[0m12:20:17.248654 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
drop view if exists "f1"."f1_data"."final_historical_analysis__dbt_backup" cascade
[0m12:20:17.248654 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
drop view if exists "f1"."f1_data"."final_session_filters__dbt_backup" cascade
[0m12:20:17.250175 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
drop view if exists "f1"."f1_data"."final_session_driver_mapping__dbt_backup" cascade
[0m12:20:17.253264 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m12:20:17.254278 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:20:17.254278 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:20:17.255787 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m12:20:17.257829 [debug] [Thread-1 (]: On model.f1_analytics.final_car: Close
[0m12:20:17.258851 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: Close
[0m12:20:17.260449 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: Close
[0m12:20:17.261537 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: Close
[0m12:20:17.267215 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32C6D2770>]}
[0m12:20:17.268228 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32B0A1030>]}
[0m12:20:17.268228 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32CC25ED0>]}
[0m12:20:17.269537 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32CBEA710>]}
[0m12:20:17.271553 [info ] [Thread-1 (]: 1 of 8 OK created sql view model f1_data.final_car ............................. [[32mCREATE VIEW[0m in 0.34s]
[0m12:20:17.271553 [info ] [Thread-4 (]: 4 of 8 OK created sql view model f1_data.final_session_filters ................. [[32mCREATE VIEW[0m in 0.34s]
[0m12:20:17.273784 [info ] [Thread-2 (]: 2 of 8 OK created sql view model f1_data.final_historical_analysis ............. [[32mCREATE VIEW[0m in 0.34s]
[0m12:20:17.275316 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_car
[0m12:20:17.274300 [info ] [Thread-3 (]: 3 of 8 OK created sql view model f1_data.final_session_driver_mapping .......... [[32mCREATE VIEW[0m in 0.34s]
[0m12:20:17.276310 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_session_filters
[0m12:20:17.276824 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m12:20:17.276824 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_mapping
[0m12:20:17.278458 [debug] [Thread-3 (]: Finished running node model.f1_analytics.final_session_driver_mapping
[0m12:20:17.278969 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_tyre_performance
[0m12:20:17.279776 [info ] [Thread-1 (]: 5 of 8 START sql view model f1_data.final_session_mapping ...................... [RUN]
[0m12:20:17.283172 [info ] [Thread-4 (]: 6 of 8 START sql view model f1_data.final_tyre_performance ..................... [RUN]
[0m12:20:17.285343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_car, now model.f1_analytics.final_session_mapping)
[0m12:20:17.286331 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_filters, now model.f1_analytics.final_tyre_performance)
[0m12:20:17.287323 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_mapping
[0m12:20:17.288318 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_tyre_performance
[0m12:20:17.291838 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_mapping"
[0m12:20:17.298205 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_tyre_performance"
[0m12:20:17.300615 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_mapping
[0m12:20:17.307197 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_mapping"
[0m12:20:17.307706 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_tyre_performance
[0m12:20:17.314684 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_tyre_performance"
[0m12:20:17.315693 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:20:17.317211 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: BEGIN
[0m12:20:17.318616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:17.318616 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:20:17.320125 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: BEGIN
[0m12:20:17.321142 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:20:17.362235 [debug] [Thread-1 (]: SQL status: BEGIN in 0.044 seconds
[0m12:20:17.363234 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:20:17.364247 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */

  create view "f1"."f1_data"."final_session_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    EXTRACT(YEAR FROM date_start)::text || ' - ' || country_name || ' - ' || session_type AS session_display_name,
    session_key
FROM "f1"."f1_data"."stg_sessions"
  );
[0m12:20:17.364778 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m12:20:17.364778 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:20:17.365806 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */

  create view "f1"."f1_data"."final_tyre_performance__dbt_tmp"
    
    
  as (
    

WITH tire_performance AS (
    SELECT
        circuit_short_name,
        compound,
        team_name,
        driver_number,
        AVG(stint_length) as avg_stint_length,
        MAX(stint_length) as max_stint_length,
        AVG(tyre_age_at_start) as avg_starting_age,
        COUNT(*) as number_of_stints
    FROM "f1"."f1_data"."int_tyre_stint"
    GROUP BY 1,2,3,4
)

SELECT
    circuit_short_name,
    compound,
    round(AVG(avg_stint_length),2) as circuit_compound_avg_stint_length,
    MAX(max_stint_length) as circuit_compound_max_stint_length,
    round(AVG(avg_starting_age),2) as avg_tire_age_start,
    SUM(number_of_stints) as total_stints
FROM tire_performance
GROUP BY 1,2
  );
[0m12:20:17.372399 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:20:17.377523 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:20:17.377523 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m12:20:17.378516 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
alter table "f1"."f1_data"."final_session_mapping" rename to "final_session_mapping__dbt_backup"
[0m12:20:17.385072 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:20:17.386075 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
alter table "f1"."f1_data"."final_tyre_performance" rename to "final_tyre_performance__dbt_backup"
[0m12:20:17.386075 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:20:17.392105 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:20:17.392105 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m12:20:17.393109 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
alter table "f1"."f1_data"."final_session_mapping__dbt_tmp" rename to "final_session_mapping"
[0m12:20:17.397667 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:20:17.397667 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
alter table "f1"."f1_data"."final_tyre_performance__dbt_tmp" rename to "final_tyre_performance"
[0m12:20:17.399185 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:20:17.401225 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m12:20:17.401225 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:20:17.402227 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m12:20:17.402227 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m12:20:17.406130 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m12:20:17.406699 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m12:20:17.407712 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:20:17.410224 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_session_mapping__dbt_backup"
[0m12:20:17.411247 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m12:20:17.413250 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m12:20:17.414774 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
drop view if exists "f1"."f1_data"."final_session_mapping__dbt_backup" cascade
[0m12:20:17.414774 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m12:20:17.419306 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."final_tyre_performance__dbt_backup"
[0m12:20:17.419306 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:20:17.420832 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m12:20:17.421846 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: Close
[0m12:20:17.423359 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
drop view if exists "f1"."f1_data"."final_tyre_performance__dbt_backup" cascade
[0m12:20:17.424901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32CD5BDC0>]}
[0m12:20:17.426901 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m12:20:17.425900 [info ] [Thread-1 (]: 5 of 8 OK created sql view model f1_data.final_session_mapping ................. [[32mCREATE VIEW[0m in 0.14s]
[0m12:20:17.428903 [debug] [Thread-4 (]: On model.f1_analytics.final_tyre_performance: Close
[0m12:20:17.428903 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_mapping
[0m12:20:17.430420 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32B0A1030>]}
[0m12:20:17.432062 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m12:20:17.432062 [info ] [Thread-4 (]: 6 of 8 OK created sql view model f1_data.final_tyre_performance ................ [[32mCREATE VIEW[0m in 0.15s]
[0m12:20:17.434585 [info ] [Thread-2 (]: 7 of 8 START sql view model f1_data.final_race_leaderboard ..................... [RUN]
[0m12:20:17.437110 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_tyre_performance
[0m12:20:17.438128 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_historical_analysis, now model.f1_analytics.final_race_leaderboard)
[0m12:20:17.440134 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.final_race_leaderboard
[0m12:20:17.445654 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.final_race_leaderboard"
[0m12:20:17.448785 [debug] [Thread-2 (]: Began executing node model.f1_analytics.final_race_leaderboard
[0m12:20:17.453520 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.final_race_leaderboard"
[0m12:20:17.455600 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:20:17.457110 [debug] [Thread-2 (]: On model.f1_analytics.final_race_leaderboard: BEGIN
[0m12:20:17.458118 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:20:17.503347 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m12:20:17.504852 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:20:17.504852 [debug] [Thread-2 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */

  create view "f1"."f1_data"."final_race_leaderboard__dbt_tmp"
    
    
  as (
    

WITH final_rankings AS (
   SELECT
       session_key,
       driver_number,
       position
   FROM int_final_position
)
SELECT
   fr.session_key,
   d.driver_number,
   d.broadcast_name AS driver_name,
   fr.position,
   d.team_name,
   d.team_colour AS team_color,
   CASE
       WHEN fr.position = 1 THEN 0
       ELSE fi.max_gap_to_leader
   END as gap_to_leader,
   fi.max_gap_to_next as gap_to_next,
   bl.fastest_lap,
   ps.pit_stop_count,

   CASE
       WHEN fr.position = 1 THEN 25
       WHEN fr.position = 2 THEN 18
       WHEN fr.position = 3 THEN 15
       WHEN fr.position = 4 THEN 12
       WHEN fr.position = 5 THEN 10
       WHEN fr.position = 6 THEN 8
       WHEN fr.position = 7 THEN 6
       WHEN fr.position = 8 THEN 4
       WHEN fr.position = 9 THEN 2
       WHEN fr.position = 10 THEN 1
       ELSE 0
   END AS points
FROM final_rankings fr
JOIN "f1"."f1_data"."stg_drivers" d
   ON fr.driver_number = d.driver_number
   AND fr.session_key = d.session_key
LEFT JOIN "f1"."f1_data"."int_final_intervals" fi
   ON fr.session_key = fi.session_key
   AND fr.driver_number = fi.driver_number
LEFT JOIN "f1"."f1_data"."int_best_laps" bl
   ON fr.session_key = bl.session_key
   AND fr.driver_number = bl.driver_number
LEFT JOIN "f1"."f1_data"."int_pit_stop" ps
   ON fr.session_key = ps.session_key
   AND fr.driver_number = ps.driver_number
JOIN "f1"."f1_data"."final_session_mapping" m
   ON fr.session_key = m.session_key
ORDER BY fr.position
  );
[0m12:20:17.512388 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:20:17.518963 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:20:17.520480 [debug] [Thread-2 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
alter table "f1"."f1_data"."final_race_leaderboard__dbt_tmp" rename to "final_race_leaderboard"
[0m12:20:17.521504 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:20:17.524092 [debug] [Thread-2 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m12:20:17.525108 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:20:17.526618 [debug] [Thread-2 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m12:20:17.527950 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m12:20:17.530730 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."final_race_leaderboard__dbt_backup"
[0m12:20:17.532727 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m12:20:17.532727 [debug] [Thread-2 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
drop view if exists "f1"."f1_data"."final_race_leaderboard__dbt_backup" cascade
[0m12:20:17.534246 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:20:17.535268 [debug] [Thread-2 (]: On model.f1_analytics.final_race_leaderboard: Close
[0m12:20:17.536270 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32C76BC10>]}
[0m12:20:17.537283 [info ] [Thread-2 (]: 7 of 8 OK created sql view model f1_data.final_race_leaderboard ................ [[32mCREATE VIEW[0m in 0.10s]
[0m12:20:17.538279 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m12:20:17.539397 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_summary
[0m12:20:17.539397 [info ] [Thread-1 (]: 8 of 8 START sql view model f1_data.final_race_summary ......................... [RUN]
[0m12:20:17.540421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_mapping, now model.f1_analytics.final_race_summary)
[0m12:20:17.541447 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_summary
[0m12:20:17.546887 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_summary"
[0m12:20:17.549170 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_summary
[0m12:20:17.556758 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_summary"
[0m12:20:17.558640 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:17.561211 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: BEGIN
[0m12:20:17.562771 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:17.606118 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m12:20:17.606634 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:17.607645 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */

  create view "f1"."f1_data"."final_race_summary__dbt_tmp"
    
    
  as (
    

WITH positions AS (
   SELECT
       session_key,
       COUNT(DISTINCT driver_number) as total_drivers

   FROM "f1"."f1_data"."stg_position"
   GROUP BY session_key
),
laps AS (
   SELECT
       session_key,
       MAX(lap_number) as total_laps
   FROM "f1"."f1_data"."stg_laps"
   GROUP BY session_key
),
team_stats AS (
   SELECT
       session_key,
       SUM(pit_stop_count) as total_pit_stops,
        COUNT(DISTINCT team_name) as total_teams
   FROM "f1"."f1_data"."final_race_leaderboard"
   GROUP BY session_key
),
driver_stats AS (
   SELECT
       session_key,
       driver_number,
       MAX(speed) as top_speed,
       AVG(speed) as avg_speed
   FROM "f1"."f1_data"."stg_car_data"
   GROUP BY session_key, driver_number
),
cte as(
SELECT
   p.session_key,
   m.session_display_name,
   p.total_drivers,
   l.total_laps,
   MAX(d.top_speed) as fastest_speed,
   round(AVG(d.avg_speed),3) as average_speed
FROM positions p
JOIN laps l ON p.session_key = l.session_key
JOIN "f1"."f1_data"."final_session_mapping" m ON p.session_key = m.session_key
LEFT JOIN driver_stats d ON p.session_key = d.session_key
GROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps
)
select c.session_key,
   c.session_display_name,
   c.total_drivers,
    t.total_teams,
   c.total_laps,
   t.total_pit_stops,
    c.fastest_speed,
   c.average_speed
from cte c left join team_stats t on c.session_key=t.session_key
  );
[0m12:20:17.615714 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m12:20:17.620248 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:17.621274 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
alter table "f1"."f1_data"."final_race_summary__dbt_tmp" rename to "final_race_summary"
[0m12:20:17.623292 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:20:17.626072 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m12:20:17.627081 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:17.627081 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m12:20:17.629085 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:20:17.631084 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_race_summary__dbt_backup"
[0m12:20:17.632084 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m12:20:17.632084 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
drop view if exists "f1"."f1_data"."final_race_summary__dbt_backup" cascade
[0m12:20:17.633464 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:20:17.634484 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: Close
[0m12:20:17.635615 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa024f77-fcd9-493a-810d-d3c019caf70a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32CDFFFD0>]}
[0m12:20:17.636614 [info ] [Thread-1 (]: 8 of 8 OK created sql view model f1_data.final_race_summary .................... [[32mCREATE VIEW[0m in 0.10s]
[0m12:20:17.638621 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_summary
[0m12:20:17.641152 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:17.642154 [debug] [MainThread]: On master: BEGIN
[0m12:20:17.643370 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:20:17.692419 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m12:20:17.693416 [debug] [MainThread]: On master: COMMIT
[0m12:20:17.694424 [debug] [MainThread]: Using postgres connection "master"
[0m12:20:17.694936 [debug] [MainThread]: On master: COMMIT
[0m12:20:17.695950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:20:17.695950 [debug] [MainThread]: On master: Close
[0m12:20:17.697486 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:17.697486 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:20:17.698598 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:20:17.698598 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_summary' was properly closed.
[0m12:20:17.699609 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_leaderboard' was properly closed.
[0m12:20:17.699609 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_driver_mapping' was properly closed.
[0m12:20:17.700619 [debug] [MainThread]: Connection 'model.f1_analytics.final_tyre_performance' was properly closed.
[0m12:20:17.700619 [info ] [MainThread]: 
[0m12:20:17.701638 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m12:20:17.702629 [debug] [MainThread]: Command end result
[0m12:20:17.735921 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:20:17.740169 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:20:17.755760 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:20:17.755760 [info ] [MainThread]: 
[0m12:20:17.756763 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:20:17.759290 [info ] [MainThread]: 
[0m12:20:17.760284 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m12:20:17.762721 [debug] [MainThread]: Command `dbt run` succeeded at 12:20:17.762721 after 2.06 seconds
[0m12:20:17.764230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D328DCE350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32C721540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D32A0D3C40>]}
[0m12:20:17.765238 [debug] [MainThread]: Flushing usage events
[0m12:20:18.127323 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:10.634059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BEBCA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BFEA0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BFEA0D30>]}


============================== 12:25:10.638250 | 750b9e98-1b36-4143-9ad1-56df991ea0eb ==============================
[0m12:25:10.638250 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:25:10.639250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_drivers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:25:10.815941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '750b9e98-1b36-4143-9ad1-56df991ea0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C0038D30>]}
[0m12:25:10.874335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '750b9e98-1b36-4143-9ad1-56df991ea0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BF5E0070>]}
[0m12:25:10.875771 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:25:11.027942 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:25:11.180635 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:11.181638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:11.230539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '750b9e98-1b36-4143-9ad1-56df991ea0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C1520E80>]}
[0m12:25:11.367875 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:25:11.368961 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:25:11.395486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '750b9e98-1b36-4143-9ad1-56df991ea0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C02EA710>]}
[0m12:25:11.396511 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:25:11.397412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '750b9e98-1b36-4143-9ad1-56df991ea0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C02EB370>]}
[0m12:25:11.398413 [info ] [MainThread]: 
[0m12:25:11.399411 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:11.400413 [info ] [MainThread]: 
[0m12:25:11.401413 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:25:11.403409 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:25:11.458329 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:25:11.459327 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:25:11.459327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:11.498989 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.040 seconds
[0m12:25:11.500579 [debug] [ThreadPool]: On list_f1: Close
[0m12:25:11.509537 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:25:11.517742 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:25:11.518798 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:25:11.518798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:11.572282 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m12:25:11.572282 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:25:11.573353 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:25:11.577778 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.004 seconds
[0m12:25:11.578774 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:25:11.580345 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:25:11.591453 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:11.592505 [debug] [MainThread]: On master: BEGIN
[0m12:25:11.592505 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:11.628362 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m12:25:11.629125 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:11.630665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:25:11.641603 [debug] [MainThread]: SQL status: SELECT 51 in 0.010 seconds
[0m12:25:11.651780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '750b9e98-1b36-4143-9ad1-56df991ea0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C0501240>]}
[0m12:25:11.651780 [debug] [MainThread]: On master: ROLLBACK
[0m12:25:11.652810 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:11.652810 [debug] [MainThread]: On master: BEGIN
[0m12:25:11.654336 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:25:11.655450 [debug] [MainThread]: On master: COMMIT
[0m12:25:11.655450 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:11.655450 [debug] [MainThread]: On master: COMMIT
[0m12:25:11.656420 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:11.656420 [debug] [MainThread]: On master: Close
[0m12:25:11.663279 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_drivers
[0m12:25:11.664398 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.stg_drivers ................................ [RUN]
[0m12:25:11.665984 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_drivers'
[0m12:25:11.667003 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_drivers
[0m12:25:11.674170 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_drivers"
[0m12:25:11.675205 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_drivers
[0m12:25:11.711642 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_drivers"
[0m12:25:11.714739 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m12:25:11.715760 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: BEGIN
[0m12:25:11.715760 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:25:11.764355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m12:25:11.765373 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m12:25:11.766382 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */

  create view "f1"."f1_data"."stg_drivers__dbt_tmp"
    
    
  as (
    

with raw as(
    select *,
           row_number() over (partition by driver_number,session_key, full_name,team_name order by full_name) as rn
           from "f1"."f1_data"."drivers"
)
SELECT
  CAST(driver_number AS INT)           AS driver_number,
  session_key,
  BROADCAST_NAME                       as broadcast_name,
  FULL_NAME                            AS full_name,
  name_acronym,
  team_name,
  team_colour,
  first_name,
  last_name,
  country_code
FROM raw
WHERE rn=1
  );
[0m12:25:11.772393 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m12:25:11.781731 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m12:25:11.781731 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
alter table "f1"."f1_data"."stg_drivers" rename to "stg_drivers__dbt_backup"
[0m12:25:11.782758 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:11.786887 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m12:25:11.787606 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
alter table "f1"."f1_data"."stg_drivers__dbt_tmp" rename to "stg_drivers"
[0m12:25:11.788857 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:11.801836 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m12:25:11.803023 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m12:25:11.804084 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m12:25:11.806816 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:25:11.814405 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_drivers__dbt_backup"
[0m12:25:11.817655 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m12:25:11.818681 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
drop view if exists "f1"."f1_data"."stg_drivers__dbt_backup" cascade
[0m12:25:11.821661 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m12:25:11.825730 [debug] [Thread-1 (]: On model.f1_analytics.stg_drivers: Close
[0m12:25:11.827735 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '750b9e98-1b36-4143-9ad1-56df991ea0eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C156BC40>]}
[0m12:25:11.828722 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.stg_drivers ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m12:25:11.829720 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_drivers
[0m12:25:11.832123 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:11.832123 [debug] [MainThread]: On master: BEGIN
[0m12:25:11.832123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:11.874157 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m12:25:11.875416 [debug] [MainThread]: On master: COMMIT
[0m12:25:11.877416 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:11.878413 [debug] [MainThread]: On master: COMMIT
[0m12:25:11.878413 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:11.879411 [debug] [MainThread]: On master: Close
[0m12:25:11.880053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:11.881061 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:25:11.881061 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:25:11.882063 [debug] [MainThread]: Connection 'model.f1_analytics.stg_drivers' was properly closed.
[0m12:25:11.883058 [info ] [MainThread]: 
[0m12:25:11.883058 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m12:25:11.884580 [debug] [MainThread]: Command end result
[0m12:25:11.908008 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:25:11.912553 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:25:11.920283 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:25:11.921291 [info ] [MainThread]: 
[0m12:25:11.922290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:11.923291 [info ] [MainThread]: 
[0m12:25:11.924307 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:25:11.925312 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:11.925312 after 1.38 seconds
[0m12:25:11.925312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BEBCA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283C1521570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000283BF637700>]}
[0m12:25:11.926834 [debug] [MainThread]: Flushing usage events
[0m12:25:12.248531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:25:42.220196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4CAAA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4DD90F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4DD90D30>]}


============================== 12:25:42.225560 | 1bdf79f9-4f29-4582-86a6-031fd72148da ==============================
[0m12:25:42.225560 [info ] [MainThread]: Running with dbt=1.10.6
[0m12:25:42.226676 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select int_car_base', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:25:42.414453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1bdf79f9-4f29-4582-86a6-031fd72148da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4DF2CFA0>]}
[0m12:25:42.468830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1bdf79f9-4f29-4582-86a6-031fd72148da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4D4C0070>]}
[0m12:25:42.470345 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:25:42.617841 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m12:25:42.765359 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:25:42.766364 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:25:42.812788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1bdf79f9-4f29-4582-86a6-031fd72148da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4F410E80>]}
[0m12:25:42.951468 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:25:42.953473 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:25:42.979022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1bdf79f9-4f29-4582-86a6-031fd72148da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4E1EE710>]}
[0m12:25:42.980592 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m12:25:42.981601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bdf79f9-4f29-4582-86a6-031fd72148da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4E1EF370>]}
[0m12:25:42.982638 [info ] [MainThread]: 
[0m12:25:42.984048 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:25:42.984560 [info ] [MainThread]: 
[0m12:25:42.985566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:25:42.986552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m12:25:43.047857 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m12:25:43.047857 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m12:25:43.048856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:43.084085 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m12:25:43.086402 [debug] [ThreadPool]: On list_f1: Close
[0m12:25:43.096938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m12:25:43.102511 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:25:43.104526 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m12:25:43.105039 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:25:43.144090 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m12:25:43.144090 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m12:25:43.145200 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m12:25:43.151630 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.007 seconds
[0m12:25:43.155740 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m12:25:43.155740 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m12:25:43.165774 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:43.165774 [debug] [MainThread]: On master: BEGIN
[0m12:25:43.166776 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:25:43.202544 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:25:43.203544 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:43.204544 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:25:43.212274 [debug] [MainThread]: SQL status: SELECT 26 in 0.008 seconds
[0m12:25:43.216765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1bdf79f9-4f29-4582-86a6-031fd72148da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4E3F1240>]}
[0m12:25:43.217771 [debug] [MainThread]: On master: ROLLBACK
[0m12:25:43.218771 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:43.218771 [debug] [MainThread]: On master: BEGIN
[0m12:25:43.220282 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:25:43.220282 [debug] [MainThread]: On master: COMMIT
[0m12:25:43.221292 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:43.221292 [debug] [MainThread]: On master: COMMIT
[0m12:25:43.222287 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:43.222287 [debug] [MainThread]: On master: Close
[0m12:25:43.227392 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_car_base
[0m12:25:43.228392 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.int_car_base ............................... [RUN]
[0m12:25:43.229394 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.int_car_base'
[0m12:25:43.229394 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_car_base
[0m12:25:43.235903 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_car_base"
[0m12:25:43.236908 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_car_base
[0m12:25:43.269140 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_car_base"
[0m12:25:43.270646 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:25:43.270646 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: BEGIN
[0m12:25:43.271653 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:25:43.308435 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m12:25:43.309431 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:25:43.310432 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */

  create view "f1"."f1_data"."int_car_base__dbt_tmp"
    
    
  as (
    

SELECT
   ts.driver_number,
   ts.session_key,
   d.name_acronym,
   d.team_name,
   d.team_colour,
   ts.date,
   ts.rpm,
   ts.speed,
   ts.throttle,
   ts.brake
FROM "f1"."f1_data"."stg_car_data" ts
LEFT JOIN "f1"."f1_data"."stg_drivers" d
   ON ts.driver_number = d.driver_number
   AND ts.session_key = d.session_key
  );
[0m12:25:43.317469 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m12:25:43.324742 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:25:43.324742 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
alter table "f1"."f1_data"."int_car_base__dbt_tmp" rename to "int_car_base"
[0m12:25:43.326265 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m12:25:43.339063 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: COMMIT
[0m12:25:43.340571 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:25:43.340571 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: COMMIT
[0m12:25:43.342576 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m12:25:43.349243 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_car_base__dbt_backup"
[0m12:25:43.354382 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m12:25:43.354914 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
drop view if exists "f1"."f1_data"."int_car_base__dbt_backup" cascade
[0m12:25:43.355915 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m12:25:43.357931 [debug] [Thread-1 (]: On model.f1_analytics.int_car_base: Close
[0m12:25:43.360441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1bdf79f9-4f29-4582-86a6-031fd72148da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4F45BC70>]}
[0m12:25:43.361449 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.int_car_base .......................... [[32mCREATE VIEW[0m in 0.13s]
[0m12:25:43.362450 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_car_base
[0m12:25:43.364450 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:43.364962 [debug] [MainThread]: On master: BEGIN
[0m12:25:43.364962 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:25:43.401680 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m12:25:43.402681 [debug] [MainThread]: On master: COMMIT
[0m12:25:43.402681 [debug] [MainThread]: Using postgres connection "master"
[0m12:25:43.404757 [debug] [MainThread]: On master: COMMIT
[0m12:25:43.407797 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:25:43.408793 [debug] [MainThread]: On master: Close
[0m12:25:43.410304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:25:43.411314 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m12:25:43.411314 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m12:25:43.412314 [debug] [MainThread]: Connection 'model.f1_analytics.int_car_base' was properly closed.
[0m12:25:43.413313 [info ] [MainThread]: 
[0m12:25:43.414512 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m12:25:43.415528 [debug] [MainThread]: Command end result
[0m12:25:43.437344 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m12:25:43.439342 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m12:25:43.449383 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m12:25:43.450380 [info ] [MainThread]: 
[0m12:25:43.452374 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:25:43.453395 [info ] [MainThread]: 
[0m12:25:43.454893 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m12:25:43.457425 [debug] [MainThread]: Command `dbt run` succeeded at 12:25:43.456913 after 1.32 seconds
[0m12:25:43.457425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4CAAA380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4F411570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E4CDB0B20>]}
[0m12:25:43.458432 [debug] [MainThread]: Flushing usage events
[0m12:25:43.760870 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:22.295175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F49D8E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4B090F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4B090D30>]}


============================== 09:57:22.300163 | 42811bbd-1ddc-4f87-ac56-3ec2e02b2470 ==============================
[0m09:57:22.300163 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:57:22.302144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:57:22.580163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42811bbd-1ddc-4f87-ac56-3ec2e02b2470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4B226AD0>]}
[0m09:57:22.629186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42811bbd-1ddc-4f87-ac56-3ec2e02b2470', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4AE03DC0>]}
[0m09:57:22.630187 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:57:23.431756 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:57:28.793157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:57:28.794052 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_position.sql
[0m09:57:28.795094 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m09:57:28.795094 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_drivers.sql
[0m09:57:28.796121 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_meeting.sql
[0m09:57:28.987786 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.f1_analytics.stg_position' (f1_analytics/models\staging\stg_position.sql) depends on a source named 'raw.POSITION' which was not found
[0m09:57:28.989839 [debug] [MainThread]: Command `dbt run` failed at 09:57:28.989839 after 6.90 seconds
[0m09:57:28.989839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F49D8E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4B4DB550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022F4B2251E0>]}
[0m09:57:28.990789 [debug] [MainThread]: Flushing usage events
[0m09:57:29.328928 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:57:59.514607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60B3FE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60D6C0FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60D6C0DC0>]}


============================== 09:57:59.519043 | 462a9d8e-2265-480a-a64e-2215efe44183 ==============================
[0m09:57:59.519043 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:57:59.520126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:57:59.670453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '462a9d8e-2265-480a-a64e-2215efe44183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60D79DED0>]}
[0m09:57:59.717967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '462a9d8e-2265-480a-a64e-2215efe44183', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60CE02440>]}
[0m09:57:59.718968 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:57:59.842500 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:58:00.098041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m09:58:00.100330 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\src.yml
[0m09:58:00.100330 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_position.sql
[0m09:58:00.101408 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_meeting.sql
[0m09:58:00.101408 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_drivers.sql
[0m09:58:00.102338 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m09:58:00.459329 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "raw_position".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("raw", "position").
  
  To fix this, change the name of one of these resources:
  - source.f1_analytics.raw.position (f1_analytics/models\staging\src.yml)
  - source.f1_analytics.raw.position (f1_analytics/models\staging\src.yml)
[0m09:58:00.462321 [debug] [MainThread]: Command `dbt run` failed at 09:58:00.461334 after 1.03 seconds
[0m09:58:00.462321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60B3FE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60EE97A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E60EF134F0>]}
[0m09:58:00.463323 [debug] [MainThread]: Flushing usage events
[0m09:58:00.775054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:26.965898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224530CE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224553A0EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224553A0D00>]}


============================== 09:58:26.969897 | fc0193f0-46b0-4806-ad49-0a88a076d881 ==============================
[0m09:58:26.969897 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:58:26.970895 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:58:27.118744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc0193f0-46b0-4806-ad49-0a88a076d881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002245547FAC0>]}
[0m09:58:27.166258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc0193f0-46b0-4806-ad49-0a88a076d881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224553A2BF0>]}
[0m09:58:27.167260 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:58:27.296521 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:58:27.425354 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:58:27.426357 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_drivers.sql
[0m09:58:27.426357 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_meeting.sql
[0m09:58:27.427357 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m09:58:27.427357 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_position.sql
[0m09:58:27.620249 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.f1_analytics.stg_sessions' (f1_analytics/models\staging\stg_sessions.sql) depends on a source named 'raw.SESSIONS' which was not found
[0m09:58:27.622165 [debug] [MainThread]: Command `dbt run` failed at 09:58:27.622165 after 0.73 seconds
[0m09:58:27.622165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224530CE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000224569D7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022452A38B80>]}
[0m09:58:27.623211 [debug] [MainThread]: Flushing usage events
[0m09:58:27.931402 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:53.636197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF3861E380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF39900F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF39900D60>]}


============================== 09:58:53.641316 | 70b1f20a-0b44-4a73-8018-fd392f290817 ==============================
[0m09:58:53.641316 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:58:53.642272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:58:53.798246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70b1f20a-0b44-4a73-8018-fd392f290817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF399DF940>]}
[0m09:58:53.844761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70b1f20a-0b44-4a73-8018-fd392f290817', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF39902C50>]}
[0m09:58:53.846715 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:58:53.983954 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:58:54.172117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:58:54.173043 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m09:58:54.174140 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_meeting.sql
[0m09:58:54.176150 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_position.sql
[0m09:58:54.177029 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_drivers.sql
[0m09:58:54.370029 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.f1_analytics.stg_sessions' (f1_analytics/models\staging\stg_sessions.sql) depends on a source named 'raw.SESSIONS' which was not found
[0m09:58:54.371933 [debug] [MainThread]: Command `dbt run` failed at 09:58:54.371933 after 0.84 seconds
[0m09:58:54.371933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF3861E380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF3AF37760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BF3AEFC850>]}
[0m09:58:54.372948 [debug] [MainThread]: Flushing usage events
[0m09:58:54.724058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:09.910526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74F0C2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F751390F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F751390D30>]}


============================== 09:59:09.914504 | 57e46f0e-5fb8-49c7-a97c-ae678e41c3b2 ==============================
[0m09:59:09.914504 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:59:09.915419 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:59:10.071116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57e46f0e-5fb8-49c7-a97c-ae678e41c3b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75146DD50>]}
[0m09:59:10.118431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57e46f0e-5fb8-49c7-a97c-ae678e41c3b2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F75135ADA0>]}
[0m09:59:10.119432 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:59:10.249702 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:59:10.378395 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m09:59:10.379276 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_position.sql
[0m09:59:10.379276 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m09:59:10.380323 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_meeting.sql
[0m09:59:10.380323 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_drivers.sql
[0m09:59:10.568035 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.f1_analytics.stg_position' (f1_analytics/models\staging\stg_position.sql) depends on a source named 'raw.POSITION' which was not found
[0m09:59:10.569109 [debug] [MainThread]: Command `dbt run` failed at 09:59:10.569109 after 0.75 seconds
[0m09:59:10.570106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74F0C2350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7529C77F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7512E7850>]}
[0m09:59:10.570106 [debug] [MainThread]: Flushing usage events
[0m09:59:10.909906 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:17.532856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F641E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F7710FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F7710DC0>]}


============================== 10:00:17.536854 | 73a1207b-f5f1-47bf-ba9e-36ddaf96e830 ==============================
[0m10:00:17.536854 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:00:17.536854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:00:17.694839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F77EDED0>]}
[0m10:00:17.742159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F6E52440>]}
[0m10:00:17.743161 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:00:17.868763 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:00:17.999835 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m10:00:17.999835 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_drivers.sql
[0m10:00:18.000836 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_position.sql
[0m10:00:18.000836 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_sessions.sql
[0m10:00:18.001838 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\staging\stg_meeting.sql
[0m10:00:18.266426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F8F10130>]}
[0m10:00:18.344955 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:00:18.346861 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:00:18.380723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F76B34C0>]}
[0m10:00:18.380723 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m10:00:18.381707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F8D400D0>]}
[0m10:00:18.383733 [info ] [MainThread]: 
[0m10:00:18.383733 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:00:18.384707 [info ] [MainThread]: 
[0m10:00:18.384707 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:00:18.389245 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m10:00:33.201403 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m10:00:33.202403 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m10:00:33.203420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:33.267161 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.064 seconds
[0m10:00:33.268157 [debug] [ThreadPool]: On list_f1: Close
[0m10:00:33.273148 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m10:00:33.278425 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:00:33.278425 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m10:00:33.279386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:33.318442 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m10:00:33.319387 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:00:33.319387 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m10:00:33.326849 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.007 seconds
[0m10:00:33.328768 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m10:00:33.329844 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m10:00:33.338813 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:33.338813 [debug] [MainThread]: On master: BEGIN
[0m10:00:33.339823 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:00:33.374988 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m10:00:33.374988 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:33.375971 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:00:33.383562 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m10:00:33.385561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F8EF0C10>]}
[0m10:00:33.385561 [debug] [MainThread]: On master: ROLLBACK
[0m10:00:33.386549 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:33.386549 [debug] [MainThread]: On master: BEGIN
[0m10:00:33.387586 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:00:33.388518 [debug] [MainThread]: On master: COMMIT
[0m10:00:33.388518 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:33.389525 [debug] [MainThread]: On master: COMMIT
[0m10:00:33.389525 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:00:33.390525 [debug] [MainThread]: On master: Close
[0m10:00:33.396060 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_car_data
[0m10:00:33.396060 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_drivers
[0m10:00:33.397582 [debug] [Thread-3 (]: Began running node model.f1_analytics.stg_intervals
[0m10:00:33.398607 [debug] [Thread-4 (]: Began running node model.f1_analytics.stg_laps
[0m10:00:33.397582 [info ] [Thread-1 (]: 1 of 10 START sql view model f1_data.stg_car_data .............................. [RUN]
[0m10:00:33.398607 [info ] [Thread-2 (]: 2 of 10 START sql view model f1_data.stg_drivers ............................... [RUN]
[0m10:00:33.399607 [info ] [Thread-3 (]: 3 of 10 START sql view model f1_data.stg_intervals ............................. [RUN]
[0m10:00:33.401604 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_car_data'
[0m10:00:33.400623 [info ] [Thread-4 (]: 4 of 10 START sql view model f1_data.stg_laps .................................. [RUN]
[0m10:00:33.402609 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.stg_drivers'
[0m10:00:33.402609 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.stg_intervals'
[0m10:00:33.403602 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_car_data
[0m10:00:33.403602 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.stg_laps'
[0m10:00:33.404605 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_drivers
[0m10:00:33.404605 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.stg_intervals
[0m10:00:33.412129 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_car_data"
[0m10:00:33.412129 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.stg_laps
[0m10:00:33.416604 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_drivers"
[0m10:00:33.420643 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m10:00:33.423634 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.stg_laps"
[0m10:00:33.425591 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_car_data
[0m10:00:33.425591 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_drivers
[0m10:00:33.426588 [debug] [Thread-3 (]: Began executing node model.f1_analytics.stg_intervals
[0m10:00:33.452765 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_car_data"
[0m10:00:33.453779 [debug] [Thread-4 (]: Began executing node model.f1_analytics.stg_laps
[0m10:00:33.457791 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_drivers"
[0m10:00:33.460784 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m10:00:33.464766 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.stg_laps"
[0m10:00:33.465769 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:00:33.466735 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:00:33.467514 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:00:33.468538 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: BEGIN
[0m10:00:33.468538 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:00:33.469575 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: BEGIN
[0m10:00:33.469575 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: BEGIN
[0m10:00:33.470535 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:00:33.470535 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: BEGIN
[0m10:00:33.471574 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:00:33.471574 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:00:33.472534 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:00:33.520352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m10:00:33.521349 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:00:33.521349 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */

  create view "f1"."f1_data"."stg_car_data__dbt_tmp"
    
    
  as (
    

SELECT
    session_key,
    driver_number,
    date,
    rpm,
    speed,
    throttle,
    brake
FROM "f1"."f1_data"."car_data"
  );
[0m10:00:33.522348 [debug] [Thread-2 (]: SQL status: BEGIN in 0.051 seconds
[0m10:00:33.523353 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:00:33.523353 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */

  create view "f1"."f1_data"."stg_drivers__dbt_tmp"
    
    
  as (
    

SELECT
  CAST(driver_number AS INT)           AS driver_number,
  BROADCAST_NAME                       as broadcast_name,
  first_name,
  last_name,
  FULL_NAME                            AS full_name,
  name_acronym,
  team_name,
  team_colour,
  country_code,
  session_key
from "f1"."f1_data"."drivers"
  );
[0m10:00:33.524349 [debug] [Thread-3 (]: SQL status: BEGIN in 0.053 seconds
[0m10:00:33.525349 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:00:33.526353 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */

  create view "f1"."f1_data"."stg_intervals__dbt_tmp"
    
    
  as (
    


   SELECT
    session_key,
    driver_number,
    date,
    CASE
        WHEN gap_to_leader = 'None' OR gap_to_leader LIKE '%L%' THEN NULL
        ELSE gap_to_leader
    END AS gap_to_leader,
    CASE
        WHEN interval = 'None' OR interval LIKE '%L%' THEN NULL
        ELSE interval
    END AS gap_to_next
FROM "f1"."f1_data"."intervals"
  );
[0m10:00:33.527353 [debug] [Thread-4 (]: SQL status: BEGIN in 0.055 seconds
[0m10:00:33.528357 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:00:33.529349 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:00:33.529349 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */

  create view "f1"."f1_data"."stg_laps__dbt_tmp"
    
    
  as (
    

select
    session_key,
    driver_number,
    date_trunc('second', date_start) as date_start,
    date_start + interval '1 second' * lap_duration as date_end,
    lap_duration,
    lap_number,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3
from "f1"."f1_data"."laps"
where lap_duration is not null
  );
[0m10:00:33.530348 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:00:33.535367 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:00:33.536369 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:00:33.539353 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:00:33.540354 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
alter table "f1"."f1_data"."stg_car_data__dbt_tmp" rename to "stg_car_data"
[0m10:00:33.543374 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:00:33.543374 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:00:33.544411 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
alter table "f1"."f1_data"."stg_drivers__dbt_tmp" rename to "stg_drivers"
[0m10:00:33.544411 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
alter table "f1"."f1_data"."stg_intervals__dbt_tmp" rename to "stg_intervals"
[0m10:00:33.547978 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:00:33.548955 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:00:33.549957 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
alter table "f1"."f1_data"."stg_laps__dbt_tmp" rename to "stg_laps"
[0m10:00:33.549957 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:00:33.549957 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:00:33.561468 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: COMMIT
[0m10:00:33.563468 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m10:00:33.564562 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:00:33.565520 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: COMMIT
[0m10:00:33.566585 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:00:33.567090 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:00:33.568098 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: COMMIT
[0m10:00:33.569212 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:00:33.570097 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: COMMIT
[0m10:00:33.570097 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m10:00:33.571222 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:00:33.571222 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: COMMIT
[0m10:00:33.572137 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: COMMIT
[0m10:00:33.573097 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:00:33.574098 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:00:33.574098 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:00:33.575098 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m10:00:33.580097 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_car_data__dbt_backup"
[0m10:00:33.582192 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."stg_intervals__dbt_backup"
[0m10:00:33.584196 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_drivers__dbt_backup"
[0m10:00:33.586194 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."stg_laps__dbt_backup"
[0m10:00:33.590097 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:00:33.591097 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:00:33.592226 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:00:33.593219 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:00:33.594176 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
drop view if exists "f1"."f1_data"."stg_car_data__dbt_backup" cascade
[0m10:00:33.594176 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
drop view if exists "f1"."f1_data"."stg_intervals__dbt_backup" cascade
[0m10:00:33.595140 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
drop view if exists "f1"."f1_data"."stg_drivers__dbt_backup" cascade
[0m10:00:33.595140 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
drop view if exists "f1"."f1_data"."stg_laps__dbt_backup" cascade
[0m10:00:33.597098 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:00:33.598099 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:00:33.598099 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:00:33.599097 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:00:33.601110 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: Close
[0m10:00:33.602112 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: Close
[0m10:00:33.603124 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: Close
[0m10:00:33.605150 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: Close
[0m10:00:33.610127 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F76B13F0>]}
[0m10:00:33.611124 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F9301A50>]}
[0m10:00:33.611124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F8EF0BB0>]}
[0m10:00:33.612129 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F9301C00>]}
[0m10:00:33.612129 [info ] [Thread-2 (]: 2 of 10 OK created sql view model f1_data.stg_drivers .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m10:00:33.613124 [info ] [Thread-4 (]: 4 of 10 OK created sql view model f1_data.stg_laps ............................. [[32mCREATE VIEW[0m in 0.20s]
[0m10:00:33.614224 [info ] [Thread-1 (]: 1 of 10 OK created sql view model f1_data.stg_car_data ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m10:00:33.615124 [info ] [Thread-3 (]: 3 of 10 OK created sql view model f1_data.stg_intervals ........................ [[32mCREATE VIEW[0m in 0.21s]
[0m10:00:33.616124 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_drivers
[0m10:00:33.616124 [debug] [Thread-4 (]: Finished running node model.f1_analytics.stg_laps
[0m10:00:33.617630 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_car_data
[0m10:00:33.617630 [debug] [Thread-3 (]: Finished running node model.f1_analytics.stg_intervals
[0m10:00:33.618653 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_meeting
[0m10:00:33.619657 [debug] [Thread-4 (]: Began running node model.f1_analytics.stg_pit
[0m10:00:33.620636 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_position
[0m10:00:33.621648 [debug] [Thread-3 (]: Began running node model.f1_analytics.stg_sessions
[0m10:00:33.622640 [info ] [Thread-2 (]: 5 of 10 START sql view model f1_data.stg_meeting ............................... [RUN]
[0m10:00:33.624148 [info ] [Thread-4 (]: 6 of 10 START sql view model f1_data.stg_pit ................................... [RUN]
[0m10:00:33.625156 [info ] [Thread-1 (]: 7 of 10 START sql view model f1_data.stg_position .............................. [RUN]
[0m10:00:33.627164 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_drivers, now model.f1_analytics.stg_meeting)
[0m10:00:33.626155 [info ] [Thread-3 (]: 8 of 10 START sql view model f1_data.stg_sessions .............................. [RUN]
[0m10:00:33.628175 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_laps, now model.f1_analytics.stg_pit)
[0m10:00:33.628175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_car_data, now model.f1_analytics.stg_position)
[0m10:00:33.629179 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_meeting
[0m10:00:33.629685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_intervals, now model.f1_analytics.stg_sessions)
[0m10:00:33.630692 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.stg_pit
[0m10:00:33.630692 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_position
[0m10:00:33.633692 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_meeting"
[0m10:00:33.633692 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.stg_sessions
[0m10:00:33.640694 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.stg_pit"
[0m10:00:33.645789 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_position"
[0m10:00:33.649798 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m10:00:33.650693 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_meeting
[0m10:00:33.651693 [debug] [Thread-4 (]: Began executing node model.f1_analytics.stg_pit
[0m10:00:33.652725 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_position
[0m10:00:33.653706 [debug] [Thread-3 (]: Began executing node model.f1_analytics.stg_sessions
[0m10:00:33.657692 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_meeting"
[0m10:00:33.660817 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.stg_pit"
[0m10:00:33.665138 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_position"
[0m10:00:33.668234 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m10:00:33.669136 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:00:33.670245 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:00:33.671140 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: BEGIN
[0m10:00:33.673196 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:00:33.673196 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: BEGIN
[0m10:00:33.674257 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:00:33.675241 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:00:33.675241 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: BEGIN
[0m10:00:33.676138 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:00:33.676138 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m10:00:33.677213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:00:33.678137 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:00:33.732134 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m10:00:33.732134 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:00:33.733142 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */

  create view "f1"."f1_data"."stg_meeting__dbt_tmp"
    
    
  as (
    

    select
            meeting_key,
            meeting_name,
            meeting_official_name,
            country_name,
            circuit_short_name,
            date_start,
            year
from "f1"."f1_data"."meetings"
  );
[0m10:00:33.734144 [debug] [Thread-4 (]: SQL status: BEGIN in 0.058 seconds
[0m10:00:33.735145 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:00:33.736140 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */

  create view "f1"."f1_data"."stg_pit__dbt_tmp"
    
    
  as (
    

    select *
    from "f1"."f1_data"."pit"
    where pit_duration is not null
  );
[0m10:00:33.736140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m10:00:33.737144 [debug] [Thread-3 (]: SQL status: BEGIN in 0.059 seconds
[0m10:00:33.737144 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:00:33.738160 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:00:33.738160 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */

  create view "f1"."f1_data"."stg_position__dbt_tmp"
    
    
  as (
    

    WITH source AS (
    SELECT * FROM "f1"."f1_data"."position"
)
SELECT
    session_key,
    driver_number,
    position,
    date
FROM source
  );
[0m10:00:33.739138 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    





















WITH source AS (
    SELECT
        session_key,
        meeting_key,
        country_name,
        session_name,
        session_type,
        year,
        circuit_short_name,
        date_start,
        date_end
    FROM "f1"."f1_data"."sessions"
)
SELECT * FROM source
  );
[0m10:00:33.739138 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:00:33.744164 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:00:33.744164 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m10:00:33.745136 [debug] [Thread-3 (]: Postgres adapter: Postgres error: column "country_name" does not exist
LINE 33:         country_name,
                 ^

[0m10:00:33.745136 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:00:33.746169 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
alter table "f1"."f1_data"."stg_meeting__dbt_tmp" rename to "stg_meeting"
[0m10:00:33.749150 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:00:33.749150 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: ROLLBACK
[0m10:00:33.752137 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:00:33.753137 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
alter table "f1"."f1_data"."stg_pit__dbt_tmp" rename to "stg_pit"
[0m10:00:33.753137 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:00:33.754142 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
alter table "f1"."f1_data"."stg_position__dbt_tmp" rename to "stg_position"
[0m10:00:33.755135 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: Close
[0m10:00:33.757151 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: COMMIT
[0m10:00:33.757151 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:00:33.759138 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:00:33.760138 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:00:33.762141 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: COMMIT
[0m10:00:33.764142 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: COMMIT
[0m10:00:33.765151 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: COMMIT
[0m10:00:33.766152 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:00:33.766152 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:00:33.767152 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: COMMIT
[0m10:00:33.768152 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: COMMIT
[0m10:00:33.769155 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m10:00:33.772152 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_meeting__dbt_backup"
[0m10:00:33.773153 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m10:00:33.774153 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:00:33.775152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m10:00:33.777250 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."stg_pit__dbt_backup"
[0m10:00:33.778247 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
drop view if exists "f1"."f1_data"."stg_meeting__dbt_backup" cascade
[0m10:00:33.780765 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_position__dbt_backup"
[0m10:00:33.781765 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:00:33.783819 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:00:33.784827 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:00:33.784827 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
drop view if exists "f1"."f1_data"."stg_pit__dbt_backup" cascade
[0m10:00:33.785929 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
drop view if exists "f1"."f1_data"."stg_position__dbt_backup" cascade
[0m10:00:33.787932 [debug] [Thread-2 (]: On model.f1_analytics.stg_meeting: Close
[0m10:00:33.788829 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:00:33.790960 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F76B13F0>]}
[0m10:00:33.791856 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:00:33.793846 [debug] [Thread-4 (]: On model.f1_analytics.stg_pit: Close
[0m10:00:33.794830 [info ] [Thread-2 (]: 5 of 10 OK created sql view model f1_data.stg_meeting .......................... [[32mCREATE VIEW[0m in 0.16s]
[0m10:00:33.796828 [debug] [Thread-1 (]: On model.f1_analytics.stg_position: Close
[0m10:00:33.797826 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F9302650>]}
[0m10:00:33.798832 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_meeting
[0m10:00:33.798832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F9595930>]}
[0m10:00:33.800337 [info ] [Thread-4 (]: 6 of 10 OK created sql view model f1_data.stg_pit .............................. [[32mCREATE VIEW[0m in 0.17s]
[0m10:00:33.801352 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_stints
[0m10:00:33.802353 [info ] [Thread-1 (]: 7 of 10 OK created sql view model f1_data.stg_position ......................... [[32mCREATE VIEW[0m in 0.17s]
[0m10:00:33.803346 [debug] [Thread-4 (]: Finished running node model.f1_analytics.stg_pit
[0m10:00:33.804387 [info ] [Thread-2 (]: 9 of 10 START sql view model f1_data.stg_stints ................................ [RUN]
[0m10:00:33.805343 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_position
[0m10:00:33.806347 [debug] [Thread-4 (]: Began running node model.f1_analytics.stg_weather
[0m10:00:33.807345 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_meeting, now model.f1_analytics.stg_stints)
[0m10:00:33.809345 [info ] [Thread-4 (]: 10 of 10 START sql view model f1_data.stg_weather .............................. [RUN]
[0m10:00:33.810347 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_stints
[0m10:00:33.811347 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_pit, now model.f1_analytics.stg_weather)
[0m10:00:33.815359 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_stints"
[0m10:00:33.816344 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.stg_weather
[0m10:00:33.819359 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.stg_weather"
[0m10:00:33.820357 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_stints
[0m10:00:33.825361 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_stints"
[0m10:00:33.827346 [debug] [Thread-4 (]: Began executing node model.f1_analytics.stg_weather
[0m10:00:33.831343 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.stg_weather"
[0m10:00:33.832343 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:00:33.833345 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:00:33.833345 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: BEGIN
[0m10:00:33.834370 [debug] [Thread-4 (]: On model.f1_analytics.stg_weather: BEGIN
[0m10:00:33.834370 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:00:33.835343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:00:33.873350 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m10:00:33.874353 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:00:33.874353 [debug] [Thread-4 (]: SQL status: BEGIN in 0.039 seconds
[0m10:00:33.875347 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */

  create view "f1"."f1_data"."stg_stints__dbt_tmp"
    
    
  as (
    

    select *
    from "f1"."f1_data"."stints"
    where compound is not null and lap_start is not null and lap_end is not null
  );
[0m10:00:33.875347 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:00:33.876346 [debug] [Thread-4 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */

  create view "f1"."f1_data"."stg_weather__dbt_tmp"
    
    
  as (
    


select *
FROM "f1"."f1_data"."weather"
  );
[0m10:00:33.881344 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:00:33.882449 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:00:33.884448 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:00:33.888444 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:00:33.888444 [debug] [Thread-4 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
alter table "f1"."f1_data"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m10:00:33.889391 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
alter table "f1"."f1_data"."stg_stints__dbt_tmp" rename to "stg_stints"
[0m10:00:33.890349 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:00:33.890349 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:00:33.892446 [debug] [Thread-4 (]: On model.f1_analytics.stg_weather: COMMIT
[0m10:00:33.893344 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: COMMIT
[0m10:00:33.894452 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:00:33.894452 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:00:33.895382 [debug] [Thread-4 (]: On model.f1_analytics.stg_weather: COMMIT
[0m10:00:33.895382 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: COMMIT
[0m10:00:33.897446 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:00:33.900345 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."stg_weather__dbt_backup"
[0m10:00:33.900345 [debug] [Thread-3 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column "country_name" does not exist
  LINE 33:         country_name,
                   ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m10:00:33.901466 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:00:33.902461 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m10:00:33.902461 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F95C4070>]}
[0m10:00:33.903388 [debug] [Thread-4 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
drop view if exists "f1"."f1_data"."stg_weather__dbt_backup" cascade
[0m10:00:33.956291 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_stints__dbt_backup"
[0m10:00:33.957819 [error] [Thread-3 (]: 8 of 10 ERROR creating sql view model f1_data.stg_sessions ..................... [[31mERROR[0m in 0.27s]
[0m10:00:33.958825 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:00:33.959826 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:00:33.960825 [debug] [Thread-3 (]: Finished running node model.f1_analytics.stg_sessions
[0m10:00:33.962263 [debug] [Thread-4 (]: On model.f1_analytics.stg_weather: Close
[0m10:00:33.962263 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
drop view if exists "f1"."f1_data"."stg_stints__dbt_backup" cascade
[0m10:00:33.963260 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column "country_name" does not exist
  LINE 33:         country_name,
                   ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m10:00:33.964262 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F96B6FE0>]}
[0m10:00:33.966262 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:00:33.967311 [info ] [Thread-4 (]: 10 of 10 OK created sql view model f1_data.stg_weather ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:00:33.968262 [debug] [Thread-2 (]: On model.f1_analytics.stg_stints: Close
[0m10:00:33.969262 [debug] [Thread-4 (]: Finished running node model.f1_analytics.stg_weather
[0m10:00:33.970329 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '73a1207b-f5f1-47bf-ba9e-36ddaf96e830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F96AA2F0>]}
[0m10:00:33.971262 [info ] [Thread-2 (]: 9 of 10 OK created sql view model f1_data.stg_stints ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m10:00:33.972266 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_stints
[0m10:00:33.974260 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:33.975305 [debug] [MainThread]: On master: BEGIN
[0m10:00:33.975305 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:00:34.011578 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m10:00:34.011578 [debug] [MainThread]: On master: COMMIT
[0m10:00:34.012620 [debug] [MainThread]: Using postgres connection "master"
[0m10:00:34.013586 [debug] [MainThread]: On master: COMMIT
[0m10:00:34.014587 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m10:00:34.015571 [debug] [MainThread]: On master: Close
[0m10:00:34.015571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:00:34.016574 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m10:00:34.016574 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m10:00:34.017584 [debug] [MainThread]: Connection 'model.f1_analytics.stg_position' was properly closed.
[0m10:00:34.017584 [debug] [MainThread]: Connection 'model.f1_analytics.stg_stints' was properly closed.
[0m10:00:34.018581 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was properly closed.
[0m10:00:34.018581 [debug] [MainThread]: Connection 'model.f1_analytics.stg_weather' was properly closed.
[0m10:00:34.019573 [info ] [MainThread]: 
[0m10:00:34.020574 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 15.63 seconds (15.63s).
[0m10:00:34.021616 [debug] [MainThread]: Command end result
[0m10:00:34.043568 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:00:34.046576 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:00:34.052569 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m10:00:34.053570 [info ] [MainThread]: 
[0m10:00:34.053570 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:00:34.054569 [info ] [MainThread]: 
[0m10:00:34.054569 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m10:00:34.055619 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column "country_name" does not exist
  LINE 33:         country_name,
                   ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m10:00:34.055619 [info ] [MainThread]: 
[0m10:00:34.056609 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m10:00:34.056609 [info ] [MainThread]: 
[0m10:00:34.057657 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=10
[0m10:00:34.058674 [debug] [MainThread]: Command `dbt run` failed at 10:00:34.058674 after 16.60 seconds
[0m10:00:34.059672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F641E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F9516470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7F9515DE0>]}
[0m10:00:34.060575 [debug] [MainThread]: Flushing usage events
[0m10:00:34.451181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:03:39.896564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8827E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F89570FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F89570DC0>]}


============================== 10:03:39.900610 | 89999e7f-8764-4483-a685-03d00cb081ad ==============================
[0m10:03:39.900610 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:03:39.901679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select stg_sessions', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:03:40.055110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '89999e7f-8764-4483-a685-03d00cb081ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8964DED0>]}
[0m10:03:40.106108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '89999e7f-8764-4483-a685-03d00cb081ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F88CB2440>]}
[0m10:03:40.108108 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:03:40.245147 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:03:40.446080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:03:40.447082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:03:40.530250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '89999e7f-8764-4483-a685-03d00cb081ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8AC48F40>]}
[0m10:03:40.677232 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:03:40.679230 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:03:40.703235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '89999e7f-8764-4483-a685-03d00cb081ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8AC724A0>]}
[0m10:03:40.704235 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m10:03:40.705232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89999e7f-8764-4483-a685-03d00cb081ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8AC7C0A0>]}
[0m10:03:40.707236 [info ] [MainThread]: 
[0m10:03:40.708261 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:03:40.709248 [info ] [MainThread]: 
[0m10:03:40.710236 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:03:40.712234 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m10:03:40.765260 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m10:03:40.765260 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m10:03:40.766260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:40.804260 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m10:03:40.806268 [debug] [ThreadPool]: On list_f1: Close
[0m10:03:40.814260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m10:03:40.819259 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:03:40.820263 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m10:03:40.821260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:03:40.880263 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m10:03:40.881369 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:03:40.882264 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m10:03:40.895263 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.012 seconds
[0m10:03:40.898261 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m10:03:40.899260 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m10:03:40.913283 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:40.914287 [debug] [MainThread]: On master: BEGIN
[0m10:03:40.914287 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:03:40.950324 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m10:03:40.951306 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:40.952313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:03:40.960314 [debug] [MainThread]: SQL status: SELECT 9 in 0.007 seconds
[0m10:03:40.963316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '89999e7f-8764-4483-a685-03d00cb081ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F86C08070>]}
[0m10:03:40.964315 [debug] [MainThread]: On master: ROLLBACK
[0m10:03:40.964315 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:40.965317 [debug] [MainThread]: On master: BEGIN
[0m10:03:40.966832 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:03:40.967841 [debug] [MainThread]: On master: COMMIT
[0m10:03:40.967841 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:40.967841 [debug] [MainThread]: On master: COMMIT
[0m10:03:40.968839 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:03:40.968839 [debug] [MainThread]: On master: Close
[0m10:03:40.973844 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m10:03:40.974880 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.stg_sessions ............................... [RUN]
[0m10:03:40.975862 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_sessions'
[0m10:03:40.976839 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m10:03:40.983854 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m10:03:40.983854 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m10:03:41.014121 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m10:03:41.016737 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:03:41.017748 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m10:03:41.017748 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:03:41.053371 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m10:03:41.054349 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:03:41.054349 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    





















WITH source AS (
    SELECT
        session_key,
        meeting_key,
        country_name,
        session_name,
        session_type,
        year,
        circuit_short_name,
        date_start,
        date_end
    FROM "f1"."f1_data"."sessions"
)
SELECT * FROM source
  );
[0m10:03:41.055361 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "year" does not exist
LINE 36:         year,
                 ^

[0m10:03:41.056522 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: ROLLBACK
[0m10:03:41.057369 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: Close
[0m10:03:41.060369 [debug] [Thread-1 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column "year" does not exist
  LINE 36:         year,
                   ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m10:03:41.062370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '89999e7f-8764-4483-a685-03d00cb081ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8953ABF0>]}
[0m10:03:41.063519 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.stg_sessions ...................... [[31mERROR[0m in 0.08s]
[0m10:03:41.064367 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m10:03:41.065370 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column "year" does not exist
  LINE 36:         year,
                   ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m10:03:41.067367 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:41.067367 [debug] [MainThread]: On master: BEGIN
[0m10:03:41.068375 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:03:41.108418 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m10:03:41.109420 [debug] [MainThread]: On master: COMMIT
[0m10:03:41.110414 [debug] [MainThread]: Using postgres connection "master"
[0m10:03:41.110414 [debug] [MainThread]: On master: COMMIT
[0m10:03:41.111429 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:03:41.111429 [debug] [MainThread]: On master: Close
[0m10:03:41.112423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:03:41.113420 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m10:03:41.113420 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m10:03:41.114420 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was properly closed.
[0m10:03:41.115418 [info ] [MainThread]: 
[0m10:03:41.115418 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m10:03:41.116419 [debug] [MainThread]: Command end result
[0m10:03:41.140417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:03:41.143414 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:03:41.150428 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m10:03:41.151422 [info ] [MainThread]: 
[0m10:03:41.153416 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:03:41.155421 [info ] [MainThread]: 
[0m10:03:41.156417 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m10:03:41.157423 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column "year" does not exist
  LINE 36:         year,
                   ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m10:03:41.158424 [info ] [MainThread]: 
[0m10:03:41.161418 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m10:03:41.162420 [info ] [MainThread]: 
[0m10:03:41.164421 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:03:41.166416 [debug] [MainThread]: Command `dbt run` failed at 10:03:41.165419 after 1.35 seconds
[0m10:03:41.166416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8827E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F8AC499C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024F856D4130>]}
[0m10:03:41.168425 [debug] [MainThread]: Flushing usage events
[0m10:03:41.479931 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:05:24.804459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A16F2A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A191D0F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A191D0D60>]}


============================== 10:05:24.808478 | 5e1a3a69-8ae9-4517-a4bf-aecf75919d72 ==============================
[0m10:05:24.808478 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:05:24.808478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select stg_sessions', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:05:24.954169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e1a3a69-8ae9-4517-a4bf-aecf75919d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A192AF940>]}
[0m10:05:25.000193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e1a3a69-8ae9-4517-a4bf-aecf75919d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A191D2C50>]}
[0m10:05:25.002196 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:05:25.127741 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:05:25.258619 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:05:25.259621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:05:25.301396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e1a3a69-8ae9-4517-a4bf-aecf75919d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1A8ACF10>]}
[0m10:05:25.420395 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:05:25.422397 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:05:25.442293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e1a3a69-8ae9-4517-a4bf-aecf75919d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1A894880>]}
[0m10:05:25.443236 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m10:05:25.444239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1a3a69-8ae9-4517-a4bf-aecf75919d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1A8959F0>]}
[0m10:05:25.445261 [info ] [MainThread]: 
[0m10:05:25.446261 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:05:25.446261 [info ] [MainThread]: 
[0m10:05:25.447245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:05:25.448239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m10:05:25.494886 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m10:05:25.495903 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m10:05:25.495903 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:25.531529 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.036 seconds
[0m10:05:25.533551 [debug] [ThreadPool]: On list_f1: Close
[0m10:05:25.539528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m10:05:25.545543 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:05:25.545543 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m10:05:25.546544 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:05:25.581529 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m10:05:25.582528 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:05:25.582528 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m10:05:25.588546 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.005 seconds
[0m10:05:25.590533 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m10:05:25.590533 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m10:05:25.597545 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:25.598543 [debug] [MainThread]: On master: BEGIN
[0m10:05:25.598543 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:05:25.629543 [debug] [MainThread]: SQL status: BEGIN in 0.031 seconds
[0m10:05:25.630537 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:25.630537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:05:25.636631 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m10:05:25.638545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1a3a69-8ae9-4517-a4bf-aecf75919d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1A896320>]}
[0m10:05:25.639640 [debug] [MainThread]: On master: ROLLBACK
[0m10:05:25.640570 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:25.640570 [debug] [MainThread]: On master: BEGIN
[0m10:05:25.641577 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:05:25.642636 [debug] [MainThread]: On master: COMMIT
[0m10:05:25.642636 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:25.643588 [debug] [MainThread]: On master: COMMIT
[0m10:05:25.644630 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:05:25.645545 [debug] [MainThread]: On master: Close
[0m10:05:25.652534 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m10:05:25.653569 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.stg_sessions ............................... [RUN]
[0m10:05:25.654529 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_sessions'
[0m10:05:25.654529 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m10:05:25.661632 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m10:05:25.662636 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m10:05:25.687572 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m10:05:25.689533 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:05:25.690533 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m10:05:25.690533 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:05:25.723529 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m10:05:25.723529 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:05:25.724535 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    





















WITH source AS (
    SELECT
        session_key,
        meeting_key,
        country_name,
        session_name,
        session_type,
        year,
        circuit_short_name,
        date_start,
        date_end
    FROM "f1"."f1_data"."sessions"
)
SELECT * FROM source
  );
[0m10:05:25.725533 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "circuit_short_name" does not exist
LINE 37:         circuit_short_name,
                 ^

[0m10:05:25.725533 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: ROLLBACK
[0m10:05:25.726534 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: Close
[0m10:05:25.729541 [debug] [Thread-1 (]: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column "circuit_short_name" does not exist
  LINE 37:         circuit_short_name,
                   ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m10:05:25.732537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1a3a69-8ae9-4517-a4bf-aecf75919d72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1919ECB0>]}
[0m10:05:25.733534 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model f1_data.stg_sessions ...................... [[31mERROR[0m in 0.08s]
[0m10:05:25.734535 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m10:05:25.734535 [debug] [Thread-7 (]: Marking all children of 'model.f1_analytics.stg_sessions' to be skipped because of status 'error'.  Reason: Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column "circuit_short_name" does not exist
  LINE 37:         circuit_short_name,
                   ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql.
[0m10:05:25.736538 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:25.737562 [debug] [MainThread]: On master: BEGIN
[0m10:05:25.737562 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:05:25.777898 [debug] [MainThread]: SQL status: BEGIN in 0.040 seconds
[0m10:05:25.778932 [debug] [MainThread]: On master: COMMIT
[0m10:05:25.778932 [debug] [MainThread]: Using postgres connection "master"
[0m10:05:25.778932 [debug] [MainThread]: On master: COMMIT
[0m10:05:25.779897 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:05:25.779897 [debug] [MainThread]: On master: Close
[0m10:05:25.780896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:05:25.780896 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m10:05:25.781897 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m10:05:25.781897 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was properly closed.
[0m10:05:25.782898 [info ] [MainThread]: 
[0m10:05:25.782898 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m10:05:25.784898 [debug] [MainThread]: Command end result
[0m10:05:25.805972 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:05:25.808544 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:05:25.816565 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m10:05:25.816565 [info ] [MainThread]: 
[0m10:05:25.817561 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:05:25.818566 [info ] [MainThread]: 
[0m10:05:25.819561 [error] [MainThread]: [31mFailure in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)[0m
[0m10:05:25.820559 [error] [MainThread]:   Database Error in model stg_sessions (f1_analytics/models\staging\stg_sessions.sql)
  column "circuit_short_name" does not exist
  LINE 37:         circuit_short_name,
                   ^
  compiled code at target\run\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m10:05:25.820559 [info ] [MainThread]: 
[0m10:05:25.822558 [info ] [MainThread]:   compiled code at target\compiled\f1_analytics\f1_analytics/models\staging\stg_sessions.sql
[0m10:05:25.823564 [info ] [MainThread]: 
[0m10:05:25.823564 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m10:05:25.825579 [debug] [MainThread]: Command `dbt run` failed at 10:05:25.825579 after 1.09 seconds
[0m10:05:25.827564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A16F2A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A1A8AD600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A19404880>]}
[0m10:05:25.828571 [debug] [MainThread]: Flushing usage events
[0m10:05:26.155394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:07:37.387456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2346CE350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2359D0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2359D0D30>]}


============================== 10:07:37.391458 | 6616c74a-16c4-40ad-9e2e-d2ad70f9b69a ==============================
[0m10:07:37.391458 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:07:37.392456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select stg_sessions', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:07:37.540677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6616c74a-16c4-40ad-9e2e-d2ad70f9b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A235AADD50>]}
[0m10:07:37.586468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6616c74a-16c4-40ad-9e2e-d2ad70f9b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A23599EDA0>]}
[0m10:07:37.588373 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:07:37.719789 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:07:37.846748 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:37.847748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:37.889786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6616c74a-16c4-40ad-9e2e-d2ad70f9b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2370A8EE0>]}
[0m10:07:38.006508 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:07:38.009983 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:07:38.032400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6616c74a-16c4-40ad-9e2e-d2ad70f9b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2370020E0>]}
[0m10:07:38.033311 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m10:07:38.033311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6616c74a-16c4-40ad-9e2e-d2ad70f9b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A237094A00>]}
[0m10:07:38.035400 [info ] [MainThread]: 
[0m10:07:38.036396 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:07:38.036396 [info ] [MainThread]: 
[0m10:07:38.037302 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:07:38.039310 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m10:07:38.084709 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m10:07:38.085675 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m10:07:38.085675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:38.128337 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.042 seconds
[0m10:07:38.129327 [debug] [ThreadPool]: On list_f1: Close
[0m10:07:38.137384 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m10:07:38.141334 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:07:38.142328 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m10:07:38.142328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:38.181644 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m10:07:38.183669 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:07:38.183669 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m10:07:38.193421 [debug] [ThreadPool]: SQL status: SELECT 20 in 0.008 seconds
[0m10:07:38.194737 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m10:07:38.195673 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m10:07:38.205187 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:38.205187 [debug] [MainThread]: On master: BEGIN
[0m10:07:38.205187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:38.241378 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m10:07:38.241378 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:38.242379 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:07:38.251361 [debug] [MainThread]: SQL status: SELECT 9 in 0.009 seconds
[0m10:07:38.254000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6616c74a-16c4-40ad-9e2e-d2ad70f9b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A231D7DE10>]}
[0m10:07:38.254944 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:38.254944 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:38.255999 [debug] [MainThread]: On master: BEGIN
[0m10:07:38.256995 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:07:38.256995 [debug] [MainThread]: On master: COMMIT
[0m10:07:38.256995 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:38.257984 [debug] [MainThread]: On master: COMMIT
[0m10:07:38.257984 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:07:38.258991 [debug] [MainThread]: On master: Close
[0m10:07:38.264362 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_sessions
[0m10:07:38.264362 [info ] [Thread-1 (]: 1 of 1 START sql view model f1_data.stg_sessions ............................... [RUN]
[0m10:07:38.265350 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_sessions'
[0m10:07:38.266376 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_sessions
[0m10:07:38.273003 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m10:07:38.273950 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_sessions
[0m10:07:38.299063 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m10:07:38.301023 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:07:38.301023 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m10:07:38.302031 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:07:38.335320 [debug] [Thread-1 (]: SQL status: BEGIN in 0.033 seconds
[0m10:07:38.336301 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:07:38.336301 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    





















WITH source AS (
    SELECT
        session_key,
        meeting_key,
        country_name,
        session_name,
        session_type,
        year,
        circuit_short_name,
        date_start,
        date_end
    FROM "f1"."f1_data"."sessions"
)
SELECT * FROM source
  );
[0m10:07:38.342296 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:07:38.348306 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:07:38.348306 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
alter table "f1"."f1_data"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m10:07:38.349311 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:07:38.360295 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: COMMIT
[0m10:07:38.360295 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:07:38.361296 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: COMMIT
[0m10:07:38.363323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:07:38.368259 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_sessions__dbt_backup"
[0m10:07:38.371264 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:07:38.372270 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
drop view if exists "f1"."f1_data"."stg_sessions__dbt_backup" cascade
[0m10:07:38.372976 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:07:38.374983 [debug] [Thread-1 (]: On model.f1_analytics.stg_sessions: Close
[0m10:07:38.376982 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6616c74a-16c4-40ad-9e2e-d2ad70f9b69a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A23711D690>]}
[0m10:07:38.377984 [info ] [Thread-1 (]: 1 of 1 OK created sql view model f1_data.stg_sessions .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m10:07:38.378988 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_sessions
[0m10:07:38.380535 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:38.380535 [debug] [MainThread]: On master: BEGIN
[0m10:07:38.381541 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:38.413674 [debug] [MainThread]: SQL status: BEGIN in 0.032 seconds
[0m10:07:38.413674 [debug] [MainThread]: On master: COMMIT
[0m10:07:38.414680 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:38.414680 [debug] [MainThread]: On master: COMMIT
[0m10:07:38.415667 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:07:38.415667 [debug] [MainThread]: On master: Close
[0m10:07:38.416679 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:38.416679 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m10:07:38.416679 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m10:07:38.418046 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was properly closed.
[0m10:07:38.419265 [info ] [MainThread]: 
[0m10:07:38.421469 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m10:07:38.422469 [debug] [MainThread]: Command end result
[0m10:07:38.444417 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:07:38.447416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:07:38.453504 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m10:07:38.454453 [info ] [MainThread]: 
[0m10:07:38.455492 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:07:38.456598 [info ] [MainThread]: 
[0m10:07:38.457630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:07:38.458615 [debug] [MainThread]: Command `dbt run` succeeded at 10:07:38.458615 after 1.14 seconds
[0m10:07:38.458615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2346CE350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A2370A9960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A235C04A00>]}
[0m10:07:38.459628 [debug] [MainThread]: Flushing usage events
[0m10:07:38.785832 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:13:13.660389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D42BFE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D43F00EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D43F00D00>]}


============================== 10:13:13.665398 | 5237e224-78cd-48ed-849b-df7a684e32ff ==============================
[0m10:13:13.665398 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:13:13.666405 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select intermediate', 'send_anonymous_usage_stats': 'True'}
[0m10:13:13.819575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D43FDFAC0>]}
[0m10:13:13.866577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D43F02BF0>]}
[0m10:13:13.867578 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:13:13.997235 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:13:14.128813 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:13:14.128813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:13:14.171647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D455D8E80>]}
[0m10:13:14.288892 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:13:14.290897 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:13:14.313796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D455C4A90>]}
[0m10:13:14.314796 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m10:13:14.314796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D455C59C0>]}
[0m10:13:14.316811 [info ] [MainThread]: 
[0m10:13:14.317794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:13:14.317794 [info ] [MainThread]: 
[0m10:13:14.318795 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:13:14.322794 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m10:13:14.367904 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m10:13:14.368895 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m10:13:14.368895 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:14.406888 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m10:13:14.407803 [debug] [ThreadPool]: On list_f1: Close
[0m10:13:14.411900 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m10:13:14.416798 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:13:14.417800 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m10:13:14.417800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:13:14.454768 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m10:13:14.454768 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:13:14.455661 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m10:13:14.462775 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.006 seconds
[0m10:13:14.463768 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m10:13:14.465389 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m10:13:14.474213 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:14.474213 [debug] [MainThread]: On master: BEGIN
[0m10:13:14.475218 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:13:14.517280 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m10:13:14.517280 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:14.518384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:13:14.527486 [debug] [MainThread]: SQL status: SELECT 10 in 0.009 seconds
[0m10:13:14.530483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D45537A00>]}
[0m10:13:14.531380 [debug] [MainThread]: On master: ROLLBACK
[0m10:13:14.532521 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:14.532521 [debug] [MainThread]: On master: BEGIN
[0m10:13:14.533380 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:13:14.533380 [debug] [MainThread]: On master: COMMIT
[0m10:13:14.534381 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:14.535392 [debug] [MainThread]: On master: COMMIT
[0m10:13:14.536500 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:13:14.537434 [debug] [MainThread]: On master: Close
[0m10:13:14.544894 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_best_laps
[0m10:13:14.545910 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_car_base
[0m10:13:14.545910 [debug] [Thread-3 (]: Began running node model.f1_analytics.int_final_intervals
[0m10:13:14.546932 [debug] [Thread-4 (]: Began running node model.f1_analytics.int_final_position
[0m10:13:14.546932 [info ] [Thread-1 (]: 1 of 9 START sql view model f1_data.int_best_laps .............................. [RUN]
[0m10:13:14.547893 [info ] [Thread-2 (]: 2 of 9 START sql view model f1_data.int_car_base ............................... [RUN]
[0m10:13:14.547893 [info ] [Thread-3 (]: 3 of 9 START sql view model f1_data.int_final_intervals ........................ [RUN]
[0m10:13:14.549896 [info ] [Thread-4 (]: 4 of 9 START sql view model f1_data.int_final_position ......................... [RUN]
[0m10:13:14.550899 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.int_best_laps'
[0m10:13:14.551910 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.int_car_base'
[0m10:13:14.552897 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.int_final_intervals'
[0m10:13:14.553895 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.int_final_position'
[0m10:13:14.554893 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_best_laps
[0m10:13:14.555900 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_car_base
[0m10:13:14.556900 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.int_final_intervals
[0m10:13:14.557912 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.int_final_position
[0m10:13:14.564462 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_best_laps"
[0m10:13:14.569457 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_car_base"
[0m10:13:14.573495 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.int_final_intervals"
[0m10:13:14.577454 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.int_final_position"
[0m10:13:14.578454 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_best_laps
[0m10:13:14.579505 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_car_base
[0m10:13:14.596553 [debug] [Thread-3 (]: Began executing node model.f1_analytics.int_final_intervals
[0m10:13:14.606556 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_best_laps"
[0m10:13:14.607567 [debug] [Thread-4 (]: Began executing node model.f1_analytics.int_final_position
[0m10:13:14.611454 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_car_base"
[0m10:13:14.615452 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.int_final_intervals"
[0m10:13:14.619452 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.int_final_position"
[0m10:13:14.621450 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:13:14.622450 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:13:14.622450 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: BEGIN
[0m10:13:14.623498 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:13:14.624495 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: BEGIN
[0m10:13:14.624495 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:13:14.625554 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:13:14.625554 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: BEGIN
[0m10:13:14.626456 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:13:14.627449 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: BEGIN
[0m10:13:14.628455 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:13:14.630453 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:13:14.679260 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m10:13:14.680261 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:13:14.681260 [debug] [Thread-2 (]: SQL status: BEGIN in 0.054 seconds
[0m10:13:14.681260 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */

  create view "f1"."f1_data"."int_best_laps__dbt_tmp"
    
    
  as (
    

select
        session_key,
        driver_number,
        min(lap_duration) as fastest_lap
from "f1"."f1_data"."stg_laps"
group by 1,2
  );
[0m10:13:14.682338 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:13:14.683260 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */

  create view "f1"."f1_data"."int_car_base__dbt_tmp"
    
    
  as (
    

SELECT
   ts.driver_number,
   ts.session_key,
   d.name_acronym,
   d.team_name,
   d.team_colour,
   ts.date,
   ts.rpm,
   ts.speed,
   ts.throttle,
   ts.brake
FROM "f1"."f1_data"."stg_car_data" ts
LEFT JOIN "f1"."f1_data"."stg_drivers" d
   ON ts.driver_number = d.driver_number
   AND ts.session_key = d.session_key
  );
[0m10:13:14.684267 [debug] [Thread-3 (]: SQL status: BEGIN in 0.056 seconds
[0m10:13:14.685270 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:13:14.686265 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */

  create view "f1"."f1_data"."int_final_intervals__dbt_tmp"
    
    
  as (
    SELECT
    session_key,
    driver_number,
    MAX(CASE
        WHEN gap_to_leader LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_leader AS FLOAT)
    END) AS max_gap_to_leader,
    MAX(CASE
        WHEN gap_to_next LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_next AS FLOAT)
    END) AS max_gap_to_next
FROM "f1"."f1_data"."stg_intervals"
GROUP BY session_key, driver_number
  );
[0m10:13:14.690260 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:13:14.696262 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:13:14.697264 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m10:13:14.697264 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:13:14.698259 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */
alter table "f1"."f1_data"."int_best_laps__dbt_tmp" rename to "int_best_laps"
[0m10:13:14.700360 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:13:14.703356 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:13:14.704355 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
alter table "f1"."f1_data"."int_car_base__dbt_tmp" rename to "int_car_base"
[0m10:13:14.705260 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:14.706274 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */
alter table "f1"."f1_data"."int_final_intervals__dbt_tmp" rename to "int_final_intervals"
[0m10:13:14.719262 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: COMMIT
[0m10:13:14.719262 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.013 seconds
[0m10:13:14.720388 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:13:14.721315 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:14.722372 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: COMMIT
[0m10:13:14.723377 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: COMMIT
[0m10:13:14.724266 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: COMMIT
[0m10:13:14.725263 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:13:14.726264 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:13:14.726264 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: COMMIT
[0m10:13:14.727299 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: COMMIT
[0m10:13:14.727299 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:13:14.733364 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_best_laps__dbt_backup"
[0m10:13:14.734364 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m10:13:14.735326 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m10:13:14.740356 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:13:14.743307 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."int_car_base__dbt_backup"
[0m10:13:14.746261 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."int_final_intervals__dbt_backup"
[0m10:13:14.746261 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */
drop view if exists "f1"."f1_data"."int_best_laps__dbt_backup" cascade
[0m10:13:14.747260 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:13:14.749283 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:13:14.750264 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
drop view if exists "f1"."f1_data"."int_car_base__dbt_backup" cascade
[0m10:13:14.751344 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:13:14.752260 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */
drop view if exists "f1"."f1_data"."int_final_intervals__dbt_backup" cascade
[0m10:13:14.756278 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: Close
[0m10:13:14.757275 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:13:14.761259 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: Close
[0m10:13:14.762258 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:13:14.766266 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: Close
[0m10:13:14.767267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D45656BF0>]}
[0m10:13:14.768264 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D45656B90>]}
[0m10:13:14.768264 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D45ACE020>]}
[0m10:13:14.769264 [info ] [Thread-1 (]: 1 of 9 OK created sql view model f1_data.int_best_laps ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m10:13:14.770265 [info ] [Thread-3 (]: 3 of 9 OK created sql view model f1_data.int_final_intervals ................... [[32mCREATE VIEW[0m in 0.22s]
[0m10:13:14.771264 [info ] [Thread-2 (]: 2 of 9 OK created sql view model f1_data.int_car_base .......................... [[32mCREATE VIEW[0m in 0.21s]
[0m10:13:14.772358 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_best_laps
[0m10:13:14.773267 [debug] [Thread-3 (]: Finished running node model.f1_analytics.int_final_intervals
[0m10:13:14.774264 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_car_base
[0m10:13:14.774264 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_lap_position
[0m10:13:14.775316 [debug] [Thread-3 (]: Began running node model.f1_analytics.int_pit_stop
[0m10:13:14.776266 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_tyre_stint
[0m10:13:14.776266 [info ] [Thread-1 (]: 5 of 9 START sql view model f1_data.int_lap_position ........................... [RUN]
[0m10:13:14.777775 [info ] [Thread-3 (]: 6 of 9 START sql view model f1_data.int_pit_stop ............................... [RUN]
[0m10:13:14.779288 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_best_laps, now model.f1_analytics.int_lap_position)
[0m10:13:14.779288 [info ] [Thread-2 (]: 7 of 9 START sql view model f1_data.int_tyre_stint ............................. [RUN]
[0m10:13:14.780294 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_final_intervals, now model.f1_analytics.int_pit_stop)
[0m10:13:14.780294 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_lap_position
[0m10:13:14.781334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_car_base, now model.f1_analytics.int_tyre_stint)
[0m10:13:14.782294 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.int_pit_stop
[0m10:13:14.785717 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_lap_position"
[0m10:13:14.786298 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_tyre_stint
[0m10:13:14.787310 [debug] [Thread-4 (]: SQL status: BEGIN in 0.157 seconds
[0m10:13:14.790299 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.int_pit_stop"
[0m10:13:14.794396 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint"
[0m10:13:14.794396 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:13:14.795983 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_lap_position
[0m10:13:14.796991 [debug] [Thread-3 (]: Began executing node model.f1_analytics.int_pit_stop
[0m10:13:14.796991 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */

  create view "f1"."f1_data"."int_final_position__dbt_tmp"
    
    
  as (
    

WITH ranked AS (
    SELECT
        session_key,
        driver_number,
        position,
        date AS latest_date,
        ROW_NUMBER() OVER (
            PARTITION BY session_key, driver_number
            ORDER BY date DESC
        ) AS rn
    FROM "f1"."f1_data"."stg_position"
)
SELECT
    session_key,
    driver_number,
    position,
    latest_date
FROM ranked
WHERE rn = 1
  );
[0m10:13:14.797990 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_tyre_stint
[0m10:13:14.803195 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_lap_position"
[0m10:13:14.808097 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.int_pit_stop"
[0m10:13:14.811131 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint"
[0m10:13:14.813105 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:13:14.814100 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: BEGIN
[0m10:13:14.815097 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:13:14.816535 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:13:14.816535 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:13:14.817636 [debug] [Thread-3 (]: On model.f1_analytics.int_pit_stop: BEGIN
[0m10:13:14.817636 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:13:14.818534 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stint: BEGIN
[0m10:13:14.819533 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:13:14.822629 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:13:14.823541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:13:14.824588 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */
alter table "f1"."f1_data"."int_final_position__dbt_tmp" rename to "int_final_position"
[0m10:13:14.828064 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:14.831063 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: COMMIT
[0m10:13:14.833062 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:13:14.834063 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: COMMIT
[0m10:13:14.837061 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:13:14.842065 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."int_final_position__dbt_backup"
[0m10:13:14.844065 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:13:14.845061 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */
drop view if exists "f1"."f1_data"."int_final_position__dbt_backup" cascade
[0m10:13:14.847120 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:13:14.849063 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: Close
[0m10:13:14.850066 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D43EA4AC0>]}
[0m10:13:14.851058 [info ] [Thread-4 (]: 4 of 9 OK created sql view model f1_data.int_final_position .................... [[32mCREATE VIEW[0m in 0.30s]
[0m10:13:14.853063 [debug] [Thread-4 (]: Finished running node model.f1_analytics.int_final_position
[0m10:13:14.854062 [debug] [Thread-4 (]: Began running node model.f1_analytics.int_tyre_stint_laps
[0m10:13:14.855058 [info ] [Thread-4 (]: 8 of 9 START sql view model f1_data.int_tyre_stint_laps ........................ [RUN]
[0m10:13:14.856065 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_final_position, now model.f1_analytics.int_tyre_stint_laps)
[0m10:13:14.857058 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.int_tyre_stint_laps
[0m10:13:14.860055 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint_laps"
[0m10:13:14.861055 [debug] [Thread-4 (]: Began executing node model.f1_analytics.int_tyre_stint_laps
[0m10:13:14.867057 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint_laps"
[0m10:13:14.869059 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:13:14.870064 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m10:13:14.870064 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: BEGIN
[0m10:13:14.871060 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:13:14.872058 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:13:14.873064 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */

  create view "f1"."f1_data"."int_lap_position__dbt_tmp"
    
    
  as (
    

WITH positions AS (
    SELECT
        p.session_key,
        p.driver_number,
        p.position,
        p.date,
        l.lap_number,
        l.date_start,
        l.date_end,
        ABS(EXTRACT(EPOCH FROM (p.date - l.date_start))) AS start_time_diff,
        ABS(EXTRACT(EPOCH FROM (p.date - l.date_end)))   AS end_time_diff
    FROM "f1"."f1_data"."stg_position" p
    JOIN "f1"."f1_data"."stg_laps" l
        ON p.session_key = l.session_key
        AND p.driver_number = l.driver_number
    WHERE p.date BETWEEN l.date_start AND l.date_end
)
SELECT *,
    ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number, lap_number
        ORDER BY start_time_diff
    ) AS start_position_rank,
    ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number, lap_number
        ORDER BY end_time_diff
    ) AS end_position_rank
FROM positions
  );
[0m10:13:14.873064 [debug] [Thread-2 (]: SQL status: BEGIN in 0.050 seconds
[0m10:13:14.873064 [debug] [Thread-3 (]: SQL status: BEGIN in 0.054 seconds
[0m10:13:14.875063 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:13:14.875063 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:13:14.876161 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */

  create view "f1"."f1_data"."int_tyre_stint__dbt_tmp"
    
    
  as (
    

WITH stints_base AS (
    SELECT
        s.*,
        d.team_name,
        ses.circuit_short_name,
        ses.country_name,
        ses.session_type
    FROM "f1"."f1_data"."stg_stints" s
    LEFT JOIN "f1"."f1_data"."stg_drivers" d ON s.driver_number = d.driver_number
        AND s.session_key = d.session_key
    LEFT JOIN "f1"."f1_data"."stg_sessions" ses ON s.session_key = ses.session_key
    WHERE ses.session_type = 'Race' -- Focus on race sessions
),

stint_durations AS (
    SELECT
        *,
        lap_end - lap_start + 1 as stint_length
    FROM stints_base
)

SELECT * FROM stint_durations
  );
[0m10:13:14.877062 [debug] [Thread-3 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */

  create view "f1"."f1_data"."int_pit_stop__dbt_tmp"
    
    
  as (
    

SELECT
    session_key,
    driver_number,
    COUNT(*) AS pit_stop_count
FROM "f1"."f1_data"."stg_pit"
GROUP BY session_key, driver_number
  );
[0m10:13:14.884068 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:13:14.885397 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:13:14.886410 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:13:14.890406 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:13:14.893522 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:13:14.897638 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:13:14.898634 [debug] [Thread-3 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */
alter table "f1"."f1_data"."int_pit_stop__dbt_tmp" rename to "int_pit_stop"
[0m10:13:14.898634 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */
alter table "f1"."f1_data"."int_lap_position__dbt_tmp" rename to "int_lap_position"
[0m10:13:14.899633 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */
alter table "f1"."f1_data"."int_tyre_stint__dbt_tmp" rename to "int_tyre_stint"
[0m10:13:14.900636 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:14.901641 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:14.901641 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:14.903637 [debug] [Thread-3 (]: On model.f1_analytics.int_pit_stop: COMMIT
[0m10:13:14.904631 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: COMMIT
[0m10:13:14.907155 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stint: COMMIT
[0m10:13:14.908149 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:13:14.908149 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:13:14.909150 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:13:14.910150 [debug] [Thread-3 (]: On model.f1_analytics.int_pit_stop: COMMIT
[0m10:13:14.910150 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: COMMIT
[0m10:13:14.911151 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stint: COMMIT
[0m10:13:14.912159 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:13:14.913152 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:13:14.913152 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m10:13:14.916154 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."int_pit_stop__dbt_backup"
[0m10:13:14.916154 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m10:13:14.918243 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_lap_position__dbt_backup"
[0m10:13:14.921252 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stint__dbt_backup"
[0m10:13:14.922157 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:13:14.922157 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:13:14.923190 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:13:14.924151 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:13:14.925156 [debug] [Thread-3 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */
drop view if exists "f1"."f1_data"."int_pit_stop__dbt_backup" cascade
[0m10:13:14.925156 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */

  create view "f1"."f1_data"."int_tyre_stint_laps__dbt_tmp"
    
    
  as (
    

with cte as (SELECT s.session_key,
                    s.driver_number,
                    s.stint_number,
                    s.compound,
                    s.lap_start,
                    s.lap_end,
                    s.lap_end - s.lap_start + 1 as stint_length,
                    -- Get the start time from the first lap of the stint
                    MIN(l.date_start)           as stint_start_time,
                    -- Get the end time from the last lap of the stint
                    MAX(l.date_start)           as stint_end_time
             FROM "f1"."f1_data"."stg_stints" s
                      LEFT JOIN "f1"."f1_data"."stg_laps" l
                                ON s.session_key = l.session_key
                                    AND s.driver_number = l.driver_number
                                    AND l.lap_number BETWEEN s.lap_start AND s.lap_end
             GROUP BY 1, 2, 3, 4, 5, 6
             )
select * from cte
         where stint_end_time is not null
           and
             stint_start_time is not null
  );
[0m10:13:14.926280 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */
drop view if exists "f1"."f1_data"."int_lap_position__dbt_backup" cascade
[0m10:13:14.927154 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */
drop view if exists "f1"."f1_data"."int_tyre_stint__dbt_backup" cascade
[0m10:13:14.928152 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:13:14.928152 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:13:14.931159 [debug] [Thread-3 (]: On model.f1_analytics.int_pit_stop: Close
[0m10:13:14.931159 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:13:14.933195 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: Close
[0m10:13:14.935163 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D45B9B490>]}
[0m10:13:14.938155 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stint: Close
[0m10:13:14.938155 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:13:14.940151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D45BC8D30>]}
[0m10:13:14.941155 [info ] [Thread-3 (]: 6 of 9 OK created sql view model f1_data.int_pit_stop .......................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:13:14.943155 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D45B1CB80>]}
[0m10:13:14.949243 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:13:14.951242 [info ] [Thread-1 (]: 5 of 9 OK created sql view model f1_data.int_lap_position ...................... [[32mCREATE VIEW[0m in 0.16s]
[0m10:13:14.952152 [debug] [Thread-3 (]: Finished running node model.f1_analytics.int_pit_stop
[0m10:13:14.953247 [info ] [Thread-2 (]: 7 of 9 OK created sql view model f1_data.int_tyre_stint ........................ [[32mCREATE VIEW[0m in 0.16s]
[0m10:13:14.954160 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */
alter table "f1"."f1_data"."int_tyre_stint_laps__dbt_tmp" rename to "int_tyre_stint_laps"
[0m10:13:14.955261 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_lap_position
[0m10:13:14.956157 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_tyre_stint
[0m10:13:14.959194 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:13:14.961151 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: COMMIT
[0m10:13:14.962189 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:13:14.962189 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: COMMIT
[0m10:13:14.965158 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m10:13:14.967164 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stint_laps__dbt_backup"
[0m10:13:14.968170 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:13:14.969167 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */
drop view if exists "f1"."f1_data"."int_tyre_stint_laps__dbt_backup" cascade
[0m10:13:14.969167 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:13:14.971163 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: Close
[0m10:13:14.972166 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D45663670>]}
[0m10:13:14.972166 [info ] [Thread-4 (]: 8 of 9 OK created sql view model f1_data.int_tyre_stint_laps ................... [[32mCREATE VIEW[0m in 0.12s]
[0m10:13:14.973167 [debug] [Thread-4 (]: Finished running node model.f1_analytics.int_tyre_stint_laps
[0m10:13:14.974151 [debug] [Thread-3 (]: Began running node model.f1_analytics.int_tyre_stints_weather
[0m10:13:14.975150 [info ] [Thread-3 (]: 9 of 9 START sql view model f1_data.int_tyre_stints_weather .................... [RUN]
[0m10:13:14.976156 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_pit_stop, now model.f1_analytics.int_tyre_stints_weather)
[0m10:13:14.977182 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.int_tyre_stints_weather
[0m10:13:14.981172 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stints_weather"
[0m10:13:14.982149 [debug] [Thread-3 (]: Began executing node model.f1_analytics.int_tyre_stints_weather
[0m10:13:14.985154 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stints_weather"
[0m10:13:14.986172 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:13:14.987150 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stints_weather: BEGIN
[0m10:13:14.987150 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:13:15.026708 [debug] [Thread-3 (]: SQL status: BEGIN in 0.039 seconds
[0m10:13:15.027671 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:13:15.028683 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */

  create view "f1"."f1_data"."int_tyre_stints_weather__dbt_tmp"
    
    
  as (
    

SELECT
        st.session_key,
        st.driver_number,
        st.stint_number,
        st.compound,
        st.lap_start,
        st.lap_end,
        st.stint_length,
        -- Average weather conditions during the stint
        AVG(w.air_temperature) as avg_air_temp,
        AVG(w.track_temperature) as avg_track_temp,
        AVG(w.humidity) as avg_humidity,
        MAX(w.rainfall) as had_rainfall,  -- If there was any rain during stint
        AVG(w.wind_speed) as avg_wind_speed,
        -- Categorize conditions
        CASE
            WHEN AVG(w.track_temperature) < 25 THEN 'Cold'
            WHEN AVG(w.track_temperature) < 35 THEN 'Medium'
            ELSE 'Hot'
        END as track_temp_category,
        CASE
            WHEN MAX(w.rainfall) > 0 THEN 'Wet'
            WHEN AVG(w.humidity) > 70 THEN 'High Humidity'
            ELSE 'Dry'
        END as weather_condition
    FROM "f1"."f1_data"."int_tyre_stint_laps" st
    LEFT JOIN "f1"."f1_data"."stg_weather" w
        ON st.session_key = w.session_key
        AND w.date BETWEEN st.stint_start_time AND st.stint_end_time
    GROUP BY 1,2,3,4,5,6,7
  );
[0m10:13:15.034668 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:13:15.037672 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:13:15.038673 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */
alter table "f1"."f1_data"."int_tyre_stints_weather__dbt_tmp" rename to "int_tyre_stints_weather"
[0m10:13:15.039672 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:13:15.040669 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stints_weather: COMMIT
[0m10:13:15.041766 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:13:15.041766 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stints_weather: COMMIT
[0m10:13:15.043667 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:13:15.045670 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stints_weather__dbt_backup"
[0m10:13:15.045670 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:13:15.047181 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */
drop view if exists "f1"."f1_data"."int_tyre_stints_weather__dbt_backup" cascade
[0m10:13:15.048191 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:13:15.049194 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stints_weather: Close
[0m10:13:15.050192 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5237e224-78cd-48ed-849b-df7a684e32ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D45C3FD60>]}
[0m10:13:15.050192 [info ] [Thread-3 (]: 9 of 9 OK created sql view model f1_data.int_tyre_stints_weather ............... [[32mCREATE VIEW[0m in 0.07s]
[0m10:13:15.052193 [debug] [Thread-3 (]: Finished running node model.f1_analytics.int_tyre_stints_weather
[0m10:13:15.055191 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:15.056193 [debug] [MainThread]: On master: BEGIN
[0m10:13:15.057192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:13:15.101206 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m10:13:15.101206 [debug] [MainThread]: On master: COMMIT
[0m10:13:15.102187 [debug] [MainThread]: Using postgres connection "master"
[0m10:13:15.103201 [debug] [MainThread]: On master: COMMIT
[0m10:13:15.104191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:13:15.104191 [debug] [MainThread]: On master: Close
[0m10:13:15.105194 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:13:15.106197 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m10:13:15.107196 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m10:13:15.108200 [debug] [MainThread]: Connection 'model.f1_analytics.int_lap_position' was properly closed.
[0m10:13:15.108200 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint' was properly closed.
[0m10:13:15.109196 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stints_weather' was properly closed.
[0m10:13:15.110194 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint_laps' was properly closed.
[0m10:13:15.110194 [info ] [MainThread]: 
[0m10:13:15.111198 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m10:13:15.112194 [debug] [MainThread]: Command end result
[0m10:13:15.136758 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:13:15.138781 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:13:15.147326 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m10:13:15.147326 [info ] [MainThread]: 
[0m10:13:15.149331 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:13:15.150333 [info ] [MainThread]: 
[0m10:13:15.152328 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m10:13:15.153370 [debug] [MainThread]: Command `dbt run` succeeded at 10:13:15.153370 after 1.57 seconds
[0m10:13:15.154325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D42BFE2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D43FDCC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011D455D96C0>]}
[0m10:13:15.155324 [debug] [MainThread]: Flushing usage events
[0m10:13:15.557521 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:18:48.509442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A677CE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A68AC0FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A68AC0DC0>]}


============================== 10:18:48.512977 | ed0f224e-55a6-494f-8745-fdb75d939240 ==============================
[0m10:18:48.512977 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:18:48.513954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select marts', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:18:48.662955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A68B9DED0>]}
[0m10:18:48.710003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A68202440>]}
[0m10:18:48.712002 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:18:48.840417 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:18:48.968644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m10:18:48.969647 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_session_mapping.sql
[0m10:18:48.970646 [debug] [MainThread]: Partial parsing: updated file: f1_analytics://f1_analytics/models\marts\final_session_filters.sql
[0m10:18:49.226217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A2A8130>]}
[0m10:18:49.303216 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:18:49.305219 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:18:49.328136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A28E380>]}
[0m10:18:49.329134 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m10:18:49.329134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A691203D0>]}
[0m10:18:49.331132 [info ] [MainThread]: 
[0m10:18:49.332116 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:18:49.332116 [info ] [MainThread]: 
[0m10:18:49.332116 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:18:49.336787 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m10:18:49.381468 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m10:18:49.381468 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m10:18:49.382450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:49.421446 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.039 seconds
[0m10:18:49.422445 [debug] [ThreadPool]: On list_f1: Close
[0m10:18:49.427435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m10:18:49.432057 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:18:49.432984 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m10:18:49.432984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:18:49.478966 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m10:18:49.478966 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:18:49.479913 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m10:18:49.486958 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.006 seconds
[0m10:18:49.487931 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m10:18:49.489489 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m10:18:49.497507 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:49.497507 [debug] [MainThread]: On master: BEGIN
[0m10:18:49.498550 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:18:49.536710 [debug] [MainThread]: SQL status: BEGIN in 0.038 seconds
[0m10:18:49.537715 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:49.537715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:18:49.547785 [debug] [MainThread]: SQL status: SELECT 25 in 0.010 seconds
[0m10:18:49.551717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A2E9960>]}
[0m10:18:49.552716 [debug] [MainThread]: On master: ROLLBACK
[0m10:18:49.553728 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:49.554713 [debug] [MainThread]: On master: BEGIN
[0m10:18:49.555723 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m10:18:49.555723 [debug] [MainThread]: On master: COMMIT
[0m10:18:49.556719 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:49.556719 [debug] [MainThread]: On master: COMMIT
[0m10:18:49.557726 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:18:49.558753 [debug] [MainThread]: On master: Close
[0m10:18:49.565717 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_car
[0m10:18:49.566699 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_historical_analysis
[0m10:18:49.566699 [debug] [Thread-3 (]: Began running node model.f1_analytics.final_session_driver_mapping
[0m10:18:49.567709 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_session_filters
[0m10:18:49.567709 [info ] [Thread-1 (]: 1 of 8 START sql view model f1_data.final_car .................................. [RUN]
[0m10:18:49.568707 [info ] [Thread-2 (]: 2 of 8 START sql view model f1_data.final_historical_analysis .................. [RUN]
[0m10:18:49.569709 [info ] [Thread-3 (]: 3 of 8 START sql view model f1_data.final_session_driver_mapping ............... [RUN]
[0m10:18:49.570699 [info ] [Thread-4 (]: 4 of 8 START sql view model f1_data.final_session_filters ...................... [RUN]
[0m10:18:49.571708 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_car'
[0m10:18:49.572709 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.final_historical_analysis'
[0m10:18:49.573711 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_driver_mapping'
[0m10:18:49.575713 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_filters'
[0m10:18:49.577736 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_car
[0m10:18:49.579760 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m10:18:49.580766 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.final_session_driver_mapping
[0m10:18:49.581739 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_session_filters
[0m10:18:49.592792 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_car"
[0m10:18:49.596709 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m10:18:49.599707 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.final_session_driver_mapping"
[0m10:18:49.602755 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_session_filters"
[0m10:18:49.605719 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_car
[0m10:18:49.608711 [debug] [Thread-3 (]: Began executing node model.f1_analytics.final_session_driver_mapping
[0m10:18:49.621764 [debug] [Thread-2 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m10:18:49.638026 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_car"
[0m10:18:49.643021 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.final_session_driver_mapping"
[0m10:18:49.643021 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_session_filters
[0m10:18:49.647007 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m10:18:49.651033 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_session_filters"
[0m10:18:49.652041 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:18:49.653008 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:18:49.653998 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:18:49.654996 [debug] [Thread-1 (]: On model.f1_analytics.final_car: BEGIN
[0m10:18:49.655944 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:18:49.655944 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: BEGIN
[0m10:18:49.656959 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: BEGIN
[0m10:18:49.656959 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:18:49.657965 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: BEGIN
[0m10:18:49.657965 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:18:49.658971 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:18:49.658971 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:18:49.701724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m10:18:49.702753 [debug] [Thread-3 (]: SQL status: BEGIN in 0.044 seconds
[0m10:18:49.703727 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:18:49.703727 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:18:49.704727 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */

  create view "f1"."f1_data"."final_car__dbt_tmp"
    
    
  as (
    

SELECT
   t.date,
   CONCAT(t.name_acronym, ' (', t.team_name, ')') as driver,
   t.driver_number,
   ROUND(t.speed) as speed,
   ROUND(t.throttle) as throttle,
   ROUND(t.brake) as brake,
   t.rpm,
   t.session_key,  -- Add session_key
   m.meeting_key   -- Add meeting_key
FROM "f1"."f1_data"."int_car_base" t
LEFT JOIN "f1"."f1_data"."stg_sessions" s ON t.session_key = s.session_key
LEFT JOIN "f1"."f1_data"."stg_meeting" m ON s.meeting_key = m.meeting_key
  );
[0m10:18:49.704727 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m10:18:49.704727 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */

  create view "f1"."f1_data"."final_session_driver_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    d.session_key,
    concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name,
    d.driver_number
FROM "f1"."f1_data"."stg_drivers" d
JOIN "f1"."f1_data"."stg_sessions" s ON d.session_key = s.session_key
  );
[0m10:18:49.706139 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m10:18:49.707160 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:18:49.707160 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:18:49.708462 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */

  create view "f1"."f1_data"."final_historical_analysis__dbt_tmp"
    
    
  as (
    

WITH first_position_record AS (
    SELECT *
    FROM (
        SELECT
            session_key,
            driver_number,
            position AS first_position,
            date,
            ROW_NUMBER() OVER (
                PARTITION BY session_key, driver_number
                ORDER BY date
            ) AS rn
        FROM stg_position
    ) t
    WHERE rn = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        ROUND(MIN(i.gap_to_next)::numeric,3) AS min_gap_to_next,
        ROUND(MAX(i.gap_to_next)::numeric,3) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM "f1"."f1_data"."stg_laps" l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN "f1"."f1_data"."stg_intervals" i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND date_trunc('second', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN "f1"."f1_data"."int_lap_position" sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN "f1"."f1_data"."int_lap_position" ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY
        l.lap_number, l.session_key, l.driver_number, l.date_start,
        l.date_end, l.is_pit_out_lap,
        l.duration_sector_1, l.duration_sector_2, l.duration_sector_3,
        fpr.first_position, sp.position, ep.position
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                MAX(start_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                MAX(end_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
    lap_number,
    session_key,
    driver_number,
    date_start AS lap_start_time,
    date_end AS lap_end_time,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3,
    min_gap_to_leader,
    max_gap_to_leader,
    min_gap_to_next,
    max_gap_to_next,
    lap_start_position,
    lap_end_position,
    first_position AS race_start_position
FROM filled_positions
  );
[0m10:18:49.708462 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */

  create view "f1"."f1_data"."final_session_filters__dbt_tmp"
    
    
  as (
    WITH session_drivers AS (
   SELECT DISTINCT
       s.session_key,
       s.country_name,
       s.session_name,
       s.session_type,
       s.year,
       d.driver_number,
       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name
   FROM "f1"."f1_data"."stg_sessions" s
   JOIN "f1"."f1_data"."stg_drivers" d ON s.session_key = d.session_key
)
SELECT
   s.session_key,
    s.year,
   s.country_name,
   s.circuit_short_name,
   s.session_name,
   s.session_type,
   concat(s.year, ' - ', s.country_name, ' - ', s.session_name) as session_display_name,
   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,
   m.meeting_name,
   m.meeting_official_name,
   s.date_start
FROM "f1"."f1_data"."stg_sessions" s
JOIN session_drivers sd ON s.session_key = sd.session_key
JOIN "f1"."f1_data"."stg_meeting" m ON s.year = m.year
   AND s.country_name = m.country_name
GROUP BY 1,2,3,4,5,6,7,9,10,11
  );
[0m10:18:49.713608 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:18:49.713608 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:18:49.719637 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:18:49.719637 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:18:49.720634 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m10:18:49.723637 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:18:49.723637 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
alter table "f1"."f1_data"."final_car__dbt_tmp" rename to "final_car"
[0m10:18:49.726632 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:18:49.729636 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:18:49.730151 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
alter table "f1"."f1_data"."final_session_driver_mapping__dbt_tmp" rename to "final_session_driver_mapping"
[0m10:18:49.731167 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
alter table "f1"."f1_data"."final_session_filters__dbt_tmp" rename to "final_session_filters"
[0m10:18:49.731167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:18:49.732178 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
alter table "f1"."f1_data"."final_historical_analysis__dbt_tmp" rename to "final_historical_analysis"
[0m10:18:49.743872 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m10:18:49.744875 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:18:49.744875 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m10:18:49.745862 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:18:49.746905 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:18:49.748814 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m10:18:49.749816 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m10:18:49.750813 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m10:18:49.751821 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m10:18:49.752812 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:18:49.753806 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:18:49.753806 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:18:49.754818 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m10:18:49.755808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:18:49.755808 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m10:18:49.756807 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m10:18:49.762811 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_car__dbt_backup"
[0m10:18:49.763829 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m10:18:49.769096 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:18:49.769096 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m10:18:49.772097 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."final_session_driver_mapping__dbt_backup"
[0m10:18:49.773100 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m10:18:49.773100 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
drop view if exists "f1"."f1_data"."final_car__dbt_backup" cascade
[0m10:18:49.776469 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."final_session_filters__dbt_backup"
[0m10:18:49.777493 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:18:49.781411 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."final_historical_analysis__dbt_backup"
[0m10:18:49.783934 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:18:49.783934 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:18:49.785004 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
drop view if exists "f1"."f1_data"."final_session_driver_mapping__dbt_backup" cascade
[0m10:18:49.785954 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:18:49.786958 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
drop view if exists "f1"."f1_data"."final_session_filters__dbt_backup" cascade
[0m10:18:49.790012 [debug] [Thread-1 (]: On model.f1_analytics.final_car: Close
[0m10:18:49.790959 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
drop view if exists "f1"."f1_data"."final_historical_analysis__dbt_backup" cascade
[0m10:18:49.791966 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:18:49.794959 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:18:49.796948 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: Close
[0m10:18:49.796948 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:18:49.797958 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A65E2C0>]}
[0m10:18:49.799474 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: Close
[0m10:18:49.800487 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A83EE00>]}
[0m10:18:49.801500 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: Close
[0m10:18:49.802498 [info ] [Thread-1 (]: 1 of 8 OK created sql view model f1_data.final_car ............................. [[32mCREATE VIEW[0m in 0.22s]
[0m10:18:49.804490 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A8F3DF0>]}
[0m10:18:49.805502 [info ] [Thread-3 (]: 3 of 8 OK created sql view model f1_data.final_session_driver_mapping .......... [[32mCREATE VIEW[0m in 0.23s]
[0m10:18:49.806909 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6562FAF0>]}
[0m10:18:49.807921 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_car
[0m10:18:49.807921 [info ] [Thread-4 (]: 4 of 8 OK created sql view model f1_data.final_session_filters ................. [[32mCREATE VIEW[0m in 0.23s]
[0m10:18:49.810404 [debug] [Thread-3 (]: Finished running node model.f1_analytics.final_session_driver_mapping
[0m10:18:49.811419 [info ] [Thread-2 (]: 2 of 8 OK created sql view model f1_data.final_historical_analysis ............. [[32mCREATE VIEW[0m in 0.23s]
[0m10:18:49.811419 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_mapping
[0m10:18:49.813808 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_session_filters
[0m10:18:49.814806 [debug] [Thread-3 (]: Began running node model.f1_analytics.final_tyre_performance
[0m10:18:49.815837 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m10:18:49.816803 [info ] [Thread-1 (]: 5 of 8 START sql view model f1_data.final_session_mapping ...................... [RUN]
[0m10:18:49.817463 [info ] [Thread-3 (]: 6 of 8 START sql view model f1_data.final_tyre_performance ..................... [RUN]
[0m10:18:49.818535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_car, now model.f1_analytics.final_session_mapping)
[0m10:18:49.819545 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_driver_mapping, now model.f1_analytics.final_tyre_performance)
[0m10:18:49.819545 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_mapping
[0m10:18:49.820469 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.final_tyre_performance
[0m10:18:49.823482 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_mapping"
[0m10:18:49.826468 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.final_tyre_performance"
[0m10:18:49.828476 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_mapping
[0m10:18:49.834469 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_mapping"
[0m10:18:49.834469 [debug] [Thread-3 (]: Began executing node model.f1_analytics.final_tyre_performance
[0m10:18:49.838750 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.final_tyre_performance"
[0m10:18:49.839634 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:18:49.839634 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:18:49.840672 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: BEGIN
[0m10:18:49.840672 [debug] [Thread-3 (]: On model.f1_analytics.final_tyre_performance: BEGIN
[0m10:18:49.841634 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:49.842651 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:18:49.890013 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m10:18:49.891010 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:18:49.892019 [debug] [Thread-3 (]: SQL status: BEGIN in 0.050 seconds
[0m10:18:49.893002 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */

  create view "f1"."f1_data"."final_session_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    EXTRACT(YEAR FROM date_start)::text || ' - ' || country_name || ' - ' || session_name AS session_display_name,
    session_key
FROM "f1"."f1_data"."stg_sessions"
  );
[0m10:18:49.893002 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:18:49.894004 [debug] [Thread-3 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */

  create view "f1"."f1_data"."final_tyre_performance__dbt_tmp"
    
    
  as (
    

WITH tire_performance AS (
    SELECT
        circuit_short_name,
        compound,
        team_name,
        driver_number,
        AVG(stint_length) as avg_stint_length,
        MAX(stint_length) as max_stint_length,
        AVG(tyre_age_at_start) as avg_starting_age,
        COUNT(*) as number_of_stints
    FROM "f1"."f1_data"."int_tyre_stint"
    GROUP BY 1,2,3,4
)

SELECT
    circuit_short_name,
    compound,
    round(AVG(avg_stint_length),2) as circuit_compound_avg_stint_length,
    MAX(max_stint_length) as circuit_compound_max_stint_length,
    round(AVG(avg_starting_age),2) as avg_tire_age_start,
    SUM(number_of_stints) as total_stints
FROM tire_performance
GROUP BY 1,2
  );
[0m10:18:49.900131 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:18:49.903342 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:18:49.904331 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:18:49.905340 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
alter table "f1"."f1_data"."final_session_mapping__dbt_tmp" rename to "final_session_mapping"
[0m10:18:49.907328 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:18:49.908332 [debug] [Thread-3 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
alter table "f1"."f1_data"."final_tyre_performance__dbt_tmp" rename to "final_tyre_performance"
[0m10:18:49.909344 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:18:49.910335 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m10:18:49.911326 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:18:49.911326 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:18:49.912853 [debug] [Thread-3 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m10:18:49.913880 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m10:18:49.914885 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:18:49.915875 [debug] [Thread-3 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m10:18:49.915875 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:18:49.919892 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_session_mapping__dbt_backup"
[0m10:18:49.919892 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m10:18:49.920897 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:18:49.922901 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."final_tyre_performance__dbt_backup"
[0m10:18:49.923886 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
drop view if exists "f1"."f1_data"."final_session_mapping__dbt_backup" cascade
[0m10:18:49.925254 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:18:49.926279 [debug] [Thread-3 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
drop view if exists "f1"."f1_data"."final_tyre_performance__dbt_backup" cascade
[0m10:18:49.926279 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:18:49.928299 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: Close
[0m10:18:49.929288 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:18:49.929288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A8F3DF0>]}
[0m10:18:49.932278 [debug] [Thread-3 (]: On model.f1_analytics.final_tyre_performance: Close
[0m10:18:49.934548 [info ] [Thread-1 (]: 5 of 8 OK created sql view model f1_data.final_session_mapping ................. [[32mCREATE VIEW[0m in 0.11s]
[0m10:18:49.934548 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A65EB90>]}
[0m10:18:49.936009 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_mapping
[0m10:18:49.937020 [info ] [Thread-3 (]: 6 of 8 OK created sql view model f1_data.final_tyre_performance ................ [[32mCREATE VIEW[0m in 0.12s]
[0m10:18:49.938023 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m10:18:49.939027 [debug] [Thread-3 (]: Finished running node model.f1_analytics.final_tyre_performance
[0m10:18:49.939963 [info ] [Thread-4 (]: 7 of 8 START sql view model f1_data.final_race_leaderboard ..................... [RUN]
[0m10:18:49.940586 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_filters, now model.f1_analytics.final_race_leaderboard)
[0m10:18:49.941643 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_race_leaderboard
[0m10:18:49.943750 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_race_leaderboard"
[0m10:18:49.945718 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_race_leaderboard
[0m10:18:49.950651 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_race_leaderboard"
[0m10:18:49.951650 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:18:49.952655 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: BEGIN
[0m10:18:49.953653 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:18:49.992304 [debug] [Thread-4 (]: SQL status: BEGIN in 0.039 seconds
[0m10:18:49.993279 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:18:49.993279 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */

  create view "f1"."f1_data"."final_race_leaderboard__dbt_tmp"
    
    
  as (
    

WITH final_rankings AS (
   SELECT
       session_key,
       driver_number,
       position
   FROM int_final_position
)
SELECT
   fr.session_key,
   d.driver_number,
   d.broadcast_name AS driver_name,
   fr.position,
   d.team_name,
   d.team_colour AS team_color,
   CASE
       WHEN fr.position = 1 THEN 0
       ELSE fi.max_gap_to_leader
   END as gap_to_leader,
   fi.max_gap_to_next as gap_to_next,
   bl.fastest_lap,
   ps.pit_stop_count,

   CASE
       WHEN fr.position = 1 THEN 25
       WHEN fr.position = 2 THEN 18
       WHEN fr.position = 3 THEN 15
       WHEN fr.position = 4 THEN 12
       WHEN fr.position = 5 THEN 10
       WHEN fr.position = 6 THEN 8
       WHEN fr.position = 7 THEN 6
       WHEN fr.position = 8 THEN 4
       WHEN fr.position = 9 THEN 2
       WHEN fr.position = 10 THEN 1
       ELSE 0
   END AS points
FROM final_rankings fr
JOIN "f1"."f1_data"."stg_drivers" d
   ON fr.driver_number = d.driver_number
   AND fr.session_key = d.session_key
LEFT JOIN "f1"."f1_data"."int_final_intervals" fi
   ON fr.session_key = fi.session_key
   AND fr.driver_number = fi.driver_number
LEFT JOIN "f1"."f1_data"."int_best_laps" bl
   ON fr.session_key = bl.session_key
   AND fr.driver_number = bl.driver_number
LEFT JOIN "f1"."f1_data"."int_pit_stop" ps
   ON fr.session_key = ps.session_key
   AND fr.driver_number = ps.driver_number
JOIN "f1"."f1_data"."final_session_mapping" m
   ON fr.session_key = m.session_key
ORDER BY fr.position
  );
[0m10:18:50.000312 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:18:50.003132 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:18:50.004226 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
alter table "f1"."f1_data"."final_race_leaderboard__dbt_tmp" rename to "final_race_leaderboard"
[0m10:18:50.004226 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:18:50.006868 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m10:18:50.006868 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:18:50.007868 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m10:18:50.009309 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:18:50.013861 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."final_race_leaderboard__dbt_backup"
[0m10:18:50.014947 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:18:50.015859 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
drop view if exists "f1"."f1_data"."final_race_leaderboard__dbt_backup" cascade
[0m10:18:50.015859 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:18:50.017389 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: Close
[0m10:18:50.018426 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A89A5F0>]}
[0m10:18:50.018426 [info ] [Thread-4 (]: 7 of 8 OK created sql view model f1_data.final_race_leaderboard ................ [[32mCREATE VIEW[0m in 0.08s]
[0m10:18:50.019618 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m10:18:50.021695 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_summary
[0m10:18:50.021695 [info ] [Thread-1 (]: 8 of 8 START sql view model f1_data.final_race_summary ......................... [RUN]
[0m10:18:50.022761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_mapping, now model.f1_analytics.final_race_summary)
[0m10:18:50.023696 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_summary
[0m10:18:50.026657 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_summary"
[0m10:18:50.027632 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_summary
[0m10:18:50.032648 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_summary"
[0m10:18:50.033627 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:18:50.033627 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: BEGIN
[0m10:18:50.034638 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:18:50.073905 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m10:18:50.075002 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:18:50.075002 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */

  create view "f1"."f1_data"."final_race_summary__dbt_tmp"
    
    
  as (
    

WITH positions AS (
   SELECT
       session_key,
       COUNT(DISTINCT driver_number) as total_drivers

   FROM "f1"."f1_data"."stg_position"
   GROUP BY session_key
),
laps AS (
   SELECT
       session_key,
       MAX(lap_number) as total_laps
   FROM "f1"."f1_data"."stg_laps"
   GROUP BY session_key
),
team_stats AS (
   SELECT
       session_key,
       SUM(pit_stop_count) as total_pit_stops,
        COUNT(DISTINCT team_name) as total_teams
   FROM "f1"."f1_data"."final_race_leaderboard"
   GROUP BY session_key
),
driver_stats AS (
   SELECT
       session_key,
       driver_number,
       MAX(speed) as top_speed,
       AVG(speed) as avg_speed
   FROM "f1"."f1_data"."stg_car_data"
   GROUP BY session_key, driver_number
),
cte as(
SELECT
   p.session_key,
   m.session_display_name,
   p.total_drivers,
   l.total_laps,
   MAX(d.top_speed) as fastest_speed,
   round(AVG(d.avg_speed),3) as average_speed
FROM positions p
JOIN laps l ON p.session_key = l.session_key
JOIN "f1"."f1_data"."final_session_mapping" m ON p.session_key = m.session_key
LEFT JOIN driver_stats d ON p.session_key = d.session_key
GROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps
)
select c.session_key,
   c.session_display_name,
   c.total_drivers,
    t.total_teams,
   c.total_laps,
   t.total_pit_stops,
    c.fastest_speed,
   c.average_speed
from cte c left join team_stats t on c.session_key=t.session_key
  );
[0m10:18:50.082903 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:18:50.086004 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:18:50.086004 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
alter table "f1"."f1_data"."final_race_summary__dbt_tmp" rename to "final_race_summary"
[0m10:18:50.086942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:18:50.089008 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m10:18:50.089008 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:18:50.089904 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m10:18:50.091902 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:18:50.094916 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_race_summary__dbt_backup"
[0m10:18:50.095902 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:18:50.095902 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
drop view if exists "f1"."f1_data"."final_race_summary__dbt_backup" cascade
[0m10:18:50.096902 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:18:50.097902 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: Close
[0m10:18:50.098917 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed0f224e-55a6-494f-8745-fdb75d939240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A6A90B820>]}
[0m10:18:50.099905 [info ] [Thread-1 (]: 8 of 8 OK created sql view model f1_data.final_race_summary .................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:18:50.100909 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_summary
[0m10:18:50.102908 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:50.102908 [debug] [MainThread]: On master: BEGIN
[0m10:18:50.103905 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:18:50.140907 [debug] [MainThread]: SQL status: BEGIN in 0.036 seconds
[0m10:18:50.140907 [debug] [MainThread]: On master: COMMIT
[0m10:18:50.141906 [debug] [MainThread]: Using postgres connection "master"
[0m10:18:50.141906 [debug] [MainThread]: On master: COMMIT
[0m10:18:50.142902 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:18:50.142902 [debug] [MainThread]: On master: Close
[0m10:18:50.143905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:18:50.143905 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m10:18:50.144910 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m10:18:50.144910 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_summary' was properly closed.
[0m10:18:50.144910 [debug] [MainThread]: Connection 'model.f1_analytics.final_historical_analysis' was properly closed.
[0m10:18:50.145906 [debug] [MainThread]: Connection 'model.f1_analytics.final_tyre_performance' was properly closed.
[0m10:18:50.146911 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_leaderboard' was properly closed.
[0m10:18:50.147904 [info ] [MainThread]: 
[0m10:18:50.148909 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m10:18:50.149945 [debug] [MainThread]: Command end result
[0m10:18:50.225282 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:18:50.227386 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:18:50.233280 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m10:18:50.233280 [info ] [MainThread]: 
[0m10:18:50.234286 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:18:50.235297 [info ] [MainThread]: 
[0m10:18:50.235297 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m10:18:50.236307 [debug] [MainThread]: Command `dbt run` succeeded at 10:18:50.236307 after 1.80 seconds
[0m10:18:50.237305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A677CE3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A68A1B670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028A682321D0>]}
[0m10:18:50.237305 [debug] [MainThread]: Flushing usage events
[0m10:18:50.633106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:34.955424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E3B2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74F6B0F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74F6B0D30>]}


============================== 10:33:34.959422 | e99395dd-8bdf-47ad-b7d0-e6881cbcd46f ==============================
[0m10:33:34.959422 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:33:34.961433 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m10:33:35.110373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74F84AAD0>]}
[0m10:33:35.156885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74F423DC0>]}
[0m10:33:35.158890 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:33:35.286417 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:33:35.441535 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:35.442539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:35.484542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B750D88EB0>]}
[0m10:33:35.603615 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:33:35.605618 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:33:35.626366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B750DB22C0>]}
[0m10:33:35.627313 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m10:33:35.628263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B750DBF700>]}
[0m10:33:35.630362 [info ] [MainThread]: 
[0m10:33:35.631263 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:33:35.631263 [info ] [MainThread]: 
[0m10:33:35.632266 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:35.636282 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m10:33:35.683895 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m10:33:35.684898 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m10:33:35.684898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:35.718905 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.034 seconds
[0m10:33:35.720903 [debug] [ThreadPool]: On list_f1: Close
[0m10:33:35.723793 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m10:33:35.728791 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:33:35.729791 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m10:33:35.729791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:35.766473 [debug] [ThreadPool]: SQL status: BEGIN in 0.036 seconds
[0m10:33:35.766473 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:33:35.767399 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m10:33:35.773390 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.005 seconds
[0m10:33:35.774385 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m10:33:35.775383 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m10:33:35.784923 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:35.784923 [debug] [MainThread]: On master: BEGIN
[0m10:33:35.785920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:35.818909 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m10:33:35.818909 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:35.819913 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:35.827464 [debug] [MainThread]: SQL status: SELECT 50 in 0.007 seconds
[0m10:33:35.834462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B750C977F0>]}
[0m10:33:35.835447 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:35.836463 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:35.836463 [debug] [MainThread]: On master: BEGIN
[0m10:33:35.837454 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:33:35.837454 [debug] [MainThread]: On master: COMMIT
[0m10:33:35.838466 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:35.838466 [debug] [MainThread]: On master: COMMIT
[0m10:33:35.839464 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:35.839464 [debug] [MainThread]: On master: Close
[0m10:33:35.845996 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_car_data
[0m10:33:35.846976 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_drivers
[0m10:33:35.846976 [debug] [Thread-3 (]: Began running node model.f1_analytics.stg_intervals
[0m10:33:35.847992 [debug] [Thread-4 (]: Began running node model.f1_analytics.stg_laps
[0m10:33:35.848983 [info ] [Thread-1 (]: 1 of 10 START sql view model f1_data.stg_car_data .............................. [RUN]
[0m10:33:35.850994 [info ] [Thread-2 (]: 2 of 10 START sql view model f1_data.stg_drivers ............................... [RUN]
[0m10:33:35.850994 [info ] [Thread-3 (]: 3 of 10 START sql view model f1_data.stg_intervals ............................. [RUN]
[0m10:33:35.852975 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_car_data'
[0m10:33:35.851975 [info ] [Thread-4 (]: 4 of 10 START sql view model f1_data.stg_laps .................................. [RUN]
[0m10:33:35.853977 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.stg_drivers'
[0m10:33:35.853977 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.stg_intervals'
[0m10:33:35.854992 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_car_data
[0m10:33:35.854992 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.stg_laps'
[0m10:33:35.855977 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_drivers
[0m10:33:35.855977 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.stg_intervals
[0m10:33:35.861977 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_car_data"
[0m10:33:35.862978 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.stg_laps
[0m10:33:35.868084 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_drivers"
[0m10:33:35.871977 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m10:33:35.875022 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.stg_laps"
[0m10:33:35.875977 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_car_data
[0m10:33:35.877090 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_drivers
[0m10:33:35.878094 [debug] [Thread-3 (]: Began executing node model.f1_analytics.stg_intervals
[0m10:33:35.907977 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_car_data"
[0m10:33:35.911136 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_drivers"
[0m10:33:35.912134 [debug] [Thread-4 (]: Began executing node model.f1_analytics.stg_laps
[0m10:33:35.916078 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m10:33:35.917033 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:33:35.918035 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:33:35.921138 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.stg_laps"
[0m10:33:35.922362 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: BEGIN
[0m10:33:35.923370 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: BEGIN
[0m10:33:35.923876 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:33:35.923876 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:33:35.924886 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:33:35.925987 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:33:35.925987 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: BEGIN
[0m10:33:35.927496 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: BEGIN
[0m10:33:35.928453 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:33:35.928453 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:33:35.981629 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m10:33:35.981629 [debug] [Thread-2 (]: SQL status: BEGIN in 0.056 seconds
[0m10:33:35.982628 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:33:35.982628 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:33:35.983628 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */

  create view "f1"."f1_data"."stg_car_data__dbt_tmp"
    
    
  as (
    

SELECT
    session_key,
    driver_number,
    date,
    rpm,
    speed,
    throttle,
    brake
FROM "f1"."f1_data"."car_data"
  );
[0m10:33:35.983628 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */

  create view "f1"."f1_data"."stg_drivers__dbt_tmp"
    
    
  as (
    

SELECT
  CAST(driver_number AS INT)           AS driver_number,
  BROADCAST_NAME                       as broadcast_name,
  first_name,
  last_name,
  FULL_NAME                            AS full_name,
  name_acronym,
  team_name,
  team_colour,
  country_code,
  session_key
from "f1"."f1_data"."drivers"
  );
[0m10:33:35.987633 [debug] [Thread-4 (]: SQL status: BEGIN in 0.059 seconds
[0m10:33:35.988636 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:33:35.988636 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */

  create view "f1"."f1_data"."stg_laps__dbt_tmp"
    
    
  as (
    

select
    session_key,
    driver_number,
    date_trunc('second', date_start) as date_start,
    date_start + interval '1 second' * lap_duration as date_end,
    lap_duration,
    lap_number,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3
from "f1"."f1_data"."laps"
where lap_duration is not null
  );
[0m10:33:35.989635 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:33:35.989635 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:33:35.995643 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:33:35.996644 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:35.999644 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:33:35.999644 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
alter table "f1"."f1_data"."stg_car_data" rename to "stg_car_data__dbt_backup"
[0m10:33:36.003644 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:33:36.004628 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
alter table "f1"."f1_data"."stg_drivers" rename to "stg_drivers__dbt_backup"
[0m10:33:36.005629 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
alter table "f1"."f1_data"."stg_laps" rename to "stg_laps__dbt_backup"
[0m10:33:36.005629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:36.006635 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:33:36.010645 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:33:36.010645 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:33:36.013635 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:33:36.014647 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
alter table "f1"."f1_data"."stg_car_data__dbt_tmp" rename to "stg_car_data"
[0m10:33:36.018644 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:33:36.018644 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
alter table "f1"."f1_data"."stg_drivers__dbt_tmp" rename to "stg_drivers"
[0m10:33:36.020638 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
alter table "f1"."f1_data"."stg_laps__dbt_tmp" rename to "stg_laps"
[0m10:33:36.021629 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:33:36.021629 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:33:36.023645 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:36.034733 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: COMMIT
[0m10:33:36.036728 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m10:33:36.038735 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: COMMIT
[0m10:33:36.039762 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:33:36.039762 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:33:36.040641 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:33:36.041672 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: COMMIT
[0m10:33:36.042760 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m10:33:36.042760 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: COMMIT
[0m10:33:36.044729 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:36.050732 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_car_data__dbt_backup"
[0m10:33:36.050732 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m10:33:36.051633 [debug] [Thread-4 (]: SQL status: COMMIT in 0.008 seconds
[0m10:33:36.056681 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m10:33:36.059632 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_drivers__dbt_backup"
[0m10:33:36.063736 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."stg_laps__dbt_backup"
[0m10:33:36.064733 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
drop view if exists "f1"."f1_data"."stg_car_data__dbt_backup" cascade
[0m10:33:36.065644 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m10:33:36.067680 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m10:33:36.068645 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
drop view if exists "f1"."f1_data"."stg_drivers__dbt_backup" cascade
[0m10:33:36.069682 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
drop view if exists "f1"."f1_data"."stg_laps__dbt_backup" cascade
[0m10:33:36.073634 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.006 seconds
[0m10:33:36.077632 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: Close
[0m10:33:36.077632 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m10:33:36.082680 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: Close
[0m10:33:36.083637 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.013 seconds
[0m10:33:36.085633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74F767C40>]}
[0m10:33:36.086632 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: Close
[0m10:33:36.087630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74F949A80>]}
[0m10:33:36.087630 [debug] [Thread-3 (]: SQL status: BEGIN in 0.160 seconds
[0m10:33:36.088629 [info ] [Thread-1 (]: 1 of 10 OK created sql view model f1_data.stg_car_data ......................... [[32mCREATE VIEW[0m in 0.23s]
[0m10:33:36.089630 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B750DB1B70>]}
[0m10:33:36.090631 [info ] [Thread-2 (]: 2 of 10 OK created sql view model f1_data.stg_drivers .......................... [[32mCREATE VIEW[0m in 0.23s]
[0m10:33:36.091631 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:33:36.092659 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_car_data
[0m10:33:36.092659 [info ] [Thread-4 (]: 4 of 10 OK created sql view model f1_data.stg_laps ............................. [[32mCREATE VIEW[0m in 0.23s]
[0m10:33:36.093633 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_drivers
[0m10:33:36.094629 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */

  create view "f1"."f1_data"."stg_intervals__dbt_tmp"
    
    
  as (
    


   SELECT
    session_key,
    driver_number,
    date,
    CASE
        WHEN gap_to_leader = 'None' OR gap_to_leader LIKE '%L%' THEN NULL
        ELSE gap_to_leader
    END AS gap_to_leader,
    CASE
        WHEN interval = 'None' OR interval LIKE '%L%' THEN NULL
        ELSE interval
    END AS gap_to_next
FROM "f1"."f1_data"."intervals"
  );
[0m10:33:36.094629 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_meeting
[0m10:33:36.095656 [debug] [Thread-4 (]: Finished running node model.f1_analytics.stg_laps
[0m10:33:36.096630 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_pit
[0m10:33:36.096630 [info ] [Thread-1 (]: 5 of 10 START sql view model f1_data.stg_meeting ............................... [RUN]
[0m10:33:36.097633 [debug] [Thread-4 (]: Began running node model.f1_analytics.stg_position
[0m10:33:36.099630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_car_data, now model.f1_analytics.stg_meeting)
[0m10:33:36.098630 [info ] [Thread-2 (]: 6 of 10 START sql view model f1_data.stg_pit ................................... [RUN]
[0m10:33:36.100632 [info ] [Thread-4 (]: 7 of 10 START sql view model f1_data.stg_position .............................. [RUN]
[0m10:33:36.101636 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_meeting
[0m10:33:36.102635 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_drivers, now model.f1_analytics.stg_pit)
[0m10:33:36.103634 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:33:36.104655 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_laps, now model.f1_analytics.stg_position)
[0m10:33:36.107645 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_meeting"
[0m10:33:36.107645 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_pit
[0m10:33:36.111645 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:33:36.112629 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.stg_position
[0m10:33:36.115631 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_pit"
[0m10:33:36.115631 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
alter table "f1"."f1_data"."stg_intervals" rename to "stg_intervals__dbt_backup"
[0m10:33:36.116630 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_meeting
[0m10:33:36.119641 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.stg_position"
[0m10:33:36.124634 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_meeting"
[0m10:33:36.125650 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_pit
[0m10:33:36.125650 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m10:33:36.130629 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_pit"
[0m10:33:36.130629 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:33:36.131630 [debug] [Thread-4 (]: Began executing node model.f1_analytics.stg_position
[0m10:33:36.135632 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:33:36.136635 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: BEGIN
[0m10:33:36.137643 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:33:36.142026 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.stg_position"
[0m10:33:36.142357 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
alter table "f1"."f1_data"."stg_intervals__dbt_tmp" rename to "stg_intervals"
[0m10:33:36.142357 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:36.143502 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: BEGIN
[0m10:33:36.144368 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:36.145467 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:33:36.146466 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:33:36.148368 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: COMMIT
[0m10:33:36.148368 [debug] [Thread-4 (]: On model.f1_analytics.stg_position: BEGIN
[0m10:33:36.150386 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:33:36.152382 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:33:36.153386 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: COMMIT
[0m10:33:36.159376 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m10:33:36.164375 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."stg_intervals__dbt_backup"
[0m10:33:36.167376 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m10:33:36.169371 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
drop view if exists "f1"."f1_data"."stg_intervals__dbt_backup" cascade
[0m10:33:36.172371 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:33:36.174373 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: Close
[0m10:33:36.175370 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74F4E3280>]}
[0m10:33:36.177371 [info ] [Thread-3 (]: 3 of 10 OK created sql view model f1_data.stg_intervals ........................ [[32mCREATE VIEW[0m in 0.32s]
[0m10:33:36.178370 [debug] [Thread-3 (]: Finished running node model.f1_analytics.stg_intervals
[0m10:33:36.179375 [debug] [Thread-3 (]: Began running node model.f1_analytics.stg_sessions
[0m10:33:36.181374 [info ] [Thread-3 (]: 8 of 10 START sql view model f1_data.stg_sessions .............................. [RUN]
[0m10:33:36.182370 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_intervals, now model.f1_analytics.stg_sessions)
[0m10:33:36.183371 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.stg_sessions
[0m10:33:36.187372 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m10:33:36.188369 [debug] [Thread-3 (]: Began executing node model.f1_analytics.stg_sessions
[0m10:33:36.194376 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m10:33:36.195368 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:33:36.196369 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m10:33:36.196369 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:33:36.199369 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m10:33:36.200378 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:33:36.201367 [debug] [Thread-2 (]: SQL status: BEGIN in 0.055 seconds
[0m10:33:36.202403 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */

  create view "f1"."f1_data"."stg_meeting__dbt_tmp"
    
    
  as (
    

    select
            meeting_key,
            meeting_name,
            meeting_official_name,
            country_name,
            circuit_short_name,
            date_start,
            year
from "f1"."f1_data"."meetings"
  );
[0m10:33:36.203372 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:33:36.204369 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */

  create view "f1"."f1_data"."stg_pit__dbt_tmp"
    
    
  as (
    

    select *
    from "f1"."f1_data"."pit"
    where pit_duration is not null
  );
[0m10:33:36.204369 [debug] [Thread-4 (]: SQL status: BEGIN in 0.053 seconds
[0m10:33:36.205369 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:33:36.206372 [debug] [Thread-4 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */

  create view "f1"."f1_data"."stg_position__dbt_tmp"
    
    
  as (
    

    WITH source AS (
    SELECT * FROM "f1"."f1_data"."position"
)
SELECT
    session_key,
    driver_number,
    position,
    date
FROM source
  );
[0m10:33:36.209368 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:33:36.213369 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:33:36.214372 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:33:36.214372 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:36.215381 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
alter table "f1"."f1_data"."stg_meeting" rename to "stg_meeting__dbt_backup"
[0m10:33:36.218369 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:33:36.222368 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:33:36.223371 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
alter table "f1"."f1_data"."stg_pit" rename to "stg_pit__dbt_backup"
[0m10:33:36.224370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:36.224370 [debug] [Thread-4 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
alter table "f1"."f1_data"."stg_position" rename to "stg_position__dbt_backup"
[0m10:33:36.227368 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:33:36.228366 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:33:36.229365 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
alter table "f1"."f1_data"."stg_meeting__dbt_tmp" rename to "stg_meeting"
[0m10:33:36.229365 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:36.232471 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:33:36.235369 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:33:36.236368 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:33:36.236368 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
alter table "f1"."f1_data"."stg_pit__dbt_tmp" rename to "stg_pit"
[0m10:33:36.237368 [debug] [Thread-3 (]: SQL status: BEGIN in 0.040 seconds
[0m10:33:36.237368 [debug] [Thread-4 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
alter table "f1"."f1_data"."stg_position__dbt_tmp" rename to "stg_position"
[0m10:33:36.238409 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: COMMIT
[0m10:33:36.239467 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:33:36.240470 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:36.241378 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:33:36.241378 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:36.242368 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    





















WITH source AS (
    SELECT
        session_key,
        meeting_key,
        country_name,
        session_name,
        session_type,
        year,
        circuit_short_name,
        date_start,
        date_end
    FROM "f1"."f1_data"."sessions"
)
SELECT * FROM source
  );
[0m10:33:36.243370 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: COMMIT
[0m10:33:36.244460 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: COMMIT
[0m10:33:36.246383 [debug] [Thread-4 (]: On model.f1_analytics.stg_position: COMMIT
[0m10:33:36.246383 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:33:36.247373 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:33:36.248373 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: COMMIT
[0m10:33:36.249370 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:33:36.249370 [debug] [Thread-4 (]: On model.f1_analytics.stg_position: COMMIT
[0m10:33:36.252388 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_meeting__dbt_backup"
[0m10:33:36.253382 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m10:33:36.253382 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:36.254369 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m10:33:36.255369 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:36.258381 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_pit__dbt_backup"
[0m10:33:36.261368 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:33:36.262369 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
drop view if exists "f1"."f1_data"."stg_meeting__dbt_backup" cascade
[0m10:33:36.265381 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."stg_position__dbt_backup"
[0m10:33:36.266378 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m10:33:36.266378 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
alter table "f1"."f1_data"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m10:33:36.267368 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m10:33:36.268370 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:36.268370 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
drop view if exists "f1"."f1_data"."stg_pit__dbt_backup" cascade
[0m10:33:36.269369 [debug] [Thread-4 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
drop view if exists "f1"."f1_data"."stg_position__dbt_backup" cascade
[0m10:33:36.269369 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:36.271392 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: Close
[0m10:33:36.275385 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:33:36.275385 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:33:36.276374 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m10:33:36.277386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B751149BA0>]}
[0m10:33:36.277386 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
alter table "f1"."f1_data"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m10:33:36.279367 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: Close
[0m10:33:36.281369 [debug] [Thread-4 (]: On model.f1_analytics.stg_position: Close
[0m10:33:36.281369 [info ] [Thread-1 (]: 5 of 10 OK created sql view model f1_data.stg_meeting .......................... [[32mCREATE VIEW[0m in 0.18s]
[0m10:33:36.283373 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B751281450>]}
[0m10:33:36.284368 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:33:36.285372 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74F44D120>]}
[0m10:33:36.286395 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_meeting
[0m10:33:36.287370 [info ] [Thread-2 (]: 6 of 10 OK created sql view model f1_data.stg_pit .............................. [[32mCREATE VIEW[0m in 0.18s]
[0m10:33:36.289391 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: COMMIT
[0m10:33:36.290370 [info ] [Thread-4 (]: 7 of 10 OK created sql view model f1_data.stg_position ......................... [[32mCREATE VIEW[0m in 0.18s]
[0m10:33:36.291390 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_stints
[0m10:33:36.292367 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_pit
[0m10:33:36.293387 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:33:36.294369 [debug] [Thread-4 (]: Finished running node model.f1_analytics.stg_position
[0m10:33:36.295367 [info ] [Thread-1 (]: 9 of 10 START sql view model f1_data.stg_stints ................................ [RUN]
[0m10:33:36.296367 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_weather
[0m10:33:36.297374 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: COMMIT
[0m10:33:36.298366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_meeting, now model.f1_analytics.stg_stints)
[0m10:33:36.299365 [info ] [Thread-2 (]: 10 of 10 START sql view model f1_data.stg_weather .............................. [RUN]
[0m10:33:36.299365 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_stints
[0m10:33:36.300399 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_pit, now model.f1_analytics.stg_weather)
[0m10:33:36.300399 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:36.303381 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_stints"
[0m10:33:36.303381 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_weather
[0m10:33:36.307372 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."stg_sessions__dbt_backup"
[0m10:33:36.312385 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_weather"
[0m10:33:36.315368 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m10:33:36.315368 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_stints
[0m10:33:36.316473 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
drop view if exists "f1"."f1_data"."stg_sessions__dbt_backup" cascade
[0m10:33:36.321463 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_stints"
[0m10:33:36.322460 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_weather
[0m10:33:36.328368 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_weather"
[0m10:33:36.329368 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m10:33:36.330371 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:33:36.332411 [debug] [Thread-3 (]: On model.f1_analytics.stg_sessions: Close
[0m10:33:36.333368 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:33:36.333368 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: BEGIN
[0m10:33:36.334414 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75141EAA0>]}
[0m10:33:36.335373 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: BEGIN
[0m10:33:36.336370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:36.337377 [info ] [Thread-3 (]: 8 of 10 OK created sql view model f1_data.stg_sessions ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m10:33:36.339422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:33:36.340412 [debug] [Thread-3 (]: Finished running node model.f1_analytics.stg_sessions
[0m10:33:36.382271 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m10:33:36.383778 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:33:36.383778 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */

  create view "f1"."f1_data"."stg_stints__dbt_tmp"
    
    
  as (
    

    select *
    from "f1"."f1_data"."stints"
    where compound is not null and lap_start is not null and lap_end is not null
  );
[0m10:33:36.384786 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m10:33:36.385784 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:33:36.386792 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */

  create view "f1"."f1_data"."stg_weather__dbt_tmp"
    
    
  as (
    


select *
FROM "f1"."f1_data"."weather"
  );
[0m10:33:36.389897 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:33:36.392887 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:33:36.393789 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:36.393789 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
alter table "f1"."f1_data"."stg_stints" rename to "stg_stints__dbt_backup"
[0m10:33:36.397601 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:33:36.398506 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
alter table "f1"."f1_data"."stg_weather" rename to "stg_weather__dbt_backup"
[0m10:33:36.398506 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:36.401541 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:33:36.401541 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m10:33:36.402500 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
alter table "f1"."f1_data"."stg_stints__dbt_tmp" rename to "stg_stints"
[0m10:33:36.404590 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:33:36.405600 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
alter table "f1"."f1_data"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m10:33:36.405600 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m10:33:36.408542 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: COMMIT
[0m10:33:36.409077 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:33:36.409077 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:33:36.410103 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: COMMIT
[0m10:33:36.411174 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: COMMIT
[0m10:33:36.412114 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:33:36.413086 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: COMMIT
[0m10:33:36.414088 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:36.414088 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:36.416098 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_stints__dbt_backup"
[0m10:33:36.419084 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_weather__dbt_backup"
[0m10:33:36.420085 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m10:33:36.421209 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m10:33:36.422201 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
drop view if exists "f1"."f1_data"."stg_stints__dbt_backup" cascade
[0m10:33:36.423088 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
drop view if exists "f1"."f1_data"."stg_weather__dbt_backup" cascade
[0m10:33:36.424087 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:36.425139 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:36.426124 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: Close
[0m10:33:36.427726 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: Close
[0m10:33:36.428738 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B751149BA0>]}
[0m10:33:36.429827 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e99395dd-8bdf-47ad-b7d0-e6881cbcd46f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B75140C0D0>]}
[0m10:33:36.431739 [info ] [Thread-1 (]: 9 of 10 OK created sql view model f1_data.stg_stints ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m10:33:36.432733 [info ] [Thread-2 (]: 10 of 10 OK created sql view model f1_data.stg_weather ......................... [[32mCREATE VIEW[0m in 0.13s]
[0m10:33:36.434737 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_stints
[0m10:33:36.435753 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_weather
[0m10:33:36.438732 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:36.438732 [debug] [MainThread]: On master: BEGIN
[0m10:33:36.438732 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:36.484358 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m10:33:36.485457 [debug] [MainThread]: On master: COMMIT
[0m10:33:36.486355 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:36.487348 [debug] [MainThread]: On master: COMMIT
[0m10:33:36.487348 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:36.489512 [debug] [MainThread]: On master: Close
[0m10:33:36.489512 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:36.490530 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m10:33:36.491534 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m10:33:36.492541 [debug] [MainThread]: Connection 'model.f1_analytics.stg_stints' was properly closed.
[0m10:33:36.494528 [debug] [MainThread]: Connection 'model.f1_analytics.stg_weather' was properly closed.
[0m10:33:36.495537 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was properly closed.
[0m10:33:36.496528 [debug] [MainThread]: Connection 'model.f1_analytics.stg_position' was properly closed.
[0m10:33:36.497539 [info ] [MainThread]: 
[0m10:33:36.499549 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m10:33:36.505364 [debug] [MainThread]: Command end result
[0m10:33:36.582747 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:33:36.584751 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:33:36.590750 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m10:33:36.591753 [info ] [MainThread]: 
[0m10:33:36.592754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:36.592754 [info ] [MainThread]: 
[0m10:33:36.593861 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m10:33:36.594862 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:36.593861 after 1.72 seconds
[0m10:33:36.594862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E3B2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74F848D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B74E7AFC10>]}
[0m10:33:36.595751 [debug] [MainThread]: Flushing usage events
[0m10:33:37.066927 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:43.721833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E89FFE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8B300F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8B300D30>]}


============================== 10:33:43.724833 | 16800e57-72bd-4892-aace-caea5682e8e4 ==============================
[0m10:33:43.724833 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:33:43.725831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select intermediate', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:33:43.870816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8B49AAD0>]}
[0m10:33:43.919338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8B06FDC0>]}
[0m10:33:43.921340 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:33:44.043338 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:33:44.171590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:44.171590 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:44.214593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8C9DCEB0>]}
[0m10:33:44.331507 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:33:44.334509 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:33:44.355355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8CA062C0>]}
[0m10:33:44.355355 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m10:33:44.356356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8CA13700>]}
[0m10:33:44.358356 [info ] [MainThread]: 
[0m10:33:44.358356 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:33:44.359355 [info ] [MainThread]: 
[0m10:33:44.360355 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:44.364391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m10:33:44.409479 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m10:33:44.410489 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m10:33:44.410489 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:44.445493 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.035 seconds
[0m10:33:44.447485 [debug] [ThreadPool]: On list_f1: Close
[0m10:33:44.450386 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m10:33:44.455486 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:33:44.455486 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m10:33:44.456465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:44.491775 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m10:33:44.491775 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:33:44.493011 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m10:33:44.499119 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.006 seconds
[0m10:33:44.501115 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m10:33:44.502012 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m10:33:44.509014 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:44.510016 [debug] [MainThread]: On master: BEGIN
[0m10:33:44.510016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:44.545017 [debug] [MainThread]: SQL status: BEGIN in 0.034 seconds
[0m10:33:44.545017 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:44.546015 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:44.555132 [debug] [MainThread]: SQL status: SELECT 10 in 0.009 seconds
[0m10:33:44.557014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8C8E7B20>]}
[0m10:33:44.558014 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:44.559020 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:44.559020 [debug] [MainThread]: On master: BEGIN
[0m10:33:44.560062 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:33:44.560062 [debug] [MainThread]: On master: COMMIT
[0m10:33:44.561014 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:44.561014 [debug] [MainThread]: On master: COMMIT
[0m10:33:44.562079 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:44.563085 [debug] [MainThread]: On master: Close
[0m10:33:44.570134 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_best_laps
[0m10:33:44.570134 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_car_base
[0m10:33:44.571029 [debug] [Thread-3 (]: Began running node model.f1_analytics.int_final_intervals
[0m10:33:44.572020 [debug] [Thread-4 (]: Began running node model.f1_analytics.int_final_position
[0m10:33:44.572020 [info ] [Thread-1 (]: 1 of 9 START sql view model f1_data.int_best_laps .............................. [RUN]
[0m10:33:44.573129 [info ] [Thread-2 (]: 2 of 9 START sql view model f1_data.int_car_base ............................... [RUN]
[0m10:33:44.574020 [info ] [Thread-3 (]: 3 of 9 START sql view model f1_data.int_final_intervals ........................ [RUN]
[0m10:33:44.575019 [info ] [Thread-4 (]: 4 of 9 START sql view model f1_data.int_final_position ......................... [RUN]
[0m10:33:44.575019 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.int_best_laps'
[0m10:33:44.576042 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.int_car_base'
[0m10:33:44.577020 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.int_final_intervals'
[0m10:33:44.577020 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.int_final_position'
[0m10:33:44.578056 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_best_laps
[0m10:33:44.579021 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_car_base
[0m10:33:44.579021 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.int_final_intervals
[0m10:33:44.580020 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.int_final_position
[0m10:33:44.587043 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_best_laps"
[0m10:33:44.590067 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_car_base"
[0m10:33:44.593048 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.int_final_intervals"
[0m10:33:44.596062 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.int_final_position"
[0m10:33:44.598054 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_best_laps
[0m10:33:44.599048 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_car_base
[0m10:33:44.616644 [debug] [Thread-3 (]: Began executing node model.f1_analytics.int_final_intervals
[0m10:33:44.627271 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_best_laps"
[0m10:33:44.631371 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_car_base"
[0m10:33:44.631371 [debug] [Thread-4 (]: Began executing node model.f1_analytics.int_final_position
[0m10:33:44.635370 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.int_final_intervals"
[0m10:33:44.636274 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:33:44.639365 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.int_final_position"
[0m10:33:44.640383 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:33:44.641270 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: BEGIN
[0m10:33:44.642372 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:33:44.643274 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: BEGIN
[0m10:33:44.643274 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:33:44.644274 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:33:44.646282 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: BEGIN
[0m10:33:44.647282 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:33:44.649278 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: BEGIN
[0m10:33:44.650388 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:33:44.651273 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:33:44.694268 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m10:33:44.695270 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:33:44.696270 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */

  create view "f1"."f1_data"."int_best_laps__dbt_tmp"
    
    
  as (
    

select
        session_key,
        driver_number,
        min(lap_duration) as fastest_lap
from "f1"."f1_data"."stg_laps"
group by 1,2
  );
[0m10:33:44.697275 [debug] [Thread-2 (]: SQL status: BEGIN in 0.049 seconds
[0m10:33:44.697275 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:33:44.698272 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */

  create view "f1"."f1_data"."int_car_base__dbt_tmp"
    
    
  as (
    

SELECT
   ts.driver_number,
   ts.session_key,
   d.name_acronym,
   d.team_name,
   d.team_colour,
   ts.date,
   ts.rpm,
   ts.speed,
   ts.throttle,
   ts.brake
FROM "f1"."f1_data"."stg_car_data" ts
LEFT JOIN "f1"."f1_data"."stg_drivers" d
   ON ts.driver_number = d.driver_number
   AND ts.session_key = d.session_key
  );
[0m10:33:44.699272 [debug] [Thread-3 (]: SQL status: BEGIN in 0.049 seconds
[0m10:33:44.700272 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:33:44.700272 [debug] [Thread-4 (]: SQL status: BEGIN in 0.049 seconds
[0m10:33:44.701271 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */

  create view "f1"."f1_data"."int_final_intervals__dbt_tmp"
    
    
  as (
    SELECT
    session_key,
    driver_number,
    MAX(CASE
        WHEN gap_to_leader LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_leader AS FLOAT)
    END) AS max_gap_to_leader,
    MAX(CASE
        WHEN gap_to_next LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_next AS FLOAT)
    END) AS max_gap_to_next
FROM "f1"."f1_data"."stg_intervals"
GROUP BY session_key, driver_number
  );
[0m10:33:44.701271 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:33:44.702272 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:33:44.708285 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:33:44.708285 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m10:33:44.709269 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:33:44.709269 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */

  create view "f1"."f1_data"."int_final_position__dbt_tmp"
    
    
  as (
    

WITH ranked AS (
    SELECT
        session_key,
        driver_number,
        position,
        date AS latest_date,
        ROW_NUMBER() OVER (
            PARTITION BY session_key, driver_number
            ORDER BY date DESC
        ) AS rn
    FROM "f1"."f1_data"."stg_position"
)
SELECT
    session_key,
    driver_number,
    position,
    latest_date
FROM ranked
WHERE rn = 1
  );
[0m10:33:44.710297 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */
alter table "f1"."f1_data"."int_best_laps__dbt_tmp" rename to "int_best_laps"
[0m10:33:44.713285 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:33:44.716271 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:33:44.717276 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
alter table "f1"."f1_data"."int_car_base__dbt_tmp" rename to "int_car_base"
[0m10:33:44.718278 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:44.718278 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */
alter table "f1"."f1_data"."int_final_intervals__dbt_tmp" rename to "int_final_intervals"
[0m10:33:44.727284 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m10:33:44.728271 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m10:33:44.732284 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: COMMIT
[0m10:33:44.733270 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m10:33:44.734302 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: COMMIT
[0m10:33:44.737284 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:33:44.738270 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:33:44.739272 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: COMMIT
[0m10:33:44.740272 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:33:44.741271 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */
alter table "f1"."f1_data"."int_final_position__dbt_tmp" rename to "int_final_position"
[0m10:33:44.741271 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: COMMIT
[0m10:33:44.742273 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:33:44.743275 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: COMMIT
[0m10:33:44.744271 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: COMMIT
[0m10:33:44.745297 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:44.746276 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:33:44.746276 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:44.748271 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: COMMIT
[0m10:33:44.749284 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m10:33:44.754285 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_best_laps__dbt_backup"
[0m10:33:44.756286 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."int_car_base__dbt_backup"
[0m10:33:44.757284 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:33:44.760272 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."int_final_intervals__dbt_backup"
[0m10:33:44.764284 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m10:33:44.765272 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m10:33:44.766293 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: COMMIT
[0m10:33:44.767271 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m10:33:44.768271 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */
drop view if exists "f1"."f1_data"."int_best_laps__dbt_backup" cascade
[0m10:33:44.768271 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
drop view if exists "f1"."f1_data"."int_car_base__dbt_backup" cascade
[0m10:33:44.769271 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */
drop view if exists "f1"."f1_data"."int_final_intervals__dbt_backup" cascade
[0m10:33:44.769271 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:44.770271 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:44.771269 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:44.771269 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:44.773285 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."int_final_position__dbt_backup"
[0m10:33:44.776285 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: Close
[0m10:33:44.777269 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: Close
[0m10:33:44.778270 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: Close
[0m10:33:44.779271 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m10:33:44.784285 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8CA577C0>]}
[0m10:33:44.785284 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8CEDC940>]}
[0m10:33:44.787281 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8CA4D1E0>]}
[0m10:33:44.789282 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */
drop view if exists "f1"."f1_data"."int_final_position__dbt_backup" cascade
[0m10:33:44.791280 [info ] [Thread-2 (]: 2 of 9 OK created sql view model f1_data.int_car_base .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m10:33:44.793272 [info ] [Thread-1 (]: 1 of 9 OK created sql view model f1_data.int_best_laps ......................... [[32mCREATE VIEW[0m in 0.21s]
[0m10:33:44.793272 [info ] [Thread-3 (]: 3 of 9 OK created sql view model f1_data.int_final_intervals ................... [[32mCREATE VIEW[0m in 0.21s]
[0m10:33:44.795273 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_car_base
[0m10:33:44.795273 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:44.796273 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_best_laps
[0m10:33:44.797271 [debug] [Thread-3 (]: Finished running node model.f1_analytics.int_final_intervals
[0m10:33:44.797775 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_lap_position
[0m10:33:44.799559 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: Close
[0m10:33:44.799559 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_pit_stop
[0m10:33:44.800560 [debug] [Thread-3 (]: Began running node model.f1_analytics.int_tyre_stint
[0m10:33:44.801109 [info ] [Thread-2 (]: 5 of 9 START sql view model f1_data.int_lap_position ........................... [RUN]
[0m10:33:44.802128 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8CEF8D00>]}
[0m10:33:44.803129 [info ] [Thread-1 (]: 6 of 9 START sql view model f1_data.int_pit_stop ............................... [RUN]
[0m10:33:44.803129 [info ] [Thread-3 (]: 7 of 9 START sql view model f1_data.int_tyre_stint ............................. [RUN]
[0m10:33:44.804130 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_car_base, now model.f1_analytics.int_lap_position)
[0m10:33:44.806127 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_best_laps, now model.f1_analytics.int_pit_stop)
[0m10:33:44.805127 [info ] [Thread-4 (]: 4 of 9 OK created sql view model f1_data.int_final_position .................... [[32mCREATE VIEW[0m in 0.23s]
[0m10:33:44.806127 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_final_intervals, now model.f1_analytics.int_tyre_stint)
[0m10:33:44.807128 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_lap_position
[0m10:33:44.808133 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_pit_stop
[0m10:33:44.808133 [debug] [Thread-4 (]: Finished running node model.f1_analytics.int_final_position
[0m10:33:44.809137 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.int_tyre_stint
[0m10:33:44.812134 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_lap_position"
[0m10:33:44.816147 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_pit_stop"
[0m10:33:44.817134 [debug] [Thread-4 (]: Began running node model.f1_analytics.int_tyre_stint_laps
[0m10:33:44.819805 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint"
[0m10:33:44.820806 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_lap_position
[0m10:33:44.822355 [info ] [Thread-4 (]: 8 of 9 START sql view model f1_data.int_tyre_stint_laps ........................ [RUN]
[0m10:33:44.823454 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_pit_stop
[0m10:33:44.826978 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_lap_position"
[0m10:33:44.827966 [debug] [Thread-3 (]: Began executing node model.f1_analytics.int_tyre_stint
[0m10:33:44.827966 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_final_position, now model.f1_analytics.int_tyre_stint_laps)
[0m10:33:44.831984 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_pit_stop"
[0m10:33:44.835637 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint"
[0m10:33:44.835637 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.int_tyre_stint_laps
[0m10:33:44.836548 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:33:44.840551 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint_laps"
[0m10:33:44.841549 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:33:44.842549 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: BEGIN
[0m10:33:44.843548 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:33:44.843548 [debug] [Thread-1 (]: On model.f1_analytics.int_pit_stop: BEGIN
[0m10:33:44.844547 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:33:44.845088 [debug] [Thread-4 (]: Began executing node model.f1_analytics.int_tyre_stint_laps
[0m10:33:44.845088 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: BEGIN
[0m10:33:44.846106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:44.850095 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint_laps"
[0m10:33:44.851095 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m10:33:44.854102 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:33:44.856105 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: BEGIN
[0m10:33:44.859101 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:33:44.899656 [debug] [Thread-2 (]: SQL status: BEGIN in 0.055 seconds
[0m10:33:44.900661 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:33:44.900661 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */

  create view "f1"."f1_data"."int_lap_position__dbt_tmp"
    
    
  as (
    

WITH positions AS (
    SELECT
        p.session_key,
        p.driver_number,
        p.position,
        p.date,
        l.lap_number,
        l.date_start,
        l.date_end,
        ABS(EXTRACT(EPOCH FROM (p.date - l.date_start))) AS start_time_diff,
        ABS(EXTRACT(EPOCH FROM (p.date - l.date_end)))   AS end_time_diff
    FROM "f1"."f1_data"."stg_position" p
    JOIN "f1"."f1_data"."stg_laps" l
        ON p.session_key = l.session_key
        AND p.driver_number = l.driver_number
    WHERE p.date BETWEEN l.date_start AND l.date_end
)
SELECT *,
    ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number, lap_number
        ORDER BY start_time_diff
    ) AS start_position_rank,
    ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number, lap_number
        ORDER BY end_time_diff
    ) AS end_position_rank
FROM positions
  );
[0m10:33:44.902663 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m10:33:44.903660 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:33:44.903660 [debug] [Thread-1 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */

  create view "f1"."f1_data"."int_pit_stop__dbt_tmp"
    
    
  as (
    

SELECT
    session_key,
    driver_number,
    COUNT(*) AS pit_stop_count
FROM "f1"."f1_data"."stg_pit"
GROUP BY session_key, driver_number
  );
[0m10:33:44.905165 [debug] [Thread-3 (]: SQL status: BEGIN in 0.054 seconds
[0m10:33:44.906173 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m10:33:44.906173 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:33:44.906173 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:33:44.907679 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */

  create view "f1"."f1_data"."int_tyre_stint__dbt_tmp"
    
    
  as (
    

WITH stints_base AS (
    SELECT
        s.*,
        d.team_name,
        ses.circuit_short_name,
        ses.country_name,
        ses.session_type
    FROM "f1"."f1_data"."stg_stints" s
    LEFT JOIN "f1"."f1_data"."stg_drivers" d ON s.driver_number = d.driver_number
        AND s.session_key = d.session_key
    LEFT JOIN "f1"."f1_data"."stg_sessions" ses ON s.session_key = ses.session_key
    WHERE ses.session_type = 'Race' -- Focus on race sessions
),

stint_durations AS (
    SELECT
        *,
        lap_end - lap_start + 1 as stint_length
    FROM stints_base
)

SELECT * FROM stint_durations
  );
[0m10:33:44.908686 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:44.908686 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */

  create view "f1"."f1_data"."int_tyre_stint_laps__dbt_tmp"
    
    
  as (
    

with cte as (SELECT s.session_key,
                    s.driver_number,
                    s.stint_number,
                    s.compound,
                    s.lap_start,
                    s.lap_end,
                    s.lap_end - s.lap_start + 1 as stint_length,
                    -- Get the start time from the first lap of the stint
                    MIN(l.date_start)           as stint_start_time,
                    -- Get the end time from the last lap of the stint
                    MAX(l.date_start)           as stint_end_time
             FROM "f1"."f1_data"."stg_stints" s
                      LEFT JOIN "f1"."f1_data"."stg_laps" l
                                ON s.session_key = l.session_key
                                    AND s.driver_number = l.driver_number
                                    AND l.lap_number BETWEEN s.lap_start AND s.lap_end
             GROUP BY 1, 2, 3, 4, 5, 6
             )
select * from cte
         where stint_end_time is not null
           and
             stint_start_time is not null
  );
[0m10:33:44.908686 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m10:33:44.912686 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:33:44.915688 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:33:44.915688 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m10:33:44.916688 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */
alter table "f1"."f1_data"."int_lap_position__dbt_tmp" rename to "int_lap_position"
[0m10:33:44.916688 [debug] [Thread-1 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */
alter table "f1"."f1_data"."int_pit_stop__dbt_tmp" rename to "int_pit_stop"
[0m10:33:44.919687 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:33:44.920699 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:44.921690 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */
alter table "f1"."f1_data"."int_tyre_stint__dbt_tmp" rename to "int_tyre_stint"
[0m10:33:44.921690 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:44.922685 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:44.924687 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:33:44.926197 [debug] [Thread-1 (]: On model.f1_analytics.int_pit_stop: COMMIT
[0m10:33:44.927236 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:33:44.928203 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: COMMIT
[0m10:33:44.929203 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */
alter table "f1"."f1_data"."int_tyre_stint_laps__dbt_tmp" rename to "int_tyre_stint_laps"
[0m10:33:44.929203 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:33:44.931218 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: COMMIT
[0m10:33:44.931218 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:33:44.932208 [debug] [Thread-1 (]: On model.f1_analytics.int_pit_stop: COMMIT
[0m10:33:44.933209 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:44.934207 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:33:44.935202 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: COMMIT
[0m10:33:44.937204 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: COMMIT
[0m10:33:44.937204 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m10:33:44.938238 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: COMMIT
[0m10:33:44.938238 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:33:44.939205 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:44.941218 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_pit_stop__dbt_backup"
[0m10:33:44.942218 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: COMMIT
[0m10:33:44.945218 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."int_lap_position__dbt_backup"
[0m10:33:44.945218 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m10:33:44.946217 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m10:33:44.948208 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m10:33:44.948208 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:44.952218 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stint__dbt_backup"
[0m10:33:44.953217 [debug] [Thread-1 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */
drop view if exists "f1"."f1_data"."int_pit_stop__dbt_backup" cascade
[0m10:33:44.954219 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */
drop view if exists "f1"."f1_data"."int_lap_position__dbt_backup" cascade
[0m10:33:44.958209 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stint_laps__dbt_backup"
[0m10:33:44.960316 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m10:33:44.962340 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m10:33:44.963302 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:33:44.963302 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:33:44.964216 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */
drop view if exists "f1"."f1_data"."int_tyre_stint__dbt_backup" cascade
[0m10:33:44.965329 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */
drop view if exists "f1"."f1_data"."int_tyre_stint_laps__dbt_backup" cascade
[0m10:33:44.968306 [debug] [Thread-1 (]: On model.f1_analytics.int_pit_stop: Close
[0m10:33:44.970311 [debug] [Thread-2 (]: On model.f1_analytics.int_lap_position: Close
[0m10:33:44.971204 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:33:44.973205 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:44.974218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8CDC7F40>]}
[0m10:33:44.977216 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8C96C3D0>]}
[0m10:33:44.980216 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: Close
[0m10:33:44.983208 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: Close
[0m10:33:44.984323 [info ] [Thread-1 (]: 6 of 9 OK created sql view model f1_data.int_pit_stop .......................... [[32mCREATE VIEW[0m in 0.17s]
[0m10:33:44.985332 [info ] [Thread-2 (]: 5 of 9 OK created sql view model f1_data.int_lap_position ...................... [[32mCREATE VIEW[0m in 0.17s]
[0m10:33:44.987217 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8B2A3A90>]}
[0m10:33:44.988212 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8D02F430>]}
[0m10:33:44.989211 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_pit_stop
[0m10:33:44.990206 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_lap_position
[0m10:33:44.991206 [info ] [Thread-3 (]: 7 of 9 OK created sql view model f1_data.int_tyre_stint ........................ [[32mCREATE VIEW[0m in 0.18s]
[0m10:33:44.992203 [info ] [Thread-4 (]: 8 of 9 OK created sql view model f1_data.int_tyre_stint_laps ................... [[32mCREATE VIEW[0m in 0.16s]
[0m10:33:44.994210 [debug] [Thread-3 (]: Finished running node model.f1_analytics.int_tyre_stint
[0m10:33:44.995204 [debug] [Thread-4 (]: Finished running node model.f1_analytics.int_tyre_stint_laps
[0m10:33:44.996205 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_tyre_stints_weather
[0m10:33:44.997216 [info ] [Thread-1 (]: 9 of 9 START sql view model f1_data.int_tyre_stints_weather .................... [RUN]
[0m10:33:44.998208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_pit_stop, now model.f1_analytics.int_tyre_stints_weather)
[0m10:33:44.999214 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_tyre_stints_weather
[0m10:33:45.003217 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stints_weather"
[0m10:33:45.004218 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_tyre_stints_weather
[0m10:33:45.008218 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stints_weather"
[0m10:33:45.010202 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:33:45.011216 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stints_weather: BEGIN
[0m10:33:45.011216 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:45.046798 [debug] [Thread-1 (]: SQL status: BEGIN in 0.035 seconds
[0m10:33:45.047786 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:33:45.047786 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */

  create view "f1"."f1_data"."int_tyre_stints_weather__dbt_tmp"
    
    
  as (
    

SELECT
        st.session_key,
        st.driver_number,
        st.stint_number,
        st.compound,
        st.lap_start,
        st.lap_end,
        st.stint_length,
        -- Average weather conditions during the stint
        AVG(w.air_temperature) as avg_air_temp,
        AVG(w.track_temperature) as avg_track_temp,
        AVG(w.humidity) as avg_humidity,
        MAX(w.rainfall) as had_rainfall,  -- If there was any rain during stint
        AVG(w.wind_speed) as avg_wind_speed,
        -- Categorize conditions
        CASE
            WHEN AVG(w.track_temperature) < 25 THEN 'Cold'
            WHEN AVG(w.track_temperature) < 35 THEN 'Medium'
            ELSE 'Hot'
        END as track_temp_category,
        CASE
            WHEN MAX(w.rainfall) > 0 THEN 'Wet'
            WHEN AVG(w.humidity) > 70 THEN 'High Humidity'
            ELSE 'Dry'
        END as weather_condition
    FROM "f1"."f1_data"."int_tyre_stint_laps" st
    LEFT JOIN "f1"."f1_data"."stg_weather" w
        ON st.session_key = w.session_key
        AND w.date BETWEEN st.stint_start_time AND st.stint_end_time
    GROUP BY 1,2,3,4,5,6,7
  );
[0m10:33:45.055339 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:45.058423 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:33:45.059445 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */
alter table "f1"."f1_data"."int_tyre_stints_weather__dbt_tmp" rename to "int_tyre_stints_weather"
[0m10:33:45.060321 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:45.061318 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stints_weather: COMMIT
[0m10:33:45.062326 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:33:45.062326 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stints_weather: COMMIT
[0m10:33:45.064323 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:45.066419 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stints_weather__dbt_backup"
[0m10:33:45.067381 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m10:33:45.067381 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */
drop view if exists "f1"."f1_data"."int_tyre_stints_weather__dbt_backup" cascade
[0m10:33:45.068320 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:33:45.069320 [debug] [Thread-1 (]: On model.f1_analytics.int_tyre_stints_weather: Close
[0m10:33:45.070320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16800e57-72bd-4892-aace-caea5682e8e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E88ECC3A0>]}
[0m10:33:45.071325 [info ] [Thread-1 (]: 9 of 9 OK created sql view model f1_data.int_tyre_stints_weather ............... [[32mCREATE VIEW[0m in 0.07s]
[0m10:33:45.072321 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_tyre_stints_weather
[0m10:33:45.074324 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:45.074324 [debug] [MainThread]: On master: BEGIN
[0m10:33:45.075328 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:45.117334 [debug] [MainThread]: SQL status: BEGIN in 0.042 seconds
[0m10:33:45.118320 [debug] [MainThread]: On master: COMMIT
[0m10:33:45.119319 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:45.119319 [debug] [MainThread]: On master: COMMIT
[0m10:33:45.120319 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:45.121338 [debug] [MainThread]: On master: Close
[0m10:33:45.121338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:45.122323 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m10:33:45.122323 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m10:33:45.123327 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stints_weather' was properly closed.
[0m10:33:45.123327 [debug] [MainThread]: Connection 'model.f1_analytics.int_lap_position' was properly closed.
[0m10:33:45.123327 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint' was properly closed.
[0m10:33:45.124335 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint_laps' was properly closed.
[0m10:33:45.125321 [info ] [MainThread]: 
[0m10:33:45.126335 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m10:33:45.128327 [debug] [MainThread]: Command end result
[0m10:33:45.150321 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:33:45.153326 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:33:45.159325 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m10:33:45.160324 [info ] [MainThread]: 
[0m10:33:45.161430 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:45.161430 [info ] [MainThread]: 
[0m10:33:45.162328 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m10:33:45.163326 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:45.163326 after 1.51 seconds
[0m10:33:45.164325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E89FFE320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8B498D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012E8CF80DC0>]}
[0m10:33:45.164325 [debug] [MainThread]: Flushing usage events
[0m10:33:45.552952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:33:52.243421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD22F8E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24290F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24290D30>]}


============================== 10:33:52.246436 | fe36f432-0e66-451d-b647-3d8c9ddb6fc5 ==============================
[0m10:33:52.246436 [info ] [MainThread]: Running with dbt=1.10.6
[0m10:33:52.247456 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --select marts', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:33:52.389722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2442AAD0>]}
[0m10:33:52.435448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24003DC0>]}
[0m10:33:52.437425 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m10:33:52.563711 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m10:33:52.693175 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:33:52.693175 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:33:52.736169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2596CEB0>]}
[0m10:33:52.853302 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:33:52.855481 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:33:52.877801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD259962C0>]}
[0m10:33:52.878801 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m10:33:52.879801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD259A3700>]}
[0m10:33:52.881842 [info ] [MainThread]: 
[0m10:33:52.882802 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:33:52.882802 [info ] [MainThread]: 
[0m10:33:52.883838 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:33:52.888367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m10:33:52.934996 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m10:33:52.934996 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m10:33:52.935997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:52.974409 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.038 seconds
[0m10:33:52.975344 [debug] [ThreadPool]: On list_f1: Close
[0m10:33:52.980410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m10:33:52.985394 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:33:52.985394 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m10:33:52.986299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:33:53.028399 [debug] [ThreadPool]: SQL status: BEGIN in 0.042 seconds
[0m10:33:53.028399 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m10:33:53.029299 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m10:33:53.035397 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.006 seconds
[0m10:33:53.037399 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m10:33:53.038333 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m10:33:53.046416 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:53.047299 [debug] [MainThread]: On master: BEGIN
[0m10:33:53.047299 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:33:53.082400 [debug] [MainThread]: SQL status: BEGIN in 0.035 seconds
[0m10:33:53.083370 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:53.084303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:33:53.093388 [debug] [MainThread]: SQL status: SELECT 25 in 0.009 seconds
[0m10:33:53.098299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD258FD780>]}
[0m10:33:53.098299 [debug] [MainThread]: On master: ROLLBACK
[0m10:33:53.099303 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:53.099303 [debug] [MainThread]: On master: BEGIN
[0m10:33:53.100303 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m10:33:53.101302 [debug] [MainThread]: On master: COMMIT
[0m10:33:53.101302 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:53.101302 [debug] [MainThread]: On master: COMMIT
[0m10:33:53.103317 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:53.104314 [debug] [MainThread]: On master: Close
[0m10:33:53.109300 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_car
[0m10:33:53.109300 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_historical_analysis
[0m10:33:53.110298 [debug] [Thread-3 (]: Began running node model.f1_analytics.final_session_driver_mapping
[0m10:33:53.111330 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_session_filters
[0m10:33:53.110298 [info ] [Thread-1 (]: 1 of 8 START sql view model f1_data.final_car .................................. [RUN]
[0m10:33:53.112297 [info ] [Thread-2 (]: 2 of 8 START sql view model f1_data.final_historical_analysis .................. [RUN]
[0m10:33:53.112297 [info ] [Thread-3 (]: 3 of 8 START sql view model f1_data.final_session_driver_mapping ............... [RUN]
[0m10:33:53.113298 [info ] [Thread-4 (]: 4 of 8 START sql view model f1_data.final_session_filters ...................... [RUN]
[0m10:33:53.114298 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_car'
[0m10:33:53.114298 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.final_historical_analysis'
[0m10:33:53.115297 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_driver_mapping'
[0m10:33:53.116301 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_filters'
[0m10:33:53.117332 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_car
[0m10:33:53.117332 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m10:33:53.118306 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.final_session_driver_mapping
[0m10:33:53.119315 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_session_filters
[0m10:33:53.126299 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_car"
[0m10:33:53.129402 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m10:33:53.133404 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.final_session_driver_mapping"
[0m10:33:53.137300 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_session_filters"
[0m10:33:53.139305 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_car
[0m10:33:53.141299 [debug] [Thread-2 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m10:33:53.166298 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_car"
[0m10:33:53.167298 [debug] [Thread-3 (]: Began executing node model.f1_analytics.final_session_driver_mapping
[0m10:33:53.167298 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_session_filters
[0m10:33:53.171299 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m10:33:53.175394 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.final_session_driver_mapping"
[0m10:33:53.176413 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:33:53.179390 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_session_filters"
[0m10:33:53.181310 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:33:53.182369 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:33:53.183308 [debug] [Thread-1 (]: On model.f1_analytics.final_car: BEGIN
[0m10:33:53.184302 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: BEGIN
[0m10:33:53.184302 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:33:53.185417 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: BEGIN
[0m10:33:53.186339 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:33:53.186339 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:33:53.187330 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: BEGIN
[0m10:33:53.187330 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:33:53.188162 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:33:53.249157 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m10:33:53.250221 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:33:53.251262 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */

  create view "f1"."f1_data"."final_car__dbt_tmp"
    
    
  as (
    

SELECT
   t.date,
   CONCAT(t.name_acronym, ' (', t.team_name, ')') as driver,
   t.driver_number,
   ROUND(t.speed) as speed,
   ROUND(t.throttle) as throttle,
   ROUND(t.brake) as brake,
   t.rpm,
   t.session_key,  -- Add session_key
   m.meeting_key   -- Add meeting_key
FROM "f1"."f1_data"."int_car_base" t
LEFT JOIN "f1"."f1_data"."stg_sessions" s ON t.session_key = s.session_key
LEFT JOIN "f1"."f1_data"."stg_meeting" m ON s.meeting_key = m.meeting_key
  );
[0m10:33:53.252324 [debug] [Thread-2 (]: SQL status: BEGIN in 0.066 seconds
[0m10:33:53.253398 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:33:53.253398 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */

  create view "f1"."f1_data"."final_historical_analysis__dbt_tmp"
    
    
  as (
    

WITH first_position_record AS (
    SELECT *
    FROM (
        SELECT
            session_key,
            driver_number,
            position AS first_position,
            date,
            ROW_NUMBER() OVER (
                PARTITION BY session_key, driver_number
                ORDER BY date
            ) AS rn
        FROM stg_position
    ) t
    WHERE rn = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        ROUND(MIN(i.gap_to_next)::numeric,3) AS min_gap_to_next,
        ROUND(MAX(i.gap_to_next)::numeric,3) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM "f1"."f1_data"."stg_laps" l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN "f1"."f1_data"."stg_intervals" i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND date_trunc('second', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN "f1"."f1_data"."int_lap_position" sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN "f1"."f1_data"."int_lap_position" ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY
        l.lap_number, l.session_key, l.driver_number, l.date_start,
        l.date_end, l.is_pit_out_lap,
        l.duration_sector_1, l.duration_sector_2, l.duration_sector_3,
        fpr.first_position, sp.position, ep.position
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                MAX(start_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                MAX(end_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
    lap_number,
    session_key,
    driver_number,
    date_start AS lap_start_time,
    date_end AS lap_end_time,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3,
    min_gap_to_leader,
    max_gap_to_leader,
    min_gap_to_next,
    max_gap_to_next,
    lap_start_position,
    lap_end_position,
    first_position AS race_start_position
FROM filled_positions
  );
[0m10:33:53.255430 [debug] [Thread-4 (]: SQL status: BEGIN in 0.067 seconds
[0m10:33:53.256437 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:33:53.256437 [debug] [Thread-3 (]: SQL status: BEGIN in 0.069 seconds
[0m10:33:53.257427 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */

  create view "f1"."f1_data"."final_session_filters__dbt_tmp"
    
    
  as (
    WITH session_drivers AS (
   SELECT DISTINCT
       s.session_key,
       s.country_name,
       s.session_name,
       s.session_type,
       s.year,
       d.driver_number,
       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name
   FROM "f1"."f1_data"."stg_sessions" s
   JOIN "f1"."f1_data"."stg_drivers" d ON s.session_key = d.session_key
)
SELECT
   s.session_key,
    s.year,
   s.country_name,
   s.circuit_short_name,
   s.session_name,
   s.session_type,
   concat(s.year, ' - ', s.country_name, ' - ', s.session_name) as session_display_name,
   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,
   m.meeting_name,
   m.meeting_official_name,
   s.date_start
FROM "f1"."f1_data"."stg_sessions" s
JOIN session_drivers sd ON s.session_key = sd.session_key
JOIN "f1"."f1_data"."stg_meeting" m ON s.year = m.year
   AND s.country_name = m.country_name
GROUP BY 1,2,3,4,5,6,7,9,10,11
  );
[0m10:33:53.258428 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:33:53.258428 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:53.259551 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */

  create view "f1"."f1_data"."final_session_driver_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    d.session_key,
    concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name,
    d.driver_number
FROM "f1"."f1_data"."stg_drivers" d
JOIN "f1"."f1_data"."stg_sessions" s ON d.session_key = s.session_key
  );
[0m10:33:53.265571 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:33:53.266571 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m10:33:53.266571 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:53.267568 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
alter table "f1"."f1_data"."final_car__dbt_tmp" rename to "final_car"
[0m10:33:53.270572 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:33:53.273565 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:33:53.274567 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:53.275573 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
alter table "f1"."f1_data"."final_historical_analysis__dbt_tmp" rename to "final_historical_analysis"
[0m10:33:53.275573 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:53.276622 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
alter table "f1"."f1_data"."final_session_filters__dbt_tmp" rename to "final_session_filters"
[0m10:33:53.280102 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:33:53.289102 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m10:33:53.292107 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m10:33:53.293105 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
alter table "f1"."f1_data"."final_session_driver_mapping__dbt_tmp" rename to "final_session_driver_mapping"
[0m10:33:53.294188 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:53.295618 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m10:33:53.295618 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:33:53.297823 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m10:33:53.298858 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:33:53.298858 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:33:53.299867 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m10:33:53.300867 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:33:53.301853 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m10:33:53.302906 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m10:33:53.303861 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m10:33:53.304935 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:33:53.306303 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m10:33:53.307330 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m10:33:53.308398 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:53.309399 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m10:33:53.315322 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_car__dbt_backup"
[0m10:33:53.318375 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."final_historical_analysis__dbt_backup"
[0m10:33:53.319323 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m10:33:53.321358 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."final_session_filters__dbt_backup"
[0m10:33:53.324364 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m10:33:53.325372 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m10:33:53.328362 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."final_session_driver_mapping__dbt_backup"
[0m10:33:53.329364 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m10:33:53.329364 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
drop view if exists "f1"."f1_data"."final_car__dbt_backup" cascade
[0m10:33:53.330377 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
drop view if exists "f1"."f1_data"."final_historical_analysis__dbt_backup" cascade
[0m10:33:53.331375 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m10:33:53.331375 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
drop view if exists "f1"."f1_data"."final_session_filters__dbt_backup" cascade
[0m10:33:53.332366 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:33:53.332366 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:53.333332 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
drop view if exists "f1"."f1_data"."final_session_driver_mapping__dbt_backup" cascade
[0m10:33:53.335328 [debug] [Thread-1 (]: On model.f1_analytics.final_car: Close
[0m10:33:53.336322 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:33:53.337693 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: Close
[0m10:33:53.339732 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m10:33:53.341712 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: Close
[0m10:33:53.341712 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD259DE530>]}
[0m10:33:53.342732 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2436D6F0>]}
[0m10:33:53.344739 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: Close
[0m10:33:53.346742 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2445A3B0>]}
[0m10:33:53.347731 [info ] [Thread-1 (]: 1 of 8 OK created sql view model f1_data.final_car ............................. [[32mCREATE VIEW[0m in 0.23s]
[0m10:33:53.348995 [info ] [Thread-2 (]: 2 of 8 OK created sql view model f1_data.final_historical_analysis ............. [[32mCREATE VIEW[0m in 0.23s]
[0m10:33:53.350029 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD259DE8F0>]}
[0m10:33:53.351013 [info ] [Thread-4 (]: 4 of 8 OK created sql view model f1_data.final_session_filters ................. [[32mCREATE VIEW[0m in 0.23s]
[0m10:33:53.353015 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_car
[0m10:33:53.354013 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m10:33:53.355025 [info ] [Thread-3 (]: 3 of 8 OK created sql view model f1_data.final_session_driver_mapping .......... [[32mCREATE VIEW[0m in 0.23s]
[0m10:33:53.356003 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_session_filters
[0m10:33:53.357027 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_mapping
[0m10:33:53.358010 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_tyre_performance
[0m10:33:53.359042 [debug] [Thread-3 (]: Finished running node model.f1_analytics.final_session_driver_mapping
[0m10:33:53.360021 [info ] [Thread-1 (]: 5 of 8 START sql view model f1_data.final_session_mapping ...................... [RUN]
[0m10:33:53.361016 [info ] [Thread-2 (]: 6 of 8 START sql view model f1_data.final_tyre_performance ..................... [RUN]
[0m10:33:53.362013 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_car, now model.f1_analytics.final_session_mapping)
[0m10:33:53.363028 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_historical_analysis, now model.f1_analytics.final_tyre_performance)
[0m10:33:53.363028 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_mapping
[0m10:33:53.364029 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.final_tyre_performance
[0m10:33:53.367103 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_mapping"
[0m10:33:53.371117 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.final_tyre_performance"
[0m10:33:53.373452 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_mapping
[0m10:33:53.377179 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_mapping"
[0m10:33:53.378271 [debug] [Thread-2 (]: Began executing node model.f1_analytics.final_tyre_performance
[0m10:33:53.382261 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.final_tyre_performance"
[0m10:33:53.383853 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:33:53.383853 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: BEGIN
[0m10:33:53.385183 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:33:53.386250 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:53.388309 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: BEGIN
[0m10:33:53.389273 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:33:53.432205 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m10:33:53.433199 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:33:53.433199 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */

  create view "f1"."f1_data"."final_session_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    EXTRACT(YEAR FROM date_start)::text || ' - ' || country_name || ' - ' || session_name AS session_display_name,
    session_key
FROM "f1"."f1_data"."stg_sessions"
  );
[0m10:33:53.434232 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m10:33:53.435289 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:33:53.435289 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */

  create view "f1"."f1_data"."final_tyre_performance__dbt_tmp"
    
    
  as (
    

WITH tire_performance AS (
    SELECT
        circuit_short_name,
        compound,
        team_name,
        driver_number,
        AVG(stint_length) as avg_stint_length,
        MAX(stint_length) as max_stint_length,
        AVG(tyre_age_at_start) as avg_starting_age,
        COUNT(*) as number_of_stints
    FROM "f1"."f1_data"."int_tyre_stint"
    GROUP BY 1,2,3,4
)

SELECT
    circuit_short_name,
    compound,
    round(AVG(avg_stint_length),2) as circuit_compound_avg_stint_length,
    MAX(max_stint_length) as circuit_compound_max_stint_length,
    round(AVG(avg_starting_age),2) as avg_tire_age_start,
    SUM(number_of_stints) as total_stints
FROM tire_performance
GROUP BY 1,2
  );
[0m10:33:53.440506 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m10:33:53.444503 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:33:53.444503 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:33:53.445530 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
alter table "f1"."f1_data"."final_session_mapping__dbt_tmp" rename to "final_session_mapping"
[0m10:33:53.449895 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:33:53.450888 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
alter table "f1"."f1_data"."final_tyre_performance__dbt_tmp" rename to "final_tyre_performance"
[0m10:33:53.450888 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:53.453910 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m10:33:53.453910 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m10:33:53.454895 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:33:53.456893 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m10:33:53.457889 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m10:33:53.457889 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:33:53.458888 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m10:33:53.459888 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:53.460913 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:53.463895 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_session_mapping__dbt_backup"
[0m10:33:53.465893 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."final_tyre_performance__dbt_backup"
[0m10:33:53.466894 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m10:33:53.468913 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m10:33:53.469929 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
drop view if exists "f1"."f1_data"."final_session_mapping__dbt_backup" cascade
[0m10:33:53.470921 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
drop view if exists "f1"."f1_data"."final_tyre_performance__dbt_backup" cascade
[0m10:33:53.471923 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:33:53.472925 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m10:33:53.473946 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: Close
[0m10:33:53.475972 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: Close
[0m10:33:53.476981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD259F1FF0>]}
[0m10:33:53.479115 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2436F0A0>]}
[0m10:33:53.480289 [info ] [Thread-1 (]: 5 of 8 OK created sql view model f1_data.final_session_mapping ................. [[32mCREATE VIEW[0m in 0.11s]
[0m10:33:53.482944 [info ] [Thread-2 (]: 6 of 8 OK created sql view model f1_data.final_tyre_performance ................ [[32mCREATE VIEW[0m in 0.12s]
[0m10:33:53.485025 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_mapping
[0m10:33:53.486046 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_tyre_performance
[0m10:33:53.487043 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m10:33:53.488049 [info ] [Thread-4 (]: 7 of 8 START sql view model f1_data.final_race_leaderboard ..................... [RUN]
[0m10:33:53.489572 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_filters, now model.f1_analytics.final_race_leaderboard)
[0m10:33:53.490593 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_race_leaderboard
[0m10:33:53.495209 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_race_leaderboard"
[0m10:33:53.496212 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_race_leaderboard
[0m10:33:53.500751 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_race_leaderboard"
[0m10:33:53.501748 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:33:53.502748 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: BEGIN
[0m10:33:53.502748 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m10:33:53.550061 [debug] [Thread-4 (]: SQL status: BEGIN in 0.047 seconds
[0m10:33:53.550061 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:33:53.551062 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */

  create view "f1"."f1_data"."final_race_leaderboard__dbt_tmp"
    
    
  as (
    

WITH final_rankings AS (
   SELECT
       session_key,
       driver_number,
       position
   FROM int_final_position
)
SELECT
   fr.session_key,
   d.driver_number,
   d.broadcast_name AS driver_name,
   fr.position,
   d.team_name,
   d.team_colour AS team_color,
   CASE
       WHEN fr.position = 1 THEN 0
       ELSE fi.max_gap_to_leader
   END as gap_to_leader,
   fi.max_gap_to_next as gap_to_next,
   bl.fastest_lap,
   ps.pit_stop_count,

   CASE
       WHEN fr.position = 1 THEN 25
       WHEN fr.position = 2 THEN 18
       WHEN fr.position = 3 THEN 15
       WHEN fr.position = 4 THEN 12
       WHEN fr.position = 5 THEN 10
       WHEN fr.position = 6 THEN 8
       WHEN fr.position = 7 THEN 6
       WHEN fr.position = 8 THEN 4
       WHEN fr.position = 9 THEN 2
       WHEN fr.position = 10 THEN 1
       ELSE 0
   END AS points
FROM final_rankings fr
JOIN "f1"."f1_data"."stg_drivers" d
   ON fr.driver_number = d.driver_number
   AND fr.session_key = d.session_key
LEFT JOIN "f1"."f1_data"."int_final_intervals" fi
   ON fr.session_key = fi.session_key
   AND fr.driver_number = fi.driver_number
LEFT JOIN "f1"."f1_data"."int_best_laps" bl
   ON fr.session_key = bl.session_key
   AND fr.driver_number = bl.driver_number
LEFT JOIN "f1"."f1_data"."int_pit_stop" ps
   ON fr.session_key = ps.session_key
   AND fr.driver_number = ps.driver_number
JOIN "f1"."f1_data"."final_session_mapping" m
   ON fr.session_key = m.session_key
ORDER BY fr.position
  );
[0m10:33:53.560058 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:33:53.563057 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:33:53.564063 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
alter table "f1"."f1_data"."final_race_leaderboard__dbt_tmp" rename to "final_race_leaderboard"
[0m10:33:53.565054 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:53.567067 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m10:33:53.568053 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:33:53.568053 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m10:33:53.570062 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:53.572061 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."final_race_leaderboard__dbt_backup"
[0m10:33:53.573067 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m10:33:53.574063 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
drop view if exists "f1"."f1_data"."final_race_leaderboard__dbt_backup" cascade
[0m10:33:53.575062 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:33:53.576073 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: Close
[0m10:33:53.577076 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD25F26530>]}
[0m10:33:53.577076 [info ] [Thread-4 (]: 7 of 8 OK created sql view model f1_data.final_race_leaderboard ................ [[32mCREATE VIEW[0m in 0.09s]
[0m10:33:53.578335 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m10:33:53.580354 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_summary
[0m10:33:53.581352 [info ] [Thread-1 (]: 8 of 8 START sql view model f1_data.final_race_summary ......................... [RUN]
[0m10:33:53.582355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_mapping, now model.f1_analytics.final_race_summary)
[0m10:33:53.582355 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_summary
[0m10:33:53.585357 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_summary"
[0m10:33:53.586352 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_summary
[0m10:33:53.590976 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_summary"
[0m10:33:53.591972 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:33:53.593390 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: BEGIN
[0m10:33:53.594412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:33:53.635507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.041 seconds
[0m10:33:53.636535 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:33:53.636535 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */

  create view "f1"."f1_data"."final_race_summary__dbt_tmp"
    
    
  as (
    

WITH positions AS (
   SELECT
       session_key,
       COUNT(DISTINCT driver_number) as total_drivers

   FROM "f1"."f1_data"."stg_position"
   GROUP BY session_key
),
laps AS (
   SELECT
       session_key,
       MAX(lap_number) as total_laps
   FROM "f1"."f1_data"."stg_laps"
   GROUP BY session_key
),
team_stats AS (
   SELECT
       session_key,
       SUM(pit_stop_count) as total_pit_stops,
        COUNT(DISTINCT team_name) as total_teams
   FROM "f1"."f1_data"."final_race_leaderboard"
   GROUP BY session_key
),
driver_stats AS (
   SELECT
       session_key,
       driver_number,
       MAX(speed) as top_speed,
       AVG(speed) as avg_speed
   FROM "f1"."f1_data"."stg_car_data"
   GROUP BY session_key, driver_number
),
cte as(
SELECT
   p.session_key,
   m.session_display_name,
   p.total_drivers,
   l.total_laps,
   MAX(d.top_speed) as fastest_speed,
   round(AVG(d.avg_speed),3) as average_speed
FROM positions p
JOIN laps l ON p.session_key = l.session_key
JOIN "f1"."f1_data"."final_session_mapping" m ON p.session_key = m.session_key
LEFT JOIN driver_stats d ON p.session_key = d.session_key
GROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps
)
select c.session_key,
   c.session_display_name,
   c.total_drivers,
    t.total_teams,
   c.total_laps,
   t.total_pit_stops,
    c.fastest_speed,
   c.average_speed
from cte c left join team_stats t on c.session_key=t.session_key
  );
[0m10:33:53.646517 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m10:33:53.653535 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:33:53.654531 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
alter table "f1"."f1_data"."final_race_summary__dbt_tmp" rename to "final_race_summary"
[0m10:33:53.655618 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m10:33:53.656644 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m10:33:53.656644 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:33:53.657642 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m10:33:53.658643 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m10:33:53.661637 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_race_summary__dbt_backup"
[0m10:33:53.662631 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m10:33:53.662631 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
drop view if exists "f1"."f1_data"."final_race_summary__dbt_backup" cascade
[0m10:33:53.663978 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m10:33:53.665002 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: Close
[0m10:33:53.665002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe36f432-0e66-451d-b647-3d8c9ddb6fc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD25F44A30>]}
[0m10:33:53.666810 [info ] [Thread-1 (]: 8 of 8 OK created sql view model f1_data.final_race_summary .................... [[32mCREATE VIEW[0m in 0.08s]
[0m10:33:53.668543 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_summary
[0m10:33:53.671071 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:53.671071 [debug] [MainThread]: On master: BEGIN
[0m10:33:53.671071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:33:53.710582 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m10:33:53.710582 [debug] [MainThread]: On master: COMMIT
[0m10:33:53.711581 [debug] [MainThread]: Using postgres connection "master"
[0m10:33:53.712531 [debug] [MainThread]: On master: COMMIT
[0m10:33:53.712531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m10:33:53.713586 [debug] [MainThread]: On master: Close
[0m10:33:53.714938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:33:53.714938 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m10:33:53.715952 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m10:33:53.715952 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_summary' was properly closed.
[0m10:33:53.716950 [debug] [MainThread]: Connection 'model.f1_analytics.final_tyre_performance' was properly closed.
[0m10:33:53.716950 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_driver_mapping' was properly closed.
[0m10:33:53.717950 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_leaderboard' was properly closed.
[0m10:33:53.717950 [info ] [MainThread]: 
[0m10:33:53.718951 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m10:33:53.720999 [debug] [MainThread]: Command end result
[0m10:33:53.741021 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m10:33:53.742984 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m10:33:53.750028 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m10:33:53.751045 [info ] [MainThread]: 
[0m10:33:53.751955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:33:53.751955 [info ] [MainThread]: 
[0m10:33:53.753072 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m10:33:53.753976 [debug] [MainThread]: Command `dbt run` succeeded at 10:33:53.753976 after 1.58 seconds
[0m10:33:53.755064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD22F8E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD24428400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD2436EB60>]}
[0m10:33:53.755064 [debug] [MainThread]: Flushing usage events
[0m10:33:54.133985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:03.840892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2793E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA29C10F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA29C10D30>]}


============================== 09:52:03.847085 | 7389a40b-5d5c-415b-8f27-3dc15fbf6b9e ==============================
[0m09:52:03.847085 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:52:03.848991 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:52:04.162029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA29CEDD50>]}
[0m09:52:04.227178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA29BDADA0>]}
[0m09:52:04.229179 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:04.782911 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:52:09.532809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:09.532809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:09.589925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2B2E8EE0>]}
[0m09:52:09.733961 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m09:52:09.769264 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m09:52:09.817717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2B241690>]}
[0m09:52:09.817717 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m09:52:09.819745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2B2D4A00>]}
[0m09:52:09.821927 [info ] [MainThread]: 
[0m09:52:09.821927 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:09.822891 [info ] [MainThread]: 
[0m09:52:09.823868 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:09.833855 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m09:52:22.260091 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m09:52:22.261094 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m09:52:22.262132 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:22.306468 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.045 seconds
[0m09:52:22.309791 [debug] [ThreadPool]: On list_f1: Close
[0m09:52:22.317131 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m09:52:22.327640 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m09:52:22.328789 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m09:52:22.329642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:22.381336 [debug] [ThreadPool]: SQL status: BEGIN in 0.051 seconds
[0m09:52:22.382244 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m09:52:22.382244 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m09:52:22.393247 [debug] [ThreadPool]: SQL status: SELECT 38 in 0.010 seconds
[0m09:52:22.396358 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m09:52:22.397244 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m09:52:22.410242 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:22.411249 [debug] [MainThread]: On master: BEGIN
[0m09:52:22.412248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:22.455857 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m09:52:22.456970 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:22.456970 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:22.469864 [debug] [MainThread]: SQL status: SELECT 50 in 0.012 seconds
[0m09:52:22.477977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA29D0ED40>]}
[0m09:52:22.478972 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:22.479974 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:22.480985 [debug] [MainThread]: On master: BEGIN
[0m09:52:22.481887 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:52:22.482865 [debug] [MainThread]: On master: COMMIT
[0m09:52:22.482865 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:22.483863 [debug] [MainThread]: On master: COMMIT
[0m09:52:22.484974 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:22.484974 [debug] [MainThread]: On master: Close
[0m09:52:22.495000 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_car_data
[0m09:52:22.495912 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_drivers
[0m09:52:22.497865 [debug] [Thread-3 (]: Began running node model.f1_analytics.stg_intervals
[0m09:52:22.497865 [debug] [Thread-4 (]: Began running node model.f1_analytics.stg_laps
[0m09:52:22.496863 [info ] [Thread-1 (]: 1 of 10 START sql view model f1_data.stg_car_data .............................. [RUN]
[0m09:52:22.499863 [info ] [Thread-2 (]: 2 of 10 START sql view model f1_data.stg_drivers ............................... [RUN]
[0m09:52:22.500892 [info ] [Thread-3 (]: 3 of 10 START sql view model f1_data.stg_intervals ............................. [RUN]
[0m09:52:22.501901 [info ] [Thread-4 (]: 4 of 10 START sql view model f1_data.stg_laps .................................. [RUN]
[0m09:52:22.502975 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.stg_car_data'
[0m09:52:22.503904 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.stg_drivers'
[0m09:52:22.504922 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.stg_intervals'
[0m09:52:22.507898 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.stg_intervals
[0m09:52:22.505901 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_car_data
[0m09:52:22.506932 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_drivers
[0m09:52:22.505901 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.stg_laps'
[0m09:52:22.519202 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.stg_intervals"
[0m09:52:22.522202 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_car_data"
[0m09:52:22.528719 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_drivers"
[0m09:52:22.529719 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.stg_laps
[0m09:52:22.535244 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.stg_laps"
[0m09:52:22.536245 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_car_data
[0m09:52:22.537246 [debug] [Thread-3 (]: Began executing node model.f1_analytics.stg_intervals
[0m09:52:22.571283 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_drivers
[0m09:52:22.573790 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_car_data"
[0m09:52:22.574859 [debug] [Thread-4 (]: Began executing node model.f1_analytics.stg_laps
[0m09:52:22.579803 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.stg_intervals"
[0m09:52:22.583818 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_drivers"
[0m09:52:22.589803 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.stg_laps"
[0m09:52:22.590804 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m09:52:22.592805 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: BEGIN
[0m09:52:22.592805 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m09:52:22.593805 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:52:22.594806 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m09:52:22.595820 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: BEGIN
[0m09:52:22.595820 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m09:52:22.597480 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: BEGIN
[0m09:52:22.598501 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:52:22.599501 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: BEGIN
[0m09:52:22.600488 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:52:22.601488 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:52:22.659449 [debug] [Thread-1 (]: SQL status: BEGIN in 0.065 seconds
[0m09:52:22.660450 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m09:52:22.661453 [debug] [Thread-3 (]: SQL status: BEGIN in 0.063 seconds
[0m09:52:22.662452 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */

  create view "f1"."f1_data"."stg_car_data__dbt_tmp"
    
    
  as (
    

SELECT
    session_key,
    driver_number,
    date,
    rpm,
    speed,
    throttle,
    brake
FROM "f1"."f1_data"."car_data"
  );
[0m09:52:22.663458 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m09:52:22.664453 [debug] [Thread-2 (]: SQL status: BEGIN in 0.064 seconds
[0m09:52:22.665471 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */

  create view "f1"."f1_data"."stg_intervals__dbt_tmp"
    
    
  as (
    


   SELECT
    session_key,
    driver_number,
    date,
    CASE
        WHEN gap_to_leader = 'None' OR gap_to_leader LIKE '%L%' THEN NULL
        ELSE gap_to_leader
    END AS gap_to_leader,
    CASE
        WHEN interval = 'None' OR interval LIKE '%L%' THEN NULL
        ELSE interval
    END AS gap_to_next
FROM "f1"."f1_data"."intervals"
  );
[0m09:52:22.666452 [debug] [Thread-4 (]: SQL status: BEGIN in 0.065 seconds
[0m09:52:22.667452 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m09:52:22.668452 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m09:52:22.669463 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */

  create view "f1"."f1_data"."stg_drivers__dbt_tmp"
    
    
  as (
    

SELECT
  CAST(driver_number AS INT)           AS driver_number,
  BROADCAST_NAME                       as broadcast_name,
  first_name,
  last_name,
  FULL_NAME                            AS full_name,
  name_acronym,
  team_name,
  team_colour,
  country_code,
  session_key
from "f1"."f1_data"."drivers"
  );
[0m09:52:22.670453 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */

  create view "f1"."f1_data"."stg_laps__dbt_tmp"
    
    
  as (
    

select
    session_key,
    driver_number,
    date_trunc('second', date_start) as date_start,
    date_start + interval '1 second' * lap_duration as date_end,
    lap_duration,
    lap_number,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3
from "f1"."f1_data"."laps"
where lap_duration is not null
  );
[0m09:52:22.676457 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:52:22.676457 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:52:22.686457 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m09:52:22.686457 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:52:22.687840 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m09:52:22.692851 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m09:52:22.693851 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
alter table "f1"."f1_data"."stg_car_data" rename to "stg_car_data__dbt_backup"
[0m09:52:22.698969 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m09:52:22.702995 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m09:52:22.703849 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
alter table "f1"."f1_data"."stg_intervals" rename to "stg_intervals__dbt_backup"
[0m09:52:22.704864 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
alter table "f1"."f1_data"."stg_drivers" rename to "stg_drivers__dbt_backup"
[0m09:52:22.705888 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
alter table "f1"."f1_data"."stg_laps" rename to "stg_laps__dbt_backup"
[0m09:52:22.707851 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:52:22.708856 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:52:22.708856 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:52:22.709846 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:52:22.713854 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m09:52:22.717983 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m09:52:22.721852 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m09:52:22.724856 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m09:52:22.726365 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
alter table "f1"."f1_data"."stg_car_data__dbt_tmp" rename to "stg_car_data"
[0m09:52:22.726365 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
alter table "f1"."f1_data"."stg_intervals__dbt_tmp" rename to "stg_intervals"
[0m09:52:22.727380 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
alter table "f1"."f1_data"."stg_drivers__dbt_tmp" rename to "stg_drivers"
[0m09:52:22.728383 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
alter table "f1"."f1_data"."stg_laps__dbt_tmp" rename to "stg_laps"
[0m09:52:22.730384 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:22.730384 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:22.731382 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:22.743372 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.011 seconds
[0m09:52:22.748501 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: COMMIT
[0m09:52:22.750504 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: COMMIT
[0m09:52:22.752371 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m09:52:22.754509 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: COMMIT
[0m09:52:22.755374 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m09:52:22.755374 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m09:52:22.756440 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m09:52:22.757372 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m09:52:22.758436 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: COMMIT
[0m09:52:22.759506 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: COMMIT
[0m09:52:22.760407 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: COMMIT
[0m09:52:22.761374 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: COMMIT
[0m09:52:22.763578 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m09:52:22.764578 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:52:22.765750 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m09:52:22.771712 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_car_data__dbt_backup"
[0m09:52:22.772715 [debug] [Thread-4 (]: SQL status: COMMIT in 0.009 seconds
[0m09:52:22.776575 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_drivers__dbt_backup"
[0m09:52:22.779707 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."stg_intervals__dbt_backup"
[0m09:52:22.784691 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_car_data"
[0m09:52:22.787709 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."stg_laps__dbt_backup"
[0m09:52:22.788578 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_drivers"
[0m09:52:22.789579 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_intervals"
[0m09:52:22.790577 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_car_data"} */
drop view if exists "f1"."f1_data"."stg_car_data__dbt_backup" cascade
[0m09:52:22.791583 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_laps"
[0m09:52:22.792578 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_drivers"} */
drop view if exists "f1"."f1_data"."stg_drivers__dbt_backup" cascade
[0m09:52:22.793617 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_intervals"} */
drop view if exists "f1"."f1_data"."stg_intervals__dbt_backup" cascade
[0m09:52:22.794577 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_laps"} */
drop view if exists "f1"."f1_data"."stg_laps__dbt_backup" cascade
[0m09:52:22.798575 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m09:52:22.801595 [debug] [Thread-1 (]: On model.f1_analytics.stg_car_data: Close
[0m09:52:22.802692 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m09:52:22.806584 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.011 seconds
[0m09:52:22.807584 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.011 seconds
[0m09:52:22.809582 [debug] [Thread-2 (]: On model.f1_analytics.stg_drivers: Close
[0m09:52:22.812687 [debug] [Thread-3 (]: On model.f1_analytics.stg_intervals: Close
[0m09:52:22.813623 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA28C3BF40>]}
[0m09:52:22.814583 [debug] [Thread-4 (]: On model.f1_analytics.stg_laps: Close
[0m09:52:22.816593 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2B83E6E0>]}
[0m09:52:22.817615 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA25D7CF10>]}
[0m09:52:22.819584 [info ] [Thread-1 (]: 1 of 10 OK created sql view model f1_data.stg_car_data ......................... [[32mCREATE VIEW[0m in 0.30s]
[0m09:52:22.821091 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA299AABC0>]}
[0m09:52:22.822098 [info ] [Thread-2 (]: 2 of 10 OK created sql view model f1_data.stg_drivers .......................... [[32mCREATE VIEW[0m in 0.31s]
[0m09:52:22.826099 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_car_data
[0m09:52:22.824102 [info ] [Thread-3 (]: 3 of 10 OK created sql view model f1_data.stg_intervals ........................ [[32mCREATE VIEW[0m in 0.31s]
[0m09:52:22.827610 [info ] [Thread-4 (]: 4 of 10 OK created sql view model f1_data.stg_laps ............................. [[32mCREATE VIEW[0m in 0.32s]
[0m09:52:22.829611 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_drivers
[0m09:52:22.830672 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_meeting
[0m09:52:22.831448 [debug] [Thread-3 (]: Finished running node model.f1_analytics.stg_intervals
[0m09:52:22.832454 [debug] [Thread-4 (]: Finished running node model.f1_analytics.stg_laps
[0m09:52:22.832454 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_pit
[0m09:52:22.835221 [debug] [Thread-3 (]: Began running node model.f1_analytics.stg_position
[0m09:52:22.834234 [info ] [Thread-1 (]: 5 of 10 START sql view model f1_data.stg_meeting ............................... [RUN]
[0m09:52:22.836216 [debug] [Thread-4 (]: Began running node model.f1_analytics.stg_sessions
[0m09:52:22.837342 [info ] [Thread-2 (]: 6 of 10 START sql view model f1_data.stg_pit ................................... [RUN]
[0m09:52:22.838318 [info ] [Thread-3 (]: 7 of 10 START sql view model f1_data.stg_position .............................. [RUN]
[0m09:52:22.840224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_car_data, now model.f1_analytics.stg_meeting)
[0m09:52:22.842257 [info ] [Thread-4 (]: 8 of 10 START sql view model f1_data.stg_sessions .............................. [RUN]
[0m09:52:22.844227 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_drivers, now model.f1_analytics.stg_pit)
[0m09:52:22.845230 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_intervals, now model.f1_analytics.stg_position)
[0m09:52:22.846224 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_meeting
[0m09:52:22.847739 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_laps, now model.f1_analytics.stg_sessions)
[0m09:52:22.848746 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_pit
[0m09:52:22.849761 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.stg_position
[0m09:52:22.853746 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_meeting"
[0m09:52:22.854746 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.stg_sessions
[0m09:52:22.859745 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_pit"
[0m09:52:22.862745 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.stg_position"
[0m09:52:22.867295 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.stg_sessions"
[0m09:52:22.868283 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_meeting
[0m09:52:22.878281 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_meeting"
[0m09:52:22.879283 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_pit
[0m09:52:22.880283 [debug] [Thread-4 (]: Began executing node model.f1_analytics.stg_sessions
[0m09:52:22.881282 [debug] [Thread-3 (]: Began executing node model.f1_analytics.stg_position
[0m09:52:22.882312 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m09:52:22.887297 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_pit"
[0m09:52:22.893298 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.stg_sessions"
[0m09:52:22.897295 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.stg_position"
[0m09:52:22.898295 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: BEGIN
[0m09:52:22.900282 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m09:52:22.902292 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m09:52:22.903282 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:22.904283 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m09:52:22.905282 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: BEGIN
[0m09:52:22.906300 [debug] [Thread-4 (]: On model.f1_analytics.stg_sessions: BEGIN
[0m09:52:22.907285 [debug] [Thread-3 (]: On model.f1_analytics.stg_position: BEGIN
[0m09:52:22.909284 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:52:22.910289 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:52:22.911280 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:52:22.965140 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m09:52:22.966142 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m09:52:22.966142 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */

  create view "f1"."f1_data"."stg_meeting__dbt_tmp"
    
    
  as (
    

    select
            meeting_key,
            meeting_name,
            meeting_official_name,
            country_name,
            circuit_short_name,
            date_start,
            year
from "f1"."f1_data"."meetings"
  );
[0m09:52:22.972146 [debug] [Thread-2 (]: SQL status: BEGIN in 0.063 seconds
[0m09:52:22.973652 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m09:52:22.974661 [debug] [Thread-4 (]: SQL status: BEGIN in 0.064 seconds
[0m09:52:22.975689 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */

  create view "f1"."f1_data"."stg_pit__dbt_tmp"
    
    
  as (
    

    select *
    from "f1"."f1_data"."pit"
    where pit_duration is not null
  );
[0m09:52:22.975689 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:52:22.976663 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m09:52:22.977661 [debug] [Thread-3 (]: SQL status: BEGIN in 0.066 seconds
[0m09:52:22.981663 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m09:52:22.982662 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m09:52:22.983676 [debug] [Thread-4 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */

  create view "f1"."f1_data"."stg_sessions__dbt_tmp"
    
    
  as (
    





















WITH source AS (
    SELECT
        session_key,
        meeting_key,
        country_name,
        session_name,
        session_type,
        year,
        circuit_short_name,
        date_start,
        date_end
    FROM "f1"."f1_data"."sessions"
)
SELECT * FROM source
  );
[0m09:52:22.983676 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m09:52:22.984676 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
alter table "f1"."f1_data"."stg_meeting" rename to "stg_meeting__dbt_backup"
[0m09:52:22.987673 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m09:52:22.988672 [debug] [Thread-3 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */

  create view "f1"."f1_data"."stg_position__dbt_tmp"
    
    
  as (
    

    WITH source AS (
    SELECT * FROM "f1"."f1_data"."position"
)
SELECT
    session_key,
    driver_number,
    position,
    date
FROM source
  );
[0m09:52:22.990661 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
alter table "f1"."f1_data"."stg_pit" rename to "stg_pit__dbt_backup"
[0m09:52:22.990661 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:22.996665 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m09:52:22.997724 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:52:22.997724 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m09:52:22.998709 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
alter table "f1"."f1_data"."stg_meeting__dbt_tmp" rename to "stg_meeting"
[0m09:52:22.999666 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:52:23.002774 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m09:52:23.007780 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m09:52:23.012870 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m09:52:23.013787 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m09:52:23.014838 [debug] [Thread-4 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
alter table "f1"."f1_data"."stg_sessions" rename to "stg_sessions__dbt_backup"
[0m09:52:23.014838 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
alter table "f1"."f1_data"."stg_pit__dbt_tmp" rename to "stg_pit"
[0m09:52:23.015766 [debug] [Thread-3 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
alter table "f1"."f1_data"."stg_position" rename to "stg_position__dbt_backup"
[0m09:52:23.018768 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: COMMIT
[0m09:52:23.020771 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:23.021869 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:52:23.022768 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:23.023792 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m09:52:23.027646 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m09:52:23.029617 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: COMMIT
[0m09:52:23.033633 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m09:52:23.034524 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: COMMIT
[0m09:52:23.035525 [debug] [Thread-4 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
alter table "f1"."f1_data"."stg_sessions__dbt_tmp" rename to "stg_sessions"
[0m09:52:23.036524 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m09:52:23.037588 [debug] [Thread-3 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
alter table "f1"."f1_data"."stg_position__dbt_tmp" rename to "stg_position"
[0m09:52:23.039539 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: COMMIT
[0m09:52:23.041540 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m09:52:23.043539 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m09:52:23.045527 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:23.048629 [debug] [Thread-4 (]: On model.f1_analytics.stg_sessions: COMMIT
[0m09:52:23.049525 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m09:52:23.053521 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_meeting__dbt_backup"
[0m09:52:23.055654 [debug] [Thread-3 (]: On model.f1_analytics.stg_position: COMMIT
[0m09:52:23.056539 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m09:52:23.060520 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_pit__dbt_backup"
[0m09:52:23.061585 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_meeting"
[0m09:52:23.062643 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m09:52:23.063649 [debug] [Thread-4 (]: On model.f1_analytics.stg_sessions: COMMIT
[0m09:52:23.064524 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_pit"
[0m09:52:23.065522 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_meeting"} */
drop view if exists "f1"."f1_data"."stg_meeting__dbt_backup" cascade
[0m09:52:23.066536 [debug] [Thread-3 (]: On model.f1_analytics.stg_position: COMMIT
[0m09:52:23.067529 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_pit"} */
drop view if exists "f1"."f1_data"."stg_pit__dbt_backup" cascade
[0m09:52:23.068545 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m09:52:23.069576 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:23.070562 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:52:23.071522 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:52:23.074636 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."stg_sessions__dbt_backup"
[0m09:52:23.077623 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."stg_position__dbt_backup"
[0m09:52:23.079521 [debug] [Thread-1 (]: On model.f1_analytics.stg_meeting: Close
[0m09:52:23.081619 [debug] [Thread-2 (]: On model.f1_analytics.stg_pit: Close
[0m09:52:23.082524 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.stg_sessions"
[0m09:52:23.084619 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.stg_position"
[0m09:52:23.085560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA28C3BF40>]}
[0m09:52:23.088656 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2B83E6E0>]}
[0m09:52:23.091541 [debug] [Thread-4 (]: On model.f1_analytics.stg_sessions: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_sessions"} */
drop view if exists "f1"."f1_data"."stg_sessions__dbt_backup" cascade
[0m09:52:23.093614 [debug] [Thread-3 (]: On model.f1_analytics.stg_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_position"} */
drop view if exists "f1"."f1_data"."stg_position__dbt_backup" cascade
[0m09:52:23.098644 [info ] [Thread-1 (]: 5 of 10 OK created sql view model f1_data.stg_meeting .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m09:52:23.101529 [info ] [Thread-2 (]: 6 of 10 OK created sql view model f1_data.stg_pit .............................. [[32mCREATE VIEW[0m in 0.24s]
[0m09:52:23.109525 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_meeting
[0m09:52:23.111526 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m09:52:23.113539 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m09:52:23.116544 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_pit
[0m09:52:23.118539 [debug] [Thread-1 (]: Began running node model.f1_analytics.stg_stints
[0m09:52:23.123543 [debug] [Thread-4 (]: On model.f1_analytics.stg_sessions: Close
[0m09:52:23.127051 [debug] [Thread-3 (]: On model.f1_analytics.stg_position: Close
[0m09:52:23.128057 [debug] [Thread-2 (]: Began running node model.f1_analytics.stg_weather
[0m09:52:23.130057 [info ] [Thread-1 (]: 9 of 10 START sql view model f1_data.stg_stints ................................ [RUN]
[0m09:52:23.132057 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2B7E1FF0>]}
[0m09:52:23.133059 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA28C3A0B0>]}
[0m09:52:23.135059 [info ] [Thread-2 (]: 10 of 10 START sql view model f1_data.stg_weather .............................. [RUN]
[0m09:52:23.137061 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_meeting, now model.f1_analytics.stg_stints)
[0m09:52:23.140067 [info ] [Thread-4 (]: 8 of 10 OK created sql view model f1_data.stg_sessions ......................... [[32mCREATE VIEW[0m in 0.28s]
[0m09:52:23.142068 [info ] [Thread-3 (]: 7 of 10 OK created sql view model f1_data.stg_position ......................... [[32mCREATE VIEW[0m in 0.29s]
[0m09:52:23.144066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.stg_pit, now model.f1_analytics.stg_weather)
[0m09:52:23.145066 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.stg_stints
[0m09:52:23.146065 [debug] [Thread-4 (]: Finished running node model.f1_analytics.stg_sessions
[0m09:52:23.147064 [debug] [Thread-3 (]: Finished running node model.f1_analytics.stg_position
[0m09:52:23.148065 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.stg_weather
[0m09:52:23.153065 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.stg_stints"
[0m09:52:23.158589 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.stg_weather"
[0m09:52:23.161589 [debug] [Thread-1 (]: Began executing node model.f1_analytics.stg_stints
[0m09:52:23.166589 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.stg_stints"
[0m09:52:23.167589 [debug] [Thread-2 (]: Began executing node model.f1_analytics.stg_weather
[0m09:52:23.174107 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.stg_weather"
[0m09:52:23.176610 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m09:52:23.176610 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: BEGIN
[0m09:52:23.177615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:23.178615 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m09:52:23.179616 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: BEGIN
[0m09:52:23.179616 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:52:23.220352 [debug] [Thread-1 (]: SQL status: BEGIN in 0.043 seconds
[0m09:52:23.221351 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m09:52:23.221351 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */

  create view "f1"."f1_data"."stg_stints__dbt_tmp"
    
    
  as (
    

    select *
    from "f1"."f1_data"."stints"
    where compound is not null and lap_start is not null and lap_end is not null
  );
[0m09:52:23.228699 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:52:23.233700 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m09:52:23.234728 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
alter table "f1"."f1_data"."stg_stints" rename to "stg_stints__dbt_backup"
[0m09:52:23.235790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:23.238699 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m09:52:23.238699 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
alter table "f1"."f1_data"."stg_stints__dbt_tmp" rename to "stg_stints"
[0m09:52:23.239702 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:23.241703 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: COMMIT
[0m09:52:23.242708 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m09:52:23.242708 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: COMMIT
[0m09:52:23.244705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:23.246811 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."stg_stints__dbt_backup"
[0m09:52:23.247839 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.stg_stints"
[0m09:52:23.248740 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_stints"} */
drop view if exists "f1"."f1_data"."stg_stints__dbt_backup" cascade
[0m09:52:23.250809 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:52:23.251706 [debug] [Thread-1 (]: On model.f1_analytics.stg_stints: Close
[0m09:52:23.252701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA28C3BF40>]}
[0m09:52:23.254699 [info ] [Thread-1 (]: 9 of 10 OK created sql view model f1_data.stg_stints ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m09:52:23.255704 [debug] [Thread-1 (]: Finished running node model.f1_analytics.stg_stints
[0m09:52:23.333488 [debug] [Thread-2 (]: SQL status: BEGIN in 0.154 seconds
[0m09:52:23.334479 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m09:52:23.335482 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */

  create view "f1"."f1_data"."stg_weather__dbt_tmp"
    
    
  as (
    


select *
FROM "f1"."f1_data"."weather"
  );
[0m09:52:23.343530 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:52:23.347479 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m09:52:23.348482 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
alter table "f1"."f1_data"."stg_weather" rename to "stg_weather__dbt_backup"
[0m09:52:23.348482 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:52:23.351619 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m09:52:23.352618 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
alter table "f1"."f1_data"."stg_weather__dbt_tmp" rename to "stg_weather"
[0m09:52:23.353483 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m09:52:23.355481 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: COMMIT
[0m09:52:23.356482 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m09:52:23.356482 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: COMMIT
[0m09:52:23.358585 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:23.360482 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."stg_weather__dbt_backup"
[0m09:52:23.361481 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.stg_weather"
[0m09:52:23.362479 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.stg_weather"} */
drop view if exists "f1"."f1_data"."stg_weather__dbt_backup" cascade
[0m09:52:23.364479 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:52:23.365478 [debug] [Thread-2 (]: On model.f1_analytics.stg_weather: Close
[0m09:52:23.366479 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7389a40b-5d5c-415b-8f27-3dc15fbf6b9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2B9B49D0>]}
[0m09:52:23.367483 [info ] [Thread-2 (]: 10 of 10 OK created sql view model f1_data.stg_weather ......................... [[32mCREATE VIEW[0m in 0.22s]
[0m09:52:23.368482 [debug] [Thread-2 (]: Finished running node model.f1_analytics.stg_weather
[0m09:52:23.373482 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:23.374483 [debug] [MainThread]: On master: BEGIN
[0m09:52:23.375486 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:23.426994 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m09:52:23.428521 [debug] [MainThread]: On master: COMMIT
[0m09:52:23.428521 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:23.429528 [debug] [MainThread]: On master: COMMIT
[0m09:52:23.430531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:23.431531 [debug] [MainThread]: On master: Close
[0m09:52:23.432536 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:23.432536 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m09:52:23.433532 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m09:52:23.434528 [debug] [MainThread]: Connection 'model.f1_analytics.stg_stints' was properly closed.
[0m09:52:23.434528 [debug] [MainThread]: Connection 'model.f1_analytics.stg_weather' was properly closed.
[0m09:52:23.435528 [debug] [MainThread]: Connection 'model.f1_analytics.stg_position' was properly closed.
[0m09:52:23.435528 [debug] [MainThread]: Connection 'model.f1_analytics.stg_sessions' was properly closed.
[0m09:52:23.436533 [info ] [MainThread]: 
[0m09:52:23.437535 [info ] [MainThread]: Finished running 10 view models in 0 hours 0 minutes and 13.61 seconds (13.61s).
[0m09:52:23.439567 [debug] [MainThread]: Command end result
[0m09:52:23.474132 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m09:52:23.477112 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m09:52:23.485126 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m09:52:23.486112 [info ] [MainThread]: 
[0m09:52:23.487113 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:23.488120 [info ] [MainThread]: 
[0m09:52:23.489112 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m09:52:23.490114 [debug] [MainThread]: Command `dbt run` succeeded at 09:52:23.490114 after 19.83 seconds
[0m09:52:23.491113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2793E350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2B2E9660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA2B2E95D0>]}
[0m09:52:23.491113 [debug] [MainThread]: Flushing usage events
[0m09:52:23.978792 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:29.204062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C3E3E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C5140F10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C5140D30>]}


============================== 09:52:29.209213 | c8aabe46-67d1-4444-baed-44dd5b03d33f ==============================
[0m09:52:29.209213 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:52:29.209213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:52:29.398700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C52DAAD0>]}
[0m09:52:29.463751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C4EB3DC0>]}
[0m09:52:29.468053 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:29.649532 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:52:29.821866 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:29.822867 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:29.879416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6818EB0>]}
[0m09:52:30.026655 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m09:52:30.030689 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m09:52:30.068691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C68422C0>]}
[0m09:52:30.069805 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m09:52:30.070692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C684F700>]}
[0m09:52:30.072698 [info ] [MainThread]: 
[0m09:52:30.073693 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:30.075202 [info ] [MainThread]: 
[0m09:52:30.076217 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:30.085222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m09:52:30.143885 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m09:52:30.143885 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m09:52:30.144872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:30.190081 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.045 seconds
[0m09:52:30.191081 [debug] [ThreadPool]: On list_f1: Close
[0m09:52:30.196079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m09:52:30.201592 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m09:52:30.202297 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m09:52:30.203318 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:30.241835 [debug] [ThreadPool]: SQL status: BEGIN in 0.039 seconds
[0m09:52:30.242832 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m09:52:30.242832 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m09:52:30.251297 [debug] [ThreadPool]: SQL status: SELECT 21 in 0.007 seconds
[0m09:52:30.252307 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m09:52:30.254302 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m09:52:30.262414 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:30.263415 [debug] [MainThread]: On master: BEGIN
[0m09:52:30.263415 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:30.422945 [debug] [MainThread]: SQL status: BEGIN in 0.159 seconds
[0m09:52:30.424060 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:30.424060 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:30.437104 [debug] [MainThread]: SQL status: SELECT 10 in 0.012 seconds
[0m09:52:30.440203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6723B20>]}
[0m09:52:30.441170 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:30.442113 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:30.442113 [debug] [MainThread]: On master: BEGIN
[0m09:52:30.443164 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m09:52:30.444148 [debug] [MainThread]: On master: COMMIT
[0m09:52:30.444148 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:30.444148 [debug] [MainThread]: On master: COMMIT
[0m09:52:30.445533 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:30.446539 [debug] [MainThread]: On master: Close
[0m09:52:30.454426 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_best_laps
[0m09:52:30.454426 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_car_base
[0m09:52:30.455759 [debug] [Thread-3 (]: Began running node model.f1_analytics.int_final_intervals
[0m09:52:30.456822 [debug] [Thread-4 (]: Began running node model.f1_analytics.int_final_position
[0m09:52:30.455759 [info ] [Thread-1 (]: 1 of 9 START sql view model f1_data.int_best_laps .............................. [RUN]
[0m09:52:30.457772 [info ] [Thread-2 (]: 2 of 9 START sql view model f1_data.int_car_base ............................... [RUN]
[0m09:52:30.458771 [info ] [Thread-3 (]: 3 of 9 START sql view model f1_data.int_final_intervals ........................ [RUN]
[0m09:52:30.461164 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.int_best_laps'
[0m09:52:30.460131 [info ] [Thread-4 (]: 4 of 9 START sql view model f1_data.int_final_position ......................... [RUN]
[0m09:52:30.462137 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.int_car_base'
[0m09:52:30.463144 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.int_final_intervals'
[0m09:52:30.463144 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_best_laps
[0m09:52:30.464482 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.int_final_position'
[0m09:52:30.465489 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_car_base
[0m09:52:30.465489 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.int_final_intervals
[0m09:52:30.477199 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_best_laps"
[0m09:52:30.478198 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.int_final_position
[0m09:52:30.481196 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_car_base"
[0m09:52:30.486684 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.int_final_intervals"
[0m09:52:30.492686 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.int_final_position"
[0m09:52:30.493771 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_best_laps
[0m09:52:30.494690 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_car_base
[0m09:52:30.513995 [debug] [Thread-3 (]: Began executing node model.f1_analytics.int_final_intervals
[0m09:52:30.536089 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_best_laps"
[0m09:52:30.537087 [debug] [Thread-4 (]: Began executing node model.f1_analytics.int_final_position
[0m09:52:30.542084 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_car_base"
[0m09:52:30.546085 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.int_final_intervals"
[0m09:52:30.549987 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.int_final_position"
[0m09:52:30.551988 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m09:52:30.552994 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m09:52:30.553709 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: BEGIN
[0m09:52:30.554817 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m09:52:30.555716 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: BEGIN
[0m09:52:30.555716 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m09:52:30.556727 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:52:30.557567 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: BEGIN
[0m09:52:30.557567 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:52:30.559026 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: BEGIN
[0m09:52:30.560105 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:52:30.562112 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:52:30.612242 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m09:52:30.613235 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m09:52:30.614234 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */

  create view "f1"."f1_data"."int_best_laps__dbt_tmp"
    
    
  as (
    

select
        session_key,
        driver_number,
        min(lap_duration) as fastest_lap
from "f1"."f1_data"."stg_laps"
group by 1,2
  );
[0m09:52:30.615547 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m09:52:30.616555 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m09:52:30.617558 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */

  create view "f1"."f1_data"."int_car_base__dbt_tmp"
    
    
  as (
    

SELECT
   ts.driver_number,
   ts.session_key,
   d.name_acronym,
   d.team_name,
   d.team_colour,
   ts.date,
   ts.rpm,
   ts.speed,
   ts.throttle,
   ts.brake
FROM "f1"."f1_data"."stg_car_data" ts
LEFT JOIN "f1"."f1_data"."stg_drivers" d
   ON ts.driver_number = d.driver_number
   AND ts.session_key = d.session_key
  );
[0m09:52:30.620556 [debug] [Thread-3 (]: SQL status: BEGIN in 0.060 seconds
[0m09:52:30.621976 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m09:52:30.621976 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m09:52:30.628988 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m09:52:30.629987 [debug] [Thread-4 (]: SQL status: BEGIN in 0.068 seconds
[0m09:52:30.630994 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m09:52:30.630994 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */

  create view "f1"."f1_data"."int_final_intervals__dbt_tmp"
    
    
  as (
    SELECT
    session_key,
    driver_number,
    MAX(CASE
        WHEN gap_to_leader LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_leader AS FLOAT)
    END) AS max_gap_to_leader,
    MAX(CASE
        WHEN gap_to_next LIKE '%L%' THEN NULL
        ELSE CAST(gap_to_next AS FLOAT)
    END) AS max_gap_to_next
FROM "f1"."f1_data"."stg_intervals"
GROUP BY session_key, driver_number
  );
[0m09:52:30.631996 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */
alter table "f1"."f1_data"."int_best_laps__dbt_tmp" rename to "int_best_laps"
[0m09:52:30.632990 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m09:52:30.637090 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m09:52:30.638015 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */

  create view "f1"."f1_data"."int_final_position__dbt_tmp"
    
    
  as (
    

WITH ranked AS (
    SELECT
        session_key,
        driver_number,
        position,
        date AS latest_date,
        ROW_NUMBER() OVER (
            PARTITION BY session_key, driver_number
            ORDER BY date DESC
        ) AS rn
    FROM "f1"."f1_data"."stg_position"
)
SELECT
    session_key,
    driver_number,
    position,
    latest_date
FROM ranked
WHERE rn = 1
  );
[0m09:52:30.639170 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:30.640178 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
alter table "f1"."f1_data"."int_car_base__dbt_tmp" rename to "int_car_base"
[0m09:52:30.653935 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: COMMIT
[0m09:52:30.654838 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m09:52:30.655838 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:52:30.655838 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:30.656877 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m09:52:30.660014 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m09:52:30.663356 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m09:52:30.665052 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: COMMIT
[0m09:52:30.665556 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: COMMIT
[0m09:52:30.665556 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */
alter table "f1"."f1_data"."int_final_intervals__dbt_tmp" rename to "int_final_intervals"
[0m09:52:30.666640 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */
alter table "f1"."f1_data"."int_final_position__dbt_tmp" rename to "int_final_position"
[0m09:52:30.667568 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m09:52:30.668571 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: COMMIT
[0m09:52:30.669572 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:30.670570 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:30.670570 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:52:30.677583 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_best_laps__dbt_backup"
[0m09:52:30.677583 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m09:52:30.679697 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: COMMIT
[0m09:52:30.681583 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: COMMIT
[0m09:52:30.686384 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_best_laps"
[0m09:52:30.689130 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."int_car_base__dbt_backup"
[0m09:52:30.690042 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m09:52:30.690653 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m09:52:30.691427 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_best_laps"} */
drop view if exists "f1"."f1_data"."int_best_laps__dbt_backup" cascade
[0m09:52:30.692105 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_car_base"
[0m09:52:30.693069 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: COMMIT
[0m09:52:30.694093 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: COMMIT
[0m09:52:30.694093 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_car_base"} */
drop view if exists "f1"."f1_data"."int_car_base__dbt_backup" cascade
[0m09:52:30.695499 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:52:30.699531 [debug] [Thread-1 (]: On model.f1_analytics.int_best_laps: Close
[0m09:52:30.699531 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:52:30.700518 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m09:52:30.700518 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m09:52:30.705222 [debug] [Thread-2 (]: On model.f1_analytics.int_car_base: Close
[0m09:52:30.708236 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."int_final_intervals__dbt_backup"
[0m09:52:30.708236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6895870>]}
[0m09:52:30.711337 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."int_final_position__dbt_backup"
[0m09:52:30.711337 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6BFE560>]}
[0m09:52:30.712792 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_final_intervals"
[0m09:52:30.714802 [info ] [Thread-1 (]: 1 of 9 OK created sql view model f1_data.int_best_laps ......................... [[32mCREATE VIEW[0m in 0.24s]
[0m09:52:30.715799 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_final_position"
[0m09:52:30.717521 [info ] [Thread-2 (]: 2 of 9 OK created sql view model f1_data.int_car_base .......................... [[32mCREATE VIEW[0m in 0.25s]
[0m09:52:30.718528 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_intervals"} */
drop view if exists "f1"."f1_data"."int_final_intervals__dbt_backup" cascade
[0m09:52:30.719528 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_best_laps
[0m09:52:30.720528 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_final_position"} */
drop view if exists "f1"."f1_data"."int_final_position__dbt_backup" cascade
[0m09:52:30.721526 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_car_base
[0m09:52:30.723528 [debug] [Thread-1 (]: Began running node model.f1_analytics.int_lap_position
[0m09:52:30.723528 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:52:30.724593 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_pit_stop
[0m09:52:30.725551 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:52:30.727590 [debug] [Thread-3 (]: On model.f1_analytics.int_final_intervals: Close
[0m09:52:30.726528 [info ] [Thread-1 (]: 5 of 9 START sql view model f1_data.int_lap_position ........................... [RUN]
[0m09:52:30.728595 [info ] [Thread-2 (]: 6 of 9 START sql view model f1_data.int_pit_stop ............................... [RUN]
[0m09:52:30.730529 [debug] [Thread-4 (]: On model.f1_analytics.int_final_position: Close
[0m09:52:30.731579 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C688FEE0>]}
[0m09:52:30.732545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_best_laps, now model.f1_analytics.int_lap_position)
[0m09:52:30.734530 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_car_base, now model.f1_analytics.int_pit_stop)
[0m09:52:30.736532 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6DCFAC0>]}
[0m09:52:30.737535 [info ] [Thread-3 (]: 3 of 9 OK created sql view model f1_data.int_final_intervals ................... [[32mCREATE VIEW[0m in 0.27s]
[0m09:52:30.738529 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.int_lap_position
[0m09:52:30.739584 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_pit_stop
[0m09:52:30.741662 [info ] [Thread-4 (]: 4 of 9 OK created sql view model f1_data.int_final_position .................... [[32mCREATE VIEW[0m in 0.27s]
[0m09:52:30.742591 [debug] [Thread-3 (]: Finished running node model.f1_analytics.int_final_intervals
[0m09:52:30.746720 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.int_lap_position"
[0m09:52:30.755954 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_pit_stop"
[0m09:52:30.757956 [debug] [Thread-4 (]: Finished running node model.f1_analytics.int_final_position
[0m09:52:30.758960 [debug] [Thread-3 (]: Began running node model.f1_analytics.int_tyre_stint
[0m09:52:30.761968 [debug] [Thread-4 (]: Began running node model.f1_analytics.int_tyre_stint_laps
[0m09:52:30.762981 [debug] [Thread-1 (]: Began executing node model.f1_analytics.int_lap_position
[0m09:52:30.764969 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_pit_stop
[0m09:52:30.763966 [info ] [Thread-3 (]: 7 of 9 START sql view model f1_data.int_tyre_stint ............................. [RUN]
[0m09:52:30.766976 [info ] [Thread-4 (]: 8 of 9 START sql view model f1_data.int_tyre_stint_laps ........................ [RUN]
[0m09:52:30.777096 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.int_lap_position"
[0m09:52:30.785096 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_pit_stop"
[0m09:52:30.787099 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_final_intervals, now model.f1_analytics.int_tyre_stint)
[0m09:52:30.788093 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_final_position, now model.f1_analytics.int_tyre_stint_laps)
[0m09:52:30.790097 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.int_tyre_stint
[0m09:52:30.790097 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m09:52:30.791224 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m09:52:30.792097 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.int_tyre_stint_laps
[0m09:52:30.796093 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint"
[0m09:52:30.797097 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: BEGIN
[0m09:52:30.798096 [debug] [Thread-2 (]: On model.f1_analytics.int_pit_stop: BEGIN
[0m09:52:30.805191 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stint_laps"
[0m09:52:30.806165 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:30.807154 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:52:30.808161 [debug] [Thread-3 (]: Began executing node model.f1_analytics.int_tyre_stint
[0m09:52:30.811095 [debug] [Thread-4 (]: Began executing node model.f1_analytics.int_tyre_stint_laps
[0m09:52:30.817093 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint"
[0m09:52:30.828468 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stint_laps"
[0m09:52:30.830999 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m09:52:30.832027 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m09:52:30.833030 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: BEGIN
[0m09:52:30.834031 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: BEGIN
[0m09:52:30.835031 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:52:30.836027 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:52:30.864136 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m09:52:30.865145 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m09:52:30.867146 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */

  create view "f1"."f1_data"."int_lap_position__dbt_tmp"
    
    
  as (
    

WITH positions AS (
    SELECT
        p.session_key,
        p.driver_number,
        p.position,
        p.date,
        l.lap_number,
        l.date_start,
        l.date_end,
        ABS(EXTRACT(EPOCH FROM (p.date - l.date_start))) AS start_time_diff,
        ABS(EXTRACT(EPOCH FROM (p.date - l.date_end)))   AS end_time_diff
    FROM "f1"."f1_data"."stg_position" p
    JOIN "f1"."f1_data"."stg_laps" l
        ON p.session_key = l.session_key
        AND p.driver_number = l.driver_number
    WHERE p.date BETWEEN l.date_start AND l.date_end
)
SELECT *,
    ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number, lap_number
        ORDER BY start_time_diff
    ) AS start_position_rank,
    ROW_NUMBER() OVER (
        PARTITION BY session_key, driver_number, lap_number
        ORDER BY end_time_diff
    ) AS end_position_rank
FROM positions
  );
[0m09:52:30.868594 [debug] [Thread-2 (]: SQL status: BEGIN in 0.062 seconds
[0m09:52:30.869603 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m09:52:30.870603 [debug] [Thread-2 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */

  create view "f1"."f1_data"."int_pit_stop__dbt_tmp"
    
    
  as (
    

SELECT
    session_key,
    driver_number,
    COUNT(*) AS pit_stop_count
FROM "f1"."f1_data"."stg_pit"
GROUP BY session_key, driver_number
  );
[0m09:52:30.878507 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:52:30.879510 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m09:52:30.885506 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m09:52:30.889505 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m09:52:30.890865 [debug] [Thread-2 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */
alter table "f1"."f1_data"."int_pit_stop__dbt_tmp" rename to "int_pit_stop"
[0m09:52:30.891878 [debug] [Thread-3 (]: SQL status: BEGIN in 0.057 seconds
[0m09:52:30.891878 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */
alter table "f1"."f1_data"."int_lap_position__dbt_tmp" rename to "int_lap_position"
[0m09:52:30.892879 [debug] [Thread-4 (]: SQL status: BEGIN in 0.057 seconds
[0m09:52:30.893875 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m09:52:30.894873 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:30.894873 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m09:52:30.895875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:30.896875 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */

  create view "f1"."f1_data"."int_tyre_stint__dbt_tmp"
    
    
  as (
    

WITH stints_base AS (
    SELECT
        s.*,
        d.team_name,
        ses.circuit_short_name,
        ses.country_name,
        ses.session_type
    FROM "f1"."f1_data"."stg_stints" s
    LEFT JOIN "f1"."f1_data"."stg_drivers" d ON s.driver_number = d.driver_number
        AND s.session_key = d.session_key
    LEFT JOIN "f1"."f1_data"."stg_sessions" ses ON s.session_key = ses.session_key
    WHERE ses.session_type = 'Race' -- Focus on race sessions
),

stint_durations AS (
    SELECT
        *,
        lap_end - lap_start + 1 as stint_length
    FROM stints_base
)

SELECT * FROM stint_durations
  );
[0m09:52:30.898874 [debug] [Thread-2 (]: On model.f1_analytics.int_pit_stop: COMMIT
[0m09:52:30.899873 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */

  create view "f1"."f1_data"."int_tyre_stint_laps__dbt_tmp"
    
    
  as (
    

with cte as (SELECT s.session_key,
                    s.driver_number,
                    s.stint_number,
                    s.compound,
                    s.lap_start,
                    s.lap_end,
                    s.lap_end - s.lap_start + 1 as stint_length,
                    -- Get the start time from the first lap of the stint
                    MIN(l.date_start)           as stint_start_time,
                    -- Get the end time from the last lap of the stint
                    MAX(l.date_start)           as stint_end_time
             FROM "f1"."f1_data"."stg_stints" s
                      LEFT JOIN "f1"."f1_data"."stg_laps" l
                                ON s.session_key = l.session_key
                                    AND s.driver_number = l.driver_number
                                    AND l.lap_number BETWEEN s.lap_start AND s.lap_end
             GROUP BY 1, 2, 3, 4, 5, 6
             )
select * from cte
         where stint_end_time is not null
           and
             stint_start_time is not null
  );
[0m09:52:30.901878 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: COMMIT
[0m09:52:30.902876 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m09:52:30.904874 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m09:52:30.904874 [debug] [Thread-2 (]: On model.f1_analytics.int_pit_stop: COMMIT
[0m09:52:30.905876 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: COMMIT
[0m09:52:30.908247 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:30.909247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:30.912415 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."int_pit_stop__dbt_backup"
[0m09:52:30.912415 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:52:30.913415 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:52:30.915427 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."int_lap_position__dbt_backup"
[0m09:52:30.917413 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_pit_stop"
[0m09:52:30.920428 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m09:52:30.923417 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m09:52:30.925417 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.int_lap_position"
[0m09:52:30.925417 [debug] [Thread-2 (]: On model.f1_analytics.int_pit_stop: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_pit_stop"} */
drop view if exists "f1"."f1_data"."int_pit_stop__dbt_backup" cascade
[0m09:52:30.926421 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */
alter table "f1"."f1_data"."int_tyre_stint__dbt_tmp" rename to "int_tyre_stint"
[0m09:52:30.926421 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */
alter table "f1"."f1_data"."int_tyre_stint_laps__dbt_tmp" rename to "int_tyre_stint_laps"
[0m09:52:30.927421 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_lap_position"} */
drop view if exists "f1"."f1_data"."int_lap_position__dbt_backup" cascade
[0m09:52:30.928423 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:52:30.929414 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:30.930414 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:30.931425 [debug] [Thread-2 (]: On model.f1_analytics.int_pit_stop: Close
[0m09:52:30.932422 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:52:30.935431 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: COMMIT
[0m09:52:30.937414 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: COMMIT
[0m09:52:30.938414 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6DB07C0>]}
[0m09:52:30.939414 [debug] [Thread-1 (]: On model.f1_analytics.int_lap_position: Close
[0m09:52:30.941416 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m09:52:30.941416 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m09:52:30.942415 [info ] [Thread-2 (]: 6 of 9 OK created sql view model f1_data.int_pit_stop .......................... [[32mCREATE VIEW[0m in 0.20s]
[0m09:52:30.944415 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6D43520>]}
[0m09:52:30.944415 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: COMMIT
[0m09:52:30.945448 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: COMMIT
[0m09:52:30.946419 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_pit_stop
[0m09:52:30.947415 [info ] [Thread-1 (]: 5 of 9 OK created sql view model f1_data.int_lap_position ...................... [[32mCREATE VIEW[0m in 0.21s]
[0m09:52:30.949415 [debug] [Thread-1 (]: Finished running node model.f1_analytics.int_lap_position
[0m09:52:30.950415 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m09:52:30.950415 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m09:52:30.955416 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stint__dbt_backup"
[0m09:52:30.958427 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stint_laps__dbt_backup"
[0m09:52:30.959429 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.int_tyre_stint"
[0m09:52:30.960428 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.int_tyre_stint_laps"
[0m09:52:30.961454 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint"} */
drop view if exists "f1"."f1_data"."int_tyre_stint__dbt_backup" cascade
[0m09:52:30.962441 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stint_laps"} */
drop view if exists "f1"."f1_data"."int_tyre_stint_laps__dbt_backup" cascade
[0m09:52:30.963439 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:52:30.963439 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:52:30.965438 [debug] [Thread-3 (]: On model.f1_analytics.int_tyre_stint: Close
[0m09:52:30.967443 [debug] [Thread-4 (]: On model.f1_analytics.int_tyre_stint_laps: Close
[0m09:52:30.968441 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6DB07C0>]}
[0m09:52:30.969441 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6DCDB10>]}
[0m09:52:30.970444 [info ] [Thread-3 (]: 7 of 9 OK created sql view model f1_data.int_tyre_stint ........................ [[32mCREATE VIEW[0m in 0.18s]
[0m09:52:30.972447 [info ] [Thread-4 (]: 8 of 9 OK created sql view model f1_data.int_tyre_stint_laps ................... [[32mCREATE VIEW[0m in 0.18s]
[0m09:52:30.973439 [debug] [Thread-3 (]: Finished running node model.f1_analytics.int_tyre_stint
[0m09:52:30.974442 [debug] [Thread-4 (]: Finished running node model.f1_analytics.int_tyre_stint_laps
[0m09:52:30.974442 [debug] [Thread-2 (]: Began running node model.f1_analytics.int_tyre_stints_weather
[0m09:52:30.975971 [info ] [Thread-2 (]: 9 of 9 START sql view model f1_data.int_tyre_stints_weather .................... [RUN]
[0m09:52:30.976988 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.int_pit_stop, now model.f1_analytics.int_tyre_stints_weather)
[0m09:52:30.977987 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.int_tyre_stints_weather
[0m09:52:30.980987 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.int_tyre_stints_weather"
[0m09:52:30.982991 [debug] [Thread-2 (]: Began executing node model.f1_analytics.int_tyre_stints_weather
[0m09:52:30.987987 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.int_tyre_stints_weather"
[0m09:52:30.989988 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m09:52:30.990987 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: BEGIN
[0m09:52:30.990987 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:52:31.027819 [debug] [Thread-2 (]: SQL status: BEGIN in 0.036 seconds
[0m09:52:31.027819 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m09:52:31.028823 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */

  create view "f1"."f1_data"."int_tyre_stints_weather__dbt_tmp"
    
    
  as (
    

SELECT
        st.session_key,
        st.driver_number,
        st.stint_number,
        st.compound,
        st.lap_start,
        st.lap_end,
        st.stint_length,
        -- Average weather conditions during the stint
        AVG(w.air_temperature) as avg_air_temp,
        AVG(w.track_temperature) as avg_track_temp,
        AVG(w.humidity) as avg_humidity,
        MAX(w.rainfall) as had_rainfall,  -- If there was any rain during stint
        AVG(w.wind_speed) as avg_wind_speed,
        -- Categorize conditions
        CASE
            WHEN AVG(w.track_temperature) < 25 THEN 'Cold'
            WHEN AVG(w.track_temperature) < 35 THEN 'Medium'
            ELSE 'Hot'
        END as track_temp_category,
        CASE
            WHEN MAX(w.rainfall) > 0 THEN 'Wet'
            WHEN AVG(w.humidity) > 70 THEN 'High Humidity'
            ELSE 'Dry'
        END as weather_condition
    FROM "f1"."f1_data"."int_tyre_stint_laps" st
    LEFT JOIN "f1"."f1_data"."stg_weather" w
        ON st.session_key = w.session_key
        AND w.date BETWEEN st.stint_start_time AND st.stint_end_time
    GROUP BY 1,2,3,4,5,6,7
  );
[0m09:52:31.037952 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:52:31.041065 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m09:52:31.042063 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */
alter table "f1"."f1_data"."int_tyre_stints_weather__dbt_tmp" rename to "int_tyre_stints_weather"
[0m09:52:31.042974 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:31.045059 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: COMMIT
[0m09:52:31.045059 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m09:52:31.046075 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: COMMIT
[0m09:52:31.047042 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:31.049063 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."int_tyre_stints_weather__dbt_backup"
[0m09:52:31.050587 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.int_tyre_stints_weather"
[0m09:52:31.050587 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.int_tyre_stints_weather"} */
drop view if exists "f1"."f1_data"."int_tyre_stints_weather__dbt_backup" cascade
[0m09:52:31.051633 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:52:31.053609 [debug] [Thread-2 (]: On model.f1_analytics.int_tyre_stints_weather: Close
[0m09:52:31.054607 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8aabe46-67d1-4444-baed-44dd5b03d33f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6DA8250>]}
[0m09:52:31.055682 [info ] [Thread-2 (]: 9 of 9 OK created sql view model f1_data.int_tyre_stints_weather ............... [[32mCREATE VIEW[0m in 0.08s]
[0m09:52:31.056602 [debug] [Thread-2 (]: Finished running node model.f1_analytics.int_tyre_stints_weather
[0m09:52:31.059570 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:31.059570 [debug] [MainThread]: On master: BEGIN
[0m09:52:31.060581 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:31.103532 [debug] [MainThread]: SQL status: BEGIN in 0.043 seconds
[0m09:52:31.104533 [debug] [MainThread]: On master: COMMIT
[0m09:52:31.104533 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:31.105533 [debug] [MainThread]: On master: COMMIT
[0m09:52:31.106531 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:31.106531 [debug] [MainThread]: On master: Close
[0m09:52:31.107526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:31.108534 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m09:52:31.109529 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m09:52:31.110528 [debug] [MainThread]: Connection 'model.f1_analytics.int_lap_position' was properly closed.
[0m09:52:31.110528 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stints_weather' was properly closed.
[0m09:52:31.111765 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint' was properly closed.
[0m09:52:31.111765 [debug] [MainThread]: Connection 'model.f1_analytics.int_tyre_stint_laps' was properly closed.
[0m09:52:31.112773 [info ] [MainThread]: 
[0m09:52:31.113279 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 1.04 seconds (1.04s).
[0m09:52:31.116294 [debug] [MainThread]: Command end result
[0m09:52:31.143935 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m09:52:31.147365 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m09:52:31.157161 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m09:52:31.158163 [info ] [MainThread]: 
[0m09:52:31.160279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:31.161321 [info ] [MainThread]: 
[0m09:52:31.162293 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m09:52:31.163366 [debug] [MainThread]: Command `dbt run` succeeded at 09:52:31.163366 after 2.04 seconds
[0m09:52:31.164287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C3E3E320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C52D8D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F2C6D44E50>]}
[0m09:52:31.165290 [debug] [MainThread]: Flushing usage events
[0m09:52:31.534533 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:52:36.946353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EE99A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EFC70F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EFC70D60>]}


============================== 09:52:36.950348 | 26cd0abb-1528-42c7-b9c5-9bc786180635 ==============================
[0m09:52:36.950348 [info ] [MainThread]: Running with dbt=1.10.6
[0m09:52:36.951346 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\samee\\Desktop\\F1\\dbt\\logs', 'profiles_dir': 'C:\\Users\\samee\\Desktop\\F1\\dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select marts', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:52:37.135308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EFD4F940>]}
[0m09:52:37.194216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EFC72C50>]}
[0m09:52:37.196863 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m09:52:37.352262 [debug] [MainThread]: checksum: f6e4baf4de20596ffb9d14e6ef805989eb0e1950dedc3cc83d03f20aa023904c, vars: {}, profile: , target: , version: 1.10.6
[0m09:52:37.509171 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:37.510172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:37.561980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F1348F10>]}
[0m09:52:37.710073 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m09:52:37.713093 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m09:52:37.754414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F13363B0>]}
[0m09:52:37.755397 [info ] [MainThread]: Found 29 models, 4 data tests, 10 sources, 434 macros
[0m09:52:37.756400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F1335990>]}
[0m09:52:37.758398 [info ] [MainThread]: 
[0m09:52:37.760415 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:52:37.761399 [info ] [MainThread]: 
[0m09:52:37.762426 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m09:52:37.768869 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1'
[0m09:52:37.831879 [debug] [ThreadPool]: Using postgres connection "list_f1"
[0m09:52:37.831879 [debug] [ThreadPool]: On list_f1: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1"} */

    select distinct nspname from pg_namespace
  
[0m09:52:37.832839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:37.875971 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.043 seconds
[0m09:52:37.877961 [debug] [ThreadPool]: On list_f1: Close
[0m09:52:37.882004 [debug] [ThreadPool]: Acquiring new postgres connection 'list_f1_f1_data'
[0m09:52:37.888001 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m09:52:37.889000 [debug] [ThreadPool]: On list_f1_f1_data: BEGIN
[0m09:52:37.889000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:37.927235 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m09:52:37.928344 [debug] [ThreadPool]: Using postgres connection "list_f1_f1_data"
[0m09:52:37.929241 [debug] [ThreadPool]: On list_f1_f1_data: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "list_f1_f1_data"} */
select
      'f1' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'f1_data'
    union all
    select
      'f1' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'f1_data'
  
[0m09:52:37.938250 [debug] [ThreadPool]: SQL status: SELECT 30 in 0.009 seconds
[0m09:52:37.940371 [debug] [ThreadPool]: On list_f1_f1_data: ROLLBACK
[0m09:52:37.941306 [debug] [ThreadPool]: On list_f1_f1_data: Close
[0m09:52:37.951393 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:37.952277 [debug] [MainThread]: On master: BEGIN
[0m09:52:37.952277 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:37.991968 [debug] [MainThread]: SQL status: BEGIN in 0.039 seconds
[0m09:52:37.991968 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:37.992969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m09:52:38.003973 [debug] [MainThread]: SQL status: SELECT 25 in 0.010 seconds
[0m09:52:38.009028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F1334070>]}
[0m09:52:38.009984 [debug] [MainThread]: On master: ROLLBACK
[0m09:52:38.010981 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:38.011973 [debug] [MainThread]: On master: BEGIN
[0m09:52:38.012992 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m09:52:38.012992 [debug] [MainThread]: On master: COMMIT
[0m09:52:38.013972 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:38.013972 [debug] [MainThread]: On master: COMMIT
[0m09:52:38.014976 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:38.014976 [debug] [MainThread]: On master: Close
[0m09:52:38.023492 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_car
[0m09:52:38.024493 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_historical_analysis
[0m09:52:38.024493 [debug] [Thread-3 (]: Began running node model.f1_analytics.final_session_driver_mapping
[0m09:52:38.025537 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_session_filters
[0m09:52:38.026172 [info ] [Thread-1 (]: 1 of 8 START sql view model f1_data.final_car .................................. [RUN]
[0m09:52:38.027201 [info ] [Thread-2 (]: 2 of 8 START sql view model f1_data.final_historical_analysis .................. [RUN]
[0m09:52:38.027773 [info ] [Thread-3 (]: 3 of 8 START sql view model f1_data.final_session_driver_mapping ............... [RUN]
[0m09:52:38.029925 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.f1_analytics.final_car'
[0m09:52:38.028898 [info ] [Thread-4 (]: 4 of 8 START sql view model f1_data.final_session_filters ...................... [RUN]
[0m09:52:38.030920 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.f1_analytics.final_historical_analysis'
[0m09:52:38.031955 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_driver_mapping'
[0m09:52:38.033939 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_car
[0m09:52:38.034920 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.f1_analytics.final_session_filters'
[0m09:52:38.034920 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.final_historical_analysis
[0m09:52:38.035920 [debug] [Thread-3 (]: Began compiling node model.f1_analytics.final_session_driver_mapping
[0m09:52:38.045433 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_car"
[0m09:52:38.046434 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_session_filters
[0m09:52:38.050509 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.final_historical_analysis"
[0m09:52:38.054538 [debug] [Thread-3 (]: Writing injected SQL for node "model.f1_analytics.final_session_driver_mapping"
[0m09:52:38.059299 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_session_filters"
[0m09:52:38.060305 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_car
[0m09:52:38.062298 [debug] [Thread-2 (]: Began executing node model.f1_analytics.final_historical_analysis
[0m09:52:38.063301 [debug] [Thread-3 (]: Began executing node model.f1_analytics.final_session_driver_mapping
[0m09:52:38.094294 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_car"
[0m09:52:38.095014 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_session_filters
[0m09:52:38.099574 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.final_historical_analysis"
[0m09:52:38.103366 [debug] [Thread-3 (]: Writing runtime sql for node "model.f1_analytics.final_session_driver_mapping"
[0m09:52:38.108606 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_session_filters"
[0m09:52:38.109531 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m09:52:38.110121 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m09:52:38.111429 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m09:52:38.112714 [debug] [Thread-1 (]: On model.f1_analytics.final_car: BEGIN
[0m09:52:38.113835 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m09:52:38.113835 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: BEGIN
[0m09:52:38.114723 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: BEGIN
[0m09:52:38.115731 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:52:38.116724 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: BEGIN
[0m09:52:38.116724 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:52:38.118236 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:52:38.119250 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:52:38.166910 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m09:52:38.167918 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m09:52:38.168917 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */

  create view "f1"."f1_data"."final_car__dbt_tmp"
    
    
  as (
    

SELECT
   t.date,
   CONCAT(t.name_acronym, ' (', t.team_name, ')') as driver,
   t.driver_number,
   ROUND(t.speed) as speed,
   ROUND(t.throttle) as throttle,
   ROUND(t.brake) as brake,
   t.rpm,
   t.session_key,  -- Add session_key
   m.meeting_key   -- Add meeting_key
FROM "f1"."f1_data"."int_car_base" t
LEFT JOIN "f1"."f1_data"."stg_sessions" s ON t.session_key = s.session_key
LEFT JOIN "f1"."f1_data"."stg_meeting" m ON s.meeting_key = m.meeting_key
  );
[0m09:52:38.174413 [debug] [Thread-2 (]: SQL status: BEGIN in 0.057 seconds
[0m09:52:38.175423 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m09:52:38.176423 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */

  create view "f1"."f1_data"."final_historical_analysis__dbt_tmp"
    
    
  as (
    

WITH first_position_record AS (
    SELECT *
    FROM (
        SELECT
            session_key,
            driver_number,
            position AS first_position,
            date,
            ROW_NUMBER() OVER (
                PARTITION BY session_key, driver_number
                ORDER BY date
            ) AS rn
        FROM stg_position
    ) t
    WHERE rn = 1
),
lap_metrics AS (
    SELECT
        l.lap_number,
        l.session_key,
        l.driver_number,
        l.date_start,
        l.date_end,
        l.is_pit_out_lap,
        l.duration_sector_1,
        l.duration_sector_2,
        l.duration_sector_3,
        fpr.first_position,
        MIN(i.gap_to_leader) AS min_gap_to_leader,
        MAX(i.gap_to_leader) AS max_gap_to_leader,
        ROUND(MIN(i.gap_to_next)::numeric,3) AS min_gap_to_next,
        ROUND(MAX(i.gap_to_next)::numeric,3) AS max_gap_to_next,
        sp.position AS start_position,
        ep.position AS end_position
    FROM "f1"."f1_data"."stg_laps" l
    LEFT JOIN first_position_record fpr
        ON l.session_key = fpr.session_key
        AND l.driver_number = fpr.driver_number
    LEFT JOIN "f1"."f1_data"."stg_intervals" i
        ON i.session_key = l.session_key
        AND i.driver_number = l.driver_number
        AND date_trunc('second', i.date) BETWEEN l.date_start AND l.date_end
    LEFT JOIN "f1"."f1_data"."int_lap_position" sp
        ON l.session_key = sp.session_key
        AND l.driver_number = sp.driver_number
        AND l.lap_number = sp.lap_number
        AND sp.start_position_rank = 1
    LEFT JOIN "f1"."f1_data"."int_lap_position" ep
        ON l.session_key = ep.session_key
        AND l.driver_number = ep.driver_number
        AND l.lap_number = ep.lap_number
        AND ep.end_position_rank = 1
    GROUP BY
        l.lap_number, l.session_key, l.driver_number, l.date_start,
        l.date_end, l.is_pit_out_lap,
        l.duration_sector_1, l.duration_sector_2, l.duration_sector_3,
        fpr.first_position, sp.position, ep.position
),
filled_positions AS (
    SELECT
        *,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                start_position,
                MAX(start_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_start_position,
        CASE
            WHEN lap_number = 1 THEN first_position
            ELSE COALESCE(
                end_position,
                MAX(end_position) OVER (
                    PARTITION BY session_key, driver_number
                    ORDER BY lap_number
                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW
                ),
                first_position
            )
        END AS lap_end_position
    FROM lap_metrics
)
SELECT
    lap_number,
    session_key,
    driver_number,
    date_start AS lap_start_time,
    date_end AS lap_end_time,
    is_pit_out_lap,
    duration_sector_1,
    duration_sector_2,
    duration_sector_3,
    min_gap_to_leader,
    max_gap_to_leader,
    min_gap_to_next,
    max_gap_to_next,
    lap_start_position,
    lap_end_position,
    first_position AS race_start_position
FROM filled_positions
  );
[0m09:52:38.177422 [debug] [Thread-3 (]: SQL status: BEGIN in 0.060 seconds
[0m09:52:38.178932 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:52:38.179941 [debug] [Thread-4 (]: SQL status: BEGIN in 0.061 seconds
[0m09:52:38.180940 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m09:52:38.188139 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m09:52:38.189097 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m09:52:38.190098 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */

  create view "f1"."f1_data"."final_session_driver_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    d.session_key,
    concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name,
    d.driver_number
FROM "f1"."f1_data"."stg_drivers" d
JOIN "f1"."f1_data"."stg_sessions" s ON d.session_key = s.session_key
  );
[0m09:52:38.191146 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
alter table "f1"."f1_data"."final_car__dbt_tmp" rename to "final_car"
[0m09:52:38.192096 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.014 seconds
[0m09:52:38.192096 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */

  create view "f1"."f1_data"."final_session_filters__dbt_tmp"
    
    
  as (
    WITH session_drivers AS (
   SELECT DISTINCT
       s.session_key,
       s.country_name,
       s.session_name,
       s.session_type,
       s.year,
       d.driver_number,
       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name
   FROM "f1"."f1_data"."stg_sessions" s
   JOIN "f1"."f1_data"."stg_drivers" d ON s.session_key = d.session_key
)
SELECT
   s.session_key,
    s.year,
   s.country_name,
   s.circuit_short_name,
   s.session_name,
   s.session_type,
   concat(s.year, ' - ', s.country_name, ' - ', s.session_name) as session_display_name,
   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,
   m.meeting_name,
   m.meeting_official_name,
   s.date_start
FROM "f1"."f1_data"."stg_sessions" s
JOIN session_drivers sd ON s.session_key = sd.session_key
JOIN "f1"."f1_data"."stg_meeting" m ON s.year = m.year
   AND s.country_name = m.country_name
GROUP BY 1,2,3,4,5,6,7,9,10,11
  );
[0m09:52:38.197095 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m09:52:38.198095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m09:52:38.198095 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
alter table "f1"."f1_data"."final_historical_analysis__dbt_tmp" rename to "final_historical_analysis"
[0m09:52:38.212018 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m09:52:38.213019 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.020 seconds
[0m09:52:38.213019 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.015 seconds
[0m09:52:38.214726 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m09:52:38.214726 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:38.218253 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m09:52:38.221280 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m09:52:38.222280 [debug] [Thread-1 (]: On model.f1_analytics.final_car: COMMIT
[0m09:52:38.224282 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m09:52:38.224282 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
alter table "f1"."f1_data"."final_session_driver_mapping__dbt_tmp" rename to "final_session_driver_mapping"
[0m09:52:38.225277 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
alter table "f1"."f1_data"."final_session_filters__dbt_tmp" rename to "final_session_filters"
[0m09:52:38.226271 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m09:52:38.227268 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: COMMIT
[0m09:52:38.227268 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:38.228271 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:52:38.228271 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m09:52:38.230269 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m09:52:38.231432 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m09:52:38.232454 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m09:52:38.238503 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_car__dbt_backup"
[0m09:52:38.239146 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m09:52:38.241840 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."final_historical_analysis__dbt_backup"
[0m09:52:38.241840 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m09:52:38.246955 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_car"
[0m09:52:38.247843 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: COMMIT
[0m09:52:38.248949 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_historical_analysis"
[0m09:52:38.248949 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: COMMIT
[0m09:52:38.249842 [debug] [Thread-1 (]: On model.f1_analytics.final_car: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_car"} */
drop view if exists "f1"."f1_data"."final_car__dbt_backup" cascade
[0m09:52:38.250841 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_historical_analysis"} */
drop view if exists "f1"."f1_data"."final_historical_analysis__dbt_backup" cascade
[0m09:52:38.250841 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:38.252427 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:52:38.252427 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:38.255535 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."final_session_filters__dbt_backup"
[0m09:52:38.255535 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m09:52:38.258546 [debug] [Thread-1 (]: On model.f1_analytics.final_car: Close
[0m09:52:38.261252 [debug] [Thread-3 (]: Applying DROP to: "f1"."f1_data"."final_session_driver_mapping__dbt_backup"
[0m09:52:38.261864 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_session_filters"
[0m09:52:38.264087 [debug] [Thread-2 (]: On model.f1_analytics.final_historical_analysis: Close
[0m09:52:38.267731 [debug] [Thread-3 (]: Using postgres connection "model.f1_analytics.final_session_driver_mapping"
[0m09:52:38.268730 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_filters"} */
drop view if exists "f1"."f1_data"."final_session_filters__dbt_backup" cascade
[0m09:52:38.269730 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F13BEA70>]}
[0m09:52:38.270747 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F13BE8F0>]}
[0m09:52:38.270747 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_driver_mapping"} */
drop view if exists "f1"."f1_data"."final_session_driver_mapping__dbt_backup" cascade
[0m09:52:38.272789 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:52:38.272789 [info ] [Thread-1 (]: 1 of 8 OK created sql view model f1_data.final_car ............................. [[32mCREATE VIEW[0m in 0.23s]
[0m09:52:38.274035 [info ] [Thread-2 (]: 2 of 8 OK created sql view model f1_data.final_historical_analysis ............. [[32mCREATE VIEW[0m in 0.24s]
[0m09:52:38.277164 [debug] [Thread-4 (]: On model.f1_analytics.final_session_filters: Close
[0m09:52:38.277164 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:52:38.278045 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_car
[0m09:52:38.280044 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_historical_analysis
[0m09:52:38.280044 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EFBC6530>]}
[0m09:52:38.283561 [debug] [Thread-3 (]: On model.f1_analytics.final_session_driver_mapping: Close
[0m09:52:38.285561 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_session_mapping
[0m09:52:38.285561 [debug] [Thread-2 (]: Began running node model.f1_analytics.final_tyre_performance
[0m09:52:38.286559 [info ] [Thread-4 (]: 4 of 8 OK created sql view model f1_data.final_session_filters ................. [[32mCREATE VIEW[0m in 0.25s]
[0m09:52:38.288642 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EFEA5060>]}
[0m09:52:38.289627 [info ] [Thread-1 (]: 5 of 8 START sql view model f1_data.final_session_mapping ...................... [RUN]
[0m09:52:38.292551 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_session_filters
[0m09:52:38.290566 [info ] [Thread-2 (]: 6 of 8 START sql view model f1_data.final_tyre_performance ..................... [RUN]
[0m09:52:38.294559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_car, now model.f1_analytics.final_session_mapping)
[0m09:52:38.293560 [info ] [Thread-3 (]: 3 of 8 OK created sql view model f1_data.final_session_driver_mapping .......... [[32mCREATE VIEW[0m in 0.26s]
[0m09:52:38.295561 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_historical_analysis, now model.f1_analytics.final_tyre_performance)
[0m09:52:38.296559 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_session_mapping
[0m09:52:38.297564 [debug] [Thread-3 (]: Finished running node model.f1_analytics.final_session_driver_mapping
[0m09:52:38.299810 [debug] [Thread-2 (]: Began compiling node model.f1_analytics.final_tyre_performance
[0m09:52:38.302802 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_session_mapping"
[0m09:52:38.308984 [debug] [Thread-2 (]: Writing injected SQL for node "model.f1_analytics.final_tyre_performance"
[0m09:52:38.309970 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_session_mapping
[0m09:52:38.314968 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_session_mapping"
[0m09:52:38.316973 [debug] [Thread-2 (]: Began executing node model.f1_analytics.final_tyre_performance
[0m09:52:38.321501 [debug] [Thread-2 (]: Writing runtime sql for node "model.f1_analytics.final_tyre_performance"
[0m09:52:38.322501 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m09:52:38.322501 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: BEGIN
[0m09:52:38.324490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:38.324490 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m09:52:38.325487 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: BEGIN
[0m09:52:38.326487 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:52:38.365486 [debug] [Thread-1 (]: SQL status: BEGIN in 0.042 seconds
[0m09:52:38.366484 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m09:52:38.367486 [debug] [Thread-2 (]: SQL status: BEGIN in 0.041 seconds
[0m09:52:38.367486 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */

  create view "f1"."f1_data"."final_session_mapping__dbt_tmp"
    
    
  as (
    

SELECT DISTINCT
    EXTRACT(YEAR FROM date_start)::text || ' - ' || country_name || ' - ' || session_name AS session_display_name,
    session_key
FROM "f1"."f1_data"."stg_sessions"
  );
[0m09:52:38.368484 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m09:52:38.369485 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */

  create view "f1"."f1_data"."final_tyre_performance__dbt_tmp"
    
    
  as (
    

WITH tire_performance AS (
    SELECT
        circuit_short_name,
        compound,
        team_name,
        driver_number,
        AVG(stint_length) as avg_stint_length,
        MAX(stint_length) as max_stint_length,
        AVG(tyre_age_at_start) as avg_starting_age,
        COUNT(*) as number_of_stints
    FROM "f1"."f1_data"."int_tyre_stint"
    GROUP BY 1,2,3,4
)

SELECT
    circuit_short_name,
    compound,
    round(AVG(avg_stint_length),2) as circuit_compound_avg_stint_length,
    MAX(max_stint_length) as circuit_compound_max_stint_length,
    round(AVG(avg_starting_age),2) as avg_tire_age_start,
    SUM(number_of_stints) as total_stints
FROM tire_performance
GROUP BY 1,2
  );
[0m09:52:38.374493 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m09:52:38.378490 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m09:52:38.378490 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m09:52:38.379489 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
alter table "f1"."f1_data"."final_session_mapping__dbt_tmp" rename to "final_session_mapping"
[0m09:52:38.382492 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m09:52:38.383491 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
alter table "f1"."f1_data"."final_tyre_performance__dbt_tmp" rename to "final_tyre_performance"
[0m09:52:38.384488 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:38.386486 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m09:52:38.386486 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m09:52:38.387484 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m09:52:38.388487 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m09:52:38.389497 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: COMMIT
[0m09:52:38.390501 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m09:52:38.391485 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: COMMIT
[0m09:52:38.391485 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:38.394490 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_session_mapping__dbt_backup"
[0m09:52:38.394490 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m09:52:38.395490 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_session_mapping"
[0m09:52:38.398489 [debug] [Thread-2 (]: Applying DROP to: "f1"."f1_data"."final_tyre_performance__dbt_backup"
[0m09:52:38.399488 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_session_mapping"} */
drop view if exists "f1"."f1_data"."final_session_mapping__dbt_backup" cascade
[0m09:52:38.400489 [debug] [Thread-2 (]: Using postgres connection "model.f1_analytics.final_tyre_performance"
[0m09:52:38.400489 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_tyre_performance"} */
drop view if exists "f1"."f1_data"."final_tyre_performance__dbt_backup" cascade
[0m09:52:38.401488 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m09:52:38.403505 [debug] [Thread-1 (]: On model.f1_analytics.final_session_mapping: Close
[0m09:52:38.404552 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m09:52:38.405586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EFEA4B50>]}
[0m09:52:38.407521 [debug] [Thread-2 (]: On model.f1_analytics.final_tyre_performance: Close
[0m09:52:38.408520 [info ] [Thread-1 (]: 5 of 8 OK created sql view model f1_data.final_session_mapping ................. [[32mCREATE VIEW[0m in 0.11s]
[0m09:52:38.410520 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EFBC6530>]}
[0m09:52:38.411527 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_session_mapping
[0m09:52:38.412827 [info ] [Thread-2 (]: 6 of 8 OK created sql view model f1_data.final_tyre_performance ................ [[32mCREATE VIEW[0m in 0.11s]
[0m09:52:38.413892 [debug] [Thread-4 (]: Began running node model.f1_analytics.final_race_leaderboard
[0m09:52:38.414900 [debug] [Thread-2 (]: Finished running node model.f1_analytics.final_tyre_performance
[0m09:52:38.415901 [info ] [Thread-4 (]: 7 of 8 START sql view model f1_data.final_race_leaderboard ..................... [RUN]
[0m09:52:38.416904 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_filters, now model.f1_analytics.final_race_leaderboard)
[0m09:52:38.418423 [debug] [Thread-4 (]: Began compiling node model.f1_analytics.final_race_leaderboard
[0m09:52:38.424433 [debug] [Thread-4 (]: Writing injected SQL for node "model.f1_analytics.final_race_leaderboard"
[0m09:52:38.426536 [debug] [Thread-4 (]: Began executing node model.f1_analytics.final_race_leaderboard
[0m09:52:38.430564 [debug] [Thread-4 (]: Writing runtime sql for node "model.f1_analytics.final_race_leaderboard"
[0m09:52:38.433432 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m09:52:38.434485 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: BEGIN
[0m09:52:38.435435 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:52:38.478814 [debug] [Thread-4 (]: SQL status: BEGIN in 0.043 seconds
[0m09:52:38.479583 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m09:52:38.480591 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */

  create view "f1"."f1_data"."final_race_leaderboard__dbt_tmp"
    
    
  as (
    

WITH final_rankings AS (
   SELECT
       session_key,
       driver_number,
       position
   FROM int_final_position
)
SELECT
   fr.session_key,
   d.driver_number,
   d.broadcast_name AS driver_name,
   fr.position,
   d.team_name,
   d.team_colour AS team_color,
   CASE
       WHEN fr.position = 1 THEN 0
       ELSE fi.max_gap_to_leader
   END as gap_to_leader,
   fi.max_gap_to_next as gap_to_next,
   bl.fastest_lap,
   ps.pit_stop_count,

   CASE
       WHEN fr.position = 1 THEN 25
       WHEN fr.position = 2 THEN 18
       WHEN fr.position = 3 THEN 15
       WHEN fr.position = 4 THEN 12
       WHEN fr.position = 5 THEN 10
       WHEN fr.position = 6 THEN 8
       WHEN fr.position = 7 THEN 6
       WHEN fr.position = 8 THEN 4
       WHEN fr.position = 9 THEN 2
       WHEN fr.position = 10 THEN 1
       ELSE 0
   END AS points
FROM final_rankings fr
JOIN "f1"."f1_data"."stg_drivers" d
   ON fr.driver_number = d.driver_number
   AND fr.session_key = d.session_key
LEFT JOIN "f1"."f1_data"."int_final_intervals" fi
   ON fr.session_key = fi.session_key
   AND fr.driver_number = fi.driver_number
LEFT JOIN "f1"."f1_data"."int_best_laps" bl
   ON fr.session_key = bl.session_key
   AND fr.driver_number = bl.driver_number
LEFT JOIN "f1"."f1_data"."int_pit_stop" ps
   ON fr.session_key = ps.session_key
   AND fr.driver_number = ps.driver_number
JOIN "f1"."f1_data"."final_session_mapping" m
   ON fr.session_key = m.session_key
ORDER BY fr.position
  );
[0m09:52:38.488993 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m09:52:38.491993 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m09:52:38.492996 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
alter table "f1"."f1_data"."final_race_leaderboard__dbt_tmp" rename to "final_race_leaderboard"
[0m09:52:38.494995 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:38.495995 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m09:52:38.496996 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m09:52:38.496996 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: COMMIT
[0m09:52:38.499388 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:38.501396 [debug] [Thread-4 (]: Applying DROP to: "f1"."f1_data"."final_race_leaderboard__dbt_backup"
[0m09:52:38.502396 [debug] [Thread-4 (]: Using postgres connection "model.f1_analytics.final_race_leaderboard"
[0m09:52:38.503398 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_leaderboard"} */
drop view if exists "f1"."f1_data"."final_race_leaderboard__dbt_backup" cascade
[0m09:52:38.503398 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:52:38.505403 [debug] [Thread-4 (]: On model.f1_analytics.final_race_leaderboard: Close
[0m09:52:38.506403 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F13BF0D0>]}
[0m09:52:38.507405 [info ] [Thread-4 (]: 7 of 8 OK created sql view model f1_data.final_race_leaderboard ................ [[32mCREATE VIEW[0m in 0.09s]
[0m09:52:38.508406 [debug] [Thread-4 (]: Finished running node model.f1_analytics.final_race_leaderboard
[0m09:52:38.510408 [debug] [Thread-1 (]: Began running node model.f1_analytics.final_race_summary
[0m09:52:38.511405 [info ] [Thread-1 (]: 8 of 8 START sql view model f1_data.final_race_summary ......................... [RUN]
[0m09:52:38.512464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.f1_analytics.final_session_mapping, now model.f1_analytics.final_race_summary)
[0m09:52:38.513408 [debug] [Thread-1 (]: Began compiling node model.f1_analytics.final_race_summary
[0m09:52:38.519133 [debug] [Thread-1 (]: Writing injected SQL for node "model.f1_analytics.final_race_summary"
[0m09:52:38.521004 [debug] [Thread-1 (]: Began executing node model.f1_analytics.final_race_summary
[0m09:52:38.527020 [debug] [Thread-1 (]: Writing runtime sql for node "model.f1_analytics.final_race_summary"
[0m09:52:38.529036 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m09:52:38.530021 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: BEGIN
[0m09:52:38.530021 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:38.570004 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m09:52:38.571101 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m09:52:38.571733 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */

  create view "f1"."f1_data"."final_race_summary__dbt_tmp"
    
    
  as (
    

WITH positions AS (
   SELECT
       session_key,
       COUNT(DISTINCT driver_number) as total_drivers

   FROM "f1"."f1_data"."stg_position"
   GROUP BY session_key
),
laps AS (
   SELECT
       session_key,
       MAX(lap_number) as total_laps
   FROM "f1"."f1_data"."stg_laps"
   GROUP BY session_key
),
team_stats AS (
   SELECT
       session_key,
       SUM(pit_stop_count) as total_pit_stops,
        COUNT(DISTINCT team_name) as total_teams
   FROM "f1"."f1_data"."final_race_leaderboard"
   GROUP BY session_key
),
driver_stats AS (
   SELECT
       session_key,
       driver_number,
       MAX(speed) as top_speed,
       AVG(speed) as avg_speed
   FROM "f1"."f1_data"."stg_car_data"
   GROUP BY session_key, driver_number
),
cte as(
SELECT
   p.session_key,
   m.session_display_name,
   p.total_drivers,
   l.total_laps,
   MAX(d.top_speed) as fastest_speed,
   round(AVG(d.avg_speed),3) as average_speed
FROM positions p
JOIN laps l ON p.session_key = l.session_key
JOIN "f1"."f1_data"."final_session_mapping" m ON p.session_key = m.session_key
LEFT JOIN driver_stats d ON p.session_key = d.session_key
GROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps
)
select c.session_key,
   c.session_display_name,
   c.total_drivers,
    t.total_teams,
   c.total_laps,
   t.total_pit_stops,
    c.fastest_speed,
   c.average_speed
from cte c left join team_stats t on c.session_key=t.session_key
  );
[0m09:52:38.582132 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m09:52:38.586243 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m09:52:38.586243 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
alter table "f1"."f1_data"."final_race_summary__dbt_tmp" rename to "final_race_summary"
[0m09:52:38.588200 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m09:52:38.589217 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m09:52:38.590219 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m09:52:38.590219 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: COMMIT
[0m09:52:38.592232 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m09:52:38.596216 [debug] [Thread-1 (]: Applying DROP to: "f1"."f1_data"."final_race_summary__dbt_backup"
[0m09:52:38.597216 [debug] [Thread-1 (]: Using postgres connection "model.f1_analytics.final_race_summary"
[0m09:52:38.597216 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: /* {"app": "dbt", "dbt_version": "1.10.6", "profile_name": "f1_analytics", "target_name": "dev", "node_id": "model.f1_analytics.final_race_summary"} */
drop view if exists "f1"."f1_data"."final_race_summary__dbt_backup" cascade
[0m09:52:38.598271 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m09:52:38.600218 [debug] [Thread-1 (]: On model.f1_analytics.final_race_summary: Close
[0m09:52:38.601255 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '26cd0abb-1528-42c7-b9c5-9bc786180635', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175ED7FC6A0>]}
[0m09:52:38.602282 [info ] [Thread-1 (]: 8 of 8 OK created sql view model f1_data.final_race_summary .................... [[32mCREATE VIEW[0m in 0.09s]
[0m09:52:38.604349 [debug] [Thread-1 (]: Finished running node model.f1_analytics.final_race_summary
[0m09:52:38.606628 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:38.607636 [debug] [MainThread]: On master: BEGIN
[0m09:52:38.607636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:38.652754 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m09:52:38.653754 [debug] [MainThread]: On master: COMMIT
[0m09:52:38.653754 [debug] [MainThread]: Using postgres connection "master"
[0m09:52:38.654793 [debug] [MainThread]: On master: COMMIT
[0m09:52:38.655755 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m09:52:38.656753 [debug] [MainThread]: On master: Close
[0m09:52:38.656753 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:38.657757 [debug] [MainThread]: Connection 'list_f1' was properly closed.
[0m09:52:38.658756 [debug] [MainThread]: Connection 'list_f1_f1_data' was properly closed.
[0m09:52:38.658756 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_summary' was properly closed.
[0m09:52:38.659756 [debug] [MainThread]: Connection 'model.f1_analytics.final_tyre_performance' was properly closed.
[0m09:52:38.660755 [debug] [MainThread]: Connection 'model.f1_analytics.final_session_driver_mapping' was properly closed.
[0m09:52:38.660755 [debug] [MainThread]: Connection 'model.f1_analytics.final_race_leaderboard' was properly closed.
[0m09:52:38.661753 [info ] [MainThread]: 
[0m09:52:38.662762 [info ] [MainThread]: Finished running 8 view models in 0 hours 0 minutes and 0.90 seconds (0.90s).
[0m09:52:38.666759 [debug] [MainThread]: Command end result
[0m09:52:38.692752 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\samee\Desktop\F1\dbt\target\manifest.json
[0m09:52:38.697758 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\samee\Desktop\F1\dbt\target\semantic_manifest.json
[0m09:52:38.707813 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\samee\Desktop\F1\dbt\target\run_results.json
[0m09:52:38.707813 [info ] [MainThread]: 
[0m09:52:38.709810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:38.710813 [info ] [MainThread]: 
[0m09:52:38.713811 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m09:52:38.716812 [debug] [MainThread]: Command `dbt run` succeeded at 09:52:38.715812 after 1.86 seconds
[0m09:52:38.716812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EE99A380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175F1349990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000175EECA0B20>]}
[0m09:52:38.717807 [debug] [MainThread]: Flushing usage events
[0m09:52:39.104184 [debug] [MainThread]: An error was encountered while trying to flush usage events
