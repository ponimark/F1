{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.10.6", "generated_at": "2025-09-07T16:52:38.664757Z", "invocation_id": "26cd0abb-1528-42c7-b9c5-9bc786180635", "invocation_started_at": "2025-09-07T16:52:36.916227Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T16:52:38.036922Z", "completed_at": "2025-09-07T16:52:38.060305Z"}, {"name": "execute", "started_at": "2025-09-07T16:52:38.064420Z", "completed_at": "2025-09-07T16:52:38.258546Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2347276210784912, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.f1_analytics.final_car", "compiled": true, "compiled_code": "\n\nSELECT\n   t.date,\n   CONCAT(t.name_acronym, ' (', t.team_name, ')') as driver,\n   t.driver_number,\n   ROUND(t.speed) as speed,\n   ROUND(t.throttle) as throttle,\n   ROUND(t.brake) as brake,\n   t.rpm,\n   t.session_key,  -- Add session_key\n   m.meeting_key   -- Add meeting_key\nFROM \"f1\".\"f1_data\".\"int_car_base\" t\nLEFT JOIN \"f1\".\"f1_data\".\"stg_sessions\" s ON t.session_key = s.session_key\nLEFT JOIN \"f1\".\"f1_data\".\"stg_meeting\" m ON s.meeting_key = m.meeting_key", "relation_name": "\"f1\".\"f1_data\".\"final_car\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T16:52:38.047433Z", "completed_at": "2025-09-07T16:52:38.062298Z"}, {"name": "execute", "started_at": "2025-09-07T16:52:38.095560Z", "completed_at": "2025-09-07T16:52:38.264087Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.23880958557128906, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.f1_analytics.final_historical_analysis", "compiled": true, "compiled_code": "\n\nWITH first_position_record AS (\n    SELECT *\n    FROM (\n        SELECT\n            session_key,\n            driver_number,\n            position AS first_position,\n            date,\n            ROW_NUMBER() OVER (\n                PARTITION BY session_key, driver_number\n                ORDER BY date\n            ) AS rn\n        FROM stg_position\n    ) t\n    WHERE rn = 1\n),\nlap_metrics AS (\n    SELECT\n        l.lap_number,\n        l.session_key,\n        l.driver_number,\n        l.date_start,\n        l.date_end,\n        l.is_pit_out_lap,\n        l.duration_sector_1,\n        l.duration_sector_2,\n        l.duration_sector_3,\n        fpr.first_position,\n        MIN(i.gap_to_leader) AS min_gap_to_leader,\n        MAX(i.gap_to_leader) AS max_gap_to_leader,\n        ROUND(MIN(i.gap_to_next)::numeric,3) AS min_gap_to_next,\n        ROUND(MAX(i.gap_to_next)::numeric,3) AS max_gap_to_next,\n        sp.position AS start_position,\n        ep.position AS end_position\n    FROM \"f1\".\"f1_data\".\"stg_laps\" l\n    LEFT JOIN first_position_record fpr\n        ON l.session_key = fpr.session_key\n        AND l.driver_number = fpr.driver_number\n    LEFT JOIN \"f1\".\"f1_data\".\"stg_intervals\" i\n        ON i.session_key = l.session_key\n        AND i.driver_number = l.driver_number\n        AND date_trunc('second', i.date) BETWEEN l.date_start AND l.date_end\n    LEFT JOIN \"f1\".\"f1_data\".\"int_lap_position\" sp\n        ON l.session_key = sp.session_key\n        AND l.driver_number = sp.driver_number\n        AND l.lap_number = sp.lap_number\n        AND sp.start_position_rank = 1\n    LEFT JOIN \"f1\".\"f1_data\".\"int_lap_position\" ep\n        ON l.session_key = ep.session_key\n        AND l.driver_number = ep.driver_number\n        AND l.lap_number = ep.lap_number\n        AND ep.end_position_rank = 1\n    GROUP BY\n        l.lap_number, l.session_key, l.driver_number, l.date_start,\n        l.date_end, l.is_pit_out_lap,\n        l.duration_sector_1, l.duration_sector_2, l.duration_sector_3,\n        fpr.first_position, sp.position, ep.position\n),\nfilled_positions AS (\n    SELECT\n        *,\n        CASE\n            WHEN lap_number = 1 THEN first_position\n            ELSE COALESCE(\n                start_position,\n                MAX(start_position) OVER (\n                    PARTITION BY session_key, driver_number\n                    ORDER BY lap_number\n                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n                ),\n                first_position\n            )\n        END AS lap_start_position,\n        CASE\n            WHEN lap_number = 1 THEN first_position\n            ELSE COALESCE(\n                end_position,\n                MAX(end_position) OVER (\n                    PARTITION BY session_key, driver_number\n                    ORDER BY lap_number\n                    ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW\n                ),\n                first_position\n            )\n        END AS lap_end_position\n    FROM lap_metrics\n)\nSELECT\n    lap_number,\n    session_key,\n    driver_number,\n    date_start AS lap_start_time,\n    date_end AS lap_end_time,\n    is_pit_out_lap,\n    duration_sector_1,\n    duration_sector_2,\n    duration_sector_3,\n    min_gap_to_leader,\n    max_gap_to_leader,\n    min_gap_to_next,\n    max_gap_to_next,\n    lap_start_position,\n    lap_end_position,\n    first_position AS race_start_position\nFROM filled_positions", "relation_name": "\"f1\".\"f1_data\".\"final_historical_analysis\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T16:52:38.055778Z", "completed_at": "2025-09-07T16:52:38.095014Z"}, {"name": "execute", "started_at": "2025-09-07T16:52:38.104499Z", "completed_at": "2025-09-07T16:52:38.277164Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.24610519409179688, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.f1_analytics.final_session_filters", "compiled": true, "compiled_code": "WITH session_drivers AS (\n   SELECT DISTINCT\n       s.session_key,\n       s.country_name,\n       s.session_name,\n       s.session_type,\n       s.year,\n       d.driver_number,\n       concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name\n   FROM \"f1\".\"f1_data\".\"stg_sessions\" s\n   JOIN \"f1\".\"f1_data\".\"stg_drivers\" d ON s.session_key = d.session_key\n)\nSELECT\n   s.session_key,\n    s.year,\n   s.country_name,\n   s.circuit_short_name,\n   s.session_name,\n   s.session_type,\n   concat(s.year, ' - ', s.country_name, ' - ', s.session_name) as session_display_name,\n   array_agg(DISTINCT sd.driver_display_name) as available_driver_names,\n   m.meeting_name,\n   m.meeting_official_name,\n   s.date_start\nFROM \"f1\".\"f1_data\".\"stg_sessions\" s\nJOIN session_drivers sd ON s.session_key = sd.session_key\nJOIN \"f1\".\"f1_data\".\"stg_meeting\" m ON s.year = m.year\n   AND s.country_name = m.country_name\nGROUP BY 1,2,3,4,5,6,7,9,10,11", "relation_name": "\"f1\".\"f1_data\".\"final_session_filters\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T16:52:38.051438Z", "completed_at": "2025-09-07T16:52:38.063301Z"}, {"name": "execute", "started_at": "2025-09-07T16:52:38.099574Z", "completed_at": "2025-09-07T16:52:38.283561Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2566874027252197, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.f1_analytics.final_session_driver_mapping", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    d.session_key,\n    concat(d.name_acronym, ' - ', d.full_name, ' (', d.team_name, ')') as driver_display_name,\n    d.driver_number\nFROM \"f1\".\"f1_data\".\"stg_drivers\" d\nJOIN \"f1\".\"f1_data\".\"stg_sessions\" s ON d.session_key = s.session_key", "relation_name": "\"f1\".\"f1_data\".\"final_session_driver_mapping\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T16:52:38.300804Z", "completed_at": "2025-09-07T16:52:38.309970Z"}, {"name": "execute", "started_at": "2025-09-07T16:52:38.310972Z", "completed_at": "2025-09-07T16:52:38.403505Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.10999202728271484, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.f1_analytics.final_session_mapping", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    EXTRACT(YEAR FROM date_start)::text || ' - ' || country_name || ' - ' || session_name AS session_display_name,\n    session_key\nFROM \"f1\".\"f1_data\".\"stg_sessions\"", "relation_name": "\"f1\".\"f1_data\".\"final_session_mapping\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T16:52:38.303950Z", "completed_at": "2025-09-07T16:52:38.316973Z"}, {"name": "execute", "started_at": "2025-09-07T16:52:38.318481Z", "completed_at": "2025-09-07T16:52:38.406523Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.11395955085754395, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.f1_analytics.final_tyre_performance", "compiled": true, "compiled_code": "\n\nWITH tire_performance AS (\n    SELECT\n        circuit_short_name,\n        compound,\n        team_name,\n        driver_number,\n        AVG(stint_length) as avg_stint_length,\n        MAX(stint_length) as max_stint_length,\n        AVG(tyre_age_at_start) as avg_starting_age,\n        COUNT(*) as number_of_stints\n    FROM \"f1\".\"f1_data\".\"int_tyre_stint\"\n    GROUP BY 1,2,3,4\n)\n\nSELECT\n    circuit_short_name,\n    compound,\n    round(AVG(avg_stint_length),2) as circuit_compound_avg_stint_length,\n    MAX(max_stint_length) as circuit_compound_max_stint_length,\n    round(AVG(avg_starting_age),2) as avg_tire_age_start,\n    SUM(number_of_stints) as total_stints\nFROM tire_performance\nGROUP BY 1,2", "relation_name": "\"f1\".\"f1_data\".\"final_tyre_performance\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T16:52:38.419438Z", "completed_at": "2025-09-07T16:52:38.426536Z"}, {"name": "execute", "started_at": "2025-09-07T16:52:38.427563Z", "completed_at": "2025-09-07T16:52:38.505403Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08849906921386719, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.f1_analytics.final_race_leaderboard", "compiled": true, "compiled_code": "\n\nWITH final_rankings AS (\n   SELECT\n       session_key,\n       driver_number,\n       position\n   FROM int_final_position\n)\nSELECT\n   fr.session_key,\n   d.driver_number,\n   d.broadcast_name AS driver_name,\n   fr.position,\n   d.team_name,\n   d.team_colour AS team_color,\n   CASE\n       WHEN fr.position = 1 THEN 0\n       ELSE fi.max_gap_to_leader\n   END as gap_to_leader,\n   fi.max_gap_to_next as gap_to_next,\n   bl.fastest_lap,\n   ps.pit_stop_count,\n\n   CASE\n       WHEN fr.position = 1 THEN 25\n       WHEN fr.position = 2 THEN 18\n       WHEN fr.position = 3 THEN 15\n       WHEN fr.position = 4 THEN 12\n       WHEN fr.position = 5 THEN 10\n       WHEN fr.position = 6 THEN 8\n       WHEN fr.position = 7 THEN 6\n       WHEN fr.position = 8 THEN 4\n       WHEN fr.position = 9 THEN 2\n       WHEN fr.position = 10 THEN 1\n       ELSE 0\n   END AS points\nFROM final_rankings fr\nJOIN \"f1\".\"f1_data\".\"stg_drivers\" d\n   ON fr.driver_number = d.driver_number\n   AND fr.session_key = d.session_key\nLEFT JOIN \"f1\".\"f1_data\".\"int_final_intervals\" fi\n   ON fr.session_key = fi.session_key\n   AND fr.driver_number = fi.driver_number\nLEFT JOIN \"f1\".\"f1_data\".\"int_best_laps\" bl\n   ON fr.session_key = bl.session_key\n   AND fr.driver_number = bl.driver_number\nLEFT JOIN \"f1\".\"f1_data\".\"int_pit_stop\" ps\n   ON fr.session_key = ps.session_key\n   AND fr.driver_number = ps.driver_number\nJOIN \"f1\".\"f1_data\".\"final_session_mapping\" m\n   ON fr.session_key = m.session_key\nORDER BY fr.position", "relation_name": "\"f1\".\"f1_data\".\"final_race_leaderboard\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-07T16:52:38.514406Z", "completed_at": "2025-09-07T16:52:38.521004Z"}, {"name": "execute", "started_at": "2025-09-07T16:52:38.522023Z", "completed_at": "2025-09-07T16:52:38.600218Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0877537727355957, "adapter_response": {"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}, "message": "CREATE VIEW", "failures": null, "unique_id": "model.f1_analytics.final_race_summary", "compiled": true, "compiled_code": "\n\nWITH positions AS (\n   SELECT\n       session_key,\n       COUNT(DISTINCT driver_number) as total_drivers\n\n   FROM \"f1\".\"f1_data\".\"stg_position\"\n   GROUP BY session_key\n),\nlaps AS (\n   SELECT\n       session_key,\n       MAX(lap_number) as total_laps\n   FROM \"f1\".\"f1_data\".\"stg_laps\"\n   GROUP BY session_key\n),\nteam_stats AS (\n   SELECT\n       session_key,\n       SUM(pit_stop_count) as total_pit_stops,\n        COUNT(DISTINCT team_name) as total_teams\n   FROM \"f1\".\"f1_data\".\"final_race_leaderboard\"\n   GROUP BY session_key\n),\ndriver_stats AS (\n   SELECT\n       session_key,\n       driver_number,\n       MAX(speed) as top_speed,\n       AVG(speed) as avg_speed\n   FROM \"f1\".\"f1_data\".\"stg_car_data\"\n   GROUP BY session_key, driver_number\n),\ncte as(\nSELECT\n   p.session_key,\n   m.session_display_name,\n   p.total_drivers,\n   l.total_laps,\n   MAX(d.top_speed) as fastest_speed,\n   round(AVG(d.avg_speed),3) as average_speed\nFROM positions p\nJOIN laps l ON p.session_key = l.session_key\nJOIN \"f1\".\"f1_data\".\"final_session_mapping\" m ON p.session_key = m.session_key\nLEFT JOIN driver_stats d ON p.session_key = d.session_key\nGROUP BY p.session_key, m.session_display_name, p.total_drivers, l.total_laps\n)\nselect c.session_key,\n   c.session_display_name,\n   c.total_drivers,\n    t.total_teams,\n   c.total_laps,\n   t.total_pit_stops,\n    c.fastest_speed,\n   c.average_speed\nfrom cte c left join team_stats t on c.session_key=t.session_key", "relation_name": "\"f1\".\"f1_data\".\"final_race_summary\"", "batch_results": null}], "elapsed_time": 0.899327278137207, "args": {"favor_state": false, "introspect": true, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors": true, "validate_macro_args": false, "show_all_deprecations": false, "print": true, "vars": {}, "log_path": "C:\\Users\\samee\\Desktop\\F1\\dbt\\logs", "require_nested_cumulative_type_params": false, "state_modified_compare_vars": false, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "defer": false, "partial_parse": true, "invocation_command": "dbt run --select marts", "show_resource_report": false, "profiles_dir": "C:\\Users\\samee\\Desktop\\F1\\dbt", "require_yaml_configuration_for_mf_time_spines": false, "upload_to_artifacts_ingest_api": false, "warn_error_options": {"error": [], "warn": [], "silence": []}, "select": ["marts"], "empty": false, "use_fast_test_edges": false, "state_modified_compare_more_unrendered_values": false, "use_colors_file": true, "log_format": "default", "log_level": "info", "quiet": false, "require_generic_test_arguments_property": false, "indirect_selection": "eager", "printer_width": 80, "log_file_max_bytes": 10485760, "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": true, "skip_nodes_if_on_run_start_fails": false, "write_json": true, "require_resource_names_without_spaces": true, "which": "run", "project_dir": "C:\\Users\\samee\\Desktop\\F1\\dbt", "populate_cache": true, "version_check": true, "partial_parse_file_diff": true, "macro_debugging": false, "log_format_file": "debug", "exclude": [], "cache_selected_only": false, "static_parser": true, "strict_mode": false, "require_all_warnings_handled_by_warn_error": false}}